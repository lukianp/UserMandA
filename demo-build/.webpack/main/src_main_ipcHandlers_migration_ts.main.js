"use strict";exports.id="src_main_ipcHandlers_migration_ts",exports.ids=["src_main_ipcHandlers_migration_ts"],exports.modules={"./src/main/ipcHandlers.migration.ts":(s,e,t)=>{t.d(e,{registerMigrationHandlers:()=>r});var n=t("electron"),a=t("./src/main/services/migrationPlanningService.ts");function r(s){(0,a.getMigrationPlanningService)();let e=null;s&&(e=s),n.ipcMain.handle("inventory:get-discovery-files",async(s,e)=>{try{return{success:!0,files:[]}}catch(s){return{success:!1,error:s.message}}}),n.ipcMain.handle("inventory:read-discovery-file",async(s,e)=>{try{return{success:!0,content:""}}catch(s){return{success:!1,error:s.message}}}),n.ipcMain.handle("migration:create-wave",async(s,e)=>{try{return console.log(`[IPC] Create wave: ${e.name}`),{success:!0,wave:e}}catch(s){return{success:!1,error:s.message}}}),n.ipcMain.handle("migration:get-waves",async(s,e)=>{try{return console.log("[IPC] Get waves with filters:",e),{success:!0,waves:[]}}catch(s){return{success:!1,error:s.message}}}),n.ipcMain.handle("migration:assign-entities-to-wave",async(s,e,t,n)=>{try{return console.log(`[IPC] Assign ${t.length} entities to wave ${e}`),{success:!0}}catch(s){return{success:!1,error:s.message}}}),n.ipcMain.handle("migration:get-wave-summary",async(s,e)=>{try{return console.log(`[IPC] Get wave summary for: ${e}`),{success:!0,summary:null}}catch(s){return{success:!1,error:s.message}}}),n.ipcMain.handle("migration:suggest-wave-assignments",async(s,e,t)=>{try{return console.log(`[IPC] Suggest wave assignments: ${e} â†’ ${t}`),{success:!0,suggestions:{}}}catch(s){return{success:!1,error:s.message}}}),console.log("Migration planning and consolidated inventory IPC handlers registered")}},"./src/main/services/migrationPlanningService.ts":(s,e,t)=>{t.d(e,{getMigrationPlanningService:()=>o});var n=t("fs"),a=t("path");class r{plansDir;plans=new Map;constructor(s="C:\\DiscoveryData"){this.plansDir=a.join(s,"MigrationPlans"),this.ensureDirectoryExists()}ensureDirectoryExists(){n.existsSync(this.plansDir)||n.mkdirSync(this.plansDir,{recursive:!0})}async createPlan(s){const e={id:crypto.randomUUID(),...s,waves:[],created:(new Date).toISOString(),modified:(new Date).toISOString()};return this.plans.set(e.id,e),await this.savePlan(e),e}async addWave(s,e){const t=this.plans.get(s);if(!t)throw new Error(`Migration plan not found: ${s}`);const n={id:crypto.randomUUID(),...e,status:"planned",users:[],priority:e.priority||1,dependencies:e.dependencies||[],created:(new Date).toISOString(),modified:(new Date).toISOString()};return t.waves.push(n),t.modified=(new Date).toISOString(),await this.savePlan(t),n}async assignUsersToWave(s,e,t){const n=this.plans.get(s);if(!n)throw new Error(`Migration plan not found: ${s}`);const a=n.waves.find(s=>s.id===e);if(!a)throw new Error(`Wave not found: ${e}`);const r=new Set(a.users);t.forEach(s=>r.add(s)),a.users=Array.from(r),a.modified=(new Date).toISOString(),n.modified=(new Date).toISOString(),await this.savePlan(n)}async updateWaveStatus(s,e,t){const n=this.plans.get(s);if(!n)throw new Error(`Migration plan not found: ${s}`);const a=n.waves.find(s=>s.id===e);if(!a)throw new Error(`Wave not found: ${e}`);a.status=t,a.modified=(new Date).toISOString(),n.modified=(new Date).toISOString(),await this.savePlan(n)}async getPlan(s){if(this.plans.has(s)){return this.plans.get(s)||null}const e=a.join(this.plansDir,`${s}.json`);if(n.existsSync(e)){const s=await n.promises.readFile(e,"utf8"),t=JSON.parse(s);return this.plans.set(t.id,t),t}return null}async getPlansByProfile(s){return await this.loadAllPlans(),Array.from(this.plans.values()).filter(e=>e.profileName===s)}async deletePlan(s){this.plans.delete(s);const e=a.join(this.plansDir,`${s}.json`);n.existsSync(e)&&await n.promises.unlink(e)}async savePlan(s){const e=a.join(this.plansDir,`${s.id}.json`);await n.promises.writeFile(e,JSON.stringify(s,null,2),"utf8")}async loadAllPlans(){if(!n.existsSync(this.plansDir))return;const s=(await n.promises.readdir(this.plansDir)).filter(s=>s.endsWith(".json"));for(const e of s)try{const s=await n.promises.readFile(a.join(this.plansDir,e),"utf8"),t=JSON.parse(s);this.plans.set(t.id,t)}catch(s){console.error(`Failed to load migration plan ${e}:`,s)}}getStatistics(){const s=Array.from(this.plans.values()).flatMap(s=>s.waves);return{totalPlans:this.plans.size,totalWaves:s.length,wavesByStatus:{planned:s.filter(s=>"planned"===s.status).length,inprogress:s.filter(s=>"inprogress"===s.status).length,completed:s.filter(s=>"completed"===s.status).length,failed:s.filter(s=>"failed"===s.status).length},totalUsersAssigned:Array.from(new Set(s.flatMap(s=>s.users))).length}}}let i=null;function o(s){return i||(i=new r(s)),i}}};
//# sourceMappingURL=src_main_ipcHandlers_migration_ts.main.js.map