{"version":3,"file":"src_main_ipc_applicationFactSheetHandlers_ts.main.js","mappings":"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","sources":["webpack://enterprise-discovery-suite/./src/main/ipc/applicationFactSheetHandlers.ts","webpack://enterprise-discovery-suite/./src/main/services/applicationFactsService.ts"],"sourcesContent":["/**\n * Application Fact Sheet IPC Handlers\n *\n * IPC handlers for LeanIX-style application fact sheet operations:\n * - CRUD operations for fact sheets\n * - Observation/provenance tracking\n * - Relation management\n * - Statistics and filtering\n * - Discovery import\n */\nimport { ipcMain } from 'electron';\nimport { getApplicationFactsService } from '../services/applicationFactsService';\n/**\n * Register all application fact sheet IPC handlers\n */\nexport function registerApplicationFactSheetHandlers() {\n    const service = getApplicationFactsService();\n    // ========================================\n    // CRUD HANDLERS\n    // ========================================\n    /**\n     * Create a new application fact sheet\n     */\n    ipcMain.handle('factsheet:create', async (_event, { sourceProfileId, name, inventoryEntityId }) => {\n        try {\n            console.log('[IPC] factsheet:create', name);\n            const factSheet = await service.create(sourceProfileId, name, inventoryEntityId);\n            return { success: true, data: factSheet };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:create error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Get fact sheet by ID\n     */\n    ipcMain.handle('factsheet:getById', async (_event, id) => {\n        try {\n            console.log('[IPC] factsheet:getById', id);\n            const factSheet = await service.getById(id);\n            if (!factSheet) {\n                return { success: false, error: 'Fact sheet not found' };\n            }\n            return { success: true, data: factSheet };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:getById error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Get fact sheet by inventory entity ID\n     */\n    ipcMain.handle('factsheet:getByInventoryEntity', async (_event, inventoryEntityId) => {\n        try {\n            console.log('[IPC] factsheet:getByInventoryEntity', inventoryEntityId);\n            const factSheet = await service.getByInventoryEntityId(inventoryEntityId);\n            return { success: true, data: factSheet };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:getByInventoryEntity error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Get all fact sheets with optional filters\n     */\n    ipcMain.handle('factsheet:getAll', async (_event, filters) => {\n        try {\n            console.log('[IPC] factsheet:getAll', filters);\n            const factSheets = await service.getAll(filters);\n            return { success: true, data: factSheets };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:getAll error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Update a section of a fact sheet\n     */\n    ipcMain.handle('factsheet:updateSection', async (_event, { id, section, updates, updatedBy, }) => {\n        try {\n            console.log('[IPC] factsheet:updateSection', id, section);\n            const factSheet = await service.updateSection(id, section, updates, updatedBy);\n            if (!factSheet) {\n                return { success: false, error: 'Fact sheet not found' };\n            }\n            return { success: true, data: factSheet };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:updateSection error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Delete a fact sheet\n     */\n    ipcMain.handle('factsheet:delete', async (_event, id) => {\n        try {\n            console.log('[IPC] factsheet:delete', id);\n            const deleted = await service.delete(id);\n            if (!deleted) {\n                return { success: false, error: 'Fact sheet not found' };\n            }\n            return { success: true, data: { deleted: true } };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:delete error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    // ========================================\n    // OBSERVATION HANDLERS\n    // ========================================\n    /**\n     * Add an observation (discovered value with provenance)\n     */\n    ipcMain.handle('factsheet:addObservation', async (_event, { applicationId, field, value, source, sourceFile, confidence, }) => {\n        try {\n            console.log('[IPC] factsheet:addObservation', applicationId, field);\n            const observation = await service.addObservation(applicationId, field, value, source, sourceFile, confidence);\n            if (!observation) {\n                return { success: false, error: 'Fact sheet not found' };\n            }\n            return { success: true, data: observation };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:addObservation error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Verify an observation\n     */\n    ipcMain.handle('factsheet:verifyObservation', async (_event, { applicationId, observationId, verifiedBy }) => {\n        try {\n            console.log('[IPC] factsheet:verifyObservation', applicationId, observationId);\n            const observation = await service.verifyObservation(applicationId, observationId, verifiedBy);\n            if (!observation) {\n                return { success: false, error: 'Observation not found' };\n            }\n            return { success: true, data: observation };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:verifyObservation error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Get observation history for a fact sheet\n     */\n    ipcMain.handle('factsheet:getObservations', async (_event, { applicationId, field }) => {\n        try {\n            console.log('[IPC] factsheet:getObservations', applicationId, field);\n            const observations = await service.getObservationHistory(applicationId, field);\n            return { success: true, data: observations };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:getObservations error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    // ========================================\n    // RELATION HANDLERS\n    // ========================================\n    /**\n     * Add a relation to a fact sheet\n     */\n    ipcMain.handle('factsheet:addRelation', async (_event, { sourceId, sourceType, targetId, targetType, targetName, relationType, source, description, }) => {\n        try {\n            console.log('[IPC] factsheet:addRelation', sourceId, relationType, targetName);\n            const relation = await service.addRelation(sourceId, sourceType, targetId, targetType, targetName, relationType, source, description);\n            if (!relation) {\n                return { success: false, error: 'Fact sheet not found' };\n            }\n            return { success: true, data: relation };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:addRelation error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Remove a relation from a fact sheet\n     */\n    ipcMain.handle('factsheet:removeRelation', async (_event, { applicationId, relationId }) => {\n        try {\n            console.log('[IPC] factsheet:removeRelation', applicationId, relationId);\n            const removed = await service.removeRelation(applicationId, relationId);\n            if (!removed) {\n                return { success: false, error: 'Relation not found' };\n            }\n            return { success: true, data: { removed: true } };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:removeRelation error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    /**\n     * Get relations for a fact sheet\n     */\n    ipcMain.handle('factsheet:getRelations', async (_event, applicationId) => {\n        try {\n            console.log('[IPC] factsheet:getRelations', applicationId);\n            const relations = await service.getRelations(applicationId);\n            return { success: true, data: relations };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:getRelations error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    // ========================================\n    // STATISTICS HANDLERS\n    // ========================================\n    /**\n     * Get fact sheet statistics\n     */\n    ipcMain.handle('factsheet:getStatistics', async (_event, sourceProfileId) => {\n        try {\n            console.log('[IPC] factsheet:getStatistics', sourceProfileId);\n            const stats = await service.getStatistics(sourceProfileId);\n            return { success: true, data: stats };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:getStatistics error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    // ========================================\n    // IMPORT HANDLERS\n    // ========================================\n    /**\n     * Import applications from discovery data\n     */\n    ipcMain.handle('factsheet:importFromDiscovery', async (_event, { sourceProfileId, applications, source, sourceFile, }) => {\n        try {\n            console.log('[IPC] factsheet:importFromDiscovery', applications.length, 'applications from', source);\n            const result = await service.importFromDiscovery(sourceProfileId, applications, source, sourceFile);\n            return { success: true, data: result };\n        }\n        catch (error) {\n            console.error('[IPC] factsheet:importFromDiscovery error:', error);\n            return { success: false, error: error.message };\n        }\n    });\n    console.log('[ApplicationFactSheetHandlers] Registered 14 IPC handlers');\n}\n","/**\n * Application Facts Service (Backend)\n *\n * Manages LeanIX-style application fact sheets with:\n * - CRUD operations for fact sheets\n * - Provenance tracking (which discovery module found what)\n * - Multi-source evidence aggregation\n * - Relation management\n * - Score calculations\n */\nimport * as path from 'path';\nimport * as fs from 'fs/promises';\nimport { app } from 'electron';\nimport { Low } from 'lowdb';\nimport { JSONFile } from 'lowdb/node';\nimport { v4 as uuidv4 } from 'uuid';\n// ============================================================================\n// Service Implementation\n// ============================================================================\nexport class ApplicationFactsService {\n    db;\n    isInitialized = false;\n    dbPath;\n    constructor() {\n        this.dbPath = path.join(app.getPath('appData'), 'MandADiscoverySuite', 'application-facts.json');\n    }\n    async initialize() {\n        if (this.isInitialized)\n            return;\n        await fs.mkdir(path.dirname(this.dbPath), { recursive: true });\n        const adapter = new JSONFile(this.dbPath);\n        this.db = new Low(adapter, { factSheets: [], version: 1 });\n        await this.db.read();\n        this.ensureData();\n        this.isInitialized = true;\n        console.log('[ApplicationFactsService] Initialized with', this.db.data?.factSheets.length, 'fact sheets');\n    }\n    ensureData() {\n        if (!this.db.data) {\n            this.db.data = { factSheets: [], version: 1 };\n        }\n        if (!this.db.data.factSheets) {\n            this.db.data.factSheets = [];\n        }\n        if (!this.db.data.version) {\n            this.db.data.version = 1;\n        }\n    }\n    // ============================================================================\n    // CRUD Operations\n    // ============================================================================\n    async create(sourceProfileId, name, inventoryEntityId) {\n        await this.initialize();\n        const now = new Date().toISOString();\n        const factSheet = {\n            id: uuidv4(),\n            sourceProfileId,\n            inventoryEntityId,\n            baseInfo: { name, tags: [], aliases: [] },\n            lifecycle: { phase: 'active' },\n            business: {\n                criticality: 'business_operational',\n                businessCapabilities: [],\n                businessProcesses: [],\n                departments: [],\n            },\n            technical: {\n                complexity: 'standard',\n                languages: [],\n                frameworks: [],\n                infrastructure: [],\n                databases: [],\n                integrations: [],\n                apisExposed: [],\n                apisConsumed: [],\n                documentationUrls: [],\n            },\n            security: {\n                dataClassification: 'internal',\n                containsPII: false,\n                containsPHI: false,\n                containsFinancialData: false,\n                complianceRequirements: [],\n                ssoEnabled: false,\n                vulnerabilities: [],\n            },\n            migration: {\n                disposition: 'retain',\n                status: 'not_started',\n                blockers: [],\n                prerequisites: [],\n                validationSteps: [],\n                riskLevel: 'medium',\n                riskFactors: [],\n            },\n            relations: [],\n            observations: [],\n            createdAt: now,\n            updatedAt: now,\n            readinessScore: 0,\n            overallRiskScore: 50,\n            completenessScore: 0,\n        };\n        this.db.data.factSheets.push(factSheet);\n        await this.db.write();\n        console.log('[ApplicationFactsService] Created fact sheet:', factSheet.id, name);\n        return factSheet;\n    }\n    async getById(id) {\n        await this.initialize();\n        return this.db.data.factSheets.find((fs) => fs.id === id) || null;\n    }\n    async getByInventoryEntityId(inventoryEntityId) {\n        await this.initialize();\n        return this.db.data.factSheets.find((fs) => fs.inventoryEntityId === inventoryEntityId) || null;\n    }\n    async getAll(filters) {\n        await this.initialize();\n        let results = this.db.data.factSheets;\n        if (filters) {\n            if (filters.sourceProfileId) {\n                results = results.filter((fs) => fs.sourceProfileId === filters.sourceProfileId);\n            }\n            if (filters.lifecyclePhase?.length) {\n                results = results.filter((fs) => filters.lifecyclePhase.includes(fs.lifecycle.phase));\n            }\n            if (filters.criticality?.length) {\n                results = results.filter((fs) => filters.criticality.includes(fs.business.criticality));\n            }\n            if (filters.disposition?.length) {\n                results = results.filter((fs) => filters.disposition.includes(fs.migration.disposition));\n            }\n            if (filters.waveId) {\n                results = results.filter((fs) => fs.migration.waveId === filters.waveId);\n            }\n            if (filters.search) {\n                const searchLower = filters.search.toLowerCase();\n                results = results.filter((fs) => fs.baseInfo.name.toLowerCase().includes(searchLower) ||\n                    fs.baseInfo.vendor?.toLowerCase().includes(searchLower) ||\n                    fs.baseInfo.description?.toLowerCase().includes(searchLower));\n            }\n            if (filters.tags?.length) {\n                results = results.filter((fs) => filters.tags.some((tag) => fs.baseInfo.tags.includes(tag)));\n            }\n            if (filters.minReadinessScore !== undefined) {\n                results = results.filter((fs) => fs.readinessScore >= filters.minReadinessScore);\n            }\n            if (filters.maxRiskScore !== undefined) {\n                results = results.filter((fs) => fs.overallRiskScore <= filters.maxRiskScore);\n            }\n        }\n        return results.map((fs) => ({\n            id: fs.id,\n            name: fs.baseInfo.name,\n            vendor: fs.baseInfo.vendor,\n            lifecyclePhase: fs.lifecycle.phase,\n            criticality: fs.business.criticality,\n            disposition: fs.migration.disposition,\n            readinessScore: fs.readinessScore,\n            riskScore: fs.overallRiskScore,\n            relationCount: fs.relations.length,\n            completenessScore: fs.completenessScore,\n        }));\n    }\n    async updateSection(id, section, updates, updatedBy) {\n        await this.initialize();\n        const factSheet = this.db.data.factSheets.find((fs) => fs.id === id);\n        if (!factSheet)\n            return null;\n        // Merge updates into the section\n        factSheet[section] = { ...factSheet[section], ...updates };\n        factSheet.updatedAt = new Date().toISOString();\n        if (updatedBy)\n            factSheet.updatedBy = updatedBy;\n        // Recalculate scores\n        this.calculateScores(factSheet);\n        await this.db.write();\n        console.log('[ApplicationFactsService] Updated section:', section, 'for', id);\n        return factSheet;\n    }\n    async delete(id) {\n        await this.initialize();\n        const index = this.db.data.factSheets.findIndex((fs) => fs.id === id);\n        if (index === -1)\n            return false;\n        this.db.data.factSheets.splice(index, 1);\n        await this.db.write();\n        console.log('[ApplicationFactsService] Deleted fact sheet:', id);\n        return true;\n    }\n    // ============================================================================\n    // Observations (Provenance Tracking)\n    // ============================================================================\n    async addObservation(applicationId, field, value, source, sourceFile, confidence = 'medium') {\n        await this.initialize();\n        const factSheet = this.db.data.factSheets.find((fs) => fs.id === applicationId);\n        if (!factSheet)\n            return null;\n        // Deactivate previous observations for this field\n        factSheet.observations\n            .filter((o) => o.field === field && o.isActive)\n            .forEach((o) => (o.isActive = false));\n        const observation = {\n            id: uuidv4(),\n            applicationId,\n            field,\n            value,\n            provenance: {\n                source,\n                discoveredAt: new Date().toISOString(),\n                confidence,\n                sourceFile,\n                verified: false,\n            },\n            isActive: true,\n        };\n        factSheet.observations.push(observation);\n        factSheet.updatedAt = new Date().toISOString();\n        // Apply the value to the fact sheet if it's a known field\n        this.applyObservationValue(factSheet, field, value);\n        this.calculateScores(factSheet);\n        await this.db.write();\n        console.log('[ApplicationFactsService] Added observation for', field, 'from', source);\n        return observation;\n    }\n    async verifyObservation(applicationId, observationId, verifiedBy) {\n        await this.initialize();\n        const factSheet = this.db.data.factSheets.find((fs) => fs.id === applicationId);\n        if (!factSheet)\n            return null;\n        const observation = factSheet.observations.find((o) => o.id === observationId);\n        if (!observation)\n            return null;\n        observation.provenance.verified = true;\n        observation.provenance.verifiedBy = verifiedBy;\n        observation.provenance.verifiedAt = new Date().toISOString();\n        observation.provenance.confidence = 'high';\n        factSheet.updatedAt = new Date().toISOString();\n        this.calculateScores(factSheet);\n        await this.db.write();\n        return observation;\n    }\n    async getObservationHistory(applicationId, field) {\n        await this.initialize();\n        const factSheet = this.db.data.factSheets.find((fs) => fs.id === applicationId);\n        if (!factSheet)\n            return [];\n        if (field) {\n            return factSheet.observations.filter((o) => o.field === field);\n        }\n        return factSheet.observations;\n    }\n    // ============================================================================\n    // Relations\n    // ============================================================================\n    async addRelation(sourceId, sourceType, targetId, targetType, targetName, relationType, source, description) {\n        await this.initialize();\n        const factSheet = this.db.data.factSheets.find((fs) => fs.id === sourceId);\n        if (!factSheet)\n            return null;\n        // Check for duplicate\n        const existing = factSheet.relations.find((r) => r.targetId === targetId && r.relationType === relationType);\n        if (existing) {\n            console.log('[ApplicationFactsService] Relation already exists, skipping');\n            return existing;\n        }\n        const relation = {\n            id: uuidv4(),\n            sourceId,\n            sourceType,\n            targetId,\n            targetType,\n            targetName,\n            relationType,\n            description,\n            provenance: {\n                source,\n                discoveredAt: new Date().toISOString(),\n                confidence: 'medium',\n                verified: false,\n            },\n        };\n        factSheet.relations.push(relation);\n        factSheet.updatedAt = new Date().toISOString();\n        await this.db.write();\n        console.log('[ApplicationFactsService] Added relation:', relationType, 'to', targetName);\n        return relation;\n    }\n    async removeRelation(applicationId, relationId) {\n        await this.initialize();\n        const factSheet = this.db.data.factSheets.find((fs) => fs.id === applicationId);\n        if (!factSheet)\n            return false;\n        const index = factSheet.relations.findIndex((r) => r.id === relationId);\n        if (index === -1)\n            return false;\n        factSheet.relations.splice(index, 1);\n        factSheet.updatedAt = new Date().toISOString();\n        await this.db.write();\n        return true;\n    }\n    async getRelations(applicationId) {\n        await this.initialize();\n        const factSheet = this.db.data.factSheets.find((fs) => fs.id === applicationId);\n        return factSheet?.relations || [];\n    }\n    // ============================================================================\n    // Statistics\n    // ============================================================================\n    async getStatistics(sourceProfileId) {\n        await this.initialize();\n        let factSheets = this.db.data.factSheets;\n        if (sourceProfileId) {\n            factSheets = factSheets.filter((fs) => fs.sourceProfileId === sourceProfileId);\n        }\n        const stats = {\n            total: factSheets.length,\n            byLifecycle: { plan: 0, phase_in: 0, active: 0, phase_out: 0, end_of_life: 0 },\n            byCriticality: {\n                mission_critical: 0,\n                business_critical: 0,\n                business_operational: 0,\n                administrative: 0,\n            },\n            byDisposition: {\n                retain: 0,\n                retire: 0,\n                replace: 0,\n                rehost: 0,\n                refactor: 0,\n                replatform: 0,\n                repurchase: 0,\n            },\n            byWave: {},\n            averageReadiness: 0,\n            averageRisk: 0,\n            averageCompleteness: 0,\n        };\n        if (factSheets.length === 0)\n            return stats;\n        let totalReadiness = 0;\n        let totalRisk = 0;\n        let totalCompleteness = 0;\n        for (const fs of factSheets) {\n            stats.byLifecycle[fs.lifecycle.phase]++;\n            stats.byCriticality[fs.business.criticality]++;\n            stats.byDisposition[fs.migration.disposition]++;\n            if (fs.migration.waveId) {\n                stats.byWave[fs.migration.waveId] = (stats.byWave[fs.migration.waveId] || 0) + 1;\n            }\n            totalReadiness += fs.readinessScore;\n            totalRisk += fs.overallRiskScore;\n            totalCompleteness += fs.completenessScore;\n        }\n        stats.averageReadiness = Math.round(totalReadiness / factSheets.length);\n        stats.averageRisk = Math.round(totalRisk / factSheets.length);\n        stats.averageCompleteness = Math.round(totalCompleteness / factSheets.length);\n        return stats;\n    }\n    // ============================================================================\n    // Import from Discovery\n    // ============================================================================\n    async importFromDiscovery(sourceProfileId, applications, source, sourceFile) {\n        await this.initialize();\n        let created = 0;\n        let updated = 0;\n        let errors = 0;\n        for (const app of applications) {\n            try {\n                const name = app.DisplayName || app.Name || app.displayName || app.name;\n                if (!name) {\n                    errors++;\n                    continue;\n                }\n                // Check if fact sheet already exists by name\n                let factSheet = this.db.data.factSheets.find((fs) => fs.sourceProfileId === sourceProfileId &&\n                    fs.baseInfo.name.toLowerCase() === name.toLowerCase());\n                if (!factSheet) {\n                    factSheet = await this.create(sourceProfileId, name);\n                    created++;\n                }\n                else {\n                    updated++;\n                }\n                // Add observations for discovered fields\n                const fieldMappings = {\n                    Publisher: 'baseInfo.vendor',\n                    Vendor: 'baseInfo.vendor',\n                    Version: 'baseInfo.version',\n                    Description: 'baseInfo.description',\n                    AppId: 'baseInfo.externalId',\n                    ApplicationId: 'baseInfo.externalId',\n                };\n                for (const [sourceField, targetField] of Object.entries(fieldMappings)) {\n                    if (app[sourceField]) {\n                        await this.addObservation(factSheet.id, targetField, app[sourceField], source, sourceFile, 'medium');\n                    }\n                }\n            }\n            catch (error) {\n                console.error('[ApplicationFactsService] Import error:', error);\n                errors++;\n            }\n        }\n        console.log('[ApplicationFactsService] Import complete:', created, 'created,', updated, 'updated,', errors, 'errors');\n        return { created, updated, errors };\n    }\n    // ============================================================================\n    // Private Helpers\n    // ============================================================================\n    applyObservationValue(factSheet, field, value) {\n        const parts = field.split('.');\n        if (parts.length !== 2)\n            return;\n        const [section, prop] = parts;\n        if (section in factSheet && typeof factSheet[section] === 'object') {\n            factSheet[section][prop] = value;\n        }\n    }\n    calculateScores(factSheet) {\n        // Completeness score based on filled fields\n        let filledFields = 0;\n        let totalFields = 0;\n        const checkSection = (section, fields) => {\n            for (const field of fields) {\n                totalFields++;\n                const value = section[field];\n                if (value !== undefined && value !== null && value !== '' && (!Array.isArray(value) || value.length > 0)) {\n                    filledFields++;\n                }\n            }\n        };\n        checkSection(factSheet.baseInfo, ['name', 'description', 'vendor', 'version', 'applicationType']);\n        checkSection(factSheet.lifecycle, ['phase', 'phaseStartDate']);\n        checkSection(factSheet.business, ['criticality', 'businessOwner', 'departments', 'userCount']);\n        checkSection(factSheet.technical, ['complexity', 'technicalOwner', 'hostingType', 'languages']);\n        checkSection(factSheet.security, ['dataClassification', 'authenticationMethod', 'ssoEnabled']);\n        checkSection(factSheet.migration, ['disposition', 'status']);\n        factSheet.completenessScore = Math.round((filledFields / totalFields) * 100);\n        // Readiness score based on migration status and completeness\n        let readiness = factSheet.completenessScore * 0.4; // 40% from completeness\n        // Add points for migration readiness\n        if (factSheet.migration.disposition !== 'retain')\n            readiness += 10;\n        if (factSheet.migration.status === 'completed')\n            readiness += 30;\n        else if (factSheet.migration.status === 'in_progress')\n            readiness += 20;\n        else if (factSheet.migration.waveId)\n            readiness += 10;\n        // Add points for verified data\n        const verifiedCount = factSheet.observations.filter((o) => o.provenance.verified).length;\n        readiness += Math.min(verifiedCount * 2, 20);\n        factSheet.readinessScore = Math.min(Math.round(readiness), 100);\n        // Risk score based on various factors\n        let risk = 50; // Start at medium\n        // Criticality affects risk\n        if (factSheet.business.criticality === 'mission_critical')\n            risk += 20;\n        else if (factSheet.business.criticality === 'business_critical')\n            risk += 10;\n        else if (factSheet.business.criticality === 'administrative')\n            risk -= 10;\n        // Complexity affects risk\n        if (factSheet.technical.complexity === 'highly_complex')\n            risk += 15;\n        else if (factSheet.technical.complexity === 'complex')\n            risk += 10;\n        else if (factSheet.technical.complexity === 'simple')\n            risk -= 10;\n        // Security factors\n        if (factSheet.security.containsPII)\n            risk += 10;\n        if (factSheet.security.containsPHI)\n            risk += 15;\n        if (factSheet.security.containsFinancialData)\n            risk += 10;\n        if (!factSheet.security.ssoEnabled)\n            risk += 5;\n        // Blockers increase risk\n        risk += factSheet.migration.blockers.length * 5;\n        factSheet.overallRiskScore = Math.max(0, Math.min(Math.round(risk), 100));\n    }\n}\n// Singleton instance\nlet serviceInstance = null;\nexport function getApplicationFactsService() {\n    if (!serviceInstance) {\n        serviceInstance = new ApplicationFactsService();\n    }\n    return serviceInstance;\n}\n"],"names":["registerApplicationFactSheetHandlers","service","getApplicationFactsService","ipcMain","handle","async","_event","sourceProfileId","name","inventoryEntityId","console","log","success","data","create","error","message","id","factSheet","getById","getByInventoryEntityId","filters","getAll","section","updates","updatedBy","updateSection","delete","deleted","applicationId","field","value","source","sourceFile","confidence","observation","addObservation","observationId","verifiedBy","verifyObservation","getObservationHistory","sourceId","sourceType","targetId","targetType","targetName","relationType","description","relation","addRelation","relationId","removeRelation","removed","getRelations","getStatistics","applications","length","importFromDiscovery","ApplicationFactsService","db","isInitialized","dbPath","constructor","this","app","getPath","initialize","recursive","adapter","JSONFile","Low","factSheets","version","read","ensureData","now","Date","toISOString","baseInfo","tags","aliases","lifecycle","phase","business","criticality","businessCapabilities","businessProcesses","departments","technical","complexity","languages","frameworks","infrastructure","databases","integrations","apisExposed","apisConsumed","documentationUrls","security","dataClassification","containsPII","containsPHI","containsFinancialData","complianceRequirements","ssoEnabled","vulnerabilities","migration","disposition","status","blockers","prerequisites","validationSteps","riskLevel","riskFactors","relations","observations","createdAt","updatedAt","readinessScore","overallRiskScore","completenessScore","push","write","find","fs","results","filter","lifecyclePhase","includes","waveId","search","searchLower","toLowerCase","vendor","some","tag","undefined","minReadinessScore","maxRiskScore","map","riskScore","relationCount","calculateScores","index","findIndex","splice","o","isActive","forEach","provenance","discoveredAt","verified","applyObservationValue","verifiedAt","existing","r","stats","total","byLifecycle","plan","phase_in","active","phase_out","end_of_life","byCriticality","mission_critical","business_critical","business_operational","administrative","byDisposition","retain","retire","replace","rehost","refactor","replatform","repurchase","byWave","averageReadiness","averageRisk","averageCompleteness","totalReadiness","totalRisk","totalCompleteness","Math","round","created","updated","errors","DisplayName","Name","displayName","fieldMappings","Publisher","Vendor","Version","Description","AppId","ApplicationId","sourceField","targetField","Object","entries","parts","split","prop","filledFields","totalFields","checkSection","fields","Array","isArray","readiness","verifiedCount","min","risk","max","serviceInstance"],"sourceRoot":""}