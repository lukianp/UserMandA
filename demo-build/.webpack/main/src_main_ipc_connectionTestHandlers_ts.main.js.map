{"version":3,"file":"src_main_ipc_connectionTestHandlers_ts.main.js","mappings":"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","sources":["webpack://enterprise-discovery-suite/./src/main/ipc/connectionTestHandlers.ts","webpack://enterprise-discovery-suite/./src/main/services/connectionTestingService.ts"],"sourcesContent":["/**\n * IPC Handlers for Connection Testing\n *\n * Provides renderer process access to connection testing functionality\n */\nimport { ipcMain } from 'electron';\nimport { getConnectionTestingService } from '../services/connectionTestingService';\nlet mainWindow = null;\n/**\n * Register all connection testing IPC handlers\n */\nexport function registerConnectionTestHandlers(window) {\n    if (window) {\n        mainWindow = window;\n    }\n    const service = getConnectionTestingService();\n    // Forward events to renderer\n    if (mainWindow) {\n        service.on('test:started', (data) => {\n            mainWindow?.webContents.send('connection-test:started', data);\n        });\n        service.on('test:progress', (data) => {\n            mainWindow?.webContents.send('connection-test:progress', data);\n        });\n        service.on('test:completed', (data) => {\n            mainWindow?.webContents.send('connection-test:completed', data);\n        });\n        service.on('test:failed', (data) => {\n            mainWindow?.webContents.send('connection-test:failed', data);\n        });\n        service.on('test:cancelled', (data) => {\n            mainWindow?.webContents.send('connection-test:cancelled', data);\n        });\n    }\n    // Test Active Directory\n    ipcMain.handle('connection-test:active-directory', async (event, domainController, credential) => {\n        console.log('[IPC] connection-test:active-directory', domainController);\n        return await service.testActiveDirectory(domainController, credential);\n    });\n    // Test Exchange Server\n    ipcMain.handle('connection-test:exchange', async (event, serverUrl, credential) => {\n        console.log('[IPC] connection-test:exchange', serverUrl);\n        return await service.testExchangeServer(serverUrl, credential);\n    });\n    // Test Azure AD\n    ipcMain.handle('connection-test:azure-ad', async (event, tenantId, clientId, clientSecret) => {\n        console.log('[IPC] connection-test:azure-ad', tenantId);\n        return await service.testAzureAD(tenantId, clientId, clientSecret);\n    });\n    // Test comprehensive environment (T-000)\n    ipcMain.handle('connection-test:environment', async (event, config) => {\n        console.log('[IPC] connection-test:environment', config.profileName);\n        return await service.testEnvironment(config);\n    });\n    // Cancel test\n    ipcMain.handle('connection-test:cancel', async (event, testId) => {\n        console.log('[IPC] connection-test:cancel', testId);\n        return await service.cancelTest(testId);\n    });\n    // Get statistics\n    ipcMain.handle('connection-test:statistics', async (event) => {\n        console.log('[IPC] connection-test:statistics');\n        return service.getStatistics();\n    });\n    console.log('[IPC] Connection test handlers registered');\n}\nexport default registerConnectionTestHandlers;\n","/**\n * Connection Testing Service (Main Process)\n *\n * Provides connection testing and validation for source and target profiles.\n * Implements T-000 environment detection pattern from GUI/MainViewModel.cs\n *\n * Pattern from GUI/Services/ConnectionTestService.cs\n */\nimport { spawn } from 'child_process';\nimport { EventEmitter } from 'events';\n/**\n * Connection Testing Service\n * Tests connectivity to various services (AD, Exchange, Azure AD, SharePoint, etc.)\n */\nexport class ConnectionTestingService extends EventEmitter {\n    activeTests = new Map();\n    /**\n     * Test connection to an Active Directory domain\n     */\n    async testActiveDirectory(domainController, credential) {\n        const startTime = Date.now();\n        try {\n            console.log(`[ConnectionTest] Testing Active Directory: ${domainController}`);\n            const script = `\r\n        param($DomainController)\r\n\r\n        try {\r\n          $startTime = Get-Date\r\n\r\n          # Test 1: DNS Resolution\r\n          $resolved = Resolve-DnsName -Name $DomainController -ErrorAction Stop\r\n\r\n          # Test 2: LDAP Port (389)\r\n          $tcpClient = New-Object System.Net.Sockets.TcpClient\r\n          $connectTask = $tcpClient.ConnectAsync($DomainController, 389)\r\n          $timeout = [System.Threading.Tasks.Task]::Delay(5000)\r\n          $completed = [System.Threading.Tasks.Task]::WaitAny(@($connectTask, $timeout))\r\n\r\n          if ($completed -eq 0 -and $tcpClient.Connected) {\r\n            $tcpClient.Close()\r\n\r\n            # Test 3: Get Domain Info\r\n            $domain = Get-ADDomain -Server $DomainController -ErrorAction Stop\r\n\r\n            $responseTime = ((Get-Date) - $startTime).TotalMilliseconds\r\n\r\n            $result = @{\r\n              Success = $true\r\n              Available = $true\r\n              ResponseTime = $responseTime\r\n              Version = $domain.DomainMode\r\n              Details = @{\r\n                DomainName = $domain.DNSRoot\r\n                NetBiosName = $domain.NetBIOSName\r\n                ForestName = $domain.Forest\r\n                DomainControllers = @($domain.ReplicaDirectoryServers)\r\n              }\r\n            }\r\n\r\n            Write-Output (ConvertTo-Json $result -Depth 10 -Compress)\r\n          } else {\r\n            throw \"Connection timeout or failed\"\r\n          }\r\n        } catch {\r\n          $result = @{\r\n            Success = $false\r\n            Available = $false\r\n            Error = $_.Exception.Message\r\n          }\r\n          Write-Output (ConvertTo-Json $result -Compress)\r\n        }\r\n      `;\n            const result = await this.executePowerShellScript(script, { DomainController: domainController });\n            return {\n                serviceType: 'ActiveDirectory',\n                ...result,\n                responseTime: Date.now() - startTime\n            };\n        }\n        catch (error) {\n            return {\n                success: false,\n                serviceType: 'ActiveDirectory',\n                available: false,\n                error: error.message,\n                responseTime: Date.now() - startTime\n            };\n        }\n    }\n    /**\n     * Test connection to Exchange Server\n     */\n    async testExchangeServer(serverUrl, credential) {\n        const startTime = Date.now();\n        try {\n            console.log(`[ConnectionTest] Testing Exchange Server: ${serverUrl}`);\n            const script = `\r\n        param($ServerUrl)\r\n\r\n        try {\r\n          $startTime = Get-Date\r\n\r\n          # Test connection to Exchange Web Services\r\n          $uri = New-Object Uri($ServerUrl)\r\n          $tcpClient = New-Object System.Net.Sockets.TcpClient\r\n          $connectTask = $tcpClient.ConnectAsync($uri.Host, $uri.Port)\r\n          $timeout = [System.Threading.Tasks.Task]::Delay(5000)\r\n          $completed = [System.Threading.Tasks.Task]::WaitAny(@($connectTask, $timeout))\r\n\r\n          if ($completed -eq 0 -and $tcpClient.Connected) {\r\n            $tcpClient.Close()\r\n\r\n            $responseTime = ((Get-Date) - $startTime).TotalMilliseconds\r\n\r\n            $result = @{\r\n              Success = $true\r\n              Available = $true\r\n              ResponseTime = $responseTime\r\n              Details = @{\r\n                ServerUrl = $ServerUrl\r\n                Host = $uri.Host\r\n                Port = $uri.Port\r\n              }\r\n            }\r\n\r\n            Write-Output (ConvertTo-Json $result -Compress)\r\n          } else {\r\n            throw \"Connection timeout or failed\"\r\n          }\r\n        } catch {\r\n          $result = @{\r\n            Success = $false\r\n            Available = $false\r\n            Error = $_.Exception.Message\r\n          }\r\n          Write-Output (ConvertTo-Json $result -Compress)\r\n        }\r\n      `;\n            const result = await this.executePowerShellScript(script, { ServerUrl: serverUrl });\n            return {\n                serviceType: 'Exchange',\n                ...result,\n                responseTime: Date.now() - startTime\n            };\n        }\n        catch (error) {\n            return {\n                success: false,\n                serviceType: 'Exchange',\n                available: false,\n                error: error.message,\n                responseTime: Date.now() - startTime\n            };\n        }\n    }\n    /**\n     * Test connection to Azure AD (Microsoft Graph)\n     */\n    async testAzureAD(tenantId, clientId, clientSecret) {\n        const startTime = Date.now();\n        try {\n            console.log(`[ConnectionTest] Testing Azure AD: ${tenantId}`);\n            const script = `\r\n        param($TenantId, $ClientId, $ClientSecret)\r\n\r\n        try {\r\n          $startTime = Get-Date\r\n\r\n          # Get access token\r\n          $body = @{\r\n            grant_type    = 'client_credentials'\r\n            client_id     = $ClientId\r\n            client_secret = $ClientSecret\r\n            scope         = 'https://graph.microsoft.com/.default'\r\n          }\r\n\r\n          $tokenUrl = \"https://login.microsoftonline.com/$TenantId/oauth2/v2.0/token\"\r\n          $tokenResponse = Invoke-RestMethod -Method Post -Uri $tokenUrl -Body $body -ContentType 'application/x-www-form-urlencoded'\r\n\r\n          # Test Graph API\r\n          $headers = @{\r\n            Authorization = \"Bearer $($tokenResponse.access_token)\"\r\n          }\r\n\r\n          $orgResponse = Invoke-RestMethod -Method Get -Uri 'https://graph.microsoft.com/v1.0/organization' -Headers $headers\r\n\r\n          $responseTime = ((Get-Date) - $startTime).TotalMilliseconds\r\n\r\n          $result = @{\r\n            Success = $true\r\n            Available = $true\r\n            ResponseTime = $responseTime\r\n            Details = @{\r\n              TenantId = $orgResponse.value[0].id\r\n              DisplayName = $orgResponse.value[0].displayName\r\n              TenantType = $orgResponse.value[0].tenantType\r\n              VerifiedDomains = @($orgResponse.value[0].verifiedDomains.name)\r\n            }\r\n          }\r\n\r\n          Write-Output (ConvertTo-Json $result -Depth 10 -Compress)\r\n        } catch {\r\n          $result = @{\r\n            Success = $false\r\n            Available = $false\r\n            Error = $_.Exception.Message\r\n          }\r\n          Write-Output (ConvertTo-Json $result -Compress)\r\n        }\r\n      `;\n            const result = await this.executePowerShellScript(script, {\n                TenantId: tenantId,\n                ClientId: clientId,\n                ClientSecret: clientSecret\n            });\n            return {\n                serviceType: 'AzureAD',\n                ...result,\n                responseTime: Date.now() - startTime\n            };\n        }\n        catch (error) {\n            return {\n                success: false,\n                serviceType: 'AzureAD',\n                available: false,\n                error: error.message,\n                responseTime: Date.now() - startTime\n            };\n        }\n    }\n    /**\n     * Test comprehensive environment (T-000 pattern)\n     * Tests all available services and generates capability matrix\n     */\n    async testEnvironment(config) {\n        const testId = `test-${Date.now()}`;\n        this.activeTests.set(testId, true);\n        try {\n            console.log(`[ConnectionTest] Starting environment test: ${testId}`);\n            this.emit('test:started', { testId, profileName: config.profileName });\n            const tests = [];\n            const capabilities = [];\n            // Test Active Directory\n            if (config.domainController) {\n                this.emit('test:progress', { testId, service: 'ActiveDirectory', status: 'testing' });\n                const adTest = await this.testActiveDirectory(config.domainController, config.credential);\n                tests.push(adTest);\n                if (adTest.success) {\n                    capabilities.push('ActiveDirectory');\n                    capabilities.push('UserDiscovery');\n                    capabilities.push('GroupDiscovery');\n                    capabilities.push('ComputerDiscovery');\n                }\n            }\n            // Test Exchange\n            if (config.exchangeServer) {\n                this.emit('test:progress', { testId, service: 'Exchange', status: 'testing' });\n                const exchangeTest = await this.testExchangeServer(config.exchangeServer, config.credential);\n                tests.push(exchangeTest);\n                if (exchangeTest.success) {\n                    capabilities.push('Exchange');\n                    capabilities.push('MailboxDiscovery');\n                }\n            }\n            // Test Azure AD\n            if (config.tenantId && config.clientId && config.clientSecret) {\n                this.emit('test:progress', { testId, service: 'AzureAD', status: 'testing' });\n                const azureTest = await this.testAzureAD(config.tenantId, config.clientId, config.clientSecret);\n                tests.push(azureTest);\n                if (azureTest.success) {\n                    capabilities.push('AzureAD');\n                    capabilities.push('CloudUserDiscovery');\n                    capabilities.push('AzureResourceDiscovery');\n                }\n            }\n            // Generate recommendations\n            const recommendations = [];\n            const failedTests = tests.filter(t => !t.success);\n            if (failedTests.length > 0) {\n                recommendations.push(`${failedTests.length} service(s) failed connectivity tests. Review credentials and network configuration.`);\n            }\n            if (capabilities.includes('ActiveDirectory') && !capabilities.includes('Exchange')) {\n                recommendations.push('Consider adding Exchange Server for mailbox discovery.');\n            }\n            if (capabilities.includes('ActiveDirectory') && !capabilities.includes('AzureAD')) {\n                recommendations.push('Consider adding Azure AD for hybrid environment discovery.');\n            }\n            const result = {\n                testId,\n                profileName: config.profileName,\n                timestamp: new Date().toISOString(),\n                overallSuccess: tests.every(t => t.success),\n                tests,\n                capabilities,\n                recommendations\n            };\n            this.emit('test:completed', result);\n            this.activeTests.delete(testId);\n            return result;\n        }\n        catch (error) {\n            this.emit('test:failed', { testId, error: error.message });\n            this.activeTests.delete(testId);\n            throw error;\n        }\n    }\n    /**\n     * Execute PowerShell script and parse JSON result\n     */\n    async executePowerShellScript(script, params) {\n        return new Promise((resolve, reject) => {\n            // Build parameter arguments\n            const args = ['-NoProfile', '-ExecutionPolicy', 'Bypass', '-Command', script];\n            // Add parameters\n            Object.entries(params).forEach(([key, value]) => {\n                args.push('-' + key);\n                args.push(String(value));\n            });\n            const child = spawn('powershell.exe', args, {\n                shell: true,\n                stdio: ['ignore', 'pipe', 'pipe']\n            });\n            let stdout = '';\n            let stderr = '';\n            child.stdout?.on('data', (data) => {\n                stdout += data.toString();\n            });\n            child.stderr?.on('data', (data) => {\n                stderr += data.toString();\n            });\n            child.on('close', (code) => {\n                if (code === 0 && stdout.trim()) {\n                    try {\n                        const result = JSON.parse(stdout.trim());\n                        resolve(result);\n                    }\n                    catch (parseError) {\n                        reject(new Error(`Failed to parse PowerShell output: ${stdout}`));\n                    }\n                }\n                else {\n                    reject(new Error(stderr || `PowerShell exited with code ${code}`));\n                }\n            });\n            child.on('error', (error) => {\n                reject(error);\n            });\n        });\n    }\n    /**\n     * Cancel active test\n     */\n    async cancelTest(testId) {\n        if (this.activeTests.has(testId)) {\n            this.activeTests.delete(testId);\n            this.emit('test:cancelled', { testId });\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Get statistics\n     */\n    getStatistics() {\n        return {\n            activeTests: this.activeTests.size,\n            testIds: Array.from(this.activeTests.keys())\n        };\n    }\n}\n// Singleton instance\nlet connectionTestingService = null;\nexport function getConnectionTestingService() {\n    if (!connectionTestingService) {\n        connectionTestingService = new ConnectionTestingService();\n    }\n    return connectionTestingService;\n}\nexport default ConnectionTestingService;\n"],"names":["mainWindow","registerConnectionTestHandlers","window","service","getConnectionTestingService","on","data","webContents","send","ipcMain","handle","async","event","domainController","credential","console","log","testActiveDirectory","serverUrl","testExchangeServer","tenantId","clientId","clientSecret","testAzureAD","config","profileName","testEnvironment","testId","cancelTest","getStatistics","ConnectionTestingService","EventEmitter","activeTests","Map","startTime","Date","now","script","serviceType","this","executePowerShellScript","DomainController","responseTime","error","success","available","message","ServerUrl","TenantId","ClientId","ClientSecret","set","emit","tests","capabilities","status","adTest","push","exchangeServer","exchangeTest","azureTest","recommendations","failedTests","filter","t","length","includes","result","timestamp","toISOString","overallSuccess","every","delete","params","Promise","resolve","reject","args","Object","entries","forEach","key","value","String","child","spawn","shell","stdio","stdout","stderr","toString","code","trim","JSON","parse","parseError","Error","has","size","testIds","Array","from","keys","connectionTestingService"],"sourceRoot":""}