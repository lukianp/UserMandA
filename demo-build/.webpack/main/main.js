(()=>{var __webpack_modules__={"./node_modules/@octokit/app/dist-node/index.js":(e,t,r)=>{"use strict";r.d(t,{App:()=>y});var s=r("./node_modules/@octokit/core/dist-src/index.js"),o=r("./node_modules/@octokit/auth-app/dist-node/index.js"),n=r("./node_modules/@octokit/oauth-app/dist-node/index.js"),i=r("./node_modules/@octokit/auth-unauthenticated/dist-node/index.js"),a=r("./node_modules/@octokit/webhooks/dist-bundle/index.js"),c=r("./node_modules/@octokit/plugin-paginate-rest/dist-bundle/index.js");async function l(e,t){return e.octokit.auth({type:"installation",installationId:t,factory(e){const r={...e.octokitOptions,authStrategy:o.createAppAuth,auth:{...e,installationId:t}};return new e.octokit.constructor(r)}})}function u(e){return Object.assign(d.bind(null,e),{iterator:p.bind(null,e)})}async function d(e,t){const r=p(e)[Symbol.asyncIterator]();let s=await r.next();for(;!s.done;)await t(s.value),s=await r.next()}function p(e){return{async*[Symbol.asyncIterator](){const t=c.composePaginateRest.iterator(e.octokit,"GET /app/installations");for await(const{data:r}of t)for(const t of r){const r=await l(e,t.id);yield{octokit:r,installation:t}}}}}function h(e){return Object.assign(m.bind(null,e),{iterator:g.bind(null,e)})}async function m(e,t,r){const s=g(e,r?t:void 0)[Symbol.asyncIterator]();let o=await s.next();for(;!o.done;)r?await r(o.value):await t(o.value),o=await s.next()}function g(e,t){return{async*[Symbol.asyncIterator](){const r=t?function(e,t){return{async*[Symbol.asyncIterator](){yield{octokit:await e.getInstallationOctokit(t)}}}}(e,t.installationId):e.eachInstallation.iterator();for await(const{octokit:e}of r){const t=c.composePaginateRest.iterator(e,"GET /installation/repositories");for await(const{data:r}of t)for(const t of r)yield{octokit:e,repository:t}}}}}function f(e){let t;return async function(r={}){t||(t=async function(e){const{data:t}=await e.octokit.request("GET /app");if(!t)throw new Error("[@octokit/app] unable to fetch metadata for app");return`${t.html_url}/installations/new`}(e));const s=await t,o=new URL(s);return void 0!==r.target_id&&(o.pathname+="/permissions",o.searchParams.append("target_id",r.target_id.toFixed())),void 0!==r.state&&o.searchParams.append("state",r.state),o.href}}var y=class{static VERSION="15.1.6";static defaults(e){return class extends(this){constructor(...t){super({...e,...t[0]})}}}octokit;webhooks;oauth;getInstallationOctokit;eachInstallation;eachRepository;getInstallationUrl;log;constructor(e){const t=e.Octokit||s.Octokit,r=Object.assign({appId:e.appId,privateKey:e.privateKey},e.oauth?{clientId:e.oauth.clientId,clientSecret:e.oauth.clientSecret}:{}),c={authStrategy:o.createAppAuth,auth:r};"log"in e&&void 0!==e.log&&(c.log=e.log),this.octokit=new t(c),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),e.webhooks?this.webhooks=function(e,t){return new a.Webhooks({secret:t.secret,transform:async t=>{if(!("installation"in t.payload)||"object"!=typeof t.payload.installation){const r=new e.constructor({authStrategy:i.createUnauthenticatedAuth,auth:{reason:'"installation" key missing in webhook event payload'}});return{...t,octokit:r}}const r=t.payload.installation.id,s=await e.auth({type:"installation",installationId:r,factory:e=>new e.octokit.constructor({...e.octokitOptions,authStrategy:o.createAppAuth,auth:{...e,installationId:r}})});return s.hook.before("request",e=>{e.headers["x-github-delivery"]=t.id}),{...t,octokit:s}}})}(this.octokit,e.webhooks):Object.defineProperty(this,"webhooks",{get(){throw new Error("[@octokit/app] webhooks option not set")}}),e.oauth?this.oauth=new n.OAuthApp({...e.oauth,clientType:"github-app",Octokit:t}):Object.defineProperty(this,"oauth",{get(){throw new Error("[@octokit/app] oauth.clientId / oauth.clientSecret options are not set")}}),this.getInstallationOctokit=l.bind(null,this),this.eachInstallation=u(this),this.eachRepository=h(this),this.getInstallationUrl=f(this)}}},"./node_modules/@octokit/auth-app/dist-node/index.js":(e,t,r)=>{"use strict";r.d(t,{createAppAuth:()=>E});var s=r("./node_modules/universal-user-agent/index.js"),o=r("./node_modules/@octokit/request/dist-bundle/index.js"),n=r("./node_modules/@octokit/auth-oauth-app/dist-bundle/index.js"),i=r("./node_modules/universal-github-app-jwt/index.js"),a=r("./node_modules/toad-cache/dist/toad-cache.mjs"),c=r("./node_modules/@octokit/auth-oauth-user/dist-bundle/index.js");async function l({appId:e,privateKey:t,timeDifference:r}){try{const s={id:e,privateKey:t};r&&Object.assign(s,{now:Math.floor(Date.now()/1e3)+r});const o=await(0,i.default)(s);return{type:"app",token:o.token,appId:o.appId,expiresAt:new Date(1e3*o.expiration).toISOString()}}catch(e){throw"-----BEGIN RSA PRIVATE KEY-----"===t?new Error("The 'privateKey` option contains only the first line '-----BEGIN RSA PRIVATE KEY-----'. If you are setting it using a `.env` file, make sure it is set on a single line with newlines replaced by '\n'"):e}}function u({installationId:e,permissions:t={},repositoryIds:r=[],repositoryNames:s=[]}){const o=Object.keys(t).sort().map(e=>"read"===t[e]?e:`${e}!`).join(",");return[e,r.sort().join(","),s.join(","),o].filter(Boolean).join("|")}function d({installationId:e,token:t,createdAt:r,expiresAt:s,repositorySelection:o,permissions:n,repositoryIds:i,repositoryNames:a,singleFileName:c}){return Object.assign({type:"token",tokenType:"installation",token:t,installationId:e,permissions:n,createdAt:r,expiresAt:s,repositorySelection:o},i?{repositoryIds:i}:null,a?{repositoryNames:a}:null,c?{singleFileName:c}:null)}async function p(e,t,r){const s=Number(t.installationId||e.installationId);if(!s)throw new Error("[@octokit/auth-app] installationId option is required for installation authentication.");if(t.factory){const{type:r,factory:s,oauthApp:o,...n}={...e,...t};return s(n)}const o=r||e.request;return function(e,t,r){const s=u(t);if(h.has(s))return h.get(s);const o=async function(e,t,r){if(!t.refresh){const r=await async function(e,t){const r=u(t),s=await e.get(r);if(!s)return;const[o,n,i,a,c,l]=s.split("|");return{token:o,createdAt:n,expiresAt:i,permissions:t.permissions||c.split(/,/).reduce((e,t)=>(/!$/.test(t)?e[t.slice(0,-1)]="write":e[t]="read",e),{}),repositoryIds:t.repositoryIds,repositoryNames:t.repositoryNames,singleFileName:l,repositorySelection:a}}(e.cache,t);if(r){const{token:e,createdAt:s,expiresAt:o,permissions:n,repositoryIds:i,repositoryNames:a,singleFileName:c,repositorySelection:l}=r;return d({installationId:t.installationId,token:e,createdAt:s,expiresAt:o,permissions:n,repositorySelection:l,repositoryIds:i,repositoryNames:a,singleFileName:c})}}const s=await l(e),o={installation_id:t.installationId,mediaType:{previews:["machine-man"]},headers:{authorization:`bearer ${s.token}`}};t.repositoryIds&&Object.assign(o,{repository_ids:t.repositoryIds});t.repositoryNames&&Object.assign(o,{repositories:t.repositoryNames});t.permissions&&Object.assign(o,{permissions:t.permissions});const{data:{token:n,expires_at:i,repositories:a,permissions:c,repository_selection:p,single_file:h}}=await r("POST /app/installations/{installation_id}/access_tokens",o),m=c||{},g=p||"all",f=a?a.map(e=>e.id):void 0,y=a?a.map(e=>e.name):void 0,v=(new Date).toISOString(),w={token:n,createdAt:v,expiresAt:i,repositorySelection:g,permissions:m,repositoryIds:f,repositoryNames:y};h&&Object.assign(o,{singleFileName:h});await async function(e,t,r){const s=u(t),o=t.permissions?"":Object.keys(r.permissions).map(e=>`${e}${"write"===r.permissions[e]?"!":""}`).join(","),n=[r.token,r.createdAt,r.expiresAt,r.repositorySelection,o,r.singleFileName].join("|");await e.set(s,n)}(e.cache,t,w);const E={installationId:t.installationId,token:n,createdAt:v,expiresAt:i,repositorySelection:g,permissions:m,repositoryIds:f,repositoryNames:y};h&&Object.assign(E,{singleFileName:h});return d(E)}(e,t,r).finally(()=>h.delete(s));return h.set(s,o),o}(e,{...t,installationId:s},o)}var h=new Map;async function m(e,t){switch(t.type){case"app":return l(e);case"oauth-app":return e.oauthApp({type:"oauth-app"});case"installation":return p(e,{...t,type:"installation"});case"oauth-user":return e.oauthApp(t);default:throw new Error(`Invalid auth type: ${t.type}`)}}var g=function(e){const t=`^(?:${e.map(e=>e.split("/").map(e=>e.startsWith("{")?"(?:.+?)":e).join("/")).map(e=>`(?:${e})`).join("|")})$`;return new RegExp(t,"i")}(["/app","/app/hook/config","/app/hook/deliveries","/app/hook/deliveries/{delivery_id}","/app/hook/deliveries/{delivery_id}/attempts","/app/installations","/app/installations/{installation_id}","/app/installations/{installation_id}/access_tokens","/app/installations/{installation_id}/suspended","/app/installation-requests","/marketplace_listing/accounts/{account_id}","/marketplace_listing/plan","/marketplace_listing/plans","/marketplace_listing/plans/{plan_id}/accounts","/marketplace_listing/stubbed/accounts/{account_id}","/marketplace_listing/stubbed/plan","/marketplace_listing/stubbed/plans","/marketplace_listing/stubbed/plans/{plan_id}/accounts","/orgs/{org}/installation","/repos/{owner}/{repo}/installation","/users/{username}/installation"]);var f=5e3;async function y(e,t,r,s){const o=t.endpoint.merge(r,s),n=o.url;if(/\/login\/oauth\/access_token$/.test(n))return t(o);if(function(e){return!!e&&g.test(e.split("?")[0])}(n.replace(t.endpoint.DEFAULTS.baseUrl,""))){const{token:r}=await l(e);let s;o.headers.authorization=`bearer ${r}`;try{s=await t(o)}catch(r){if(function(e){return!(e.message.match(/'Expiration time' claim \('exp'\) must be a numeric value representing the future time at which the assertion expires/)||e.message.match(/'Issued at' claim \('iat'\) must be an Integer representing the time that the assertion was issued/))}(r))throw r;if(void 0===r.response.headers.date)throw r;const s=Math.floor((Date.parse(r.response.headers.date)-Date.parse((new Date).toString()))/1e3);e.log.warn(r.message),e.log.warn(`[@octokit/auth-app] GitHub API time and system time are different by ${s} seconds. Retrying request with the difference accounted for.`);const{token:n}=await l({...e,timeDifference:s});return o.headers.authorization=`bearer ${n}`,t(o)}return s}if((0,c.requiresBasicAuth)(n)){const r=await e.oauthApp({type:"oauth-app"});return o.headers.authorization=r.headers.authorization,t(o)}const{token:i,createdAt:a}=await p(e,{},t.defaults({baseUrl:o.baseUrl}));return o.headers.authorization=`token ${i}`,v(e,t,o,a)}async function v(e,t,r,s,o=0){const n=+new Date-+new Date(s);try{return await t(r)}catch(i){if(401!==i.status)throw i;if(n>=f)throw o>0&&(i.message=`After ${o} retries within ${n/1e3}s of creating the installation access token, the response remains 401. At this point, the cause may be an authentication problem or a system outage. Please check https://www.githubstatus.com for status information`),i;const a=1e3*++o;return e.log.warn(`[@octokit/auth-app] Retrying after 401 response to account for token replication delay (retry: ${o}, wait: ${a/1e3}s)`),await new Promise(e=>setTimeout(e,a)),v(e,t,r,s,o)}}var w="7.2.2";function E(e){if(!e.appId)throw new Error("[@octokit/auth-app] appId option is required");if(!e.privateKey)throw new Error("[@octokit/auth-app] privateKey option is required");if("installationId"in e&&!e.installationId)throw new Error("[@octokit/auth-app] installationId is set to a falsy value");const t=e.log||{};"function"!=typeof t.warn&&(t.warn=console.warn.bind(console));const r=e.request||o.request.defaults({headers:{"user-agent":`octokit-auth-app.js/${w} ${(0,s.getUserAgent)()}`}}),i=Object.assign({request:r,cache:new a.Lru(15e3,354e4)},e,e.installationId?{installationId:Number(e.installationId)}:{},{log:t,oauthApp:(0,n.createOAuthAppAuth)({clientType:"github-app",clientId:e.clientId||"",clientSecret:e.clientSecret||"",request:r})});return Object.assign(m.bind(null,i),{hook:y.bind(null,i)})}},"./node_modules/@octokit/auth-oauth-app/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{createOAuthAppAuth:()=>l});var s=r("./node_modules/universal-user-agent/index.js"),o=r("./node_modules/@octokit/request/dist-bundle/index.js"),n=r("./node_modules/@octokit/auth-oauth-user/dist-bundle/index.js");async function i(e,t){if("oauth-app"===t.type)return{type:"oauth-app",clientId:e.clientId,clientSecret:e.clientSecret,clientType:e.clientType,headers:{authorization:`basic ${btoa(`${e.clientId}:${e.clientSecret}`)}`}};if("factory"in t){const{type:r,...s}={...t,...e};return t.factory(s)}const r={clientId:e.clientId,clientSecret:e.clientSecret,request:e.request,...t};return(e.clientType,await(0,n.createOAuthUserAuth)({...r,clientType:e.clientType}))()}async function a(e,t,r,s){let o=t.endpoint.merge(r,s);if(/\/login\/(oauth\/access_token|device\/code)$/.test(o.url))return t(o);if("github-app"===e.clientType&&!(0,n.requiresBasicAuth)(o.url))throw new Error(`[@octokit/auth-oauth-app] GitHub Apps cannot use their client ID/secret for basic authentication for endpoints other than "/applications/{client_id}/**". "${o.method} ${o.url}" is not supported.`);const i=btoa(`${e.clientId}:${e.clientSecret}`);o.headers.authorization=`basic ${i}`;try{return await t(o)}catch(e){if(401!==e.status)throw e;throw e.message=`[@octokit/auth-oauth-app] "${o.method} ${o.url}" does not support clientId/clientSecret basic authentication.`,e}}var c="0.0.0-development";function l(e){const t=Object.assign({request:o.request.defaults({headers:{"user-agent":`octokit-auth-oauth-app.js/${c} ${(0,s.getUserAgent)()}`}}),clientType:"oauth-app"},e);return Object.assign(i.bind(null,t),{hook:a.bind(null,t)})}},"./node_modules/@octokit/auth-oauth-device/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{createOAuthDeviceAuth:()=>p});var s=r("./node_modules/universal-user-agent/index.js"),o=r("./node_modules/@octokit/request/dist-bundle/index.js"),n=r("./node_modules/@octokit/oauth-methods/dist-bundle/index.js");async function i(e,t){const r=function(e,t){if(!0===t.refresh)return!1;if(!e.authentication)return!1;if("github-app"===e.clientType)return e.authentication;const r=e.authentication,s=("scopes"in t&&t.scopes||e.scopes).join(" "),o=r.scopes.join(" ");return s===o&&r}(e,t.auth);if(r)return r;const{data:s}=await(0,n.createDeviceCode)({clientType:e.clientType,clientId:e.clientId,request:t.request||e.request,scopes:t.auth.scopes||e.scopes});await e.onVerification(s);const o=await c(t.request||e.request,e.clientId,e.clientType,s);return e.authentication=o,o}async function a(e){await new Promise(t=>setTimeout(t,1e3*e))}async function c(e,t,r,s){try{const o={clientId:t,request:e,code:s.device_code},{authentication:i}="oauth-app"===r?await(0,n.exchangeDeviceCode)({...o,clientType:"oauth-app"}):await(0,n.exchangeDeviceCode)({...o,clientType:"github-app"});return{type:"token",tokenType:"oauth",...i}}catch(o){if(!o.response)throw o;const n=o.response.data.error;if("authorization_pending"===n)return await a(s.interval),c(e,t,r,s);if("slow_down"===n)return await a(s.interval+7),c(e,t,r,s);throw o}}async function l(e,t){return i(e,{auth:t})}async function u(e,t,r,s){let o=t.endpoint.merge(r,s);if(/\/login\/(oauth\/access_token|device\/code)$/.test(o.url))return t(o);const{token:n}=await i(e,{request:t,auth:{type:"oauth"}});return o.headers.authorization=`token ${n}`,t(o)}var d="0.0.0-development";function p(e){const t=e.request||o.request.defaults({headers:{"user-agent":`octokit-auth-oauth-device.js/${d} ${(0,s.getUserAgent)()}`}}),{request:r=t,...n}=e,i="github-app"===e.clientType?{...n,clientType:"github-app",request:r}:{...n,clientType:"oauth-app",request:r,scopes:e.scopes||[]};if(!e.clientId)throw new Error('[@octokit/auth-oauth-device] "clientId" option must be set (https://github.com/octokit/auth-oauth-device.js#usage)');if(!e.onVerification)throw new Error('[@octokit/auth-oauth-device] "onVerification" option must be a function (https://github.com/octokit/auth-oauth-device.js#usage)');return Object.assign(l.bind(null,i),{hook:u.bind(null,i)})}},"./node_modules/@octokit/auth-oauth-user/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{createOAuthUserAuth:()=>h,requiresBasicAuth:()=>d});var s=r("./node_modules/universal-user-agent/index.js"),o=r("./node_modules/@octokit/request/dist-bundle/index.js"),n=r("./node_modules/@octokit/auth-oauth-device/dist-bundle/index.js"),i=r("./node_modules/@octokit/oauth-methods/dist-bundle/index.js"),a="0.0.0-development";async function c(e){if("code"in e.strategyOptions){const{authentication:t}=await(0,i.exchangeWebFlowCode)({clientId:e.clientId,clientSecret:e.clientSecret,clientType:e.clientType,onTokenCreated:e.onTokenCreated,...e.strategyOptions,request:e.request});return{type:"token",tokenType:"oauth",...t}}if("onVerification"in e.strategyOptions){const t=(0,n.createOAuthDeviceAuth)({clientType:e.clientType,clientId:e.clientId,onTokenCreated:e.onTokenCreated,...e.strategyOptions,request:e.request}),r=await t({type:"oauth"});return{clientSecret:e.clientSecret,...r}}if("token"in e.strategyOptions)return{type:"token",tokenType:"oauth",clientId:e.clientId,clientSecret:e.clientSecret,clientType:e.clientType,onTokenCreated:e.onTokenCreated,...e.strategyOptions};throw new Error("[@octokit/auth-oauth-user] Invalid strategy options")}async function l(e,t={}){if(e.authentication||(e.authentication=(e.clientType,await c(e))),e.authentication.invalid)throw new Error("[@octokit/auth-oauth-user] Token is invalid");const r=e.authentication;if("expiresAt"in r&&("refresh"===t.type||new Date(r.expiresAt)<new Date)){const{authentication:t}=await(0,i.refreshToken)({clientType:"github-app",clientId:e.clientId,clientSecret:e.clientSecret,refreshToken:r.refreshToken,request:e.request});e.authentication={tokenType:"oauth",type:"token",...t}}if("refresh"===t.type){if("oauth-app"===e.clientType)throw new Error("[@octokit/auth-oauth-user] OAuth Apps do not support expiring tokens");if(!r.hasOwnProperty("expiresAt"))throw new Error("[@octokit/auth-oauth-user] Refresh token missing");await(e.onTokenCreated?.(e.authentication,{type:t.type}))}if("check"===t.type||"reset"===t.type){const r="check"===t.type?i.checkToken:i.resetToken;try{const{authentication:s}=await r({clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:e.authentication.token,request:e.request});return e.authentication={tokenType:"oauth",type:"token",...s},"reset"===t.type&&await(e.onTokenCreated?.(e.authentication,{type:t.type})),e.authentication}catch(t){throw 404===t.status&&(t.message="[@octokit/auth-oauth-user] Token is invalid",e.authentication.invalid=!0),t}}if("delete"===t.type||"deleteAuthorization"===t.type){const r="delete"===t.type?i.deleteToken:i.deleteAuthorization;try{await r({clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:e.authentication.token,request:e.request})}catch(e){if(404!==e.status)throw e}return e.authentication.invalid=!0,e.authentication}return e.authentication}var u=/\/applications\/[^/]+\/(token|grant)s?/;function d(e){return e&&u.test(e)}async function p(e,t,r,s={}){const o=t.endpoint.merge(r,s);if(/\/login\/(oauth\/access_token|device\/code)$/.test(o.url))return t(o);if(d(o.url)){const r=btoa(`${e.clientId}:${e.clientSecret}`);return o.headers.authorization=`basic ${r}`,t(o)}const{token:n}=(e.clientType,await l({...e,request:t}));return o.headers.authorization="token "+n,t(o)}function h({clientId:e,clientSecret:t,clientType:r="oauth-app",request:n=o.request.defaults({headers:{"user-agent":`octokit-auth-oauth-app.js/${a} ${(0,s.getUserAgent)()}`}}),onTokenCreated:i,...c}){const u=Object.assign({clientType:r,clientId:e,clientSecret:t,onTokenCreated:i,strategyOptions:c,request:n});return Object.assign(l.bind(null,u),{hook:p.bind(null,u)})}h.VERSION=a},"./node_modules/@octokit/auth-token/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{createTokenAuth:()=>c});var s="(?:[a-zA-Z0-9_-]+)",o=new RegExp(`^${s}\\.${s}\\.${s}$`),n=o.test.bind(o);async function i(e){const t=n(e),r=e.startsWith("v1.")||e.startsWith("ghs_"),s=e.startsWith("ghu_");return{type:"token",token:e,tokenType:t?"app":r?"installation":s?"user-to-server":"oauth"}}async function a(e,t,r,s){const o=t.endpoint.merge(r,s);return o.headers.authorization=function(e){return 3===e.split(/\./).length?`bearer ${e}`:`token ${e}`}(e),t(o)}var c=function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if("string"!=typeof e)throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(i.bind(null,e),{hook:a.bind(null,e)})}},"./node_modules/@octokit/auth-unauthenticated/dist-node/index.js":(e,t,r)=>{"use strict";async function s(e){return{type:"unauthenticated",reason:e}}r.d(t,{createUnauthenticatedAuth:()=>i});var o=/\babuse\b/i;async function n(e,t,r,s){const n=t.endpoint.merge(r,s);return t(n).catch(t=>{if(404===t.status)throw t.message=`Not found. May be due to lack of authentication. Reason: ${e}`,t;if(function(e){return 403===e.status&&!!e.response&&"0"===e.response.headers["x-ratelimit-remaining"]}(t))throw t.message=`API rate limit exceeded. This maybe caused by the lack of authentication. Reason: ${e}`,t;if(function(e){return 403===e.status&&o.test(e.message)}(t))throw t.message=`You have triggered an abuse detection mechanism. This maybe caused by the lack of authentication. Reason: ${e}`,t;if(401===t.status)throw t.message=`Unauthorized. "${n.method} ${n.url}" failed most likely due to lack of authentication. Reason: ${e}`,t;throw t.status>=400&&t.status<500&&(t.message=t.message.replace(/\.?$/,`. May be caused by lack of authentication (${e}).`)),t})}var i=function(e){if(!e||!e.reason)throw new Error("[@octokit/auth-unauthenticated] No reason passed to createUnauthenticatedAuth");return Object.assign(s.bind(null,e.reason),{hook:n.bind(null,e.reason)})}},"./node_modules/@octokit/core/dist-src/index.js":(e,t,r)=>{"use strict";r.d(t,{Octokit:()=>h});var s=r("./node_modules/universal-user-agent/index.js"),o=r("./node_modules/before-after-hook/index.js"),n=r("./node_modules/@octokit/request/dist-bundle/index.js"),i=r("./node_modules/@octokit/graphql/dist-bundle/index.js"),a=r("./node_modules/@octokit/auth-token/dist-bundle/index.js"),c=r("./node_modules/@octokit/core/dist-src/version.js");const l=()=>{},u=console.warn.bind(console),d=console.error.bind(console);const p=`octokit-core.js/${c.VERSION} ${(0,s.getUserAgent)()}`;class h{static VERSION=c.VERSION;static defaults(e){return class extends(this){constructor(...t){const r=t[0]||{};super("function"!=typeof e?Object.assign({},e,r,r.userAgent&&e.userAgent?{userAgent:`${r.userAgent} ${e.userAgent}`}:null):e(r))}}}static plugins=[];static plugin(...e){const t=this.plugins;return class extends(this){static plugins=t.concat(e.filter(e=>!t.includes(e)))}}constructor(e={}){const t=new o.default.Collection,r={baseUrl:n.request.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:t.bind(null,"request")}),mediaType:{previews:[],format:""}};if(r.headers["user-agent"]=e.userAgent?`${e.userAgent} ${p}`:p,e.baseUrl&&(r.baseUrl=e.baseUrl),e.previews&&(r.mediaType.previews=e.previews),e.timeZone&&(r.headers["time-zone"]=e.timeZone),this.request=n.request.defaults(r),this.graphql=(0,i.withCustomRequest)(this.request).defaults(r),this.log=function(e={}){return"function"!=typeof e.debug&&(e.debug=l),"function"!=typeof e.info&&(e.info=l),"function"!=typeof e.warn&&(e.warn=u),"function"!=typeof e.error&&(e.error=d),e}(e.log),this.hook=t,e.authStrategy){const{authStrategy:r,...s}=e,o=r(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:s},e.auth));t.wrap("request",o.hook),this.auth=o}else if(e.auth){const r=(0,a.createTokenAuth)(e.auth);t.wrap("request",r.hook),this.auth=r}else this.auth=async()=>({type:"unauthenticated"});const s=this.constructor;for(let t=0;t<s.plugins.length;++t)Object.assign(this,s.plugins[t](this,e))}request;graphql;log;hook;auth}},"./node_modules/@octokit/core/dist-src/version.js":(e,t,r)=>{"use strict";r.d(t,{VERSION:()=>s});const s="6.1.6"},"./node_modules/@octokit/endpoint/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{endpoint:()=>v});var s=`octokit-endpoint.js/0.0.0-development ${(0,r("./node_modules/universal-user-agent/index.js").getUserAgent)()}`;function o(e,t){const r=Object.assign({},e);return Object.keys(t).forEach(s=>{!function(e){if("object"!=typeof e||null===e)return!1;if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);if(null===t)return!0;const r=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(e)}(t[s])?Object.assign(r,{[s]:t[s]}):s in e?r[s]=o(e[s],t[s]):Object.assign(r,{[s]:t[s]})}),r}function n(e){for(const t in e)void 0===e[t]&&delete e[t];return e}function i(e,t,r){if("string"==typeof t){let[e,s]=t.split(" ");r=Object.assign(s?{method:e,url:s}:{url:e},r)}else r=Object.assign({},t);var s;r.headers=(s=r.headers)?Object.keys(s).reduce((e,t)=>(e[t.toLowerCase()]=s[t],e),{}):{},n(r),n(r.headers);const i=o(e||{},r);return"/graphql"===r.url&&(e&&e.mediaType.previews?.length&&(i.mediaType.previews=e.mediaType.previews.filter(e=>!i.mediaType.previews.includes(e)).concat(i.mediaType.previews)),i.mediaType.previews=(i.mediaType.previews||[]).map(e=>e.replace(/-preview/,""))),i}var a=/\{[^{}}]+\}/g;function c(e){return e.replace(/(?:^\W+)|(?:(?<!\W)\W+$)/g,"").split(/,/)}function l(e,t){const r={__proto__:null};for(const s of Object.keys(e))-1===t.indexOf(s)&&(r[s]=e[s]);return r}function u(e){return e.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}function d(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function p(e,t,r){return t="+"===e||"#"===e?u(t):d(t),r?d(r)+"="+t:t}function h(e){return null!=e}function m(e){return";"===e||"&"===e||"?"===e}function g(e,t){var r=["+","#",".","/",";","?","&"];return e=e.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(e,s,o){if(s){let e="";const o=[];if(-1!==r.indexOf(s.charAt(0))&&(e=s.charAt(0),s=s.substr(1)),s.split(/,/g).forEach(function(r){var s=/([^:\*]*)(?::(\d+)|(\*))?/.exec(r);o.push(function(e,t,r,s){var o=e[r],n=[];if(h(o)&&""!==o)if("string"==typeof o||"number"==typeof o||"boolean"==typeof o)o=o.toString(),s&&"*"!==s&&(o=o.substring(0,parseInt(s,10))),n.push(p(t,o,m(t)?r:""));else if("*"===s)Array.isArray(o)?o.filter(h).forEach(function(e){n.push(p(t,e,m(t)?r:""))}):Object.keys(o).forEach(function(e){h(o[e])&&n.push(p(t,o[e],e))});else{const e=[];Array.isArray(o)?o.filter(h).forEach(function(r){e.push(p(t,r))}):Object.keys(o).forEach(function(r){h(o[r])&&(e.push(d(r)),e.push(p(t,o[r].toString())))}),m(t)?n.push(d(r)+"="+e.join(",")):0!==e.length&&n.push(e.join(","))}else";"===t?h(o)&&n.push(d(r)):""!==o||"&"!==t&&"?"!==t?""===o&&n.push(""):n.push(d(r)+"=");return n}(t,e,s[1],s[2]||s[3]))}),e&&"+"!==e){var n=",";return"?"===e?n="&":"#"!==e&&(n=e),(0!==o.length?e:"")+o.join(n)}return o.join(",")}return u(o)}),"/"===e?e:e.replace(/\/$/,"")}function f(e){let t,r=e.method.toUpperCase(),s=(e.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),o=Object.assign({},e.headers),n=l(e,["method","baseUrl","url","headers","request","mediaType"]);const i=function(e){const t=e.match(a);return t?t.map(c).reduce((e,t)=>e.concat(t),[]):[]}(s);var u;s=(u=s,{expand:g.bind(null,u)}).expand(n),/^http/.test(s)||(s=e.baseUrl+s);const d=l(n,Object.keys(e).filter(e=>i.includes(e)).concat("baseUrl"));if(!/application\/octet-stream/i.test(o.accept)&&(e.mediaType.format&&(o.accept=o.accept.split(/,/).map(t=>t.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${e.mediaType.format}`)).join(",")),s.endsWith("/graphql")&&e.mediaType.previews?.length)){const t=o.accept.match(/(?<![\w-])[\w-]+(?=-preview)/g)||[];o.accept=t.concat(e.mediaType.previews).map(t=>`application/vnd.github.${t}-preview${e.mediaType.format?`.${e.mediaType.format}`:"+json"}`).join(",")}return["GET","HEAD"].includes(r)?s=function(e,t){const r=/\?/.test(e)?"&":"?",s=Object.keys(t);return 0===s.length?e:e+r+s.map(e=>"q"===e?"q="+t.q.split("+").map(encodeURIComponent).join("+"):`${e}=${encodeURIComponent(t[e])}`).join("&")}(s,d):"data"in d?t=d.data:Object.keys(d).length&&(t=d),o["content-type"]||void 0===t||(o["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(r)&&void 0===t&&(t=""),Object.assign({method:r,url:s,headers:o},void 0!==t?{body:t}:null,e.request?{request:e.request}:null)}function y(e,t,r){return f(i(e,t,r))}var v=function e(t,r){const s=i(t,r),o=y.bind(null,s);return Object.assign(o,{DEFAULTS:s,defaults:e.bind(null,s),merge:i.bind(null,s),parse:f})}(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":s},mediaType:{format:""}})},"./node_modules/@octokit/graphql/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{withCustomRequest:()=>u});var s=r("./node_modules/@octokit/request/dist-bundle/index.js"),o=r("./node_modules/universal-user-agent/index.js");var n=class extends Error{constructor(e,t,r){super("Request failed due to following response errors:\n"+r.errors.map(e=>` - ${e.message}`).join("\n")),this.request=e,this.headers=t,this.response=r,this.errors=r.errors,this.data=r.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}name="GraphqlResponseError";errors;data},i=["method","baseUrl","url","headers","request","query","mediaType","operationName"],a=["query","method","url"],c=/\/api\/v3\/?$/;function l(e,t){const r=e.defaults(t);return Object.assign((e,t)=>function(e,t,r){if(r){if("string"==typeof t&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const e in r)if(a.includes(e))return Promise.reject(new Error(`[@octokit/graphql] "${e}" cannot be used as variable name`))}const s="string"==typeof t?Object.assign({query:t},r):t,o=Object.keys(s).reduce((e,t)=>i.includes(t)?(e[t]=s[t],e):(e.variables||(e.variables={}),e.variables[t]=s[t],e),{}),l=s.baseUrl||e.endpoint.DEFAULTS.baseUrl;return c.test(l)&&(o.url=l.replace(c,"/api/graphql")),e(o).then(e=>{if(e.data.errors){const t={};for(const r of Object.keys(e.headers))t[r]=e.headers[r];throw new n(o,t,e.data)}return e.data.data})}(r,e,t),{defaults:l.bind(null,r),endpoint:r.endpoint})}l(s.request,{headers:{"user-agent":`octokit-graphql.js/0.0.0-development ${(0,o.getUserAgent)()}`},method:"POST",url:"/graphql"});function u(e){return l(e,{method:"POST",url:"/graphql"})}},"./node_modules/@octokit/oauth-app/dist-node/index.js":(e,t,r)=>{"use strict";r.d(t,{OAuthApp:()=>I,createNodeMiddleware:()=>C,sendNodeResponse:()=>T,unknownRouteResponse:()=>b});var s=r("./node_modules/@octokit/auth-oauth-app/dist-bundle/index.js"),o=r("./node_modules/@octokit/core/dist-src/index.js"),n=r("./node_modules/universal-user-agent/index.js"),i=r("./node_modules/@octokit/auth-oauth-user/dist-bundle/index.js"),a=r("./node_modules/@octokit/oauth-methods/dist-bundle/index.js"),c=r("./node_modules/@octokit/auth-unauthenticated/dist-node/index.js"),l="7.1.6";function u(e,t,r){if(Array.isArray(t))for(const s of t)u(e,s,r);else e.eventHandlers[t]||(e.eventHandlers[t]=[]),e.eventHandlers[t].push(r)}var d=o.Octokit.defaults({userAgent:`octokit-oauth-app.js/${l} ${(0,n.getUserAgent)()}`});async function p(e,t){const{name:r,action:s}=t;if(e.eventHandlers[`${r}.${s}`])for(const o of e.eventHandlers[`${r}.${s}`])await o(t);if(e.eventHandlers[r])for(const s of e.eventHandlers[r])await s(t)}async function h(e,t){return e.octokit.auth({type:"oauth-user",...t,async factory(t){const r=new e.Octokit({authStrategy:i.createOAuthUserAuth,auth:t}),s=await r.auth({type:"get"});return await p(e,{name:"token",action:"created",token:s.token,scopes:s.scopes,authentication:s,octokit:r}),r}})}function m(e,t){const r={clientId:e.clientId,request:e.octokit.request,...t,allowSignup:e.allowSignup??t.allowSignup,redirectUrl:t.redirectUrl??e.redirectUrl,scopes:t.scopes??e.defaultScopes};return a.getWebFlowAuthorizationUrl({clientType:e.clientType,...r})}async function g(e,t){const r=await e.octokit.auth({type:"oauth-user",...t});return await p(e,{name:"token",action:"created",token:r.token,scopes:r.scopes,authentication:r,octokit:new e.Octokit({authStrategy:i.createOAuthUserAuth,auth:{clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:r.token,scopes:r.scopes,refreshToken:r.refreshToken,expiresAt:r.expiresAt,refreshTokenExpiresAt:r.refreshTokenExpiresAt}})}),{authentication:r}}async function f(e,t){const r=await a.checkToken({clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,request:e.octokit.request,...t});return Object.assign(r.authentication,{type:"token",tokenType:"oauth"}),r}async function y(e,t){const r={clientId:e.clientId,clientSecret:e.clientSecret,request:e.octokit.request,...t};if("oauth-app"===e.clientType){const t=await a.resetToken({clientType:"oauth-app",...r}),s=Object.assign(t.authentication,{type:"token",tokenType:"oauth"});return await p(e,{name:"token",action:"reset",token:t.authentication.token,scopes:t.authentication.scopes||void 0,authentication:s,octokit:new e.Octokit({authStrategy:i.createOAuthUserAuth,auth:{clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:t.authentication.token,scopes:t.authentication.scopes}})}),{...t,authentication:s}}const s=await a.resetToken({clientType:"github-app",...r}),o=Object.assign(s.authentication,{type:"token",tokenType:"oauth"});return await p(e,{name:"token",action:"reset",token:s.authentication.token,authentication:o,octokit:new e.Octokit({authStrategy:i.createOAuthUserAuth,auth:{clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:s.authentication.token}})}),{...s,authentication:o}}async function v(e,t){if("oauth-app"===e.clientType)throw new Error("[@octokit/oauth-app] app.refreshToken() is not supported for OAuth Apps");const r=await a.refreshToken({clientType:"github-app",clientId:e.clientId,clientSecret:e.clientSecret,request:e.octokit.request,refreshToken:t.refreshToken}),s=Object.assign(r.authentication,{type:"token",tokenType:"oauth"});return await p(e,{name:"token",action:"refreshed",token:r.authentication.token,authentication:s,octokit:new e.Octokit({authStrategy:i.createOAuthUserAuth,auth:{clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:r.authentication.token}})}),{...r,authentication:s}}async function w(e,t){if("oauth-app"===e.clientType)throw new Error("[@octokit/oauth-app] app.scopeToken() is not supported for OAuth Apps");const r=await a.scopeToken({clientType:"github-app",clientId:e.clientId,clientSecret:e.clientSecret,request:e.octokit.request,...t}),s=Object.assign(r.authentication,{type:"token",tokenType:"oauth"});return await p(e,{name:"token",action:"scoped",token:r.authentication.token,authentication:s,octokit:new e.Octokit({authStrategy:i.createOAuthUserAuth,auth:{clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:r.authentication.token}})}),{...r,authentication:s}}async function E(e,t){const r={clientId:e.clientId,clientSecret:e.clientSecret,request:e.octokit.request,...t},s="oauth-app"===e.clientType?await a.deleteToken({clientType:"oauth-app",...r}):await a.deleteToken({clientType:"github-app",...r});return await p(e,{name:"token",action:"deleted",token:t.token,octokit:new e.Octokit({authStrategy:c.createUnauthenticatedAuth,auth:{reason:'Handling "token.deleted" event. The access for the token has been revoked.'}})}),s}async function S(e,t){const r={clientId:e.clientId,clientSecret:e.clientSecret,request:e.octokit.request,...t},s="oauth-app"===e.clientType?await a.deleteAuthorization({clientType:"oauth-app",...r}):await a.deleteAuthorization({clientType:"github-app",...r});return await p(e,{name:"token",action:"deleted",token:t.token,octokit:new e.Octokit({authStrategy:c.createUnauthenticatedAuth,auth:{reason:'Handling "token.deleted" event. The access for the token has been revoked.'}})}),await p(e,{name:"authorization",action:"deleted",token:t.token,octokit:new e.Octokit({authStrategy:c.createUnauthenticatedAuth,auth:{reason:'Handling "authorization.deleted" event. The access for the app has been revoked.'}})}),s}function b(e){return{status:404,headers:{"content-type":"application/json"},text:JSON.stringify({error:`Unknown route: ${e.method} ${e.url}`})}}async function _(e,{pathPrefix:t="/api/github/oauth"},r){let{pathname:s}=new URL(r.url,"http://localhost");if(!s.startsWith(`${t}/`))return;if("OPTIONS"===r.method)return{status:200,headers:{"access-control-allow-origin":"*","access-control-allow-methods":"*","access-control-allow-headers":"Content-Type, User-Agent, Authorization"}};s=s.slice(t.length+1);const o=[r.method,s].join(" "),n={getLogin:"GET login",getCallback:"GET callback",createToken:"POST token",getToken:"GET token",patchToken:"PATCH token",patchRefreshToken:"PATCH refresh-token",scopeToken:"POST token/scoped",deleteToken:"DELETE token",deleteGrant:"DELETE grant"};if(!Object.values(n).includes(o))return b(r);let i;try{const e=await r.text();i=e?JSON.parse(e):{}}catch(e){return{status:400,headers:{"content-type":"application/json","access-control-allow-origin":"*"},text:JSON.stringify({error:"[@octokit/oauth-app] request error"})}}const{searchParams:a}=new URL(r.url,"http://localhost"),c=Object.fromEntries(a),l=r.headers;try{if(o===n.getLogin){const t={};c.state&&Object.assign(t,{state:c.state}),c.scopes&&Object.assign(t,{scopes:c.scopes.split(",")}),c.allowSignup&&Object.assign(t,{allowSignup:"true"===c.allowSignup}),c.redirectUrl&&Object.assign(t,{redirectUrl:c.redirectUrl});const{url:r}=e.getWebFlowAuthorizationUrl(t);return{status:302,headers:{location:r}}}if(o===n.getCallback){if(c.error)throw new Error(`[@octokit/oauth-app] ${c.error} ${c.error_description}`);if(!c.code)throw new Error('[@octokit/oauth-app] "code" parameter is required');const{authentication:{token:t}}=await e.createToken({code:c.code});return{status:200,headers:{"content-type":"text/html"},text:`<h1>Token created successfully</h1>\n\n<p>Your token is: <strong>${t}</strong>. Copy it now as it cannot be shown again.</p>`}}if(o===n.createToken){const{code:t,redirectUrl:r}=i;if(!t)throw new Error('[@octokit/oauth-app] "code" parameter is required');const s=await e.createToken({code:t,redirectUrl:r});return delete s.authentication.clientSecret,{status:201,headers:{"content-type":"application/json","access-control-allow-origin":"*"},text:JSON.stringify(s)}}if(o===n.getToken){const t=l.authorization?.substr(6);if(!t)throw new Error('[@octokit/oauth-app] "Authorization" header is required');const r=await e.checkToken({token:t});return delete r.authentication.clientSecret,{status:200,headers:{"content-type":"application/json","access-control-allow-origin":"*"},text:JSON.stringify(r)}}if(o===n.patchToken){const t=l.authorization?.substr(6);if(!t)throw new Error('[@octokit/oauth-app] "Authorization" header is required');const r=await e.resetToken({token:t});return delete r.authentication.clientSecret,{status:200,headers:{"content-type":"application/json","access-control-allow-origin":"*"},text:JSON.stringify(r)}}if(o===n.patchRefreshToken){const t=l.authorization?.substr(6);if(!t)throw new Error('[@octokit/oauth-app] "Authorization" header is required');const{refreshToken:r}=i;if(!r)throw new Error("[@octokit/oauth-app] refreshToken must be sent in request body");const s=await e.refreshToken({refreshToken:r});return delete s.authentication.clientSecret,{status:200,headers:{"content-type":"application/json","access-control-allow-origin":"*"},text:JSON.stringify(s)}}if(o===n.scopeToken){const t=l.authorization?.substr(6);if(!t)throw new Error('[@octokit/oauth-app] "Authorization" header is required');const r=await e.scopeToken({token:t,...i});return delete r.authentication.clientSecret,{status:200,headers:{"content-type":"application/json","access-control-allow-origin":"*"},text:JSON.stringify(r)}}if(o===n.deleteToken){const t=l.authorization?.substr(6);if(!t)throw new Error('[@octokit/oauth-app] "Authorization" header is required');return await e.deleteToken({token:t}),{status:204,headers:{"access-control-allow-origin":"*"}}}const t=l.authorization?.substr(6);if(!t)throw new Error('[@octokit/oauth-app] "Authorization" header is required');return await e.deleteAuthorization({token:t}),{status:204,headers:{"access-control-allow-origin":"*"}}}catch(e){return{status:400,headers:{"content-type":"application/json","access-control-allow-origin":"*"},text:JSON.stringify({error:e.message})}}}function T(e,t){t.writeHead(e.status,e.headers),t.end(e.text)}function C(e,t={}){return async function(r,s,o){const n=await function(e){const{method:t,url:r,headers:s}=e;return{method:t,url:r,headers:s,text:async function(){return await new Promise((t,r)=>{let s=[];e.on("error",r).on("data",e=>s.push(e)).on("end",()=>t(Buffer.concat(s).toString()))})}}}(r),i=await _(e,t,n);return i?(T(i,s),!0):(o?.(),!1)}}var I=class{static VERSION=l;static defaults(e){return class extends(this){constructor(...t){super({...e,...t[0]})}}}constructor(e){const t=e.Octokit||d;this.type=e.clientType||"oauth-app";const r=new t({authStrategy:s.createOAuthAppAuth,auth:{clientType:this.type,clientId:e.clientId,clientSecret:e.clientSecret}}),o={clientType:this.type,clientId:e.clientId,clientSecret:e.clientSecret,defaultScopes:e.defaultScopes||[],allowSignup:e.allowSignup,baseUrl:e.baseUrl,redirectUrl:e.redirectUrl,log:e.log,Octokit:t,octokit:r,eventHandlers:{}};this.on=u.bind(null,o),this.octokit=r,this.getUserOctokit=h.bind(null,o),this.getWebFlowAuthorizationUrl=m.bind(null,o),this.createToken=g.bind(null,o),this.checkToken=f.bind(null,o),this.resetToken=y.bind(null,o),this.refreshToken=v.bind(null,o),this.scopeToken=w.bind(null,o),this.deleteToken=E.bind(null,o),this.deleteAuthorization=S.bind(null,o)}type;on;octokit;getUserOctokit;getWebFlowAuthorizationUrl;createToken;checkToken;resetToken;refreshToken;scopeToken;deleteToken;deleteAuthorization}},"./node_modules/@octokit/oauth-authorization-url/dist-src/index.js":(e,t,r)=>{"use strict";function s(e){const t=e.clientType||"oauth-app",r=e.baseUrl||"https://github.com",s={clientType:t,allowSignup:!1!==e.allowSignup,clientId:e.clientId,login:e.login||null,redirectUrl:e.redirectUrl||null,state:e.state||Math.random().toString(36).substr(2),url:""};if("oauth-app"===t){const t="scopes"in e?e.scopes:[];s.scopes="string"==typeof t?t.split(/[,\s]+/).filter(Boolean):t}return s.url=function(e,t){const r={allowSignup:"allow_signup",clientId:"client_id",login:"login",redirectUrl:"redirect_uri",scopes:"scope",state:"state"};let s=e;return Object.keys(r).filter(e=>null!==t[e]).filter(e=>"scopes"!==e||"github-app"!==t.clientType&&(!Array.isArray(t[e])||t[e].length>0)).map(e=>[r[e],`${t[e]}`]).forEach(([e,t],r)=>{s+=0===r?"?":"&",s+=`${e}=${encodeURIComponent(t)}`}),s}(`${r}/login/oauth/authorize`,s),s}r.d(t,{oauthAuthorizationUrl:()=>s})},"./node_modules/@octokit/oauth-methods/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{checkToken:()=>m,createDeviceCode:()=>d,deleteAuthorization:()=>E,deleteToken:()=>w,exchangeDeviceCode:()=>p,exchangeWebFlowCode:()=>l,getWebFlowAuthorizationUrl:()=>c,refreshToken:()=>g,resetToken:()=>v,scopeToken:()=>y});var s=r("./node_modules/@octokit/oauth-authorization-url/dist-src/index.js"),o=r("./node_modules/@octokit/request/dist-bundle/index.js"),n=r("./node_modules/@octokit/request-error/dist-src/index.js");function i(e){const t=e.endpoint.DEFAULTS;return/^https:\/\/(api\.)?github\.com$/.test(t.baseUrl)?"https://github.com":t.baseUrl.replace("/api/v3","")}async function a(e,t,r){const s={baseUrl:i(e),headers:{accept:"application/json"},...r},o=await e(t,s);if("error"in o.data){const r=new n.RequestError(`${o.data.error_description} (${o.data.error}, ${o.data.error_uri})`,400,{request:e.endpoint.merge(t,s)});throw r.response=o,r}return o}function c({request:e=o.request,...t}){const r=i(e);return(0,s.oauthAuthorizationUrl)({...t,baseUrl:r})}async function l(e){const t=e.request||o.request,r=await a(t,"POST /login/oauth/access_token",{client_id:e.clientId,client_secret:e.clientSecret,code:e.code,redirect_uri:e.redirectUrl}),s={clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:r.data.access_token,scopes:r.data.scope.split(/\s+/).filter(Boolean)};if("github-app"===e.clientType){if("refresh_token"in r.data){const e=new Date(r.headers.date).getTime();s.refreshToken=r.data.refresh_token,s.expiresAt=u(e,r.data.expires_in),s.refreshTokenExpiresAt=u(e,r.data.refresh_token_expires_in)}delete s.scopes}return{...r,authentication:s}}function u(e,t){return new Date(e+1e3*t).toISOString()}async function d(e){const t=e.request||o.request,r={client_id:e.clientId};return"scopes"in e&&Array.isArray(e.scopes)&&(r.scope=e.scopes.join(" ")),a(t,"POST /login/device/code",r)}async function p(e){const t=e.request||o.request,r=await a(t,"POST /login/oauth/access_token",{client_id:e.clientId,device_code:e.code,grant_type:"urn:ietf:params:oauth:grant-type:device_code"}),s={clientType:e.clientType,clientId:e.clientId,token:r.data.access_token,scopes:r.data.scope.split(/\s+/).filter(Boolean)};if("clientSecret"in e&&(s.clientSecret=e.clientSecret),"github-app"===e.clientType){if("refresh_token"in r.data){const e=new Date(r.headers.date).getTime();s.refreshToken=r.data.refresh_token,s.expiresAt=h(e,r.data.expires_in),s.refreshTokenExpiresAt=h(e,r.data.refresh_token_expires_in)}delete s.scopes}return{...r,authentication:s}}function h(e,t){return new Date(e+1e3*t).toISOString()}async function m(e){const t=e.request||o.request,r=await t("POST /applications/{client_id}/token",{headers:{authorization:`basic ${btoa(`${e.clientId}:${e.clientSecret}`)}`},client_id:e.clientId,access_token:e.token}),s={clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:e.token,scopes:r.data.scopes};return r.data.expires_at&&(s.expiresAt=r.data.expires_at),"github-app"===e.clientType&&delete s.scopes,{...r,authentication:s}}async function g(e){const t=e.request||o.request,r=await a(t,"POST /login/oauth/access_token",{client_id:e.clientId,client_secret:e.clientSecret,grant_type:"refresh_token",refresh_token:e.refreshToken}),s=new Date(r.headers.date).getTime(),n={clientType:"github-app",clientId:e.clientId,clientSecret:e.clientSecret,token:r.data.access_token,refreshToken:r.data.refresh_token,expiresAt:f(s,r.data.expires_in),refreshTokenExpiresAt:f(s,r.data.refresh_token_expires_in)};return{...r,authentication:n}}function f(e,t){return new Date(e+1e3*t).toISOString()}async function y(e){const{request:t,clientType:r,clientId:s,clientSecret:n,token:i,...a}=e,c=e.request||o.request,l=await c("POST /applications/{client_id}/token/scoped",{headers:{authorization:`basic ${btoa(`${s}:${n}`)}`},client_id:s,access_token:i,...a}),u=Object.assign({clientType:r,clientId:s,clientSecret:n,token:l.data.token},l.data.expires_at?{expiresAt:l.data.expires_at}:{});return{...l,authentication:u}}async function v(e){const t=e.request||o.request,r=btoa(`${e.clientId}:${e.clientSecret}`),s=await t("PATCH /applications/{client_id}/token",{headers:{authorization:`basic ${r}`},client_id:e.clientId,access_token:e.token}),n={clientType:e.clientType,clientId:e.clientId,clientSecret:e.clientSecret,token:s.data.token,scopes:s.data.scopes};return s.data.expires_at&&(n.expiresAt=s.data.expires_at),"github-app"===e.clientType&&delete n.scopes,{...s,authentication:n}}async function w(e){return(e.request||o.request)("DELETE /applications/{client_id}/token",{headers:{authorization:`basic ${btoa(`${e.clientId}:${e.clientSecret}`)}`},client_id:e.clientId,access_token:e.token})}async function E(e){return(e.request||o.request)("DELETE /applications/{client_id}/grant",{headers:{authorization:`basic ${btoa(`${e.clientId}:${e.clientSecret}`)}`},client_id:e.clientId,access_token:e.token})}},"./node_modules/@octokit/plugin-paginate-graphql/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{paginateGraphQL:()=>m});var s=class extends Error{constructor(e,t){super(((e,t)=>`The cursor at "${e.join(",")}" did not change its value "${t}" after a page transition. Please make sure your that your query is set up correctly.`)(e.pathInQuery,t)),this.pageInfo=e,this.cursorValue=t,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}name="MissingCursorChangeError"},o=class extends Error{constructor(e){super(`No pageInfo property found in response. Please make sure to specify the pageInfo in your query. Response-Data: ${JSON.stringify(e,null,2)}`),this.response=e,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}name="MissingPageInfo"},n=e=>"[object Object]"===Object.prototype.toString.call(e);function i(e){const t=a(e,"pageInfo");if(0===t.length)throw new o(e);return t}var a=(e,t,r=[])=>{for(const s of Object.keys(e)){const o=[...r,s],i=e[s];if(n(i)){if(i.hasOwnProperty(t))return o;const e=a(i,t,o);if(e.length>0)return e}}return[]},c=(e,t)=>t.reduce((e,t)=>e[t],e),l=(e,t,r)=>{const s=t[t.length-1],o=[...t].slice(0,-1),n=c(e,o);n[s]="function"==typeof r?r(n[s]):r},u=e=>e.hasOwnProperty("hasNextPage"),d=e=>(t,r={})=>{let o=!0,n={...r};return{[Symbol.asyncIterator]:()=>({async next(){if(!o)return{done:!0,value:{}};const r=await e.graphql(t,n),a=(e=>{const t=i(e);return{pathInQuery:t,pageInfo:c(e,[...t,"pageInfo"])}})(r),l=(d=a.pageInfo,u(d)?d.endCursor:d.startCursor);var d;if(o=(e=>u(e)?e.hasNextPage:e.hasPreviousPage)(a.pageInfo),o&&l===n.cursor)throw new s(a,l);return n={...n,cursor:l},{done:!1,value:r}}})}},p=(e,t)=>{if(0===Object.keys(e).length)return Object.assign(e,t);const r=i(e),s=[...r,"nodes"],o=c(t,s);o&&l(e,s,e=>[...e,...o]);const n=[...r,"edges"],a=c(t,n);a&&l(e,n,e=>[...e,...a]);const u=[...r,"pageInfo"];return l(e,u,c(t,u)),e},h=e=>{const t=d(e);return async(e,r={})=>{let s={};for await(const o of t(e,r))s=p(s,o);return s}};function m(e){return{graphql:Object.assign(e.graphql,{paginate:Object.assign(h(e),{iterator:d(e)})})}}},"./node_modules/@octokit/plugin-paginate-rest/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{composePaginateRest:()=>i,paginateRest:()=>a});function s(e,t,r){const s="function"==typeof t?t.endpoint(r):e.request.endpoint(t,r),o="function"==typeof t?t:e.request,n=s.method,i=s.headers;let a=s.url;return{[Symbol.asyncIterator]:()=>({async next(){if(!a)return{done:!0};try{const e=function(e){if(!e.data)return{...e,data:[]};if(!("total_count"in e.data)||"url"in e.data)return e;const t=e.data.incomplete_results,r=e.data.repository_selection,s=e.data.total_count;delete e.data.incomplete_results,delete e.data.repository_selection,delete e.data.total_count;const o=Object.keys(e.data)[0],n=e.data[o];return e.data=n,void 0!==t&&(e.data.incomplete_results=t),void 0!==r&&(e.data.repository_selection=r),e.data.total_count=s,e}(await o({method:n,url:a,headers:i}));return a=((e.headers.link||"").match(/<([^<>]+)>;\s*rel="next"/)||[])[1],{value:e}}catch(e){if(409!==e.status)throw e;return a="",{value:{status:200,headers:{},data:[]}}}}})}}function o(e,t,r,o){return"function"==typeof r&&(o=r,r=void 0),n(e,[],s(e,t,r)[Symbol.asyncIterator](),o)}function n(e,t,r,s){return r.next().then(o=>{if(o.done)return t;let i=!1;return t=t.concat(s?s(o.value,function(){i=!0}):o.value.data),i?t:n(e,t,r,s)})}var i=Object.assign(o,{iterator:s});function a(e){return{paginate:Object.assign(o.bind(null,e),{iterator:s.bind(null,e)})}}a.VERSION="0.0.0-development"},"./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/endpoints-to-methods.js":(e,t,r)=>{"use strict";r.d(t,{endpointsToMethods:()=>i});var s=r("./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/generated/endpoints.js");const o=new Map;for(const[e,t]of Object.entries(s.default))for(const[r,s]of Object.entries(t)){const[t,n,i]=s,[a,c]=t.split(/ /),l=Object.assign({method:a,url:c},n);o.has(e)||o.set(e,new Map),o.get(e).set(r,{scope:e,methodName:r,endpointDefaults:l,decorations:i})}const n={has:({scope:e},t)=>o.get(e).has(t),getOwnPropertyDescriptor(e,t){return{value:this.get(e,t),configurable:!0,writable:!0,enumerable:!0}},defineProperty:(e,t,r)=>(Object.defineProperty(e.cache,t,r),!0),deleteProperty:(e,t)=>(delete e.cache[t],!0),ownKeys:({scope:e})=>[...o.get(e).keys()],set:(e,t,r)=>e.cache[t]=r,get({octokit:e,scope:t,cache:r},s){if(r[s])return r[s];const n=o.get(t).get(s);if(!n)return;const{endpointDefaults:i,decorations:a}=n;return r[s]=a?function(e,t,r,s,o){const n=e.request.defaults(s);function i(...s){let i=n.endpoint.merge(...s);if(o.mapToData)return i=Object.assign({},i,{data:i[o.mapToData],[o.mapToData]:void 0}),n(i);if(o.renamed){const[s,n]=o.renamed;e.log.warn(`octokit.${t}.${r}() has been renamed to octokit.${s}.${n}()`)}if(o.deprecated&&e.log.warn(o.deprecated),o.renamedParameters){const i=n.endpoint.merge(...s);for(const[s,n]of Object.entries(o.renamedParameters))s in i&&(e.log.warn(`"${s}" parameter is deprecated for "octokit.${t}.${r}()". Use "${n}" instead`),n in i||(i[n]=i[s]),delete i[s]);return n(i)}return n(...s)}return Object.assign(i,n)}(e,t,s,i,a):e.request.defaults(i),r[s]}};function i(e){const t={};for(const r of o.keys())t[r]=new Proxy({octokit:e,scope:r,cache:{}},n);return t}},"./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/generated/endpoints.js":(e,t,r)=>{"use strict";r.d(t,{default:()=>s});var s={actions:{addCustomLabelsToSelfHostedRunnerForOrg:["POST /orgs/{org}/actions/runners/{runner_id}/labels"],addCustomLabelsToSelfHostedRunnerForRepo:["POST /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],addRepoAccessToSelfHostedRunnerGroupInOrg:["PUT /orgs/{org}/actions/runner-groups/{runner_group_id}/repositories/{repository_id}"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],approveWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/approve"],cancelWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/cancel"],createEnvironmentVariable:["POST /repos/{owner}/{repo}/environments/{environment_name}/variables"],createHostedRunnerForOrg:["POST /orgs/{org}/actions/hosted-runners"],createOrUpdateEnvironmentSecret:["PUT /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/actions/secrets/{secret_name}"],createOrgVariable:["POST /orgs/{org}/actions/variables"],createRegistrationTokenForOrg:["POST /orgs/{org}/actions/runners/registration-token"],createRegistrationTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/registration-token"],createRemoveTokenForOrg:["POST /orgs/{org}/actions/runners/remove-token"],createRemoveTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/remove-token"],createRepoVariable:["POST /repos/{owner}/{repo}/actions/variables"],createWorkflowDispatch:["POST /repos/{owner}/{repo}/actions/workflows/{workflow_id}/dispatches"],deleteActionsCacheById:["DELETE /repos/{owner}/{repo}/actions/caches/{cache_id}"],deleteActionsCacheByKey:["DELETE /repos/{owner}/{repo}/actions/caches{?key,ref}"],deleteArtifact:["DELETE /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],deleteEnvironmentSecret:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],deleteEnvironmentVariable:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],deleteHostedRunnerForOrg:["DELETE /orgs/{org}/actions/hosted-runners/{hosted_runner_id}"],deleteOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}"],deleteOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/actions/secrets/{secret_name}"],deleteRepoVariable:["DELETE /repos/{owner}/{repo}/actions/variables/{name}"],deleteSelfHostedRunnerFromOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}"],deleteSelfHostedRunnerFromRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}"],deleteWorkflowRun:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}"],deleteWorkflowRunLogs:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],disableSelectedRepositoryGithubActionsOrganization:["DELETE /orgs/{org}/actions/permissions/repositories/{repository_id}"],disableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/disable"],downloadArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}/{archive_format}"],downloadJobLogsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}/logs"],downloadWorkflowRunAttemptLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/logs"],downloadWorkflowRunLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],enableSelectedRepositoryGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories/{repository_id}"],enableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/enable"],forceCancelWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/force-cancel"],generateRunnerJitconfigForOrg:["POST /orgs/{org}/actions/runners/generate-jitconfig"],generateRunnerJitconfigForRepo:["POST /repos/{owner}/{repo}/actions/runners/generate-jitconfig"],getActionsCacheList:["GET /repos/{owner}/{repo}/actions/caches"],getActionsCacheUsage:["GET /repos/{owner}/{repo}/actions/cache/usage"],getActionsCacheUsageByRepoForOrg:["GET /orgs/{org}/actions/cache/usage-by-repository"],getActionsCacheUsageForOrg:["GET /orgs/{org}/actions/cache/usage"],getAllowedActionsOrganization:["GET /orgs/{org}/actions/permissions/selected-actions"],getAllowedActionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/selected-actions"],getArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],getCustomOidcSubClaimForRepo:["GET /repos/{owner}/{repo}/actions/oidc/customization/sub"],getEnvironmentPublicKey:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets/public-key"],getEnvironmentSecret:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],getEnvironmentVariable:["GET /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],getGithubActionsDefaultWorkflowPermissionsOrganization:["GET /orgs/{org}/actions/permissions/workflow"],getGithubActionsDefaultWorkflowPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/workflow"],getGithubActionsPermissionsOrganization:["GET /orgs/{org}/actions/permissions"],getGithubActionsPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions"],getHostedRunnerForOrg:["GET /orgs/{org}/actions/hosted-runners/{hosted_runner_id}"],getHostedRunnersGithubOwnedImagesForOrg:["GET /orgs/{org}/actions/hosted-runners/images/github-owned"],getHostedRunnersLimitsForOrg:["GET /orgs/{org}/actions/hosted-runners/limits"],getHostedRunnersMachineSpecsForOrg:["GET /orgs/{org}/actions/hosted-runners/machine-sizes"],getHostedRunnersPartnerImagesForOrg:["GET /orgs/{org}/actions/hosted-runners/images/partner"],getHostedRunnersPlatformsForOrg:["GET /orgs/{org}/actions/hosted-runners/platforms"],getJobForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}"],getOrgPublicKey:["GET /orgs/{org}/actions/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}"],getOrgVariable:["GET /orgs/{org}/actions/variables/{name}"],getPendingDeploymentsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],getRepoPermissions:["GET /repos/{owner}/{repo}/actions/permissions",{},{renamed:["actions","getGithubActionsPermissionsRepository"]}],getRepoPublicKey:["GET /repos/{owner}/{repo}/actions/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/actions/secrets/{secret_name}"],getRepoVariable:["GET /repos/{owner}/{repo}/actions/variables/{name}"],getReviewsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/approvals"],getSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}"],getSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}"],getWorkflow:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}"],getWorkflowAccessToRepository:["GET /repos/{owner}/{repo}/actions/permissions/access"],getWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}"],getWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}"],getWorkflowRunUsage:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/timing"],getWorkflowUsage:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/timing"],listArtifactsForRepo:["GET /repos/{owner}/{repo}/actions/artifacts"],listEnvironmentSecrets:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets"],listEnvironmentVariables:["GET /repos/{owner}/{repo}/environments/{environment_name}/variables"],listGithubHostedRunnersInGroupForOrg:["GET /orgs/{org}/actions/runner-groups/{runner_group_id}/hosted-runners"],listHostedRunnersForOrg:["GET /orgs/{org}/actions/hosted-runners"],listJobsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/jobs"],listJobsForWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/jobs"],listLabelsForSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}/labels"],listLabelsForSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],listOrgSecrets:["GET /orgs/{org}/actions/secrets"],listOrgVariables:["GET /orgs/{org}/actions/variables"],listRepoOrganizationSecrets:["GET /repos/{owner}/{repo}/actions/organization-secrets"],listRepoOrganizationVariables:["GET /repos/{owner}/{repo}/actions/organization-variables"],listRepoSecrets:["GET /repos/{owner}/{repo}/actions/secrets"],listRepoVariables:["GET /repos/{owner}/{repo}/actions/variables"],listRepoWorkflows:["GET /repos/{owner}/{repo}/actions/workflows"],listRunnerApplicationsForOrg:["GET /orgs/{org}/actions/runners/downloads"],listRunnerApplicationsForRepo:["GET /repos/{owner}/{repo}/actions/runners/downloads"],listSelectedReposForOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}/repositories"],listSelectedReposForOrgVariable:["GET /orgs/{org}/actions/variables/{name}/repositories"],listSelectedRepositoriesEnabledGithubActionsOrganization:["GET /orgs/{org}/actions/permissions/repositories"],listSelfHostedRunnersForOrg:["GET /orgs/{org}/actions/runners"],listSelfHostedRunnersForRepo:["GET /repos/{owner}/{repo}/actions/runners"],listWorkflowRunArtifacts:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/artifacts"],listWorkflowRuns:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/runs"],listWorkflowRunsForRepo:["GET /repos/{owner}/{repo}/actions/runs"],reRunJobForWorkflowRun:["POST /repos/{owner}/{repo}/actions/jobs/{job_id}/rerun"],reRunWorkflow:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun"],reRunWorkflowFailedJobs:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun-failed-jobs"],removeAllCustomLabelsFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels"],removeAllCustomLabelsFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],removeCustomLabelFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels/{name}"],removeCustomLabelFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels/{name}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],reviewCustomGatesForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/deployment_protection_rule"],reviewPendingDeploymentsForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],setAllowedActionsOrganization:["PUT /orgs/{org}/actions/permissions/selected-actions"],setAllowedActionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/selected-actions"],setCustomLabelsForSelfHostedRunnerForOrg:["PUT /orgs/{org}/actions/runners/{runner_id}/labels"],setCustomLabelsForSelfHostedRunnerForRepo:["PUT /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],setCustomOidcSubClaimForRepo:["PUT /repos/{owner}/{repo}/actions/oidc/customization/sub"],setGithubActionsDefaultWorkflowPermissionsOrganization:["PUT /orgs/{org}/actions/permissions/workflow"],setGithubActionsDefaultWorkflowPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/workflow"],setGithubActionsPermissionsOrganization:["PUT /orgs/{org}/actions/permissions"],setGithubActionsPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories"],setSelectedReposForOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories"],setSelectedRepositoriesEnabledGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories"],setWorkflowAccessToRepository:["PUT /repos/{owner}/{repo}/actions/permissions/access"],updateEnvironmentVariable:["PATCH /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],updateHostedRunnerForOrg:["PATCH /orgs/{org}/actions/hosted-runners/{hosted_runner_id}"],updateOrgVariable:["PATCH /orgs/{org}/actions/variables/{name}"],updateRepoVariable:["PATCH /repos/{owner}/{repo}/actions/variables/{name}"]},activity:{checkRepoIsStarredByAuthenticatedUser:["GET /user/starred/{owner}/{repo}"],deleteRepoSubscription:["DELETE /repos/{owner}/{repo}/subscription"],deleteThreadSubscription:["DELETE /notifications/threads/{thread_id}/subscription"],getFeeds:["GET /feeds"],getRepoSubscription:["GET /repos/{owner}/{repo}/subscription"],getThread:["GET /notifications/threads/{thread_id}"],getThreadSubscriptionForAuthenticatedUser:["GET /notifications/threads/{thread_id}/subscription"],listEventsForAuthenticatedUser:["GET /users/{username}/events"],listNotificationsForAuthenticatedUser:["GET /notifications"],listOrgEventsForAuthenticatedUser:["GET /users/{username}/events/orgs/{org}"],listPublicEvents:["GET /events"],listPublicEventsForRepoNetwork:["GET /networks/{owner}/{repo}/events"],listPublicEventsForUser:["GET /users/{username}/events/public"],listPublicOrgEvents:["GET /orgs/{org}/events"],listReceivedEventsForUser:["GET /users/{username}/received_events"],listReceivedPublicEventsForUser:["GET /users/{username}/received_events/public"],listRepoEvents:["GET /repos/{owner}/{repo}/events"],listRepoNotificationsForAuthenticatedUser:["GET /repos/{owner}/{repo}/notifications"],listReposStarredByAuthenticatedUser:["GET /user/starred"],listReposStarredByUser:["GET /users/{username}/starred"],listReposWatchedByUser:["GET /users/{username}/subscriptions"],listStargazersForRepo:["GET /repos/{owner}/{repo}/stargazers"],listWatchedReposForAuthenticatedUser:["GET /user/subscriptions"],listWatchersForRepo:["GET /repos/{owner}/{repo}/subscribers"],markNotificationsAsRead:["PUT /notifications"],markRepoNotificationsAsRead:["PUT /repos/{owner}/{repo}/notifications"],markThreadAsDone:["DELETE /notifications/threads/{thread_id}"],markThreadAsRead:["PATCH /notifications/threads/{thread_id}"],setRepoSubscription:["PUT /repos/{owner}/{repo}/subscription"],setThreadSubscription:["PUT /notifications/threads/{thread_id}/subscription"],starRepoForAuthenticatedUser:["PUT /user/starred/{owner}/{repo}"],unstarRepoForAuthenticatedUser:["DELETE /user/starred/{owner}/{repo}"]},apps:{addRepoToInstallation:["PUT /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","addRepoToInstallationForAuthenticatedUser"]}],addRepoToInstallationForAuthenticatedUser:["PUT /user/installations/{installation_id}/repositories/{repository_id}"],checkToken:["POST /applications/{client_id}/token"],createFromManifest:["POST /app-manifests/{code}/conversions"],createInstallationAccessToken:["POST /app/installations/{installation_id}/access_tokens"],deleteAuthorization:["DELETE /applications/{client_id}/grant"],deleteInstallation:["DELETE /app/installations/{installation_id}"],deleteToken:["DELETE /applications/{client_id}/token"],getAuthenticated:["GET /app"],getBySlug:["GET /apps/{app_slug}"],getInstallation:["GET /app/installations/{installation_id}"],getOrgInstallation:["GET /orgs/{org}/installation"],getRepoInstallation:["GET /repos/{owner}/{repo}/installation"],getSubscriptionPlanForAccount:["GET /marketplace_listing/accounts/{account_id}"],getSubscriptionPlanForAccountStubbed:["GET /marketplace_listing/stubbed/accounts/{account_id}"],getUserInstallation:["GET /users/{username}/installation"],getWebhookConfigForApp:["GET /app/hook/config"],getWebhookDelivery:["GET /app/hook/deliveries/{delivery_id}"],listAccountsForPlan:["GET /marketplace_listing/plans/{plan_id}/accounts"],listAccountsForPlanStubbed:["GET /marketplace_listing/stubbed/plans/{plan_id}/accounts"],listInstallationReposForAuthenticatedUser:["GET /user/installations/{installation_id}/repositories"],listInstallationRequestsForAuthenticatedApp:["GET /app/installation-requests"],listInstallations:["GET /app/installations"],listInstallationsForAuthenticatedUser:["GET /user/installations"],listPlans:["GET /marketplace_listing/plans"],listPlansStubbed:["GET /marketplace_listing/stubbed/plans"],listReposAccessibleToInstallation:["GET /installation/repositories"],listSubscriptionsForAuthenticatedUser:["GET /user/marketplace_purchases"],listSubscriptionsForAuthenticatedUserStubbed:["GET /user/marketplace_purchases/stubbed"],listWebhookDeliveries:["GET /app/hook/deliveries"],redeliverWebhookDelivery:["POST /app/hook/deliveries/{delivery_id}/attempts"],removeRepoFromInstallation:["DELETE /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","removeRepoFromInstallationForAuthenticatedUser"]}],removeRepoFromInstallationForAuthenticatedUser:["DELETE /user/installations/{installation_id}/repositories/{repository_id}"],resetToken:["PATCH /applications/{client_id}/token"],revokeInstallationAccessToken:["DELETE /installation/token"],scopeToken:["POST /applications/{client_id}/token/scoped"],suspendInstallation:["PUT /app/installations/{installation_id}/suspended"],unsuspendInstallation:["DELETE /app/installations/{installation_id}/suspended"],updateWebhookConfigForApp:["PATCH /app/hook/config"]},billing:{getGithubActionsBillingOrg:["GET /orgs/{org}/settings/billing/actions"],getGithubActionsBillingUser:["GET /users/{username}/settings/billing/actions"],getGithubBillingUsageReportOrg:["GET /organizations/{org}/settings/billing/usage"],getGithubPackagesBillingOrg:["GET /orgs/{org}/settings/billing/packages"],getGithubPackagesBillingUser:["GET /users/{username}/settings/billing/packages"],getSharedStorageBillingOrg:["GET /orgs/{org}/settings/billing/shared-storage"],getSharedStorageBillingUser:["GET /users/{username}/settings/billing/shared-storage"]},campaigns:{createCampaign:["POST /orgs/{org}/campaigns"],deleteCampaign:["DELETE /orgs/{org}/campaigns/{campaign_number}"],getCampaignSummary:["GET /orgs/{org}/campaigns/{campaign_number}"],listOrgCampaigns:["GET /orgs/{org}/campaigns"],updateCampaign:["PATCH /orgs/{org}/campaigns/{campaign_number}"]},checks:{create:["POST /repos/{owner}/{repo}/check-runs"],createSuite:["POST /repos/{owner}/{repo}/check-suites"],get:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}"],getSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}"],listAnnotations:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}/annotations"],listForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-runs"],listForSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}/check-runs"],listSuitesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-suites"],rerequestRun:["POST /repos/{owner}/{repo}/check-runs/{check_run_id}/rerequest"],rerequestSuite:["POST /repos/{owner}/{repo}/check-suites/{check_suite_id}/rerequest"],setSuitesPreferences:["PATCH /repos/{owner}/{repo}/check-suites/preferences"],update:["PATCH /repos/{owner}/{repo}/check-runs/{check_run_id}"]},codeScanning:{commitAutofix:["POST /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/autofix/commits"],createAutofix:["POST /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/autofix"],createVariantAnalysis:["POST /repos/{owner}/{repo}/code-scanning/codeql/variant-analyses"],deleteAnalysis:["DELETE /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}{?confirm_delete}"],deleteCodeqlDatabase:["DELETE /repos/{owner}/{repo}/code-scanning/codeql/databases/{language}"],getAlert:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}",{},{renamedParameters:{alert_id:"alert_number"}}],getAnalysis:["GET /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}"],getAutofix:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/autofix"],getCodeqlDatabase:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases/{language}"],getDefaultSetup:["GET /repos/{owner}/{repo}/code-scanning/default-setup"],getSarif:["GET /repos/{owner}/{repo}/code-scanning/sarifs/{sarif_id}"],getVariantAnalysis:["GET /repos/{owner}/{repo}/code-scanning/codeql/variant-analyses/{codeql_variant_analysis_id}"],getVariantAnalysisRepoTask:["GET /repos/{owner}/{repo}/code-scanning/codeql/variant-analyses/{codeql_variant_analysis_id}/repos/{repo_owner}/{repo_name}"],listAlertInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances"],listAlertsForOrg:["GET /orgs/{org}/code-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/code-scanning/alerts"],listAlertsInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances",{},{renamed:["codeScanning","listAlertInstances"]}],listCodeqlDatabases:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases"],listRecentAnalyses:["GET /repos/{owner}/{repo}/code-scanning/analyses"],updateAlert:["PATCH /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}"],updateDefaultSetup:["PATCH /repos/{owner}/{repo}/code-scanning/default-setup"],uploadSarif:["POST /repos/{owner}/{repo}/code-scanning/sarifs"]},codeSecurity:{attachConfiguration:["POST /orgs/{org}/code-security/configurations/{configuration_id}/attach"],attachEnterpriseConfiguration:["POST /enterprises/{enterprise}/code-security/configurations/{configuration_id}/attach"],createConfiguration:["POST /orgs/{org}/code-security/configurations"],createConfigurationForEnterprise:["POST /enterprises/{enterprise}/code-security/configurations"],deleteConfiguration:["DELETE /orgs/{org}/code-security/configurations/{configuration_id}"],deleteConfigurationForEnterprise:["DELETE /enterprises/{enterprise}/code-security/configurations/{configuration_id}"],detachConfiguration:["DELETE /orgs/{org}/code-security/configurations/detach"],getConfiguration:["GET /orgs/{org}/code-security/configurations/{configuration_id}"],getConfigurationForRepository:["GET /repos/{owner}/{repo}/code-security-configuration"],getConfigurationsForEnterprise:["GET /enterprises/{enterprise}/code-security/configurations"],getConfigurationsForOrg:["GET /orgs/{org}/code-security/configurations"],getDefaultConfigurations:["GET /orgs/{org}/code-security/configurations/defaults"],getDefaultConfigurationsForEnterprise:["GET /enterprises/{enterprise}/code-security/configurations/defaults"],getRepositoriesForConfiguration:["GET /orgs/{org}/code-security/configurations/{configuration_id}/repositories"],getRepositoriesForEnterpriseConfiguration:["GET /enterprises/{enterprise}/code-security/configurations/{configuration_id}/repositories"],getSingleConfigurationForEnterprise:["GET /enterprises/{enterprise}/code-security/configurations/{configuration_id}"],setConfigurationAsDefault:["PUT /orgs/{org}/code-security/configurations/{configuration_id}/defaults"],setConfigurationAsDefaultForEnterprise:["PUT /enterprises/{enterprise}/code-security/configurations/{configuration_id}/defaults"],updateConfiguration:["PATCH /orgs/{org}/code-security/configurations/{configuration_id}"],updateEnterpriseConfiguration:["PATCH /enterprises/{enterprise}/code-security/configurations/{configuration_id}"]},codesOfConduct:{getAllCodesOfConduct:["GET /codes_of_conduct"],getConductCode:["GET /codes_of_conduct/{key}"]},codespaces:{addRepositoryForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],checkPermissionsForDevcontainer:["GET /repos/{owner}/{repo}/codespaces/permissions_check"],codespaceMachinesForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/machines"],createForAuthenticatedUser:["POST /user/codespaces"],createOrUpdateOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],createOrUpdateSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}"],createWithPrForAuthenticatedUser:["POST /repos/{owner}/{repo}/pulls/{pull_number}/codespaces"],createWithRepoForAuthenticatedUser:["POST /repos/{owner}/{repo}/codespaces"],deleteForAuthenticatedUser:["DELETE /user/codespaces/{codespace_name}"],deleteFromOrganization:["DELETE /orgs/{org}/members/{username}/codespaces/{codespace_name}"],deleteOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],deleteSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}"],exportForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/exports"],getCodespacesForUserInOrg:["GET /orgs/{org}/members/{username}/codespaces"],getExportDetailsForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/exports/{export_id}"],getForAuthenticatedUser:["GET /user/codespaces/{codespace_name}"],getOrgPublicKey:["GET /orgs/{org}/codespaces/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}"],getPublicKeyForAuthenticatedUser:["GET /user/codespaces/secrets/public-key"],getRepoPublicKey:["GET /repos/{owner}/{repo}/codespaces/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],getSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}"],listDevcontainersInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/devcontainers"],listForAuthenticatedUser:["GET /user/codespaces"],listInOrganization:["GET /orgs/{org}/codespaces",{},{renamedParameters:{org_id:"org"}}],listInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces"],listOrgSecrets:["GET /orgs/{org}/codespaces/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/codespaces/secrets"],listRepositoriesForSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}/repositories"],listSecretsForAuthenticatedUser:["GET /user/codespaces/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],preFlightWithRepoForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/new"],publishForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/publish"],removeRepositoryForSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],repoMachinesForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/machines"],setRepositoriesForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],startForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/start"],stopForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/stop"],stopInOrganization:["POST /orgs/{org}/members/{username}/codespaces/{codespace_name}/stop"],updateForAuthenticatedUser:["PATCH /user/codespaces/{codespace_name}"]},copilot:{addCopilotSeatsForTeams:["POST /orgs/{org}/copilot/billing/selected_teams"],addCopilotSeatsForUsers:["POST /orgs/{org}/copilot/billing/selected_users"],cancelCopilotSeatAssignmentForTeams:["DELETE /orgs/{org}/copilot/billing/selected_teams"],cancelCopilotSeatAssignmentForUsers:["DELETE /orgs/{org}/copilot/billing/selected_users"],copilotMetricsForOrganization:["GET /orgs/{org}/copilot/metrics"],copilotMetricsForTeam:["GET /orgs/{org}/team/{team_slug}/copilot/metrics"],getCopilotOrganizationDetails:["GET /orgs/{org}/copilot/billing"],getCopilotSeatDetailsForUser:["GET /orgs/{org}/members/{username}/copilot"],listCopilotSeats:["GET /orgs/{org}/copilot/billing/seats"]},dependabot:{addSelectedRepoToOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],deleteOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],getAlert:["GET /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"],getOrgPublicKey:["GET /orgs/{org}/dependabot/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}"],getRepoPublicKey:["GET /repos/{owner}/{repo}/dependabot/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/dependabot/alerts"],listAlertsForOrg:["GET /orgs/{org}/dependabot/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/dependabot/alerts"],listOrgSecrets:["GET /orgs/{org}/dependabot/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/dependabot/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],updateAlert:["PATCH /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"]},dependencyGraph:{createRepositorySnapshot:["POST /repos/{owner}/{repo}/dependency-graph/snapshots"],diffRange:["GET /repos/{owner}/{repo}/dependency-graph/compare/{basehead}"],exportSbom:["GET /repos/{owner}/{repo}/dependency-graph/sbom"]},emojis:{get:["GET /emojis"]},gists:{checkIsStarred:["GET /gists/{gist_id}/star"],create:["POST /gists"],createComment:["POST /gists/{gist_id}/comments"],delete:["DELETE /gists/{gist_id}"],deleteComment:["DELETE /gists/{gist_id}/comments/{comment_id}"],fork:["POST /gists/{gist_id}/forks"],get:["GET /gists/{gist_id}"],getComment:["GET /gists/{gist_id}/comments/{comment_id}"],getRevision:["GET /gists/{gist_id}/{sha}"],list:["GET /gists"],listComments:["GET /gists/{gist_id}/comments"],listCommits:["GET /gists/{gist_id}/commits"],listForUser:["GET /users/{username}/gists"],listForks:["GET /gists/{gist_id}/forks"],listPublic:["GET /gists/public"],listStarred:["GET /gists/starred"],star:["PUT /gists/{gist_id}/star"],unstar:["DELETE /gists/{gist_id}/star"],update:["PATCH /gists/{gist_id}"],updateComment:["PATCH /gists/{gist_id}/comments/{comment_id}"]},git:{createBlob:["POST /repos/{owner}/{repo}/git/blobs"],createCommit:["POST /repos/{owner}/{repo}/git/commits"],createRef:["POST /repos/{owner}/{repo}/git/refs"],createTag:["POST /repos/{owner}/{repo}/git/tags"],createTree:["POST /repos/{owner}/{repo}/git/trees"],deleteRef:["DELETE /repos/{owner}/{repo}/git/refs/{ref}"],getBlob:["GET /repos/{owner}/{repo}/git/blobs/{file_sha}"],getCommit:["GET /repos/{owner}/{repo}/git/commits/{commit_sha}"],getRef:["GET /repos/{owner}/{repo}/git/ref/{ref}"],getTag:["GET /repos/{owner}/{repo}/git/tags/{tag_sha}"],getTree:["GET /repos/{owner}/{repo}/git/trees/{tree_sha}"],listMatchingRefs:["GET /repos/{owner}/{repo}/git/matching-refs/{ref}"],updateRef:["PATCH /repos/{owner}/{repo}/git/refs/{ref}"]},gitignore:{getAllTemplates:["GET /gitignore/templates"],getTemplate:["GET /gitignore/templates/{name}"]},hostedCompute:{createNetworkConfigurationForOrg:["POST /orgs/{org}/settings/network-configurations"],deleteNetworkConfigurationFromOrg:["DELETE /orgs/{org}/settings/network-configurations/{network_configuration_id}"],getNetworkConfigurationForOrg:["GET /orgs/{org}/settings/network-configurations/{network_configuration_id}"],getNetworkSettingsForOrg:["GET /orgs/{org}/settings/network-settings/{network_settings_id}"],listNetworkConfigurationsForOrg:["GET /orgs/{org}/settings/network-configurations"],updateNetworkConfigurationForOrg:["PATCH /orgs/{org}/settings/network-configurations/{network_configuration_id}"]},interactions:{getRestrictionsForAuthenticatedUser:["GET /user/interaction-limits"],getRestrictionsForOrg:["GET /orgs/{org}/interaction-limits"],getRestrictionsForRepo:["GET /repos/{owner}/{repo}/interaction-limits"],getRestrictionsForYourPublicRepos:["GET /user/interaction-limits",{},{renamed:["interactions","getRestrictionsForAuthenticatedUser"]}],removeRestrictionsForAuthenticatedUser:["DELETE /user/interaction-limits"],removeRestrictionsForOrg:["DELETE /orgs/{org}/interaction-limits"],removeRestrictionsForRepo:["DELETE /repos/{owner}/{repo}/interaction-limits"],removeRestrictionsForYourPublicRepos:["DELETE /user/interaction-limits",{},{renamed:["interactions","removeRestrictionsForAuthenticatedUser"]}],setRestrictionsForAuthenticatedUser:["PUT /user/interaction-limits"],setRestrictionsForOrg:["PUT /orgs/{org}/interaction-limits"],setRestrictionsForRepo:["PUT /repos/{owner}/{repo}/interaction-limits"],setRestrictionsForYourPublicRepos:["PUT /user/interaction-limits",{},{renamed:["interactions","setRestrictionsForAuthenticatedUser"]}]},issues:{addAssignees:["POST /repos/{owner}/{repo}/issues/{issue_number}/assignees"],addLabels:["POST /repos/{owner}/{repo}/issues/{issue_number}/labels"],addSubIssue:["POST /repos/{owner}/{repo}/issues/{issue_number}/sub_issues"],checkUserCanBeAssigned:["GET /repos/{owner}/{repo}/assignees/{assignee}"],checkUserCanBeAssignedToIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/assignees/{assignee}"],create:["POST /repos/{owner}/{repo}/issues"],createComment:["POST /repos/{owner}/{repo}/issues/{issue_number}/comments"],createLabel:["POST /repos/{owner}/{repo}/labels"],createMilestone:["POST /repos/{owner}/{repo}/milestones"],deleteComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}"],deleteLabel:["DELETE /repos/{owner}/{repo}/labels/{name}"],deleteMilestone:["DELETE /repos/{owner}/{repo}/milestones/{milestone_number}"],get:["GET /repos/{owner}/{repo}/issues/{issue_number}"],getComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}"],getEvent:["GET /repos/{owner}/{repo}/issues/events/{event_id}"],getLabel:["GET /repos/{owner}/{repo}/labels/{name}"],getMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}"],list:["GET /issues"],listAssignees:["GET /repos/{owner}/{repo}/assignees"],listComments:["GET /repos/{owner}/{repo}/issues/{issue_number}/comments"],listCommentsForRepo:["GET /repos/{owner}/{repo}/issues/comments"],listEvents:["GET /repos/{owner}/{repo}/issues/{issue_number}/events"],listEventsForRepo:["GET /repos/{owner}/{repo}/issues/events"],listEventsForTimeline:["GET /repos/{owner}/{repo}/issues/{issue_number}/timeline"],listForAuthenticatedUser:["GET /user/issues"],listForOrg:["GET /orgs/{org}/issues"],listForRepo:["GET /repos/{owner}/{repo}/issues"],listLabelsForMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}/labels"],listLabelsForRepo:["GET /repos/{owner}/{repo}/labels"],listLabelsOnIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/labels"],listMilestones:["GET /repos/{owner}/{repo}/milestones"],listSubIssues:["GET /repos/{owner}/{repo}/issues/{issue_number}/sub_issues"],lock:["PUT /repos/{owner}/{repo}/issues/{issue_number}/lock"],removeAllLabels:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels"],removeAssignees:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/assignees"],removeLabel:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels/{name}"],removeSubIssue:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/sub_issue"],reprioritizeSubIssue:["PATCH /repos/{owner}/{repo}/issues/{issue_number}/sub_issues/priority"],setLabels:["PUT /repos/{owner}/{repo}/issues/{issue_number}/labels"],unlock:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/lock"],update:["PATCH /repos/{owner}/{repo}/issues/{issue_number}"],updateComment:["PATCH /repos/{owner}/{repo}/issues/comments/{comment_id}"],updateLabel:["PATCH /repos/{owner}/{repo}/labels/{name}"],updateMilestone:["PATCH /repos/{owner}/{repo}/milestones/{milestone_number}"]},licenses:{get:["GET /licenses/{license}"],getAllCommonlyUsed:["GET /licenses"],getForRepo:["GET /repos/{owner}/{repo}/license"]},markdown:{render:["POST /markdown"],renderRaw:["POST /markdown/raw",{headers:{"content-type":"text/plain; charset=utf-8"}}]},meta:{get:["GET /meta"],getAllVersions:["GET /versions"],getOctocat:["GET /octocat"],getZen:["GET /zen"],root:["GET /"]},migrations:{deleteArchiveForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/archive"],deleteArchiveForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/archive"],downloadArchiveForOrg:["GET /orgs/{org}/migrations/{migration_id}/archive"],getArchiveForAuthenticatedUser:["GET /user/migrations/{migration_id}/archive"],getStatusForAuthenticatedUser:["GET /user/migrations/{migration_id}"],getStatusForOrg:["GET /orgs/{org}/migrations/{migration_id}"],listForAuthenticatedUser:["GET /user/migrations"],listForOrg:["GET /orgs/{org}/migrations"],listReposForAuthenticatedUser:["GET /user/migrations/{migration_id}/repositories"],listReposForOrg:["GET /orgs/{org}/migrations/{migration_id}/repositories"],listReposForUser:["GET /user/migrations/{migration_id}/repositories",{},{renamed:["migrations","listReposForAuthenticatedUser"]}],startForAuthenticatedUser:["POST /user/migrations"],startForOrg:["POST /orgs/{org}/migrations"],unlockRepoForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/repos/{repo_name}/lock"],unlockRepoForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/repos/{repo_name}/lock"]},oidc:{getOidcCustomSubTemplateForOrg:["GET /orgs/{org}/actions/oidc/customization/sub"],updateOidcCustomSubTemplateForOrg:["PUT /orgs/{org}/actions/oidc/customization/sub"]},orgs:{addSecurityManagerTeam:["PUT /orgs/{org}/security-managers/teams/{team_slug}",{},{deprecated:"octokit.rest.orgs.addSecurityManagerTeam() is deprecated, see https://docs.github.com/rest/orgs/security-managers#add-a-security-manager-team"}],assignTeamToOrgRole:["PUT /orgs/{org}/organization-roles/teams/{team_slug}/{role_id}"],assignUserToOrgRole:["PUT /orgs/{org}/organization-roles/users/{username}/{role_id}"],blockUser:["PUT /orgs/{org}/blocks/{username}"],cancelInvitation:["DELETE /orgs/{org}/invitations/{invitation_id}"],checkBlockedUser:["GET /orgs/{org}/blocks/{username}"],checkMembershipForUser:["GET /orgs/{org}/members/{username}"],checkPublicMembershipForUser:["GET /orgs/{org}/public_members/{username}"],convertMemberToOutsideCollaborator:["PUT /orgs/{org}/outside_collaborators/{username}"],createInvitation:["POST /orgs/{org}/invitations"],createIssueType:["POST /orgs/{org}/issue-types"],createOrUpdateCustomProperties:["PATCH /orgs/{org}/properties/schema"],createOrUpdateCustomPropertiesValuesForRepos:["PATCH /orgs/{org}/properties/values"],createOrUpdateCustomProperty:["PUT /orgs/{org}/properties/schema/{custom_property_name}"],createWebhook:["POST /orgs/{org}/hooks"],delete:["DELETE /orgs/{org}"],deleteIssueType:["DELETE /orgs/{org}/issue-types/{issue_type_id}"],deleteWebhook:["DELETE /orgs/{org}/hooks/{hook_id}"],enableOrDisableSecurityProductOnAllOrgRepos:["POST /orgs/{org}/{security_product}/{enablement}",{},{deprecated:"octokit.rest.orgs.enableOrDisableSecurityProductOnAllOrgRepos() is deprecated, see https://docs.github.com/rest/orgs/orgs#enable-or-disable-a-security-feature-for-an-organization"}],get:["GET /orgs/{org}"],getAllCustomProperties:["GET /orgs/{org}/properties/schema"],getCustomProperty:["GET /orgs/{org}/properties/schema/{custom_property_name}"],getMembershipForAuthenticatedUser:["GET /user/memberships/orgs/{org}"],getMembershipForUser:["GET /orgs/{org}/memberships/{username}"],getOrgRole:["GET /orgs/{org}/organization-roles/{role_id}"],getOrgRulesetHistory:["GET /orgs/{org}/rulesets/{ruleset_id}/history"],getOrgRulesetVersion:["GET /orgs/{org}/rulesets/{ruleset_id}/history/{version_id}"],getWebhook:["GET /orgs/{org}/hooks/{hook_id}"],getWebhookConfigForOrg:["GET /orgs/{org}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}"],list:["GET /organizations"],listAppInstallations:["GET /orgs/{org}/installations"],listAttestations:["GET /orgs/{org}/attestations/{subject_digest}"],listBlockedUsers:["GET /orgs/{org}/blocks"],listCustomPropertiesValuesForRepos:["GET /orgs/{org}/properties/values"],listFailedInvitations:["GET /orgs/{org}/failed_invitations"],listForAuthenticatedUser:["GET /user/orgs"],listForUser:["GET /users/{username}/orgs"],listInvitationTeams:["GET /orgs/{org}/invitations/{invitation_id}/teams"],listIssueTypes:["GET /orgs/{org}/issue-types"],listMembers:["GET /orgs/{org}/members"],listMembershipsForAuthenticatedUser:["GET /user/memberships/orgs"],listOrgRoleTeams:["GET /orgs/{org}/organization-roles/{role_id}/teams"],listOrgRoleUsers:["GET /orgs/{org}/organization-roles/{role_id}/users"],listOrgRoles:["GET /orgs/{org}/organization-roles"],listOrganizationFineGrainedPermissions:["GET /orgs/{org}/organization-fine-grained-permissions"],listOutsideCollaborators:["GET /orgs/{org}/outside_collaborators"],listPatGrantRepositories:["GET /orgs/{org}/personal-access-tokens/{pat_id}/repositories"],listPatGrantRequestRepositories:["GET /orgs/{org}/personal-access-token-requests/{pat_request_id}/repositories"],listPatGrantRequests:["GET /orgs/{org}/personal-access-token-requests"],listPatGrants:["GET /orgs/{org}/personal-access-tokens"],listPendingInvitations:["GET /orgs/{org}/invitations"],listPublicMembers:["GET /orgs/{org}/public_members"],listSecurityManagerTeams:["GET /orgs/{org}/security-managers",{},{deprecated:"octokit.rest.orgs.listSecurityManagerTeams() is deprecated, see https://docs.github.com/rest/orgs/security-managers#list-security-manager-teams"}],listWebhookDeliveries:["GET /orgs/{org}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /orgs/{org}/hooks"],pingWebhook:["POST /orgs/{org}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeCustomProperty:["DELETE /orgs/{org}/properties/schema/{custom_property_name}"],removeMember:["DELETE /orgs/{org}/members/{username}"],removeMembershipForUser:["DELETE /orgs/{org}/memberships/{username}"],removeOutsideCollaborator:["DELETE /orgs/{org}/outside_collaborators/{username}"],removePublicMembershipForAuthenticatedUser:["DELETE /orgs/{org}/public_members/{username}"],removeSecurityManagerTeam:["DELETE /orgs/{org}/security-managers/teams/{team_slug}",{},{deprecated:"octokit.rest.orgs.removeSecurityManagerTeam() is deprecated, see https://docs.github.com/rest/orgs/security-managers#remove-a-security-manager-team"}],reviewPatGrantRequest:["POST /orgs/{org}/personal-access-token-requests/{pat_request_id}"],reviewPatGrantRequestsInBulk:["POST /orgs/{org}/personal-access-token-requests"],revokeAllOrgRolesTeam:["DELETE /orgs/{org}/organization-roles/teams/{team_slug}"],revokeAllOrgRolesUser:["DELETE /orgs/{org}/organization-roles/users/{username}"],revokeOrgRoleTeam:["DELETE /orgs/{org}/organization-roles/teams/{team_slug}/{role_id}"],revokeOrgRoleUser:["DELETE /orgs/{org}/organization-roles/users/{username}/{role_id}"],setMembershipForUser:["PUT /orgs/{org}/memberships/{username}"],setPublicMembershipForAuthenticatedUser:["PUT /orgs/{org}/public_members/{username}"],unblockUser:["DELETE /orgs/{org}/blocks/{username}"],update:["PATCH /orgs/{org}"],updateIssueType:["PUT /orgs/{org}/issue-types/{issue_type_id}"],updateMembershipForAuthenticatedUser:["PATCH /user/memberships/orgs/{org}"],updatePatAccess:["POST /orgs/{org}/personal-access-tokens/{pat_id}"],updatePatAccesses:["POST /orgs/{org}/personal-access-tokens"],updateWebhook:["PATCH /orgs/{org}/hooks/{hook_id}"],updateWebhookConfigForOrg:["PATCH /orgs/{org}/hooks/{hook_id}/config"]},packages:{deletePackageForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}"],deletePackageForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}"],deletePackageForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}"],deletePackageVersionForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getAllPackageVersionsForAPackageOwnedByAnOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByOrg"]}],getAllPackageVersionsForAPackageOwnedByTheAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByAuthenticatedUser"]}],getAllPackageVersionsForPackageOwnedByAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions"],getPackageForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}"],getPackageForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}"],getPackageForUser:["GET /users/{username}/packages/{package_type}/{package_name}"],getPackageVersionForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],listDockerMigrationConflictingPackagesForAuthenticatedUser:["GET /user/docker/conflicts"],listDockerMigrationConflictingPackagesForOrganization:["GET /orgs/{org}/docker/conflicts"],listDockerMigrationConflictingPackagesForUser:["GET /users/{username}/docker/conflicts"],listPackagesForAuthenticatedUser:["GET /user/packages"],listPackagesForOrganization:["GET /orgs/{org}/packages"],listPackagesForUser:["GET /users/{username}/packages"],restorePackageForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForUser:["POST /users/{username}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageVersionForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForUser:["POST /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"]},privateRegistries:{createOrgPrivateRegistry:["POST /orgs/{org}/private-registries"],deleteOrgPrivateRegistry:["DELETE /orgs/{org}/private-registries/{secret_name}"],getOrgPrivateRegistry:["GET /orgs/{org}/private-registries/{secret_name}"],getOrgPublicKey:["GET /orgs/{org}/private-registries/public-key"],listOrgPrivateRegistries:["GET /orgs/{org}/private-registries"],updateOrgPrivateRegistry:["PATCH /orgs/{org}/private-registries/{secret_name}"]},pulls:{checkIfMerged:["GET /repos/{owner}/{repo}/pulls/{pull_number}/merge"],create:["POST /repos/{owner}/{repo}/pulls"],createReplyForReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments/{comment_id}/replies"],createReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],createReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments"],deletePendingReview:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],deleteReviewComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}"],dismissReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/dismissals"],get:["GET /repos/{owner}/{repo}/pulls/{pull_number}"],getReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],getReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}"],list:["GET /repos/{owner}/{repo}/pulls"],listCommentsForReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/comments"],listCommits:["GET /repos/{owner}/{repo}/pulls/{pull_number}/commits"],listFiles:["GET /repos/{owner}/{repo}/pulls/{pull_number}/files"],listRequestedReviewers:["GET /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],listReviewComments:["GET /repos/{owner}/{repo}/pulls/{pull_number}/comments"],listReviewCommentsForRepo:["GET /repos/{owner}/{repo}/pulls/comments"],listReviews:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],merge:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/merge"],removeRequestedReviewers:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],requestReviewers:["POST /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],submitReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/events"],update:["PATCH /repos/{owner}/{repo}/pulls/{pull_number}"],updateBranch:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/update-branch"],updateReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],updateReviewComment:["PATCH /repos/{owner}/{repo}/pulls/comments/{comment_id}"]},rateLimit:{get:["GET /rate_limit"]},reactions:{createForCommitComment:["POST /repos/{owner}/{repo}/comments/{comment_id}/reactions"],createForIssue:["POST /repos/{owner}/{repo}/issues/{issue_number}/reactions"],createForIssueComment:["POST /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],createForPullRequestReviewComment:["POST /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],createForRelease:["POST /repos/{owner}/{repo}/releases/{release_id}/reactions"],createForTeamDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],createForTeamDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"],deleteForCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}/reactions/{reaction_id}"],deleteForIssue:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/reactions/{reaction_id}"],deleteForIssueComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions/{reaction_id}"],deleteForPullRequestComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions/{reaction_id}"],deleteForRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}/reactions/{reaction_id}"],deleteForTeamDiscussion:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions/{reaction_id}"],deleteForTeamDiscussionComment:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions/{reaction_id}"],listForCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}/reactions"],listForIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/reactions"],listForIssueComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],listForPullRequestReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],listForRelease:["GET /repos/{owner}/{repo}/releases/{release_id}/reactions"],listForTeamDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],listForTeamDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"]},repos:{acceptInvitation:["PATCH /user/repository_invitations/{invitation_id}",{},{renamed:["repos","acceptInvitationForAuthenticatedUser"]}],acceptInvitationForAuthenticatedUser:["PATCH /user/repository_invitations/{invitation_id}"],addAppAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],addCollaborator:["PUT /repos/{owner}/{repo}/collaborators/{username}"],addStatusCheckContexts:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],addTeamAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],addUserAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],cancelPagesDeployment:["POST /repos/{owner}/{repo}/pages/deployments/{pages_deployment_id}/cancel"],checkAutomatedSecurityFixes:["GET /repos/{owner}/{repo}/automated-security-fixes"],checkCollaborator:["GET /repos/{owner}/{repo}/collaborators/{username}"],checkPrivateVulnerabilityReporting:["GET /repos/{owner}/{repo}/private-vulnerability-reporting"],checkVulnerabilityAlerts:["GET /repos/{owner}/{repo}/vulnerability-alerts"],codeownersErrors:["GET /repos/{owner}/{repo}/codeowners/errors"],compareCommits:["GET /repos/{owner}/{repo}/compare/{base}...{head}"],compareCommitsWithBasehead:["GET /repos/{owner}/{repo}/compare/{basehead}"],createAttestation:["POST /repos/{owner}/{repo}/attestations"],createAutolink:["POST /repos/{owner}/{repo}/autolinks"],createCommitComment:["POST /repos/{owner}/{repo}/commits/{commit_sha}/comments"],createCommitSignatureProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],createCommitStatus:["POST /repos/{owner}/{repo}/statuses/{sha}"],createDeployKey:["POST /repos/{owner}/{repo}/keys"],createDeployment:["POST /repos/{owner}/{repo}/deployments"],createDeploymentBranchPolicy:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],createDeploymentProtectionRule:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],createDeploymentStatus:["POST /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],createDispatchEvent:["POST /repos/{owner}/{repo}/dispatches"],createForAuthenticatedUser:["POST /user/repos"],createFork:["POST /repos/{owner}/{repo}/forks"],createInOrg:["POST /orgs/{org}/repos"],createOrUpdateCustomPropertiesValues:["PATCH /repos/{owner}/{repo}/properties/values"],createOrUpdateEnvironment:["PUT /repos/{owner}/{repo}/environments/{environment_name}"],createOrUpdateFileContents:["PUT /repos/{owner}/{repo}/contents/{path}"],createOrgRuleset:["POST /orgs/{org}/rulesets"],createPagesDeployment:["POST /repos/{owner}/{repo}/pages/deployments"],createPagesSite:["POST /repos/{owner}/{repo}/pages"],createRelease:["POST /repos/{owner}/{repo}/releases"],createRepoRuleset:["POST /repos/{owner}/{repo}/rulesets"],createUsingTemplate:["POST /repos/{template_owner}/{template_repo}/generate"],createWebhook:["POST /repos/{owner}/{repo}/hooks"],declineInvitation:["DELETE /user/repository_invitations/{invitation_id}",{},{renamed:["repos","declineInvitationForAuthenticatedUser"]}],declineInvitationForAuthenticatedUser:["DELETE /user/repository_invitations/{invitation_id}"],delete:["DELETE /repos/{owner}/{repo}"],deleteAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],deleteAdminBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],deleteAnEnvironment:["DELETE /repos/{owner}/{repo}/environments/{environment_name}"],deleteAutolink:["DELETE /repos/{owner}/{repo}/autolinks/{autolink_id}"],deleteBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection"],deleteCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}"],deleteCommitSignatureProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],deleteDeployKey:["DELETE /repos/{owner}/{repo}/keys/{key_id}"],deleteDeployment:["DELETE /repos/{owner}/{repo}/deployments/{deployment_id}"],deleteDeploymentBranchPolicy:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],deleteFile:["DELETE /repos/{owner}/{repo}/contents/{path}"],deleteInvitation:["DELETE /repos/{owner}/{repo}/invitations/{invitation_id}"],deleteOrgRuleset:["DELETE /orgs/{org}/rulesets/{ruleset_id}"],deletePagesSite:["DELETE /repos/{owner}/{repo}/pages"],deletePullRequestReviewProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],deleteRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}"],deleteReleaseAsset:["DELETE /repos/{owner}/{repo}/releases/assets/{asset_id}"],deleteRepoRuleset:["DELETE /repos/{owner}/{repo}/rulesets/{ruleset_id}"],deleteWebhook:["DELETE /repos/{owner}/{repo}/hooks/{hook_id}"],disableAutomatedSecurityFixes:["DELETE /repos/{owner}/{repo}/automated-security-fixes"],disableDeploymentProtectionRule:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],disablePrivateVulnerabilityReporting:["DELETE /repos/{owner}/{repo}/private-vulnerability-reporting"],disableVulnerabilityAlerts:["DELETE /repos/{owner}/{repo}/vulnerability-alerts"],downloadArchive:["GET /repos/{owner}/{repo}/zipball/{ref}",{},{renamed:["repos","downloadZipballArchive"]}],downloadTarballArchive:["GET /repos/{owner}/{repo}/tarball/{ref}"],downloadZipballArchive:["GET /repos/{owner}/{repo}/zipball/{ref}"],enableAutomatedSecurityFixes:["PUT /repos/{owner}/{repo}/automated-security-fixes"],enablePrivateVulnerabilityReporting:["PUT /repos/{owner}/{repo}/private-vulnerability-reporting"],enableVulnerabilityAlerts:["PUT /repos/{owner}/{repo}/vulnerability-alerts"],generateReleaseNotes:["POST /repos/{owner}/{repo}/releases/generate-notes"],get:["GET /repos/{owner}/{repo}"],getAccessRestrictions:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],getAdminBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],getAllDeploymentProtectionRules:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],getAllEnvironments:["GET /repos/{owner}/{repo}/environments"],getAllStatusCheckContexts:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts"],getAllTopics:["GET /repos/{owner}/{repo}/topics"],getAppsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps"],getAutolink:["GET /repos/{owner}/{repo}/autolinks/{autolink_id}"],getBranch:["GET /repos/{owner}/{repo}/branches/{branch}"],getBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection"],getBranchRules:["GET /repos/{owner}/{repo}/rules/branches/{branch}"],getClones:["GET /repos/{owner}/{repo}/traffic/clones"],getCodeFrequencyStats:["GET /repos/{owner}/{repo}/stats/code_frequency"],getCollaboratorPermissionLevel:["GET /repos/{owner}/{repo}/collaborators/{username}/permission"],getCombinedStatusForRef:["GET /repos/{owner}/{repo}/commits/{ref}/status"],getCommit:["GET /repos/{owner}/{repo}/commits/{ref}"],getCommitActivityStats:["GET /repos/{owner}/{repo}/stats/commit_activity"],getCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}"],getCommitSignatureProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],getCommunityProfileMetrics:["GET /repos/{owner}/{repo}/community/profile"],getContent:["GET /repos/{owner}/{repo}/contents/{path}"],getContributorsStats:["GET /repos/{owner}/{repo}/stats/contributors"],getCustomDeploymentProtectionRule:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],getCustomPropertiesValues:["GET /repos/{owner}/{repo}/properties/values"],getDeployKey:["GET /repos/{owner}/{repo}/keys/{key_id}"],getDeployment:["GET /repos/{owner}/{repo}/deployments/{deployment_id}"],getDeploymentBranchPolicy:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],getDeploymentStatus:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses/{status_id}"],getEnvironment:["GET /repos/{owner}/{repo}/environments/{environment_name}"],getLatestPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/latest"],getLatestRelease:["GET /repos/{owner}/{repo}/releases/latest"],getOrgRuleSuite:["GET /orgs/{org}/rulesets/rule-suites/{rule_suite_id}"],getOrgRuleSuites:["GET /orgs/{org}/rulesets/rule-suites"],getOrgRuleset:["GET /orgs/{org}/rulesets/{ruleset_id}"],getOrgRulesets:["GET /orgs/{org}/rulesets"],getPages:["GET /repos/{owner}/{repo}/pages"],getPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/{build_id}"],getPagesDeployment:["GET /repos/{owner}/{repo}/pages/deployments/{pages_deployment_id}"],getPagesHealthCheck:["GET /repos/{owner}/{repo}/pages/health"],getParticipationStats:["GET /repos/{owner}/{repo}/stats/participation"],getPullRequestReviewProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],getPunchCardStats:["GET /repos/{owner}/{repo}/stats/punch_card"],getReadme:["GET /repos/{owner}/{repo}/readme"],getReadmeInDirectory:["GET /repos/{owner}/{repo}/readme/{dir}"],getRelease:["GET /repos/{owner}/{repo}/releases/{release_id}"],getReleaseAsset:["GET /repos/{owner}/{repo}/releases/assets/{asset_id}"],getReleaseByTag:["GET /repos/{owner}/{repo}/releases/tags/{tag}"],getRepoRuleSuite:["GET /repos/{owner}/{repo}/rulesets/rule-suites/{rule_suite_id}"],getRepoRuleSuites:["GET /repos/{owner}/{repo}/rulesets/rule-suites"],getRepoRuleset:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}"],getRepoRulesetHistory:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}/history"],getRepoRulesetVersion:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}/history/{version_id}"],getRepoRulesets:["GET /repos/{owner}/{repo}/rulesets"],getStatusChecksProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],getTeamsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams"],getTopPaths:["GET /repos/{owner}/{repo}/traffic/popular/paths"],getTopReferrers:["GET /repos/{owner}/{repo}/traffic/popular/referrers"],getUsersWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users"],getViews:["GET /repos/{owner}/{repo}/traffic/views"],getWebhook:["GET /repos/{owner}/{repo}/hooks/{hook_id}"],getWebhookConfigForRepo:["GET /repos/{owner}/{repo}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}"],listActivities:["GET /repos/{owner}/{repo}/activity"],listAttestations:["GET /repos/{owner}/{repo}/attestations/{subject_digest}"],listAutolinks:["GET /repos/{owner}/{repo}/autolinks"],listBranches:["GET /repos/{owner}/{repo}/branches"],listBranchesForHeadCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/branches-where-head"],listCollaborators:["GET /repos/{owner}/{repo}/collaborators"],listCommentsForCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/comments"],listCommitCommentsForRepo:["GET /repos/{owner}/{repo}/comments"],listCommitStatusesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/statuses"],listCommits:["GET /repos/{owner}/{repo}/commits"],listContributors:["GET /repos/{owner}/{repo}/contributors"],listCustomDeploymentRuleIntegrations:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/apps"],listDeployKeys:["GET /repos/{owner}/{repo}/keys"],listDeploymentBranchPolicies:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],listDeploymentStatuses:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],listDeployments:["GET /repos/{owner}/{repo}/deployments"],listForAuthenticatedUser:["GET /user/repos"],listForOrg:["GET /orgs/{org}/repos"],listForUser:["GET /users/{username}/repos"],listForks:["GET /repos/{owner}/{repo}/forks"],listInvitations:["GET /repos/{owner}/{repo}/invitations"],listInvitationsForAuthenticatedUser:["GET /user/repository_invitations"],listLanguages:["GET /repos/{owner}/{repo}/languages"],listPagesBuilds:["GET /repos/{owner}/{repo}/pages/builds"],listPublic:["GET /repositories"],listPullRequestsAssociatedWithCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/pulls"],listReleaseAssets:["GET /repos/{owner}/{repo}/releases/{release_id}/assets"],listReleases:["GET /repos/{owner}/{repo}/releases"],listTags:["GET /repos/{owner}/{repo}/tags"],listTeams:["GET /repos/{owner}/{repo}/teams"],listWebhookDeliveries:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /repos/{owner}/{repo}/hooks"],merge:["POST /repos/{owner}/{repo}/merges"],mergeUpstream:["POST /repos/{owner}/{repo}/merge-upstream"],pingWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeAppAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],removeCollaborator:["DELETE /repos/{owner}/{repo}/collaborators/{username}"],removeStatusCheckContexts:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],removeStatusCheckProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],removeTeamAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],removeUserAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],renameBranch:["POST /repos/{owner}/{repo}/branches/{branch}/rename"],replaceAllTopics:["PUT /repos/{owner}/{repo}/topics"],requestPagesBuild:["POST /repos/{owner}/{repo}/pages/builds"],setAdminBranchProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],setAppAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],setStatusCheckContexts:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],setTeamAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],setUserAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],testPushWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/tests"],transfer:["POST /repos/{owner}/{repo}/transfer"],update:["PATCH /repos/{owner}/{repo}"],updateBranchProtection:["PUT /repos/{owner}/{repo}/branches/{branch}/protection"],updateCommitComment:["PATCH /repos/{owner}/{repo}/comments/{comment_id}"],updateDeploymentBranchPolicy:["PUT /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],updateInformationAboutPagesSite:["PUT /repos/{owner}/{repo}/pages"],updateInvitation:["PATCH /repos/{owner}/{repo}/invitations/{invitation_id}"],updateOrgRuleset:["PUT /orgs/{org}/rulesets/{ruleset_id}"],updatePullRequestReviewProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],updateRelease:["PATCH /repos/{owner}/{repo}/releases/{release_id}"],updateReleaseAsset:["PATCH /repos/{owner}/{repo}/releases/assets/{asset_id}"],updateRepoRuleset:["PUT /repos/{owner}/{repo}/rulesets/{ruleset_id}"],updateStatusCheckPotection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks",{},{renamed:["repos","updateStatusCheckProtection"]}],updateStatusCheckProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],updateWebhook:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}"],updateWebhookConfigForRepo:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}/config"],uploadReleaseAsset:["POST /repos/{owner}/{repo}/releases/{release_id}/assets{?name,label}",{baseUrl:"https://uploads.github.com"}]},search:{code:["GET /search/code"],commits:["GET /search/commits"],issuesAndPullRequests:["GET /search/issues",{},{deprecated:"octokit.rest.search.issuesAndPullRequests() is deprecated, see https://docs.github.com/rest/search/search#search-issues-and-pull-requests"}],labels:["GET /search/labels"],repos:["GET /search/repositories"],topics:["GET /search/topics"],users:["GET /search/users"]},secretScanning:{createPushProtectionBypass:["POST /repos/{owner}/{repo}/secret-scanning/push-protection-bypasses"],getAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"],getScanHistory:["GET /repos/{owner}/{repo}/secret-scanning/scan-history"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/secret-scanning/alerts"],listAlertsForOrg:["GET /orgs/{org}/secret-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/secret-scanning/alerts"],listLocationsForAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}/locations"],updateAlert:["PATCH /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"]},securityAdvisories:{createFork:["POST /repos/{owner}/{repo}/security-advisories/{ghsa_id}/forks"],createPrivateVulnerabilityReport:["POST /repos/{owner}/{repo}/security-advisories/reports"],createRepositoryAdvisory:["POST /repos/{owner}/{repo}/security-advisories"],createRepositoryAdvisoryCveRequest:["POST /repos/{owner}/{repo}/security-advisories/{ghsa_id}/cve"],getGlobalAdvisory:["GET /advisories/{ghsa_id}"],getRepositoryAdvisory:["GET /repos/{owner}/{repo}/security-advisories/{ghsa_id}"],listGlobalAdvisories:["GET /advisories"],listOrgRepositoryAdvisories:["GET /orgs/{org}/security-advisories"],listRepositoryAdvisories:["GET /repos/{owner}/{repo}/security-advisories"],updateRepositoryAdvisory:["PATCH /repos/{owner}/{repo}/security-advisories/{ghsa_id}"]},teams:{addOrUpdateMembershipForUserInOrg:["PUT /orgs/{org}/teams/{team_slug}/memberships/{username}"],addOrUpdateRepoPermissionsInOrg:["PUT /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],checkPermissionsForRepoInOrg:["GET /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],create:["POST /orgs/{org}/teams"],createDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],createDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions"],deleteDiscussionCommentInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],deleteDiscussionInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],deleteInOrg:["DELETE /orgs/{org}/teams/{team_slug}"],getByName:["GET /orgs/{org}/teams/{team_slug}"],getDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],getDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],getMembershipForUserInOrg:["GET /orgs/{org}/teams/{team_slug}/memberships/{username}"],list:["GET /orgs/{org}/teams"],listChildInOrg:["GET /orgs/{org}/teams/{team_slug}/teams"],listDiscussionCommentsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],listDiscussionsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions"],listForAuthenticatedUser:["GET /user/teams"],listMembersInOrg:["GET /orgs/{org}/teams/{team_slug}/members"],listPendingInvitationsInOrg:["GET /orgs/{org}/teams/{team_slug}/invitations"],listReposInOrg:["GET /orgs/{org}/teams/{team_slug}/repos"],removeMembershipForUserInOrg:["DELETE /orgs/{org}/teams/{team_slug}/memberships/{username}"],removeRepoInOrg:["DELETE /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],updateDiscussionCommentInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],updateDiscussionInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],updateInOrg:["PATCH /orgs/{org}/teams/{team_slug}"]},users:{addEmailForAuthenticated:["POST /user/emails",{},{renamed:["users","addEmailForAuthenticatedUser"]}],addEmailForAuthenticatedUser:["POST /user/emails"],addSocialAccountForAuthenticatedUser:["POST /user/social_accounts"],block:["PUT /user/blocks/{username}"],checkBlocked:["GET /user/blocks/{username}"],checkFollowingForUser:["GET /users/{username}/following/{target_user}"],checkPersonIsFollowedByAuthenticated:["GET /user/following/{username}"],createGpgKeyForAuthenticated:["POST /user/gpg_keys",{},{renamed:["users","createGpgKeyForAuthenticatedUser"]}],createGpgKeyForAuthenticatedUser:["POST /user/gpg_keys"],createPublicSshKeyForAuthenticated:["POST /user/keys",{},{renamed:["users","createPublicSshKeyForAuthenticatedUser"]}],createPublicSshKeyForAuthenticatedUser:["POST /user/keys"],createSshSigningKeyForAuthenticatedUser:["POST /user/ssh_signing_keys"],deleteEmailForAuthenticated:["DELETE /user/emails",{},{renamed:["users","deleteEmailForAuthenticatedUser"]}],deleteEmailForAuthenticatedUser:["DELETE /user/emails"],deleteGpgKeyForAuthenticated:["DELETE /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","deleteGpgKeyForAuthenticatedUser"]}],deleteGpgKeyForAuthenticatedUser:["DELETE /user/gpg_keys/{gpg_key_id}"],deletePublicSshKeyForAuthenticated:["DELETE /user/keys/{key_id}",{},{renamed:["users","deletePublicSshKeyForAuthenticatedUser"]}],deletePublicSshKeyForAuthenticatedUser:["DELETE /user/keys/{key_id}"],deleteSocialAccountForAuthenticatedUser:["DELETE /user/social_accounts"],deleteSshSigningKeyForAuthenticatedUser:["DELETE /user/ssh_signing_keys/{ssh_signing_key_id}"],follow:["PUT /user/following/{username}"],getAuthenticated:["GET /user"],getById:["GET /user/{account_id}"],getByUsername:["GET /users/{username}"],getContextForUser:["GET /users/{username}/hovercard"],getGpgKeyForAuthenticated:["GET /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","getGpgKeyForAuthenticatedUser"]}],getGpgKeyForAuthenticatedUser:["GET /user/gpg_keys/{gpg_key_id}"],getPublicSshKeyForAuthenticated:["GET /user/keys/{key_id}",{},{renamed:["users","getPublicSshKeyForAuthenticatedUser"]}],getPublicSshKeyForAuthenticatedUser:["GET /user/keys/{key_id}"],getSshSigningKeyForAuthenticatedUser:["GET /user/ssh_signing_keys/{ssh_signing_key_id}"],list:["GET /users"],listAttestations:["GET /users/{username}/attestations/{subject_digest}"],listBlockedByAuthenticated:["GET /user/blocks",{},{renamed:["users","listBlockedByAuthenticatedUser"]}],listBlockedByAuthenticatedUser:["GET /user/blocks"],listEmailsForAuthenticated:["GET /user/emails",{},{renamed:["users","listEmailsForAuthenticatedUser"]}],listEmailsForAuthenticatedUser:["GET /user/emails"],listFollowedByAuthenticated:["GET /user/following",{},{renamed:["users","listFollowedByAuthenticatedUser"]}],listFollowedByAuthenticatedUser:["GET /user/following"],listFollowersForAuthenticatedUser:["GET /user/followers"],listFollowersForUser:["GET /users/{username}/followers"],listFollowingForUser:["GET /users/{username}/following"],listGpgKeysForAuthenticated:["GET /user/gpg_keys",{},{renamed:["users","listGpgKeysForAuthenticatedUser"]}],listGpgKeysForAuthenticatedUser:["GET /user/gpg_keys"],listGpgKeysForUser:["GET /users/{username}/gpg_keys"],listPublicEmailsForAuthenticated:["GET /user/public_emails",{},{renamed:["users","listPublicEmailsForAuthenticatedUser"]}],listPublicEmailsForAuthenticatedUser:["GET /user/public_emails"],listPublicKeysForUser:["GET /users/{username}/keys"],listPublicSshKeysForAuthenticated:["GET /user/keys",{},{renamed:["users","listPublicSshKeysForAuthenticatedUser"]}],listPublicSshKeysForAuthenticatedUser:["GET /user/keys"],listSocialAccountsForAuthenticatedUser:["GET /user/social_accounts"],listSocialAccountsForUser:["GET /users/{username}/social_accounts"],listSshSigningKeysForAuthenticatedUser:["GET /user/ssh_signing_keys"],listSshSigningKeysForUser:["GET /users/{username}/ssh_signing_keys"],setPrimaryEmailVisibilityForAuthenticated:["PATCH /user/email/visibility",{},{renamed:["users","setPrimaryEmailVisibilityForAuthenticatedUser"]}],setPrimaryEmailVisibilityForAuthenticatedUser:["PATCH /user/email/visibility"],unblock:["DELETE /user/blocks/{username}"],unfollow:["DELETE /user/following/{username}"],updateAuthenticated:["PATCH /user"]}}},"./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/index.js":(e,t,r)=>{"use strict";r.d(t,{restEndpointMethods:()=>n});var s=r("./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/version.js"),o=r("./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/endpoints-to-methods.js");function n(e){return{rest:(0,o.endpointsToMethods)(e)}}n.VERSION=s.VERSION,s.VERSION},"./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/version.js":(e,t,r)=>{"use strict";r.d(t,{VERSION:()=>s});const s="14.0.0"},"./node_modules/@octokit/plugin-retry/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{retry:()=>c});var s=r("./node_modules/bottleneck/light.js"),o=r("./node_modules/@octokit/request-error/dist-src/index.js");async function n(e,t,r,s){if(!r.request||!r.request.request)throw r;if(r.status>=400&&!e.doNotRetry.includes(r.status)){const o=null!=s.request.retries?s.request.retries:e.retries,n=Math.pow((s.request.retryCount||0)+1,2);throw t.retry.retryRequest(r,o,n)}throw r}async function i(e,t,r,o){const n=new s;return n.on("failed",function(t,r){const s=~~t.request.request.retries,n=~~t.request.request.retryAfter;if(o.request.retryCount=r.retryCount+1,s>r.retryCount)return n*e.retryAfterBaseValue}),n.schedule(a.bind(null,e,t,r),o)}async function a(e,t,r,s){const i=await r(r,s);if(i.data&&i.data.errors&&i.data.errors.length>0&&/Something went wrong while executing your query/.test(i.data.errors[0].message)){return n(e,t,new o.RequestError(i.data.errors[0].message,500,{request:s,response:i}),s)}return i}function c(e,t){const r=Object.assign({enabled:!0,retryAfterBaseValue:1e3,doNotRetry:[400,401,403,404,410,422,451],retries:3},t.retry);return r.enabled&&(e.hook.error("request",n.bind(null,r,e)),e.hook.wrap("request",i.bind(null,r,e))),{retry:{retryRequest:(e,t,r)=>(e.request.request=Object.assign({},e.request.request,{retries:t,retryAfter:r}),e)}}}c.VERSION="0.0.0-development"},"./node_modules/@octokit/plugin-throttling/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{throttling:()=>d});var s=r("./node_modules/bottleneck/light.js"),o=()=>Promise.resolve();function n(e,t,r){return e.retryLimiter.schedule(i,e,t,r)}async function i(e,t,r){const{pathname:s}=new URL(r.url,"http://github.test"),n=function(e,t){return"PATCH"===e&&/^\/applications\/[^/]+\/token\/scoped$/.test(t)||"POST"===e&&(/^\/applications\/[^/]+\/token$/.test(t)||/^\/app\/installations\/[^/]+\/access_tokens$/.test(t)||"/login/oauth/access_token"===t)}(r.method,s),i=!n&&"GET"!==r.method&&"HEAD"!==r.method,a="GET"===r.method&&s.startsWith("/search/"),c=s.startsWith("/graphql"),l=~~t.retryCount>0?{priority:0,weight:0}:{};e.clustering&&(l.expiration=6e4),(i||c)&&await e.write.key(e.id).schedule(l,o),i&&e.triggersNotification(s)&&await e.notifications.key(e.id).schedule(l,o),a&&await e.search.key(e.id).schedule(l,o);const u=(n?e.auth:e.global).key(e.id).schedule(l,t,r);if(c){const e=await u;if(null!=e.data.errors&&e.data.errors.some(e=>"RATE_LIMITED"===e.type)){throw Object.assign(new Error("GraphQL Rate Limit Exceeded"),{response:e,data:e.data})}}return u}var a=function(e){const t=`^(?:${e.map(e=>e.split("/").map(e=>e.startsWith("{")?"(?:.+?)":e).join("/")).map(e=>`(?:${e})`).join("|")})[^/]*$`;return new RegExp(t,"i")}(["/orgs/{org}/invitations","/orgs/{org}/invitations/{invitation_id}","/orgs/{org}/teams/{team_slug}/discussions","/orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments","/repos/{owner}/{repo}/collaborators/{username}","/repos/{owner}/{repo}/commits/{commit_sha}/comments","/repos/{owner}/{repo}/issues","/repos/{owner}/{repo}/issues/{issue_number}/comments","/repos/{owner}/{repo}/issues/{issue_number}/sub_issue","/repos/{owner}/{repo}/issues/{issue_number}/sub_issues/priority","/repos/{owner}/{repo}/pulls","/repos/{owner}/{repo}/pulls/{pull_number}/comments","/repos/{owner}/{repo}/pulls/{pull_number}/comments/{comment_id}/replies","/repos/{owner}/{repo}/pulls/{pull_number}/merge","/repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers","/repos/{owner}/{repo}/pulls/{pull_number}/reviews","/repos/{owner}/{repo}/releases","/teams/{team_id}/discussions","/teams/{team_id}/discussions/{discussion_number}/comments"]),c=a.test.bind(a),l={},u=function(e,t){l.global=new e.Group({id:"octokit-global",maxConcurrent:10,...t}),l.auth=new e.Group({id:"octokit-auth",maxConcurrent:1,...t}),l.search=new e.Group({id:"octokit-search",maxConcurrent:1,minTime:2e3,...t}),l.write=new e.Group({id:"octokit-write",maxConcurrent:1,minTime:1e3,...t}),l.notifications=new e.Group({id:"octokit-notifications",maxConcurrent:1,minTime:3e3,...t})};function d(e,t){const{enabled:r=!0,Bottleneck:o=s,id:i="no-id",timeout:a=12e4,connection:d}=t.throttle||{};if(!r)return{};const p={timeout:a};void 0!==d&&(p.connection=d),null==l.global&&u(o,p);const h=Object.assign({clustering:null!=d,triggersNotification:c,fallbackSecondaryRateRetryAfter:60,retryAfterBaseValue:1e3,retryLimiter:new o,id:i,...l},t.throttle);if("function"!=typeof h.onSecondaryRateLimit||"function"!=typeof h.onRateLimit)throw new Error("octokit/plugin-throttling error:\n        You must pass the onSecondaryRateLimit and onRateLimit error handlers.\n        See https://octokit.github.io/rest.js/#throttling\n\n        const octokit = new Octokit({\n          throttle: {\n            onSecondaryRateLimit: (retryAfter, options) => {/* ... */},\n            onRateLimit: (retryAfter, options) => {/* ... */}\n          }\n        })\n    ");const m={},g=new o.Events(m);return m.on("secondary-limit",h.onSecondaryRateLimit),m.on("rate-limit",h.onRateLimit),m.on("error",t=>e.log.warn("Error in throttling-plugin limit handler",t)),h.retryLimiter.on("failed",async function(t,r){const[s,o,n]=r.args,{pathname:i}=new URL(n.url,"http://github.test");if(!(i.startsWith("/graphql")&&401!==t.status)&&403!==t.status&&429!==t.status)return;const a=~~o.retryCount;o.retryCount=a,n.request.retryCount=a;const{wantRetry:c,retryAfter:l=0}=await async function(){if(/\bsecondary rate\b/i.test(t.message)){const r=Number(t.response.headers["retry-after"])||s.fallbackSecondaryRateRetryAfter;return{wantRetry:await g.trigger("secondary-limit",r,n,e,a),retryAfter:r}}if(null!=t.response.headers&&"0"===t.response.headers["x-ratelimit-remaining"]||(t.response.data?.errors??[]).some(e=>"RATE_LIMITED"===e.type)){const r=new Date(1e3*~~t.response.headers["x-ratelimit-reset"]).getTime(),s=Math.max(Math.ceil((r-Date.now())/1e3)+1,0);return{wantRetry:await g.trigger("rate-limit",s,n,e,a),retryAfter:s}}return{}}();return c?(o.retryCount++,l*s.retryAfterBaseValue):void 0}),e.hook.wrap("request",n.bind(null,h)),{}}d.VERSION="0.0.0-development",d.triggersNotification=c},"./node_modules/@octokit/request-error/dist-src/index.js":(e,t,r)=>{"use strict";r.d(t,{RequestError:()=>s});class s extends Error{name;status;request;response;constructor(e,t,r){super(e),this.name="HttpError",this.status=Number.parseInt(t),Number.isNaN(this.status)&&(this.status=0),"response"in r&&(this.response=r.response);const s=Object.assign({},r.request);r.request.headers.authorization&&(s.headers=Object.assign({},r.request.headers,{authorization:r.request.headers.authorization.replace(/(?<! ) .*$/," [REDACTED]")})),s.url=s.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=s}}},"./node_modules/@octokit/request/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{request:()=>u});var s=r("./node_modules/@octokit/endpoint/dist-bundle/index.js"),o=r("./node_modules/universal-user-agent/index.js"),n=r("./node_modules/fast-content-type-parse/index.js"),i=r("./node_modules/@octokit/request-error/dist-src/index.js"),a={headers:{"user-agent":`octokit-request.js/9.2.4 ${(0,o.getUserAgent)()}`}};async function c(e){const t=e.request?.fetch||globalThis.fetch;if(!t)throw new Error("fetch is not set. Please pass a fetch implementation as new Octokit({ request: { fetch }}). Learn more at https://github.com/octokit/octokit.js/#fetch-missing");const r=e.request?.log||console,s=!1!==e.request?.parseSuccessResponseBody,o=function(e){if("object"!=typeof e||null===e)return!1;if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);if(null===t)return!0;const r=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(e)}(e.body)||Array.isArray(e.body)?JSON.stringify(e.body):e.body,n=Object.fromEntries(Object.entries(e.headers).map(([e,t])=>[e,String(t)]));let a;try{a=await t(e.url,{method:e.method,body:o,redirect:e.request?.redirect,headers:n,signal:e.request?.signal,...e.body&&{duplex:"half"}})}catch(t){let r="Unknown Error";if(t instanceof Error){if("AbortError"===t.name)throw t.status=500,t;r=t.message,"TypeError"===t.name&&"cause"in t&&(t.cause instanceof Error?r=t.cause.message:"string"==typeof t.cause&&(r=t.cause))}const s=new i.RequestError(r,500,{request:e});throw s.cause=t,s}const c=a.status,u=a.url,d={};for(const[e,t]of a.headers)d[e]=t;const p={url:u,status:c,headers:d,data:""};if("deprecation"in d){const t=d.link&&d.link.match(/<([^<>]+)>; rel="deprecation"/),s=t&&t.pop();r.warn(`[@octokit/request] "${e.method} ${e.url}" is deprecated. It is scheduled to be removed on ${d.sunset}${s?`. See ${s}`:""}`)}if(204===c||205===c)return p;if("HEAD"===e.method){if(c<400)return p;throw new i.RequestError(a.statusText,c,{response:p,request:e})}if(304===c)throw p.data=await l(a),new i.RequestError("Not modified",c,{response:p,request:e});if(c>=400)throw p.data=await l(a),new i.RequestError(function(e){if("string"==typeof e)return e;if(e instanceof ArrayBuffer)return"Unknown error";if("message"in e){const t="documentation_url"in e?` - ${e.documentation_url}`:"";return Array.isArray(e.errors)?`${e.message}: ${e.errors.map(e=>JSON.stringify(e)).join(", ")}${t}`:`${e.message}${t}`}return`Unknown error: ${JSON.stringify(e)}`}(p.data),c,{response:p,request:e});return p.data=s?await l(a):a.body,p}async function l(e){const t=e.headers.get("content-type");if(!t)return e.text().catch(()=>"");const r=(0,n.safeParse)(t);if(!function(e){return"application/json"===e.type||"application/scim+json"===e.type}(r))return r.type.startsWith("text/")||"utf-8"===r.parameters.charset?.toLowerCase()?e.text().catch(()=>""):e.arrayBuffer().catch(()=>new ArrayBuffer(0));{let t="";try{return t=await e.text(),JSON.parse(t)}catch(e){return t}}}var u=function e(t,r){const s=t.defaults(r);return Object.assign(function(t,r){const o=s.merge(t,r);if(!o.request||!o.request.hook)return c(s.parse(o));const n=(e,t)=>c(s.parse(s.merge(e,t)));return Object.assign(n,{endpoint:s,defaults:e.bind(null,s)}),o.request.hook(n,o)},{endpoint:s,defaults:e.bind(null,s)})}(s.endpoint,a)},"./node_modules/@octokit/webhooks-methods/dist-node/index.js":(e,t,r)=>{"use strict";r.d(t,{sign:()=>i,verify:()=>a,verifyWithFallback:()=>c});var s=r("node:crypto"),o=r("node:buffer"),n="5.1.1";async function i(e,t){if(!e||!t)throw new TypeError("[@octokit/webhooks-methods] secret & payload required for sign()");if("string"!=typeof t)throw new TypeError("[@octokit/webhooks-methods] payload must be a string");const r="sha256";return`${r}=${(0,s.createHmac)(r,e).update(t).digest("hex")}`}async function a(e,t,r){if(!e||!t||!r)throw new TypeError("[@octokit/webhooks-methods] secret, eventPayload & signature required");if("string"!=typeof t)throw new TypeError("[@octokit/webhooks-methods] eventPayload must be a string");const n=o.Buffer.from(r),a=o.Buffer.from(await i(e,t));return n.length===a.length&&(0,s.timingSafeEqual)(n,a)}async function c(e,t,r,s){if(await a(e,t,r))return!0;if(void 0!==s)for(const e of s){const s=await a(e,t,r);if(s)return s}return!1}i.VERSION=n,a.VERSION=n},"./node_modules/@octokit/webhooks/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{Webhooks:()=>T,createNodeMiddleware:()=>_});var s=r("./node_modules/@octokit/webhooks-methods/dist-node/index.js"),o=(e={})=>("function"!=typeof e.debug&&(e.debug=()=>{}),"function"!=typeof e.info&&(e.info=()=>{}),"function"!=typeof e.warn&&(e.warn=console.warn.bind(console)),"function"!=typeof e.error&&(e.error=console.error.bind(console)),e),n=["branch_protection_configuration","branch_protection_configuration.disabled","branch_protection_configuration.enabled","branch_protection_rule","branch_protection_rule.created","branch_protection_rule.deleted","branch_protection_rule.edited","check_run","check_run.completed","check_run.created","check_run.requested_action","check_run.rerequested","check_suite","check_suite.completed","check_suite.requested","check_suite.rerequested","code_scanning_alert","code_scanning_alert.appeared_in_branch","code_scanning_alert.closed_by_user","code_scanning_alert.created","code_scanning_alert.fixed","code_scanning_alert.reopened","code_scanning_alert.reopened_by_user","commit_comment","commit_comment.created","create","custom_property","custom_property.created","custom_property.deleted","custom_property.promote_to_enterprise","custom_property.updated","custom_property_values","custom_property_values.updated","delete","dependabot_alert","dependabot_alert.auto_dismissed","dependabot_alert.auto_reopened","dependabot_alert.created","dependabot_alert.dismissed","dependabot_alert.fixed","dependabot_alert.reintroduced","dependabot_alert.reopened","deploy_key","deploy_key.created","deploy_key.deleted","deployment","deployment.created","deployment_protection_rule","deployment_protection_rule.requested","deployment_review","deployment_review.approved","deployment_review.rejected","deployment_review.requested","deployment_status","deployment_status.created","discussion","discussion.answered","discussion.category_changed","discussion.closed","discussion.created","discussion.deleted","discussion.edited","discussion.labeled","discussion.locked","discussion.pinned","discussion.reopened","discussion.transferred","discussion.unanswered","discussion.unlabeled","discussion.unlocked","discussion.unpinned","discussion_comment","discussion_comment.created","discussion_comment.deleted","discussion_comment.edited","fork","github_app_authorization","github_app_authorization.revoked","gollum","installation","installation.created","installation.deleted","installation.new_permissions_accepted","installation.suspend","installation.unsuspend","installation_repositories","installation_repositories.added","installation_repositories.removed","installation_target","installation_target.renamed","issue_comment","issue_comment.created","issue_comment.deleted","issue_comment.edited","issues","issues.assigned","issues.closed","issues.deleted","issues.demilestoned","issues.edited","issues.labeled","issues.locked","issues.milestoned","issues.opened","issues.pinned","issues.reopened","issues.transferred","issues.typed","issues.unassigned","issues.unlabeled","issues.unlocked","issues.unpinned","issues.untyped","label","label.created","label.deleted","label.edited","marketplace_purchase","marketplace_purchase.cancelled","marketplace_purchase.changed","marketplace_purchase.pending_change","marketplace_purchase.pending_change_cancelled","marketplace_purchase.purchased","member","member.added","member.edited","member.removed","membership","membership.added","membership.removed","merge_group","merge_group.checks_requested","merge_group.destroyed","meta","meta.deleted","milestone","milestone.closed","milestone.created","milestone.deleted","milestone.edited","milestone.opened","org_block","org_block.blocked","org_block.unblocked","organization","organization.deleted","organization.member_added","organization.member_invited","organization.member_removed","organization.renamed","package","package.published","package.updated","page_build","personal_access_token_request","personal_access_token_request.approved","personal_access_token_request.cancelled","personal_access_token_request.created","personal_access_token_request.denied","ping","project","project.closed","project.created","project.deleted","project.edited","project.reopened","project_card","project_card.converted","project_card.created","project_card.deleted","project_card.edited","project_card.moved","project_column","project_column.created","project_column.deleted","project_column.edited","project_column.moved","projects_v2","projects_v2.closed","projects_v2.created","projects_v2.deleted","projects_v2.edited","projects_v2.reopened","projects_v2_item","projects_v2_item.archived","projects_v2_item.converted","projects_v2_item.created","projects_v2_item.deleted","projects_v2_item.edited","projects_v2_item.reordered","projects_v2_item.restored","projects_v2_status_update","projects_v2_status_update.created","projects_v2_status_update.deleted","projects_v2_status_update.edited","public","pull_request","pull_request.assigned","pull_request.auto_merge_disabled","pull_request.auto_merge_enabled","pull_request.closed","pull_request.converted_to_draft","pull_request.demilestoned","pull_request.dequeued","pull_request.edited","pull_request.enqueued","pull_request.labeled","pull_request.locked","pull_request.milestoned","pull_request.opened","pull_request.ready_for_review","pull_request.reopened","pull_request.review_request_removed","pull_request.review_requested","pull_request.synchronize","pull_request.unassigned","pull_request.unlabeled","pull_request.unlocked","pull_request_review","pull_request_review.dismissed","pull_request_review.edited","pull_request_review.submitted","pull_request_review_comment","pull_request_review_comment.created","pull_request_review_comment.deleted","pull_request_review_comment.edited","pull_request_review_thread","pull_request_review_thread.resolved","pull_request_review_thread.unresolved","push","registry_package","registry_package.published","registry_package.updated","release","release.created","release.deleted","release.edited","release.prereleased","release.published","release.released","release.unpublished","repository","repository.archived","repository.created","repository.deleted","repository.edited","repository.privatized","repository.publicized","repository.renamed","repository.transferred","repository.unarchived","repository_advisory","repository_advisory.published","repository_advisory.reported","repository_dispatch","repository_dispatch.sample.collected","repository_import","repository_ruleset","repository_ruleset.created","repository_ruleset.deleted","repository_ruleset.edited","repository_vulnerability_alert","repository_vulnerability_alert.create","repository_vulnerability_alert.dismiss","repository_vulnerability_alert.reopen","repository_vulnerability_alert.resolve","secret_scanning_alert","secret_scanning_alert.created","secret_scanning_alert.publicly_leaked","secret_scanning_alert.reopened","secret_scanning_alert.resolved","secret_scanning_alert.validated","secret_scanning_alert_location","secret_scanning_alert_location.created","secret_scanning_scan","secret_scanning_scan.completed","security_advisory","security_advisory.published","security_advisory.updated","security_advisory.withdrawn","security_and_analysis","sponsorship","sponsorship.cancelled","sponsorship.created","sponsorship.edited","sponsorship.pending_cancellation","sponsorship.pending_tier_change","sponsorship.tier_changed","star","star.created","star.deleted","status","sub_issues","sub_issues.parent_issue_added","sub_issues.parent_issue_removed","sub_issues.sub_issue_added","sub_issues.sub_issue_removed","team","team.added_to_repository","team.created","team.deleted","team.edited","team.removed_from_repository","team_add","watch","watch.started","workflow_dispatch","workflow_job","workflow_job.completed","workflow_job.in_progress","workflow_job.queued","workflow_job.waiting","workflow_run","workflow_run.completed","workflow_run.in_progress","workflow_run.requested"];function i(e,t,r){e.hooks[t]||(e.hooks[t]=[]),e.hooks[t].push(r)}function a(e,t,r){if(Array.isArray(t))t.forEach(t=>a(e,t,r));else{if(["*","error"].includes(t)){const e="*"===t?"any":t,r=`Using the "${t}" event with the regular Webhooks.on() function is not supported. Please use the Webhooks.on${e.charAt(0).toUpperCase()+e.slice(1)}() method instead`;throw new Error(r)}n.includes(t)||e.log.warn(`"${t}" is not a known webhook name (https://developer.github.com/v3/activity/events/types/)`),i(e,t,r)}}function c(e,t){i(e,"*",t)}function l(e,t){i(e,"error",t)}function u(e,t){let r;try{r=e(t)}catch(e){console.log('FATAL: Error occurred in "error" event handler'),console.log(e)}r&&r.catch&&r.catch(e=>{console.log('FATAL: Error occurred in "error" event handler'),console.log(e)})}function d(e,t){const r=e.hooks.error||[];if(t instanceof Error){const e=Object.assign(new AggregateError([t],t.message),{event:t});return r.forEach(t=>u(t,e)),Promise.reject(e)}if(!t||!t.name){const e=new Error("Event name not passed");throw new AggregateError([e],e.message)}if(!t.payload){const e=new Error("Event name not passed");throw new AggregateError([e],e.message)}const s=function(e,t,r){const s=[e.hooks[r],e.hooks["*"]];return t&&s.unshift(e.hooks[`${r}.${t}`]),[].concat(...s.filter(Boolean))}(e,"action"in t.payload?t.payload.action:null,t.name);if(0===s.length)return Promise.resolve();const o=[],n=s.map(r=>{let s=Promise.resolve(t);return e.transform&&(s=s.then(e.transform)),s.then(e=>r(e)).catch(e=>o.push(Object.assign(e,{event:t})))});return Promise.all(n).then(()=>{if(0===o.length)return;const e=new AggregateError(o,o.map(e=>e.message).join("\n"));throw Object.assign(e,{event:t}),r.forEach(t=>u(t,e)),e})}function p(e,t,r){if(Array.isArray(t))t.forEach(t=>p(e,t,r));else if(e.hooks[t])for(let s=e.hooks[t].length-1;s>=0;s--)if(e.hooks[t][s]===r)return void e.hooks[t].splice(s,1)}function h(e){const t={hooks:{},log:o(e&&e.log)};return e&&e.transform&&(t.transform=e.transform),{on:a.bind(null,t),onAny:c.bind(null,t),onError:l.bind(null,t),removeListener:p.bind(null,t),receive:d.bind(null,t)}}async function m(e,t){if(!await(0,s.verifyWithFallback)(e.secret,t.payload,t.signature,e.additionalSecrets).catch(()=>!1)){const r=new Error("[@octokit/webhooks] signature does not match event payload and secret");return e.eventHandler.receive(Object.assign(r,{event:t,status:400}))}let r;try{r=JSON.parse(t.payload)}catch(e){throw e.message="Invalid JSON",e.status=400,new AggregateError([e],e.message)}return e.eventHandler.receive({id:t.id,name:t.name,payload:r})}var g=/^\s*(application\/json)\s*(?:;|$)/u,f=["x-github-event","x-hub-signature-256","x-github-delivery"];function y(e){const{handleResponse:t,getRequestHeader:r,getPayload:s}=e;return function(e,o){return async function(n,i,a){let c;try{c=new URL(n.url,"http://localhost").pathname}catch(e){return t(JSON.stringify({error:`Request URL could not be parsed: ${n.url}`}),422,{"content-type":"application/json"},i)}if(c!==o.path)return a?.(),t(null);if("POST"!==n.method)return t(JSON.stringify({error:`Unknown route: ${n.method} ${c}`}),404,{"content-type":"application/json"},i);const l=r(n,"content-type");if("string"!=typeof l||!g.test(l))return t(JSON.stringify({error:'Unsupported "Content-Type" header value. Must be "application/json"'}),415,{"content-type":"application/json",accept:"application/json"},i);const u=f.filter(e=>null==r(n,e)).join(", ");if(u)return t(JSON.stringify({error:`Required headers missing: ${u}`}),400,{"content-type":"application/json",accept:"application/json"},i);const d=r(n,"x-github-event"),p=r(n,"x-hub-signature-256"),h=r(n,"x-github-delivery");o.log.debug(`${d} event received (id: ${h})`);let m,y=!1;const v=new Promise(e=>{m=setTimeout(()=>{y=!0,e(t("still processing\n",202,{"Content-Type":"text/plain",accept:"application/json"},i))},o.timeout)});return await Promise.race([v,(async()=>{try{const r=await s(n);return await e.verifyAndReceive({id:h,name:d,payload:r,signature:p}),clearTimeout(m),y?t(null):t("ok\n",200,{"content-type":"text/plain",accept:"application/json"},i)}catch(e){if(clearTimeout(m),y)return t(null);const r=Array.from(e.errors)[0],s=r.message?`${r.name}: ${r.message}`:"Error: An Unspecified error occurred",n=void 0!==r.status?r.status:500;return o.log.error(e),t(JSON.stringify({error:s}),n,{"content-type":"application/json",accept:"application/json"},i)}})()])}}}function v(e,t=200,r={},s){return null!==e&&(r["content-length"]=e.length.toString(),s.writeHead(t,r).end(e),!0)}function w(e,t){return e.headers[t]}var E=new TextDecoder("utf-8",{fatal:!1}),S=E.decode.bind(E);async function b(e){if("object"==typeof e.body&&"rawBody"in e&&e.rawBody instanceof Uint8Array)return S(e.rawBody);if("string"==typeof e.body)return e.body;const t=await function(e){return new Promise((t,r)=>{let s=[];e.on("error",e=>r(new AggregateError([e],e.message))),e.on("data",s.push.bind(s)),e.on("end",()=>{const e=function(e){if(0===e.length)return new Uint8Array(0);let t=0;for(let r=0;r<e.length;r++)t+=e[r].length;if(0===t)return new Uint8Array(0);const r=new Uint8Array(t);let s=0;for(let t=0;t<e.length;t++)r.set(e[t],s),s+=e[t].length;return r}(s);queueMicrotask(()=>t(e))})})}(e);return S(t)}function _(e,{path:t="/api/github/webhooks",log:r=o(),timeout:s=9e3}={}){return y({handleResponse:v,getRequestHeader:w,getPayload:b})(e,{path:t,log:r,timeout:s})}var T=class{sign;verify;on;onAny;onError;removeListener;receive;verifyAndReceive;constructor(e){if(!e||!e.secret)throw new Error("[@octokit/webhooks] options.secret required");const t={eventHandler:h(e),secret:e.secret,additionalSecrets:e.additionalSecrets,hooks:{},log:o(e.log)};this.sign=s.sign.bind(null,e.secret),this.verify=s.verify.bind(null,e.secret),this.on=t.eventHandler.on,this.onAny=t.eventHandler.onAny,this.onError=t.eventHandler.onError,this.removeListener=t.eventHandler.removeListener,this.receive=t.eventHandler.receive,this.verifyAndReceive=m.bind(null,t)}}},"./node_modules/before-after-hook/index.js":(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var s=r("./node_modules/before-after-hook/lib/register.js"),o=r("./node_modules/before-after-hook/lib/add.js"),n=r("./node_modules/before-after-hook/lib/remove.js");const i=Function.bind,a=i.bind(i);function c(e,t,r){const s=a(n.removeHook,null).apply(null,r?[t,r]:[t]);e.api={remove:s},e.remove=s,["before","error","after","wrap"].forEach(s=>{const n=r?[t,s,r]:[t,s];e[s]=e.api[s]=a(o.addHook,null).apply(null,n)})}const l={Singular:function(){const e=Symbol("Singular"),t={registry:{}},r=s.register.bind(null,t,e);return c(r,t,e),r},Collection:function(){const e={registry:{}},t=s.register.bind(null,e);return c(t,e),t}}},"./node_modules/before-after-hook/lib/add.js":(e,t,r)=>{"use strict";function s(e,t,r,s){const o=s;e.registry[r]||(e.registry[r]=[]),"before"===t&&(s=(e,t)=>Promise.resolve().then(o.bind(null,t)).then(e.bind(null,t))),"after"===t&&(s=(e,t)=>{let r;return Promise.resolve().then(e.bind(null,t)).then(e=>(r=e,o(r,t))).then(()=>r)}),"error"===t&&(s=(e,t)=>Promise.resolve().then(e.bind(null,t)).catch(e=>o(e,t))),e.registry[r].push({hook:s,orig:o})}r.d(t,{addHook:()=>s})},"./node_modules/before-after-hook/lib/register.js":(e,t,r)=>{"use strict";function s(e,t,r,o){if("function"!=typeof r)throw new Error("method for before hook must be a function");return o||(o={}),Array.isArray(t)?t.reverse().reduce((t,r)=>s.bind(null,e,r,t,o),r)():Promise.resolve().then(()=>e.registry[t]?e.registry[t].reduce((e,t)=>t.hook.bind(null,e,o),r)():r(o))}r.d(t,{register:()=>s})},"./node_modules/before-after-hook/lib/remove.js":(e,t,r)=>{"use strict";function s(e,t,r){if(!e.registry[t])return;const s=e.registry[t].map(e=>e.orig).indexOf(r);-1!==s&&e.registry[t].splice(s,1)}r.d(t,{removeHook:()=>s})},"./node_modules/better-sqlite3/lib/database.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";const fs=__webpack_require__("fs"),path=__webpack_require__("path"),util=__webpack_require__("./node_modules/better-sqlite3/lib/util.js"),SqliteError=__webpack_require__("./node_modules/better-sqlite3/lib/sqlite-error.js");let DEFAULT_ADDON;function Database(filenameGiven,options){if(null==new.target)return new Database(filenameGiven,options);let buffer;if(Buffer.isBuffer(filenameGiven)&&(buffer=filenameGiven,filenameGiven=":memory:"),null==filenameGiven&&(filenameGiven=""),null==options&&(options={}),"string"!=typeof filenameGiven)throw new TypeError("Expected first argument to be a string");if("object"!=typeof options)throw new TypeError("Expected second argument to be an options object");if("readOnly"in options)throw new TypeError('Misspelled option "readOnly" should be "readonly"');if("memory"in options)throw new TypeError('Option "memory" was removed in v7.0.0 (use ":memory:" filename instead)');const filename=filenameGiven.trim(),anonymous=""===filename||":memory:"===filename,readonly=util.getBooleanOption(options,"readonly"),fileMustExist=util.getBooleanOption(options,"fileMustExist"),timeout="timeout"in options?options.timeout:5e3,verbose="verbose"in options?options.verbose:null,nativeBinding="nativeBinding"in options?options.nativeBinding:null;if(readonly&&anonymous&&!buffer)throw new TypeError("In-memory/temporary databases cannot be readonly");if(!Number.isInteger(timeout)||timeout<0)throw new TypeError('Expected the "timeout" option to be a positive integer');if(timeout>2147483647)throw new RangeError('Option "timeout" cannot be greater than 2147483647');if(null!=verbose&&"function"!=typeof verbose)throw new TypeError('Expected the "verbose" option to be a function');if(null!=nativeBinding&&"string"!=typeof nativeBinding&&"object"!=typeof nativeBinding)throw new TypeError('Expected the "nativeBinding" option to be a string or addon object');let addon;if(null==nativeBinding)addon=DEFAULT_ADDON||(DEFAULT_ADDON=require(__webpack_require__.ab+"build/Release/better_sqlite3.node"));else if("string"==typeof nativeBinding){const requireFunc="function"==typeof require?eval("require"):require;addon=requireFunc(path.resolve(nativeBinding).replace(/(\.node)?$/,".node"))}else addon=nativeBinding;if(addon.isInitialized||(addon.setErrorConstructor(SqliteError),addon.isInitialized=!0),!anonymous&&!filename.startsWith("file:")&&!fs.existsSync(path.dirname(filename)))throw new TypeError("Cannot open database because the directory does not exist");Object.defineProperties(this,{[util.cppdb]:{value:new addon.Database(filename,filenameGiven,anonymous,readonly,fileMustExist,timeout,verbose||null,buffer||null)},...wrappers.getters})}const wrappers=__webpack_require__("./node_modules/better-sqlite3/lib/methods/wrappers.js");Database.prototype.prepare=wrappers.prepare,Database.prototype.transaction=__webpack_require__("./node_modules/better-sqlite3/lib/methods/transaction.js"),Database.prototype.pragma=__webpack_require__("./node_modules/better-sqlite3/lib/methods/pragma.js"),Database.prototype.backup=__webpack_require__("./node_modules/better-sqlite3/lib/methods/backup.js"),Database.prototype.serialize=__webpack_require__("./node_modules/better-sqlite3/lib/methods/serialize.js"),Database.prototype.function=__webpack_require__("./node_modules/better-sqlite3/lib/methods/function.js"),Database.prototype.aggregate=__webpack_require__("./node_modules/better-sqlite3/lib/methods/aggregate.js"),Database.prototype.table=__webpack_require__("./node_modules/better-sqlite3/lib/methods/table.js"),Database.prototype.loadExtension=wrappers.loadExtension,Database.prototype.exec=wrappers.exec,Database.prototype.close=wrappers.close,Database.prototype.defaultSafeIntegers=wrappers.defaultSafeIntegers,Database.prototype.unsafeMode=wrappers.unsafeMode,Database.prototype[util.inspect]=__webpack_require__("./node_modules/better-sqlite3/lib/methods/inspect.js"),module.exports=Database},"./node_modules/better-sqlite3/lib/index.js":(e,t,r)=>{"use strict";e.exports=r("./node_modules/better-sqlite3/lib/database.js"),e.exports.SqliteError=r("./node_modules/better-sqlite3/lib/sqlite-error.js")},"./node_modules/better-sqlite3/lib/methods/aggregate.js":(e,t,r)=>{"use strict";const{getBooleanOption:s,cppdb:o}=r("./node_modules/better-sqlite3/lib/util.js");e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("Expected first argument to be a string");if("object"!=typeof t||null===t)throw new TypeError("Expected second argument to be an options object");if(!e)throw new TypeError("User-defined function name cannot be an empty string");const r="start"in t?t.start:null,a=n(t,"step",!0),c=n(t,"inverse",!1),l=n(t,"result",!1),u="safeIntegers"in t?+s(t,"safeIntegers"):2,d=s(t,"deterministic"),p=s(t,"directOnly");let h=-1;if(!s(t,"varargs")&&(h=Math.max(i(a),c?i(c):0),h>0&&(h-=1),h>100))throw new RangeError("User-defined functions cannot have more than 100 arguments");return this[o].aggregate(r,a,c,l,e,h,u,d,p),this};const n=(e,t,r)=>{const s=t in e?e[t]:null;if("function"==typeof s)return s;if(null!=s)throw new TypeError(`Expected the "${t}" option to be a function`);if(r)throw new TypeError(`Missing required option "${t}"`);return null},i=({length:e})=>{if(Number.isInteger(e)&&e>=0)return e;throw new TypeError("Expected function.length to be a positive integer")}},"./node_modules/better-sqlite3/lib/methods/backup.js":(e,t,r)=>{"use strict";const s=r("fs"),o=r("path"),{promisify:n}=r("util"),{cppdb:i}=r("./node_modules/better-sqlite3/lib/util.js"),a=n(s.access);e.exports=async function(e,t){if(null==t&&(t={}),"string"!=typeof e)throw new TypeError("Expected first argument to be a string");if("object"!=typeof t)throw new TypeError("Expected second argument to be an options object");e=e.trim();const r="attached"in t?t.attached:"main",s="progress"in t?t.progress:null;if(!e)throw new TypeError("Backup filename cannot be an empty string");if(":memory:"===e)throw new TypeError('Invalid backup filename ":memory:"');if("string"!=typeof r)throw new TypeError('Expected the "attached" option to be a string');if(!r)throw new TypeError('The "attached" option cannot be an empty string');if(null!=s&&"function"!=typeof s)throw new TypeError('Expected the "progress" option to be a function');await a(o.dirname(e)).catch(()=>{throw new TypeError("Cannot save backup because the directory does not exist")});const n=await a(e).then(()=>!1,()=>!0);return c(this[i].backup(this,r,e,n),s||null)};const c=(e,t)=>{let r=0,s=!0;return new Promise((o,n)=>{setImmediate(function i(){try{const n=e.transfer(r);if(!n.remainingPages)return e.close(),void o(n);if(s&&(s=!1,r=100),t){const e=t(n);if(void 0!==e){if("number"!=typeof e||e!=e)throw new TypeError("Expected progress callback to return a number or undefined");r=Math.max(0,Math.min(2147483647,Math.round(e)))}}setImmediate(i)}catch(t){e.close(),n(t)}})})}},"./node_modules/better-sqlite3/lib/methods/function.js":(e,t,r)=>{"use strict";const{getBooleanOption:s,cppdb:o}=r("./node_modules/better-sqlite3/lib/util.js");e.exports=function(e,t,r){if(null==t&&(t={}),"function"==typeof t&&(r=t,t={}),"string"!=typeof e)throw new TypeError("Expected first argument to be a string");if("function"!=typeof r)throw new TypeError("Expected last argument to be a function");if("object"!=typeof t)throw new TypeError("Expected second argument to be an options object");if(!e)throw new TypeError("User-defined function name cannot be an empty string");const n="safeIntegers"in t?+s(t,"safeIntegers"):2,i=s(t,"deterministic"),a=s(t,"directOnly");let c=-1;if(!s(t,"varargs")){if(c=r.length,!Number.isInteger(c)||c<0)throw new TypeError("Expected function.length to be a positive integer");if(c>100)throw new RangeError("User-defined functions cannot have more than 100 arguments")}return this[o].function(r,e,c,n,i,a),this}},"./node_modules/better-sqlite3/lib/methods/inspect.js":e=>{"use strict";const t=function(){};e.exports=function(e,r){return Object.assign(new t,this)}},"./node_modules/better-sqlite3/lib/methods/pragma.js":(e,t,r)=>{"use strict";const{getBooleanOption:s,cppdb:o}=r("./node_modules/better-sqlite3/lib/util.js");e.exports=function(e,t){if(null==t&&(t={}),"string"!=typeof e)throw new TypeError("Expected first argument to be a string");if("object"!=typeof t)throw new TypeError("Expected second argument to be an options object");const r=s(t,"simple"),n=this[o].prepare(`PRAGMA ${e}`,this,!0);return r?n.pluck().get():n.all()}},"./node_modules/better-sqlite3/lib/methods/serialize.js":(e,t,r)=>{"use strict";const{cppdb:s}=r("./node_modules/better-sqlite3/lib/util.js");e.exports=function(e){if(null==e&&(e={}),"object"!=typeof e)throw new TypeError("Expected first argument to be an options object");const t="attached"in e?e.attached:"main";if("string"!=typeof t)throw new TypeError('Expected the "attached" option to be a string');if(!t)throw new TypeError('The "attached" option cannot be an empty string');return this[s].serialize(t)}},"./node_modules/better-sqlite3/lib/methods/table.js":(e,t,r)=>{"use strict";const{cppdb:s}=r("./node_modules/better-sqlite3/lib/util.js");function o(e,t,r){if(!c.call(e,"rows"))throw new TypeError(`Virtual table module "${r}" ${t} a table definition without a "rows" property`);if(!c.call(e,"columns"))throw new TypeError(`Virtual table module "${r}" ${t} a table definition without a "columns" property`);const s=e.rows;if("function"!=typeof s||Object.getPrototypeOf(s)!==u)throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "rows" property (should be a generator function)`);let o,i=e.columns;if(!Array.isArray(i)||!(i=[...i]).every(e=>"string"==typeof e))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "columns" property (should be an array of strings)`);if(i.length!==new Set(i).size)throw new TypeError(`Virtual table module "${r}" ${t} a table definition with duplicate column names`);if(!i.length)throw new RangeError(`Virtual table module "${r}" ${t} a table definition with zero columns`);if(c.call(e,"parameters")){if(o=e.parameters,!Array.isArray(o)||!(o=[...o]).every(e=>"string"==typeof e))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "parameters" property (should be an array of strings)`)}else o=function({length:e}){if(!Number.isInteger(e)||e<0)throw new TypeError("Expected function.length to be a positive integer");const t=[];for(let r=0;r<e;++r)t.push(`$${r+1}`);return t}(s);if(o.length!==new Set(o).size)throw new TypeError(`Virtual table module "${r}" ${t} a table definition with duplicate parameter names`);if(o.length>32)throw new RangeError(`Virtual table module "${r}" ${t} a table definition with more than the maximum number of 32 parameters`);for(const e of o)if(i.includes(e))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with column "${e}" which was ambiguously defined as both a column and parameter`);let a=2;if(c.call(e,"safeIntegers")){const s=e.safeIntegers;if("boolean"!=typeof s)throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "safeIntegers" property (should be a boolean)`);a=+s}let l=!1;if(c.call(e,"directOnly")&&(l=e.directOnly,"boolean"!=typeof l))throw new TypeError(`Virtual table module "${r}" ${t} a table definition with an invalid "directOnly" property (should be a boolean)`);return[`CREATE TABLE x(${[...o.map(d).map(e=>`${e} HIDDEN`),...i.map(d)].join(", ")});`,n(s,new Map(i.map((e,t)=>[e,o.length+t])),r),o,a,l]}function n(e,t,r){return function*(...s){const o=s.map(e=>Buffer.isBuffer(e)?Buffer.from(e):e);for(let e=0;e<t.size;++e)o.push(null);for(const n of e(...s))if(Array.isArray(n))i(n,o,t.size,r),yield o;else{if("object"!=typeof n||null===n)throw new TypeError(`Virtual table module "${r}" yielded something that isn't a valid row object`);a(n,o,t,r),yield o}}}function i(e,t,r,s){if(e.length!==r)throw new TypeError(`Virtual table module "${s}" yielded a row with an incorrect number of columns`);const o=t.length-r;for(let s=0;s<r;++s)t[s+o]=e[s]}function a(e,t,r,s){let o=0;for(const n of Object.keys(e)){const i=r.get(n);if(void 0===i)throw new TypeError(`Virtual table module "${s}" yielded a row with an undeclared column "${n}"`);t[i]=e[n],o+=1}if(o!==r.size)throw new TypeError(`Virtual table module "${s}" yielded a row with missing columns`)}e.exports=function(e,t){if("string"!=typeof e)throw new TypeError("Expected first argument to be a string");if(!e)throw new TypeError("Virtual table module name cannot be an empty string");let r=!1;if("object"==typeof t&&null!==t)r=!0,t=p(o(t,"used",e));else{if("function"!=typeof t)throw new TypeError("Expected second argument to be a function or a table definition object");t=function(e){return function(t,r,s,...n){const i={module:t,database:r,table:s},a=l.call(e,i,n);if("object"!=typeof a||null===a)throw new TypeError(`Virtual table module "${t}" did not return a table definition object`);return o(a,"returned",t)}}(t)}return this[s].table(t,e,r),this};const{hasOwnProperty:c}=Object.prototype,{apply:l}=Function.prototype,u=Object.getPrototypeOf(function*(){}),d=e=>`"${e.replace(/"/g,'""')}"`,p=e=>()=>e},"./node_modules/better-sqlite3/lib/methods/transaction.js":(e,t,r)=>{"use strict";const{cppdb:s}=r("./node_modules/better-sqlite3/lib/util.js"),o=new WeakMap;e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected first argument to be a function");const t=this[s],r=n(t,this),{apply:o}=Function.prototype,a={default:{value:i(o,e,t,r.default)},deferred:{value:i(o,e,t,r.deferred)},immediate:{value:i(o,e,t,r.immediate)},exclusive:{value:i(o,e,t,r.exclusive)},database:{value:this,enumerable:!0}};return Object.defineProperties(a.default.value,a),Object.defineProperties(a.deferred.value,a),Object.defineProperties(a.immediate.value,a),Object.defineProperties(a.exclusive.value,a),a.default.value};const n=(e,t)=>{let r=o.get(e);if(!r){const s={commit:e.prepare("COMMIT",t,!1),rollback:e.prepare("ROLLBACK",t,!1),savepoint:e.prepare("SAVEPOINT `\t_bs3.\t`",t,!1),release:e.prepare("RELEASE `\t_bs3.\t`",t,!1),rollbackTo:e.prepare("ROLLBACK TO `\t_bs3.\t`",t,!1)};o.set(e,r={default:Object.assign({begin:e.prepare("BEGIN",t,!1)},s),deferred:Object.assign({begin:e.prepare("BEGIN DEFERRED",t,!1)},s),immediate:Object.assign({begin:e.prepare("BEGIN IMMEDIATE",t,!1)},s),exclusive:Object.assign({begin:e.prepare("BEGIN EXCLUSIVE",t,!1)},s)})}return r},i=(e,t,r,{begin:s,commit:o,rollback:n,savepoint:i,release:a,rollbackTo:c})=>function(){let l,u,d;r.inTransaction?(l=i,u=a,d=c):(l=s,u=o,d=n),l.run();try{const r=e.call(t,this,arguments);if(r&&"function"==typeof r.then)throw new TypeError("Transaction function cannot return a promise");return u.run(),r}catch(e){throw r.inTransaction&&(d.run(),d!==n&&u.run()),e}}},"./node_modules/better-sqlite3/lib/methods/wrappers.js":(e,t,r)=>{"use strict";const{cppdb:s}=r("./node_modules/better-sqlite3/lib/util.js");t.prepare=function(e){return this[s].prepare(e,this,!1)},t.exec=function(e){return this[s].exec(e),this},t.close=function(){return this[s].close(),this},t.loadExtension=function(...e){return this[s].loadExtension(...e),this},t.defaultSafeIntegers=function(...e){return this[s].defaultSafeIntegers(...e),this},t.unsafeMode=function(...e){return this[s].unsafeMode(...e),this},t.getters={name:{get:function(){return this[s].name},enumerable:!0},open:{get:function(){return this[s].open},enumerable:!0},inTransaction:{get:function(){return this[s].inTransaction},enumerable:!0},readonly:{get:function(){return this[s].readonly},enumerable:!0},memory:{get:function(){return this[s].memory},enumerable:!0}}},"./node_modules/better-sqlite3/lib/sqlite-error.js":e=>{"use strict";const t={value:"SqliteError",writable:!0,enumerable:!1,configurable:!0};function r(e,s){if(new.target!==r)return new r(e,s);if("string"!=typeof s)throw new TypeError("Expected second argument to be a string");Error.call(this,e),t.value=""+e,Object.defineProperty(this,"message",t),Error.captureStackTrace(this,r),this.code=s}Object.setPrototypeOf(r,Error),Object.setPrototypeOf(r.prototype,Error.prototype),Object.defineProperty(r.prototype,"name",t),e.exports=r},"./node_modules/better-sqlite3/lib/util.js":(e,t)=>{"use strict";t.getBooleanOption=(e,t)=>{let r=!1;if(t in e&&"boolean"!=typeof(r=e[t]))throw new TypeError(`Expected the "${t}" option to be a boolean`);return r},t.cppdb=Symbol(),t.inspect=Symbol.for("nodejs.util.inspect.custom")},"./node_modules/bottleneck/light.js":function(e){var t;t=function(){"use strict";var e,t,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s={load:function(e,t,r={}){var s,o,n;for(s in t)n=t[s],r[s]=null!=(o=e[s])?o:n;return r},overwrite:function(e,t,r={}){var s,o;for(s in e)o=e[s],void 0!==t[s]&&(r[s]=o);return r}},o=class{constructor(e,t){this.incr=e,this.decr=t,this._first=null,this._last=null,this.length=0}push(e){var t;this.length++,"function"==typeof this.incr&&this.incr(),t={value:e,prev:this._last,next:null},null!=this._last?(this._last.next=t,this._last=t):this._first=this._last=t}shift(){var e;if(null!=this._first)return this.length--,"function"==typeof this.decr&&this.decr(),e=this._first.value,null!=(this._first=this._first.next)?this._first.prev=null:this._last=null,e}first(){if(null!=this._first)return this._first.value}getArray(){var e,t,r;for(e=this._first,r=[];null!=e;)r.push((t=e,e=e.next,t.value));return r}forEachShift(e){var t;for(t=this.shift();null!=t;)e(t),t=this.shift()}debug(){var e,t,r,s,o;for(e=this._first,o=[];null!=e;)o.push((t=e,e=e.next,{value:t.value,prev:null!=(r=t.prev)?r.value:void 0,next:null!=(s=t.next)?s.value:void 0}));return o}},n=class{constructor(e){if(this.instance=e,this._events={},null!=this.instance.on||null!=this.instance.once||null!=this.instance.removeAllListeners)throw new Error("An Emitter already exists for this object");this.instance.on=(e,t)=>this._addListener(e,"many",t),this.instance.once=(e,t)=>this._addListener(e,"once",t),this.instance.removeAllListeners=(e=null)=>null!=e?delete this._events[e]:this._events={}}_addListener(e,t,r){var s;return null==(s=this._events)[e]&&(s[e]=[]),this._events[e].push({cb:r,status:t}),this.instance}listenerCount(e){return null!=this._events[e]?this._events[e].length:0}async trigger(e,...t){var r,s;try{if("debug"!==e&&this.trigger("debug",`Event triggered: ${e}`,t),null==this._events[e])return;return this._events[e]=this._events[e].filter(function(e){return"none"!==e.status}),s=this._events[e].map(async e=>{var r,s;if("none"!==e.status){"once"===e.status&&(e.status="none");try{return"function"==typeof(null!=(s="function"==typeof e.cb?e.cb(...t):void 0)?s.then:void 0)?await s:s}catch(e){return r=e,this.trigger("error",r),null}}}),(await Promise.all(s)).find(function(e){return null!=e})}catch(e){return r=e,this.trigger("error",r),null}}};e=o,t=n;var i,a,c,l=class{constructor(r){this.Events=new t(this),this._length=0,this._lists=function(){var t,s,o;for(o=[],t=1,s=r;1<=s?t<=s:t>=s;1<=s?++t:--t)o.push(new e(()=>this.incr(),()=>this.decr()));return o}.call(this)}incr(){if(0===this._length++)return this.Events.trigger("leftzero")}decr(){if(0===--this._length)return this.Events.trigger("zero")}push(e){return this._lists[e.options.priority].push(e)}queued(e){return null!=e?this._lists[e].length:this._length}shiftAll(e){return this._lists.forEach(function(t){return t.forEachShift(e)})}getFirst(e=this._lists){var t,r,s;for(t=0,r=e.length;t<r;t++)if((s=e[t]).length>0)return s;return[]}shiftLastFrom(e){return this.getFirst(this._lists.slice(e).reverse()).shift()}},u=class extends Error{};c=s,i=u,a=class{constructor(e,t,r,s,o,n,i,a){this.task=e,this.args=t,this.rejectOnDrop=o,this.Events=n,this._states=i,this.Promise=a,this.options=c.load(r,s),this.options.priority=this._sanitizePriority(this.options.priority),this.options.id===s.id&&(this.options.id=`${this.options.id}-${this._randomIndex()}`),this.promise=new this.Promise((e,t)=>{this._resolve=e,this._reject=t}),this.retryCount=0}_sanitizePriority(e){var t;return(t=~~e!==e?5:e)<0?0:t>9?9:t}_randomIndex(){return Math.random().toString(36).slice(2)}doDrop({error:e,message:t="This job has been dropped by Bottleneck"}={}){return!!this._states.remove(this.options.id)&&(this.rejectOnDrop&&this._reject(null!=e?e:new i(t)),this.Events.trigger("dropped",{args:this.args,options:this.options,task:this.task,promise:this.promise}),!0)}_assertStatus(e){var t;if((t=this._states.jobStatus(this.options.id))!==e&&("DONE"!==e||null!==t))throw new i(`Invalid job status ${t}, expected ${e}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`)}doReceive(){return this._states.start(this.options.id),this.Events.trigger("received",{args:this.args,options:this.options})}doQueue(e,t){return this._assertStatus("RECEIVED"),this._states.next(this.options.id),this.Events.trigger("queued",{args:this.args,options:this.options,reachedHWM:e,blocked:t})}doRun(){return 0===this.retryCount?(this._assertStatus("QUEUED"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),this.Events.trigger("scheduled",{args:this.args,options:this.options})}async doExecute(e,t,r,s){var o,n,i;0===this.retryCount?(this._assertStatus("RUNNING"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),n={args:this.args,options:this.options,retryCount:this.retryCount},this.Events.trigger("executing",n);try{if(i=await(null!=e?e.schedule(this.options,this.task,...this.args):this.task(...this.args)),t())return this.doDone(n),await s(this.options,n),this._assertStatus("DONE"),this._resolve(i)}catch(e){return o=e,this._onFailure(o,n,t,r,s)}}doExpire(e,t,r){var s,o;return this._states.jobStatus("RUNNING"===this.options.id)&&this._states.next(this.options.id),this._assertStatus("EXECUTING"),o={args:this.args,options:this.options,retryCount:this.retryCount},s=new i(`This job timed out after ${this.options.expiration} ms.`),this._onFailure(s,o,e,t,r)}async _onFailure(e,t,r,s,o){var n,i;if(r())return null!=(n=await this.Events.trigger("failed",e,t))?(i=~~n,this.Events.trigger("retry",`Retrying ${this.options.id} after ${i} ms`,t),this.retryCount++,s(i)):(this.doDone(t),await o(this.options,t),this._assertStatus("DONE"),this._reject(e))}doDone(e){return this._assertStatus("EXECUTING"),this._states.next(this.options.id),this.Events.trigger("done",e)}};var d,p,h=a;p=s,d=u;var m,g=class{constructor(e,t,r){this.instance=e,this.storeOptions=t,this.clientId=this.instance._randomIndex(),p.load(r,r,this),this._nextRequest=this._lastReservoirRefresh=this._lastReservoirIncrease=Date.now(),this._running=0,this._done=0,this._unblockTime=0,this.ready=this.Promise.resolve(),this.clients={},this._startHeartbeat()}_startHeartbeat(){var e;return null==this.heartbeat&&(null!=this.storeOptions.reservoirRefreshInterval&&null!=this.storeOptions.reservoirRefreshAmount||null!=this.storeOptions.reservoirIncreaseInterval&&null!=this.storeOptions.reservoirIncreaseAmount)?"function"==typeof(e=this.heartbeat=setInterval(()=>{var e,t,r,s,o;if(s=Date.now(),null!=this.storeOptions.reservoirRefreshInterval&&s>=this._lastReservoirRefresh+this.storeOptions.reservoirRefreshInterval&&(this._lastReservoirRefresh=s,this.storeOptions.reservoir=this.storeOptions.reservoirRefreshAmount,this.instance._drainAll(this.computeCapacity())),null!=this.storeOptions.reservoirIncreaseInterval&&s>=this._lastReservoirIncrease+this.storeOptions.reservoirIncreaseInterval&&(({reservoirIncreaseAmount:e,reservoirIncreaseMaximum:r,reservoir:o}=this.storeOptions),this._lastReservoirIncrease=s,(t=null!=r?Math.min(e,r-o):e)>0))return this.storeOptions.reservoir+=t,this.instance._drainAll(this.computeCapacity())},this.heartbeatInterval)).unref?e.unref():void 0:clearInterval(this.heartbeat)}async __publish__(e){return await this.yieldLoop(),this.instance.Events.trigger("message",e.toString())}async __disconnect__(e){return await this.yieldLoop(),clearInterval(this.heartbeat),this.Promise.resolve()}yieldLoop(e=0){return new this.Promise(function(t,r){return setTimeout(t,e)})}computePenalty(){var e;return null!=(e=this.storeOptions.penalty)?e:15*this.storeOptions.minTime||5e3}async __updateSettings__(e){return await this.yieldLoop(),p.overwrite(e,e,this.storeOptions),this._startHeartbeat(),this.instance._drainAll(this.computeCapacity()),!0}async __running__(){return await this.yieldLoop(),this._running}async __queued__(){return await this.yieldLoop(),this.instance.queued()}async __done__(){return await this.yieldLoop(),this._done}async __groupCheck__(e){return await this.yieldLoop(),this._nextRequest+this.timeout<e}computeCapacity(){var e,t;return({maxConcurrent:e,reservoir:t}=this.storeOptions),null!=e&&null!=t?Math.min(e-this._running,t):null!=e?e-this._running:null!=t?t:null}conditionsCheck(e){var t;return null==(t=this.computeCapacity())||e<=t}async __incrementReservoir__(e){var t;return await this.yieldLoop(),t=this.storeOptions.reservoir+=e,this.instance._drainAll(this.computeCapacity()),t}async __currentReservoir__(){return await this.yieldLoop(),this.storeOptions.reservoir}isBlocked(e){return this._unblockTime>=e}check(e,t){return this.conditionsCheck(e)&&this._nextRequest-t<=0}async __check__(e){var t;return await this.yieldLoop(),t=Date.now(),this.check(e,t)}async __register__(e,t,r){var s,o;return await this.yieldLoop(),s=Date.now(),this.conditionsCheck(t)?(this._running+=t,null!=this.storeOptions.reservoir&&(this.storeOptions.reservoir-=t),o=Math.max(this._nextRequest-s,0),this._nextRequest=s+o+this.storeOptions.minTime,{success:!0,wait:o,reservoir:this.storeOptions.reservoir}):{success:!1}}strategyIsBlock(){return 3===this.storeOptions.strategy}async __submit__(e,t){var r,s,o;if(await this.yieldLoop(),null!=this.storeOptions.maxConcurrent&&t>this.storeOptions.maxConcurrent)throw new d(`Impossible to add a job having a weight of ${t} to a limiter having a maxConcurrent setting of ${this.storeOptions.maxConcurrent}`);return s=Date.now(),o=null!=this.storeOptions.highWater&&e===this.storeOptions.highWater&&!this.check(t,s),(r=this.strategyIsBlock()&&(o||this.isBlocked(s)))&&(this._unblockTime=s+this.computePenalty(),this._nextRequest=this._unblockTime+this.storeOptions.minTime,this.instance._dropAllQueued()),{reachedHWM:o,blocked:r,strategy:this.storeOptions.strategy}}async __free__(e,t){return await this.yieldLoop(),this._running-=t,this._done+=t,this.instance._drainAll(this.computeCapacity()),{running:this._running}}};m=u;var f,y=class{constructor(e){this.status=e,this._jobs={},this.counts=this.status.map(function(){return 0})}next(e){var t,r;return r=(t=this._jobs[e])+1,null!=t&&r<this.status.length?(this.counts[t]--,this.counts[r]++,this._jobs[e]++):null!=t?(this.counts[t]--,delete this._jobs[e]):void 0}start(e){return this._jobs[e]=0,this.counts[0]++}remove(e){var t;return null!=(t=this._jobs[e])&&(this.counts[t]--,delete this._jobs[e]),null!=t}jobStatus(e){var t;return null!=(t=this.status[this._jobs[e]])?t:null}statusJobs(e){var t,r,s,o;if(null!=e){if((r=this.status.indexOf(e))<0)throw new m(`status must be one of ${this.status.join(", ")}`);for(t in o=[],s=this._jobs)s[t]===r&&o.push(t);return o}return Object.keys(this._jobs)}statusCounts(){return this.counts.reduce((e,t,r)=>(e[this.status[r]]=t,e),{})}};f=o;var v,w,E,S,b,_=class{constructor(e,t){this.schedule=this.schedule.bind(this),this.name=e,this.Promise=t,this._running=0,this._queue=new f}isEmpty(){return 0===this._queue.length}async _tryToRun(){var e,t,r,s,o,n,i;if(this._running<1&&this._queue.length>0)return this._running++,({task:i,args:e,resolve:o,reject:s}=this._queue.shift()),t=await async function(){try{return n=await i(...e),function(){return o(n)}}catch(e){return r=e,function(){return s(r)}}}(),this._running--,this._tryToRun(),t()}schedule(e,...t){var r,s,o;return o=s=null,r=new this.Promise(function(e,t){return o=e,s=t}),this._queue.push({task:e,args:t,resolve:o,reject:s}),this._tryToRun(),r}},T="2.19.5",C={version:T},I=Object.freeze({version:T,default:C}),k=()=>console.log("You must import the full version of Bottleneck in order to use this feature."),P=()=>console.log("You must import the full version of Bottleneck in order to use this feature.");b=s,v=n,E=k,w=P,S=()=>console.log("You must import the full version of Bottleneck in order to use this feature.");var A,D,O=function(){class e{constructor(e={}){this.deleteKey=this.deleteKey.bind(this),this.limiterOptions=e,b.load(this.limiterOptions,this.defaults,this),this.Events=new v(this),this.instances={},this.Bottleneck=z,this._startAutoCleanup(),this.sharedConnection=null!=this.connection,null==this.connection&&("redis"===this.limiterOptions.datastore?this.connection=new E(Object.assign({},this.limiterOptions,{Events:this.Events})):"ioredis"===this.limiterOptions.datastore&&(this.connection=new w(Object.assign({},this.limiterOptions,{Events:this.Events}))))}key(e=""){var t;return null!=(t=this.instances[e])?t:(()=>{var t;return t=this.instances[e]=new this.Bottleneck(Object.assign(this.limiterOptions,{id:`${this.id}-${e}`,timeout:this.timeout,connection:this.connection})),this.Events.trigger("created",t,e),t})()}async deleteKey(e=""){var t,r;return r=this.instances[e],this.connection&&(t=await this.connection.__runCommand__(["del",...S.allKeys(`${this.id}-${e}`)])),null!=r&&(delete this.instances[e],await r.disconnect()),null!=r||t>0}limiters(){var e,t,r,s;for(e in r=[],t=this.instances)s=t[e],r.push({key:e,limiter:s});return r}keys(){return Object.keys(this.instances)}async clusterKeys(){var e,t,r,s,o,n,i,a;if(null==this.connection)return this.Promise.resolve(this.keys());for(o=[],e=null,a=`b_${this.id}-`.length;0!==e;)for([i,t]=await this.connection.__runCommand__(["scan",null!=e?e:0,"match",`b_${this.id}-*_settings`,"count",1e4]),e=~~i,r=0,n=t.length;r<n;r++)s=t[r],o.push(s.slice(a,-9));return o}_startAutoCleanup(){var e;return clearInterval(this.interval),"function"==typeof(e=this.interval=setInterval(async()=>{var e,t,r,s,o,n;for(t in o=Date.now(),s=[],r=this.instances){n=r[t];try{await n._store.__groupCheck__(o)?s.push(this.deleteKey(t)):s.push(void 0)}catch(t){e=t,s.push(n.Events.trigger("error",e))}}return s},this.timeout/2)).unref?e.unref():void 0}updateSettings(e={}){if(b.overwrite(e,this.defaults,this),b.overwrite(e,e,this.limiterOptions),null!=e.timeout)return this._startAutoCleanup()}disconnect(e=!0){var t;if(!this.sharedConnection)return null!=(t=this.connection)?t.disconnect(e):void 0}}return e.prototype.defaults={timeout:3e5,connection:null,Promise,id:"group-key"},e}.call(r);D=s,A=n;var $,R,x,M,j,F,N,L,U,G=function(){class e{constructor(e={}){this.options=e,D.load(this.options,this.defaults,this),this.Events=new A(this),this._arr=[],this._resetPromise(),this._lastFlush=Date.now()}_resetPromise(){return this._promise=new this.Promise((e,t)=>this._resolve=e)}_flush(){return clearTimeout(this._timeout),this._lastFlush=Date.now(),this._resolve(),this.Events.trigger("batch",this._arr),this._arr=[],this._resetPromise()}add(e){var t;return this._arr.push(e),t=this._promise,this._arr.length===this.maxSize?this._flush():null!=this.maxTime&&1===this._arr.length&&(this._timeout=setTimeout(()=>this._flush(),this.maxTime)),t}}return e.prototype.defaults={maxTime:null,maxSize:null,Promise},e}.call(r),q=($=I)&&$.default||$,B=[].splice;U=s,j=l,x=h,M=g,F=()=>console.log("You must import the full version of Bottleneck in order to use this feature."),R=n,N=y,L=_;var z=function(){class e{constructor(t={},...r){var s,o;this._addToQueue=this._addToQueue.bind(this),this._validateOptions(t,r),U.load(t,this.instanceDefaults,this),this._queues=new j(10),this._scheduled={},this._states=new N(["RECEIVED","QUEUED","RUNNING","EXECUTING"].concat(this.trackDoneStatus?["DONE"]:[])),this._limiter=null,this.Events=new R(this),this._submitLock=new L("submit",this.Promise),this._registerLock=new L("register",this.Promise),o=U.load(t,this.storeDefaults,{}),this._store=function(){if("redis"===this.datastore||"ioredis"===this.datastore||null!=this.connection)return s=U.load(t,this.redisStoreDefaults,{}),new F(this,o,s);if("local"===this.datastore)return s=U.load(t,this.localStoreDefaults,{}),new M(this,o,s);throw new e.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`)}.call(this),this._queues.on("leftzero",()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.ref?e.ref():void 0}),this._queues.on("zero",()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.unref?e.unref():void 0})}_validateOptions(t,r){if(null==t||"object"!=typeof t||0!==r.length)throw new e.prototype.BottleneckError("Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.")}ready(){return this._store.ready}clients(){return this._store.clients}channel(){return`b_${this.id}`}channel_client(){return`b_${this.id}_${this._store.clientId}`}publish(e){return this._store.__publish__(e)}disconnect(e=!0){return this._store.__disconnect__(e)}chain(e){return this._limiter=e,this}queued(e){return this._queues.queued(e)}clusterQueued(){return this._store.__queued__()}empty(){return 0===this.queued()&&this._submitLock.isEmpty()}running(){return this._store.__running__()}done(){return this._store.__done__()}jobStatus(e){return this._states.jobStatus(e)}jobs(e){return this._states.statusJobs(e)}counts(){return this._states.statusCounts()}_randomIndex(){return Math.random().toString(36).slice(2)}check(e=1){return this._store.__check__(e)}_clearGlobalState(e){return null!=this._scheduled[e]&&(clearTimeout(this._scheduled[e].expiration),delete this._scheduled[e],!0)}async _free(e,t,r,s){var o,n;try{if(({running:n}=await this._store.__free__(e,r.weight)),this.Events.trigger("debug",`Freed ${r.id}`,s),0===n&&this.empty())return this.Events.trigger("idle")}catch(e){return o=e,this.Events.trigger("error",o)}}_run(e,t,r){var s,o,n;return t.doRun(),s=this._clearGlobalState.bind(this,e),n=this._run.bind(this,e,t),o=this._free.bind(this,e,t),this._scheduled[e]={timeout:setTimeout(()=>t.doExecute(this._limiter,s,n,o),r),expiration:null!=t.options.expiration?setTimeout(function(){return t.doExpire(s,n,o)},r+t.options.expiration):void 0,job:t}}_drainOne(e){return this._registerLock.schedule(()=>{var t,r,s,o,n;return 0===this.queued()?this.Promise.resolve(null):(n=this._queues.getFirst(),({options:o,args:t}=s=n.first()),null!=e&&o.weight>e?this.Promise.resolve(null):(this.Events.trigger("debug",`Draining ${o.id}`,{args:t,options:o}),r=this._randomIndex(),this._store.__register__(r,o.weight,o.expiration).then(({success:e,wait:i,reservoir:a})=>{var c;return this.Events.trigger("debug",`Drained ${o.id}`,{success:e,args:t,options:o}),e?(n.shift(),(c=this.empty())&&this.Events.trigger("empty"),0===a&&this.Events.trigger("depleted",c),this._run(r,s,i),this.Promise.resolve(o.weight)):this.Promise.resolve(null)})))})}_drainAll(e,t=0){return this._drainOne(e).then(r=>{var s;return null!=r?(s=null!=e?e-r:e,this._drainAll(s,t+r)):this.Promise.resolve(t)}).catch(e=>this.Events.trigger("error",e))}_dropAllQueued(e){return this._queues.shiftAll(function(t){return t.doDrop({message:e})})}stop(t={}){var r,s;return t=U.load(t,this.stopDefaults),s=e=>{var t;return t=()=>{var t;return(t=this._states.counts)[0]+t[1]+t[2]+t[3]===e},new this.Promise((e,r)=>t()?e():this.on("done",()=>{if(t())return this.removeAllListeners("done"),e()}))},r=t.dropWaitingJobs?(this._run=function(e,r){return r.doDrop({message:t.dropErrorMessage})},this._drainOne=()=>this.Promise.resolve(null),this._registerLock.schedule(()=>this._submitLock.schedule(()=>{var e,r,o;for(e in r=this._scheduled)o=r[e],"RUNNING"===this.jobStatus(o.job.options.id)&&(clearTimeout(o.timeout),clearTimeout(o.expiration),o.job.doDrop({message:t.dropErrorMessage}));return this._dropAllQueued(t.dropErrorMessage),s(0)}))):this.schedule({priority:9,weight:0},()=>s(1)),this._receive=function(r){return r._reject(new e.prototype.BottleneckError(t.enqueueErrorMessage))},this.stop=()=>this.Promise.reject(new e.prototype.BottleneckError("stop() has already been called")),r}async _addToQueue(t){var r,s,o,n,i,a,c;({args:r,options:n}=t);try{({reachedHWM:i,blocked:s,strategy:c}=await this._store.__submit__(this.queued(),n.weight))}catch(e){return o=e,this.Events.trigger("debug",`Could not queue ${n.id}`,{args:r,options:n,error:o}),t.doDrop({error:o}),!1}return s?(t.doDrop(),!0):i&&(null!=(a=c===e.prototype.strategy.LEAK?this._queues.shiftLastFrom(n.priority):c===e.prototype.strategy.OVERFLOW_PRIORITY?this._queues.shiftLastFrom(n.priority+1):c===e.prototype.strategy.OVERFLOW?t:void 0)&&a.doDrop(),null==a||c===e.prototype.strategy.OVERFLOW)?(null==a&&t.doDrop(),i):(t.doQueue(i,s),this._queues.push(t),await this._drainAll(),i)}_receive(t){return null!=this._states.jobStatus(t.options.id)?(t._reject(new e.prototype.BottleneckError(`A job with the same id already exists (id=${t.options.id})`)),!1):(t.doReceive(),this._submitLock.schedule(this._addToQueue,t))}submit(...e){var t,r,s,o,n,i,a;return"function"==typeof e[0]?(n=e,[r,...e]=n,[t]=B.call(e,-1),o=U.load({},this.jobDefaults)):(i=e,[o,r,...e]=i,[t]=B.call(e,-1),o=U.load(o,this.jobDefaults)),a=(...e)=>new this.Promise(function(t,s){return r(...e,function(...e){return(null!=e[0]?s:t)(e)})}),(s=new x(a,e,o,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise)).promise.then(function(e){return"function"==typeof t?t(...e):void 0}).catch(function(e){return Array.isArray(e)?"function"==typeof t?t(...e):void 0:"function"==typeof t?t(e):void 0}),this._receive(s)}schedule(...e){var t,r,s;return"function"==typeof e[0]?([s,...e]=e,r={}):[r,s,...e]=e,t=new x(s,e,r,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise),this._receive(t),t.promise}wrap(e){var t,r;return t=this.schedule.bind(this),(r=function(...r){return t(e.bind(this),...r)}).withOptions=function(r,...s){return t(r,e,...s)},r}async updateSettings(e={}){return await this._store.__updateSettings__(U.overwrite(e,this.storeDefaults)),U.overwrite(e,this.instanceDefaults,this),this}currentReservoir(){return this._store.__currentReservoir__()}incrementReservoir(e=0){return this._store.__incrementReservoir__(e)}}return e.default=e,e.Events=R,e.version=e.prototype.version=q.version,e.strategy=e.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},e.BottleneckError=e.prototype.BottleneckError=u,e.Group=e.prototype.Group=O,e.RedisConnection=e.prototype.RedisConnection=k,e.IORedisConnection=e.prototype.IORedisConnection=P,e.Batcher=e.prototype.Batcher=G,e.prototype.jobDefaults={priority:5,weight:1,expiration:null,id:"<no-id>"},e.prototype.storeDefaults={maxConcurrent:null,minTime:0,highWater:null,strategy:e.prototype.strategy.LEAK,penalty:null,reservoir:null,reservoirRefreshInterval:null,reservoirRefreshAmount:null,reservoirIncreaseInterval:null,reservoirIncreaseAmount:null,reservoirIncreaseMaximum:null},e.prototype.localStoreDefaults={Promise,timeout:null,heartbeatInterval:250},e.prototype.redisStoreDefaults={Promise,timeout:null,heartbeatInterval:5e3,clientTimeout:1e4,Redis:null,clientOptions:{},clusterNodes:null,clearDatastore:!1,connection:null},e.prototype.instanceDefaults={datastore:"local",connection:null,id:"<no-id>",rejectOnDrop:!0,trackDoneStatus:!1,Promise},e.prototype.stopDefaults={enqueueErrorMessage:"This limiter has been stopped and cannot accept new jobs.",dropWaitingJobs:!0,dropErrorMessage:"This limiter has been stopped."},e}.call(r);return z},e.exports=t()},"./node_modules/electron-squirrel-startup/index.js":(e,t,r)=>{var s=r("path"),o=r("child_process").spawn,n=r("./node_modules/electron-squirrel-startup/node_modules/debug/src/index.js")("electron-squirrel-startup"),i=r("electron").app,a=function(e,t){var r=s.resolve(s.dirname(process.execPath),"..","Update.exe");n("Spawning `%s` with args `%s`",r,e),o(r,e,{detached:!0}).on("close",t)};e.exports=function(){if("win32"===process.platform){var e=process.argv[1];n("processing squirrel command `%s`",e);var t=s.basename(process.execPath);if("--squirrel-install"===e||"--squirrel-updated"===e)return a(["--createShortcut="+t],i.quit),!0;if("--squirrel-uninstall"===e)return a(["--removeShortcut="+t],i.quit),!0;if("--squirrel-obsolete"===e)return i.quit(),!0}return!1}()},"./node_modules/electron-squirrel-startup/node_modules/debug/src/browser.js":(e,t,r)=>{function s(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=r("./node_modules/electron-squirrel-startup/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var s="color: "+this.color;e.splice(1,0,s,"color: inherit");var o=0,n=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(n=o))}),e.splice(n,0,s)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=s,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(s())},"./node_modules/electron-squirrel-startup/node_modules/debug/src/debug.js":(e,t,r)=>{var s;function o(e){function r(){if(r.enabled){var e=r,o=+new Date,n=o-(s||o);e.diff=n,e.prev=s,e.curr=o,s=o;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var c=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(r,s){if("%%"===r)return r;c++;var o=t.formatters[s];if("function"==typeof o){var n=i[c];r=o.call(e,n),i.splice(c,1),c--}return r}),t.formatArgs.call(e,i),(r.log||t.log||console.log.bind(console)).apply(e,i)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,s=0;for(r in e)s=(s<<5)-s+e.charCodeAt(r),s|=0;return t.colors[Math.abs(s)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),s=r.length,o=0;o<s;o++)r[o]&&("-"===(e=r[o].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,s;for(r=0,s=t.skips.length;r<s;r++)if(t.skips[r].test(e))return!1;for(r=0,s=t.names.length;r<s;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r("./node_modules/electron-squirrel-startup/node_modules/ms/index.js"),t.names=[],t.skips=[],t.formatters={}},"./node_modules/electron-squirrel-startup/node_modules/debug/src/index.js":(e,t,r)=>{"undefined"!=typeof process&&"renderer"===process.type?e.exports=r("./node_modules/electron-squirrel-startup/node_modules/debug/src/browser.js"):e.exports=r("./node_modules/electron-squirrel-startup/node_modules/debug/src/node.js")},"./node_modules/electron-squirrel-startup/node_modules/debug/src/node.js":(e,t,r)=>{var s=r("tty"),o=r("util");(t=e.exports=r("./node_modules/electron-squirrel-startup/node_modules/debug/src/debug.js")).init=function(e){e.inspectOpts={};for(var r=Object.keys(t.inspectOpts),s=0;s<r.length;s++)e.inspectOpts[r[s]]=t.inspectOpts[r[s]]},t.log=function(){return i.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function(e){var r=this.namespace,s=this.useColors;if(s){var o=this.color,n="  [3"+o+";1m"+r+" [0m";e[0]=n+e[0].split("\n").join("\n"+n),e.push("[3"+o+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(new Date).toUTCString()+" "+r+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=a,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):s.isatty(n)},t.colors=[6,2,3,4,5,1],t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var r=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),s=process.env[t];return s=!!/^(yes|on|true|enabled)$/i.test(s)||!/^(no|off|false|disabled)$/i.test(s)&&("null"===s?null:Number(s)),e[r]=s,e},{});var n=parseInt(process.env.DEBUG_FD,10)||2;1!==n&&2!==n&&o.deprecate(function(){},"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var i=1===n?process.stdout:2===n?process.stderr:function(e){var t;switch(process.binding("tty_wrap").guessHandleType(e)){case"TTY":(t=new s.WriteStream(e))._type="tty",t._handle&&t._handle.unref&&t._handle.unref();break;case"FILE":(t=new(r("fs").SyncWriteStream)(e,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":(t=new(r("net").Socket)({fd:e,readable:!1,writable:!0})).readable=!1,t.read=null,t._type="pipe",t._handle&&t._handle.unref&&t._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return t.fd=e,t._isStdio=!0,t}(n);function a(){return process.env.DEBUG}t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map(function(e){return e.trim()}).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)},t.enable(a())},"./node_modules/electron-squirrel-startup/node_modules/ms/index.js":e=>{var t=1e3,r=60*t,s=60*r,o=24*s,n=365.25*o;function i(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,a){a=a||{};var c,l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var i=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!i)return;var a=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*n;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*s;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===l&&!1===isNaN(e))return a.long?i(c=e,o,"day")||i(c,s,"hour")||i(c,r,"minute")||i(c,t,"second")||c+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=s)return Math.round(e/s)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"./node_modules/fast-content-type-parse/index.js":e=>{"use strict";const t=function(){};t.prototype=Object.create(null);const r=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,s=/\\([\v\u0020-\u00ff])/gu,o=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,n={type:"",parameters:new t};function i(e){if("string"!=typeof e)throw new TypeError("argument header is required and must be a string");let n=e.indexOf(";");const i=-1!==n?e.slice(0,n).trim():e.trim();if(!1===o.test(i))throw new TypeError("invalid media type");const a={type:i.toLowerCase(),parameters:new t};if(-1===n)return a;let c,l,u;for(r.lastIndex=n;l=r.exec(e);){if(l.index!==n)throw new TypeError("invalid parameter format");n+=l[0].length,c=l[1].toLowerCase(),u=l[2],'"'===u[0]&&(u=u.slice(1,u.length-1),s.test(u)&&(u=u.replace(s,"$1"))),a.parameters[c]=u}if(n!==e.length)throw new TypeError("invalid parameter format");return a}function a(e){if("string"!=typeof e)return n;let i=e.indexOf(";");const a=-1!==i?e.slice(0,i).trim():e.trim();if(!1===o.test(a))return n;const c={type:a.toLowerCase(),parameters:new t};if(-1===i)return c;let l,u,d;for(r.lastIndex=i;u=r.exec(e);){if(u.index!==i)return n;i+=u[0].length,l=u[1].toLowerCase(),d=u[2],'"'===d[0]&&(d=d.slice(1,d.length-1),s.test(d)&&(d=d.replace(s,"$1"))),c.parameters[l]=d}return i!==e.length?n:c}Object.freeze(n.parameters),Object.freeze(n),e.exports.safeParse=a},"./node_modules/lowdb/lib/adapters/Memory.js":(e,t,r)=>{"use strict"},"./node_modules/lowdb/lib/adapters/node/DataFile.js":(e,t,r)=>{"use strict";r.d(t,{DataFile:()=>o,DataFileSync:()=>n});var s=r("./node_modules/lowdb/lib/adapters/node/TextFile.js");class o{#e;#t;#r;constructor(e,{parse:t,stringify:r}){this.#e=new s.TextFile(e),this.#t=t,this.#r=r}async read(){const e=await this.#e.read();return null===e?null:this.#t(e)}write(e){return this.#e.write(this.#r(e))}}class n{#e;#t;#r;constructor(e,{parse:t,stringify:r}){this.#e=new s.TextFileSync(e),this.#t=t,this.#r=r}read(){const e=this.#e.read();return null===e?null:this.#t(e)}write(e){this.#e.write(this.#r(e))}}},"./node_modules/lowdb/lib/adapters/node/JSONFile.js":(e,t,r)=>{"use strict";r.d(t,{JSONFile:()=>o,JSONFileSync:()=>n});var s=r("./node_modules/lowdb/lib/adapters/node/DataFile.js");class o extends s.DataFile{constructor(e){super(e,{parse:JSON.parse,stringify:e=>JSON.stringify(e,null,2)})}}class n extends s.DataFileSync{constructor(e){super(e,{parse:JSON.parse,stringify:e=>JSON.stringify(e,null,2)})}}},"./node_modules/lowdb/lib/adapters/node/TextFile.js":(e,t,r)=>{"use strict";r.d(t,{TextFile:()=>a,TextFileSync:()=>c});var s=r("node:fs"),o=r("node:fs/promises"),n=r("node:path"),i=r("./node_modules/steno/lib/index.js");class a{#s;#o;constructor(e){this.#s=e,this.#o=new i.Writer(e)}async read(){let e;try{e=await(0,o.readFile)(this.#s,"utf-8")}catch(e){if("ENOENT"===e.code)return null;throw e}return e}write(e){return this.#o.write(e)}}class c{#n;#s;constructor(e){this.#s=e;const t=e.toString();this.#n=n.join(n.dirname(t),`.${n.basename(t)}.tmp`)}read(){let e;try{e=(0,s.readFileSync)(this.#s,"utf-8")}catch(e){if("ENOENT"===e.code)return null;throw e}return e}write(e){(0,s.writeFileSync)(this.#n,e),(0,s.renameSync)(this.#n,this.#s)}}},"./node_modules/lowdb/lib/core/Low.js":(e,t,r)=>{"use strict";function s(e,t){if(void 0===e)throw new Error("lowdb: missing adapter");if(void 0===t)throw new Error("lowdb: missing default data")}r.d(t,{Low:()=>o,LowSync:()=>n});class o{adapter;data;constructor(e,t){s(e,t),this.adapter=e,this.data=t}async read(){const e=await this.adapter.read();e&&(this.data=e)}async write(){this.data&&await this.adapter.write(this.data)}async update(e){e(this.data),await this.write()}}class n{adapter;data;constructor(e,t){s(e,t),this.adapter=e,this.data=t}read(){const e=this.adapter.read();e&&(this.data=e)}write(){this.data&&this.adapter.write(this.data)}update(e){e(this.data),this.write()}}},"./node_modules/lowdb/lib/index.js":(e,t,r)=>{"use strict";r.d(t,{Low:()=>s.Low});r("./node_modules/lowdb/lib/adapters/Memory.js");var s=r("./node_modules/lowdb/lib/core/Low.js")},"./node_modules/lowdb/lib/node.js":(e,t,r)=>{"use strict";r.d(t,{JSONFile:()=>s.JSONFile});r("./node_modules/lowdb/lib/adapters/node/DataFile.js");var s=r("./node_modules/lowdb/lib/adapters/node/JSONFile.js");r("./node_modules/lowdb/lib/adapters/node/TextFile.js"),r("./node_modules/lowdb/lib/presets/node.js")},"./node_modules/lowdb/lib/presets/node.js":(e,t,r)=>{"use strict";r("./node_modules/lowdb/lib/adapters/Memory.js"),r("./node_modules/lowdb/lib/adapters/node/JSONFile.js"),r("./node_modules/lowdb/lib/core/Low.js")},"./node_modules/octokit/dist-bundle/index.js":(e,t,r)=>{"use strict";r.d(t,{Octokit:()=>d});var s=r("./node_modules/@octokit/core/dist-src/index.js"),o=r("./node_modules/@octokit/plugin-paginate-rest/dist-bundle/index.js"),n=r("./node_modules/@octokit/plugin-paginate-graphql/dist-bundle/index.js"),i=r("./node_modules/@octokit/plugin-rest-endpoint-methods/dist-src/index.js"),a=r("./node_modules/@octokit/plugin-retry/dist-bundle/index.js"),c=r("./node_modules/@octokit/plugin-throttling/dist-bundle/index.js"),l=r("./node_modules/@octokit/app/dist-node/index.js"),u=r("./node_modules/@octokit/oauth-app/dist-node/index.js"),d=s.Octokit.plugin(i.restEndpointMethods,o.paginateRest,n.paginateGraphQL,a.retry,c.throttling).defaults({userAgent:"octokit.js/0.0.0-development",throttle:{onRateLimit:function(e,t,r){if(r.log.warn(`Request quota exhausted for request ${t.method} ${t.url}`),0===t.request.retryCount)return r.log.info(`Retrying after ${e} seconds!`),!0},onSecondaryRateLimit:function(e,t,r){if(r.log.warn(`SecondaryRateLimit detected for request ${t.method} ${t.url}`),0===t.request.retryCount)return r.log.info(`Retrying after ${e} seconds!`),!0}}});l.App.defaults({Octokit:d}),u.OAuthApp.defaults({Octokit:d})},"./node_modules/papaparse/papaparse.js":function(e,t,r){var s;s=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},s=!t.document&&!!t.postMessage,o=t.IS_PAPA_WORKER||!1,n={},i=0,a={parse:function(r,s){var o=(s=s||{}).dynamicTyping||!1;if(_(o)&&(s.dynamicTypingFunction=o,o={}),s.dynamicTyping=o,s.transform=!!_(s.transform)&&s.transform,s.worker&&a.WORKERS_SUPPORTED){var c=function(){if(!a.WORKERS_SUPPORTED)return!1;var r=function(){var r=t.URL||t.webkitURL||null,s=e.toString();return a.BLOB_URL||(a.BLOB_URL=r.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",s,")();"],{type:"text/javascript"})))}(),s=new t.Worker(r);return s.onmessage=v,s.id=i++,n[s.id]=s,s}();return c.userStep=s.step,c.userChunk=s.chunk,c.userComplete=s.complete,c.userError=s.error,s.step=_(s.step),s.chunk=_(s.chunk),s.complete=_(s.complete),s.error=_(s.error),delete s.worker,void c.postMessage({input:r,config:s,workerId:c.id})}var l,g=null;return r===a.NODE_STREAM_INPUT&&"undefined"==typeof PAPA_BROWSER_CONTEXT?(g=new m(s)).getStream():("string"==typeof r?(r=65279===(l=r).charCodeAt(0)?l.slice(1):l,g=s.download?new u(s):new p(s)):!0===r.readable&&_(r.read)&&_(r.on)?g=new h(s):(t.File&&r instanceof File||r instanceof Object)&&(g=new d(s)),g.stream(r))},unparse:function(e,t){var r=!1,s=!0,o=",",n="\r\n",i='"',c=i+i,l=!1,u=null,d=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(o=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(l=t.skipEmptyLines),"string"==typeof t.newline&&(n=t.newline),"string"==typeof t.quoteChar&&(i=t.quoteChar),"boolean"==typeof t.header&&(s=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");u=t.columns}void 0!==t.escapeChar&&(c=t.escapeChar+i),t.escapeFormulae instanceof RegExp?d=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(d=/^[=+\-@\t\r].*$/)}}();var p=new RegExp(f(i),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return h(null,e,l);if("object"==typeof e[0])return h(u||Object.keys(e[0]),e,l)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||u),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),h(e.fields||[],e.data||[],l);throw new Error("Unable to serialize unrecognized input");function h(e,t,r){var i="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var a=Array.isArray(e)&&e.length>0,c=!Array.isArray(t[0]);if(a&&s){for(var l=0;l<e.length;l++)l>0&&(i+=o),i+=m(e[l],l);t.length>0&&(i+=n)}for(var u=0;u<t.length;u++){var d=a?e.length:t[u].length,p=!1,h=a?0===Object.keys(t[u]).length:0===t[u].length;if(r&&!a&&(p="greedy"===r?""===t[u].join("").trim():1===t[u].length&&0===t[u][0].length),"greedy"===r&&a){for(var g=[],f=0;f<d;f++){var y=c?e[f]:f;g.push(t[u][y])}p=""===g.join("").trim()}if(!p){for(var v=0;v<d;v++){v>0&&!h&&(i+=o);var w=a&&c?e[v]:v;i+=m(t[u][w],v)}u<t.length-1&&(!r||d>0&&!h)&&(i+=n)}}return i}function m(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var s=!1;d&&"string"==typeof e&&d.test(e)&&(e="'"+e,s=!0);var n=e.toString().replace(p,c);return s=s||!0===r||"function"==typeof r&&r(e,t)||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return!0;return!1}(n,a.BAD_DELIMITERS)||n.indexOf(o)>-1||" "===n.charAt(0)||" "===n.charAt(n.length-1),s?i+n+i:n}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!s&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=y,a.ParserHandle=g,a.NetworkStreamer=u,a.FileStreamer=d,a.StringStreamer=p,a.ReadableStreamStreamer=h,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(a.DuplexStreamStreamer=m),t.jQuery){var c=t.jQuery;c.fn.parse=function(e){var r=e.config||{},s=[];return this.each(function(e){if("INPUT"!==c(this).prop("tagName").toUpperCase()||"file"!==c(this).attr("type").toLowerCase()||!t.FileReader||!this.files||0===this.files.length)return!0;for(var o=0;o<this.files.length;o++)s.push({file:this.files[o],inputElem:this,instanceConfig:c.extend({},r)})}),o(),this;function o(){if(0!==s.length){var t,r,o,i,l=s[0];if(_(e.before)){var u=e.before(l.file,l.inputElem);if("object"==typeof u){if("abort"===u.action)return t="AbortError",r=l.file,o=l.inputElem,i=u.reason,void(_(e.error)&&e.error({name:t},r,o,i));if("skip"===u.action)return void n();"object"==typeof u.config&&(l.instanceConfig=c.extend(l.instanceConfig,u.config))}else if("skip"===u)return void n()}var d=l.instanceConfig.complete;l.instanceConfig.complete=function(e){_(d)&&d(e,l.file,l.inputElem),n()},a.parse(l.file,l.instanceConfig)}else _(e.complete)&&e.complete()}function n(){s.splice(0,1),o()}}}function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=S(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new g(t),this._handle.streamer=this,this._config=t}.call(this,e),this.parseChunk=function(e,r){const s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&s>0){let t=this._config.newline;if(!t){const r=this._config.quoteChar||'"';t=this._handle.guessLineEndings(e,r)}const r=e.split(t);e=[...r.slice(s)].join(t)}if(this.isFirstChunk&&_(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(e);void 0!==n&&(e=n)}this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+e;this._partialLine="";var c=this._handle.parse(i,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var l=c.meta.cursor;this._finished||(this._partialLine=i.substring(l-this._baseIndex),this._baseIndex=l),c&&c.data&&(this._rowCount+=c.data.length);var u=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)t.postMessage({results:c,workerId:a.WORKER_ID,finished:u});else if(_(this._config.chunk)&&!r){if(this._config.chunk(c,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);c=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(c.data),this._completeResults.errors=this._completeResults.errors.concat(c.errors),this._completeResults.meta=c.meta),this._completed||!u||!_(this._config.complete)||c&&c.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||c&&c.meta.paused||this._nextChunk(),c}this._halted=!0},this._sendError=function(e){_(this._config.error)?this._config.error(e):o&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function u(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),l.call(this,e),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),s||(t.onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var o=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+o)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}s&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||t.status>=400?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var r=t.statusText||e;this._sendError(new Error(r))}}function d(e){var t,r;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),l.call(this,e);var s="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,s?((t=new FileReader).onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var o=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,o)}var n=t.readAsText(e,this._config.encoding);s||this._chunkLoaded({target:{result:n}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function p(e){var t;e=e||{},l.call(this,e),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,r=this._config.chunkSize;return r?(e=t.substring(0,r),t=t.substring(r)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function h(e){e=e||{},l.call(this,e);var t=[],r=!0,s=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=b(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=b(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=b(function(){this._streamCleanUp(),s=!0,this._streamData("")},this),this._streamCleanUp=b(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(e){var t=r("stream").Duplex,s=S(e),o=!0,n=!1,i=[],a=null;this._onCsvData=function(e){var t=e.data;a.push(t)||this._handle.paused()||this._handle.pause()},this._onCsvComplete=function(){a.push(null)},s.step=b(this._onCsvData,this),s.complete=b(this._onCsvComplete,this),l.call(this,s),this._nextChunk=function(){n&&1===i.length&&(this._finished=!0),i.length?i.shift()():o=!0},this._addToParseQueue=function(e,t){i.push(b(function(){if(this.parseChunk("string"==typeof e?e:e.toString(s.encoding)),_(t))return t()},this)),o&&(o=!1,this._nextChunk())},this._onRead=function(){this._handle.paused()&&this._handle.resume()},this._onWrite=function(e,t,r){this._addToParseQueue(e,r)},this._onWriteComplete=function(){n=!0,this._addToParseQueue("")},this.getStream=function(){return a},(a=new t({readableObjectMode:!0,decodeStrings:!1,read:b(this._onRead,this),write:b(this._onWrite,this)})).once("finish",b(this._onWriteComplete,this))}function g(e){var t,r,s,o=Math.pow(2,53),n=-o,i=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,c=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,u=0,d=0,p=!1,h=!1,m=[],g={data:[],errors:[],meta:{}};if(_(e.step)){var v=e.step;e.step=function(t){if(g=t,b())E();else{if(E(),0===g.data.length)return;u+=t.data.length,e.preview&&u>e.preview?r.abort():(g.data=g.data[0],v(g,l))}}}function w(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function E(){return g&&s&&(C("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(g.data=g.data.filter(function(e){return!w(e)})),b()&&function(){if(g)if(Array.isArray(g.data[0])){for(var t=0;b()&&t<g.data.length;t++)g.data[t].forEach(r);g.data.splice(0,1)}else g.data.forEach(r);function r(t,r){_(e.transformHeader)&&(t=e.transformHeader(t,r)),m.push(t)}}(),function(){if(!g||!e.header&&!e.dynamicTyping&&!e.transform)return g;function t(t,r){var s,o=e.header?{}:[];for(s=0;s<t.length;s++){var n=s,i=t[s];e.header&&(n=s>=m.length?"__parsed_extra":m[s]),e.transform&&(i=e.transform(i,n)),i=T(n,i),"__parsed_extra"===n?(o[n]=o[n]||[],o[n].push(i)):o[n]=i}return e.header&&(s>m.length?C("FieldMismatch","TooManyFields","Too many fields: expected "+m.length+" fields but parsed "+s,d+r):s<m.length&&C("FieldMismatch","TooFewFields","Too few fields: expected "+m.length+" fields but parsed "+s,d+r)),o}var r=1;return!g.data.length||Array.isArray(g.data[0])?(g.data=g.data.map(t),r=g.data.length):g.data=t(g.data,0),e.header&&g.meta&&(g.meta.fields=m),d+=r,g}()}function b(){return e.header&&0===m.length}function T(t,r){return function(t){return e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)}(t)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(function(e){if(i.test(e)){var t=parseFloat(e);if(t>n&&t<o)return!0}return!1}(r)?parseFloat(r):c.test(r)?new Date(r):""===r?null:r):r}function C(e,t,r,s){var o={type:e,code:t,message:r};void 0!==s&&(o.row=s),g.errors.push(o)}this.parse=function(o,n,i){var c=e.quoteChar||'"';if(e.newline||(e.newline=this.guessLineEndings(o,c)),s=!1,e.delimiter)_(e.delimiter)&&(e.delimiter=e.delimiter(o),g.meta.delimiter=e.delimiter);else{var l=function(t,r,s,o,n){var i,c,l,u;n=n||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<n.length;d++){var p=n[d],h=0,m=0,g=0;l=void 0;for(var f=new y({comments:o,delimiter:p,newline:r,preview:10}).parse(t),v=0;v<f.data.length;v++)if(s&&w(f.data[v]))g++;else{var E=f.data[v].length;m+=E,void 0!==l?E>0&&(h+=Math.abs(E-l),l=E):l=E}f.data.length>0&&(m/=f.data.length-g),(void 0===c||h<=c)&&(void 0===u||m>u)&&m>1.99&&(c=h,i=p,u=m)}return e.delimiter=i,{successful:!!i,bestDelimiter:i}}(o,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);l.successful?e.delimiter=l.bestDelimiter:(s=!0,e.delimiter=a.DefaultDelimiter),g.meta.delimiter=e.delimiter}var u=S(e);return e.preview&&e.header&&u.preview++,t=o,r=new y(u),g=r.parse(t,n,i),E(),p?{meta:{paused:!0}}:g||{meta:{paused:!1}}},this.paused=function(){return p},this.pause=function(){p=!0,r.abort(),t=_(e.chunk)?"":t.substring(r.getCharIndex())},this.resume=function(){l.streamer._halted?(p=!1,l.streamer.parseChunk(t,!0)):setTimeout(l.resume,3)},this.aborted=function(){return h},this.abort=function(){h=!0,r.abort(),g.meta.aborted=!0,_(e.complete)&&e.complete(g),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576);var r=new RegExp(f(t)+"([^]*?)"+f(t),"gm"),s=(e=e.replace(r,"")).split("\r"),o=e.split("\n"),n=o.length>1&&o[0].length<s[0].length;if(1===s.length||n)return"\n";for(var i=0,a=0;a<s.length;a++)"\n"===s[a][0]&&i++;return i>=s.length/2?"\r\n":"\r"}}function f(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(e){var t,r=(e=e||{}).delimiter,s=e.newline,o=e.comments,n=e.step,i=e.preview,c=e.fastMode,l=null,u=!1,d=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(d=e.escapeChar),("string"!=typeof r||a.BAD_DELIMITERS.indexOf(r)>-1)&&(r=","),o===r)throw new Error("Comment character same as delimiter");!0===o?o="#":("string"!=typeof o||a.BAD_DELIMITERS.indexOf(o)>-1)&&(o=!1),"\n"!==s&&"\r"!==s&&"\r\n"!==s&&(s="\n");var p=0,h=!1;this.parse=function(a,m,g){if("string"!=typeof a)throw new Error("Input must be a string");var y=a.length,v=r.length,w=s.length,E=o.length,S=_(n);p=0;var b=[],T=[],C=[],I=0;if(!a)return L();if(c||!1!==c&&-1===a.indexOf(t)){for(var k=a.split(s),P=0;P<k.length;P++){if(C=k[P],p+=C.length,P!==k.length-1)p+=s.length;else if(g)return L();if(!o||C.substring(0,E)!==o){if(S){if(b=[],M(C.split(r)),U(),h)return L()}else M(C.split(r));if(i&&P>=i)return b=b.slice(0,i),L(!0)}}return L()}for(var A=a.indexOf(r,p),D=a.indexOf(s,p),O=new RegExp(f(d)+f(t),"g"),$=a.indexOf(t,p);;)if(a[p]!==t)if(o&&0===C.length&&a.substring(p,p+E)===o){if(-1===D)return L();p=D+w,D=a.indexOf(s,p),A=a.indexOf(r,p)}else if(-1!==A&&(A<D||-1===D))C.push(a.substring(p,A)),p=A+v,A=a.indexOf(r,p);else{if(-1===D)break;if(C.push(a.substring(p,D)),N(D+w),S&&(U(),h))return L();if(i&&b.length>=i)return L(!0)}else for($=p,p++;;){if(-1===($=a.indexOf(t,$+1)))return g||T.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:b.length,index:p}),F();if($===y-1)return F(a.substring(p,$).replace(O,t));if(t!==d||a[$+1]!==d){if(t===d||0===$||a[$-1]!==d){-1!==A&&A<$+1&&(A=a.indexOf(r,$+1)),-1!==D&&D<$+1&&(D=a.indexOf(s,$+1));var R=j(-1===D?A:Math.min(A,D));if(a.substr($+1+R,v)===r){C.push(a.substring(p,$).replace(O,t)),p=$+1+R+v,a[$+1+R+v]!==t&&($=a.indexOf(t,p)),A=a.indexOf(r,p),D=a.indexOf(s,p);break}var x=j(D);if(a.substring($+1+x,$+1+x+w)===s){if(C.push(a.substring(p,$).replace(O,t)),N($+1+x+w),A=a.indexOf(r,p),$=a.indexOf(t,p),S&&(U(),h))return L();if(i&&b.length>=i)return L(!0);break}T.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:b.length,index:p}),$++}}else $++}return F();function M(e){b.push(e),I=p}function j(e){var t=0;if(-1!==e){var r=a.substring($+1,e);r&&""===r.trim()&&(t=r.length)}return t}function F(e){return g||(void 0===e&&(e=a.substring(p)),C.push(e),p=y,M(C),S&&U()),L()}function N(e){p=e,M(C),C=[],D=a.indexOf(s,p)}function L(t){if(e.header&&!m&&b.length&&!u){const t=b[0],r=Object.create(null),s=new Set(t);let o=!1;for(let n=0;n<t.length;n++){let i=t[n];if(_(e.transformHeader)&&(i=e.transformHeader(i,n)),r[i]){let e,a=r[i];do{e=`${i}_${a}`,a++}while(s.has(e));s.add(e),t[n]=e,r[i]++,o=!0,null===l&&(l={}),l[e]=i}else r[i]=1,t[n]=i;s.add(i)}o&&console.warn("Duplicate headers found and renamed."),u=!0}return{data:b,errors:T,meta:{delimiter:r,linebreak:s,aborted:h,truncated:!!t,cursor:I+(m||0),renamedHeaders:l}}}function U(){n(L()),b=[],T=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return p}}function v(e){var t=e.data,r=n[t.workerId],s=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){s=!0,w(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:E,resume:E};if(_(r.userStep)){for(var i=0;i<t.results.data.length&&(r.userStep({data:t.results.data[i],errors:t.results.errors,meta:t.results.meta},o),!s);i++);delete t.results}else _(r.userChunk)&&(r.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!s&&w(t.workerId,t.results)}function w(e,t){var r=n[e];_(r.userComplete)&&r.userComplete(t),r.terminate(),delete n[e]}function E(){throw new Error("Not implemented.")}function S(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=S(e[r]);return t}function b(e,t){return function(){e.apply(t,arguments)}}function _(e){return"function"==typeof e}return o&&(t.onmessage=function(e){var r=e.data;if(void 0===a.WORKER_ID&&r&&(a.WORKER_ID=r.workerId),"string"==typeof r.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(r.input,r.config),finished:!0});else if(t.File&&r.input instanceof File||r.input instanceof Object){var s=a.parse(r.input,r.config);s&&t.postMessage({workerId:a.WORKER_ID,results:s,finished:!0})}}),u.prototype=Object.create(l.prototype),u.prototype.constructor=u,d.prototype=Object.create(l.prototype),d.prototype.constructor=d,p.prototype=Object.create(p.prototype),p.prototype.constructor=p,h.prototype=Object.create(l.prototype),h.prototype.constructor=h,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(m.prototype=Object.create(l.prototype),m.prototype.constructor=m),a},"function"==typeof define&&define.amd?define([],s):e.exports=s()},"./node_modules/semver/classes/comparator.js":(e,t,r)=>{"use strict";const s=Symbol("SemVer ANY");class o{static get ANY(){return s}constructor(e,t){if(t=n(t),e instanceof o){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===s?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?i[a.COMPARATORLOOSE]:i[a.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new u(r[2],this.options.loose):this.semver=s}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===s||e===s)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return c(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof o))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):(!(t=n(t)).includePrerelease||"<0.0.0-0"!==this.value&&"<0.0.0-0"!==e.value)&&(!(!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0")))&&(!(!this.operator.startsWith(">")||!e.operator.startsWith(">"))||(!(!this.operator.startsWith("<")||!e.operator.startsWith("<"))||(!(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))||(!!(c(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))||!!(c(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))))))}}e.exports=o;const n=r("./node_modules/semver/internal/parse-options.js"),{safeRe:i,t:a}=r("./node_modules/semver/internal/re.js"),c=r("./node_modules/semver/functions/cmp.js"),l=r("./node_modules/semver/internal/debug.js"),u=r("./node_modules/semver/classes/semver.js"),d=r("./node_modules/semver/classes/range.js")},"./node_modules/semver/classes/range.js":(e,t,r)=>{"use strict";const s=/\s+/g;class o{constructor(e,t){if(t=i(t),e instanceof o)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new o(e.raw,t);if(e instanceof a)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(s," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!y(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&v(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&g)|(this.options.loose&&f))+":"+e,r=n.get(t);if(r)return r;const s=this.options.loose,o=s?u[d.HYPHENRANGELOOSE]:u[d.HYPHENRANGE];e=e.replace(o,D(this.options.includePrerelease)),c("hyphen replace",e),e=e.replace(u[d.COMPARATORTRIM],p),c("comparator trim",e),e=e.replace(u[d.TILDETRIM],h),c("tilde trim",e),e=e.replace(u[d.CARETTRIM],m),c("caret trim",e);let i=e.split(" ").map(e=>E(e,this.options)).join(" ").split(/\s+/).map(e=>A(e,this.options));s&&(i=i.filter(e=>(c("loose invalid filter",e,this.options),!!e.match(u[d.COMPARATORLOOSE])))),c("range list",i);const l=new Map,v=i.map(e=>new a(e,this.options));for(const e of v){if(y(e))return[e];l.set(e.value,e)}l.size>1&&l.has("")&&l.delete("");const w=[...l.values()];return n.set(t,w),w}intersects(e,t){if(!(e instanceof o))throw new TypeError("a Range is required");return this.set.some(r=>w(r,t)&&e.set.some(e=>w(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(O(this.set[t],e,this.options))return!0;return!1}}e.exports=o;const n=new(r("./node_modules/semver/internal/lrucache.js")),i=r("./node_modules/semver/internal/parse-options.js"),a=r("./node_modules/semver/classes/comparator.js"),c=r("./node_modules/semver/internal/debug.js"),l=r("./node_modules/semver/classes/semver.js"),{safeRe:u,t:d,comparatorTrimReplace:p,tildeTrimReplace:h,caretTrimReplace:m}=r("./node_modules/semver/internal/re.js"),{FLAG_INCLUDE_PRERELEASE:g,FLAG_LOOSE:f}=r("./node_modules/semver/internal/constants.js"),y=e=>"<0.0.0-0"===e.value,v=e=>""===e.value,w=(e,t)=>{let r=!0;const s=e.slice();let o=s.pop();for(;r&&s.length;)r=s.every(e=>o.intersects(e,t)),o=s.pop();return r},E=(e,t)=>(e=e.replace(u[d.BUILD],""),c("comp",e,t),e=T(e,t),c("caret",e),e=b(e,t),c("tildes",e),e=I(e,t),c("xrange",e),e=P(e,t),c("stars",e),e),S=e=>!e||"x"===e.toLowerCase()||"*"===e,b=(e,t)=>e.trim().split(/\s+/).map(e=>_(e,t)).join(" "),_=(e,t)=>{const r=t.loose?u[d.TILDELOOSE]:u[d.TILDE];return e.replace(r,(t,r,s,o,n)=>{let i;return c("tilde",e,t,r,s,o,n),S(r)?i="":S(s)?i=`>=${r}.0.0 <${+r+1}.0.0-0`:S(o)?i=`>=${r}.${s}.0 <${r}.${+s+1}.0-0`:n?(c("replaceTilde pr",n),i=`>=${r}.${s}.${o}-${n} <${r}.${+s+1}.0-0`):i=`>=${r}.${s}.${o} <${r}.${+s+1}.0-0`,c("tilde return",i),i})},T=(e,t)=>e.trim().split(/\s+/).map(e=>C(e,t)).join(" "),C=(e,t)=>{c("caret",e,t);const r=t.loose?u[d.CARETLOOSE]:u[d.CARET],s=t.includePrerelease?"-0":"";return e.replace(r,(t,r,o,n,i)=>{let a;return c("caret",e,t,r,o,n,i),S(r)?a="":S(o)?a=`>=${r}.0.0${s} <${+r+1}.0.0-0`:S(n)?a="0"===r?`>=${r}.${o}.0${s} <${r}.${+o+1}.0-0`:`>=${r}.${o}.0${s} <${+r+1}.0.0-0`:i?(c("replaceCaret pr",i),a="0"===r?"0"===o?`>=${r}.${o}.${n}-${i} <${r}.${o}.${+n+1}-0`:`>=${r}.${o}.${n}-${i} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${n}-${i} <${+r+1}.0.0-0`):(c("no pr"),a="0"===r?"0"===o?`>=${r}.${o}.${n}${s} <${r}.${o}.${+n+1}-0`:`>=${r}.${o}.${n}${s} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${n} <${+r+1}.0.0-0`),c("caret return",a),a})},I=(e,t)=>(c("replaceXRanges",e,t),e.split(/\s+/).map(e=>k(e,t)).join(" ")),k=(e,t)=>{e=e.trim();const r=t.loose?u[d.XRANGELOOSE]:u[d.XRANGE];return e.replace(r,(r,s,o,n,i,a)=>{c("xRange",e,r,s,o,n,i,a);const l=S(o),u=l||S(n),d=u||S(i),p=d;return"="===s&&p&&(s=""),a=t.includePrerelease?"-0":"",l?r=">"===s||"<"===s?"<0.0.0-0":"*":s&&p?(u&&(n=0),i=0,">"===s?(s=">=",u?(o=+o+1,n=0,i=0):(n=+n+1,i=0)):"<="===s&&(s="<",u?o=+o+1:n=+n+1),"<"===s&&(a="-0"),r=`${s+o}.${n}.${i}${a}`):u?r=`>=${o}.0.0${a} <${+o+1}.0.0-0`:d&&(r=`>=${o}.${n}.0${a} <${o}.${+n+1}.0-0`),c("xRange return",r),r})},P=(e,t)=>(c("replaceStars",e,t),e.trim().replace(u[d.STAR],"")),A=(e,t)=>(c("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),D=e=>(t,r,s,o,n,i,a,c,l,u,d,p)=>`${r=S(s)?"":S(o)?`>=${s}.0.0${e?"-0":""}`:S(n)?`>=${s}.${o}.0${e?"-0":""}`:i?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=S(l)?"":S(u)?`<${+l+1}.0.0-0`:S(d)?`<${l}.${+u+1}.0-0`:p?`<=${l}.${u}.${d}-${p}`:e?`<${l}.${u}.${+d+1}-0`:`<=${c}`}`.trim(),O=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(c(e[r].semver),e[r].semver!==a.ANY&&e[r].semver.prerelease.length>0){const s=e[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}},"./node_modules/semver/classes/semver.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/internal/debug.js"),{MAX_LENGTH:o,MAX_SAFE_INTEGER:n}=r("./node_modules/semver/internal/constants.js"),{safeRe:i,t:a}=r("./node_modules/semver/internal/re.js"),c=r("./node_modules/semver/internal/parse-options.js"),{compareIdentifiers:l}=r("./node_modules/semver/internal/identifiers.js");class u{constructor(e,t){if(t=c(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>o)throw new TypeError(`version is longer than ${o} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?i[a.LOOSE]:i[a.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<n)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),this.major<e.major?-1:this.major>e.major?1:this.minor<e.minor?-1:this.minor>e.minor?1:this.patch<e.patch?-1:this.patch>e.patch?1:0}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],o=e.prerelease[t];if(s("prerelease compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return l(r,o)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const r=this.build[t],o=e.build[t];if(s("build compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return l(r,o)}while(++t)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?i[a.PRERELEASELOOSE]:i[a.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let s=this.prerelease.length;for(;--s>=0;)"number"==typeof this.prerelease[s]&&(this.prerelease[s]++,s=-2);if(-1===s){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let s=[t,e];!1===r&&(s=[t]),0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},"./node_modules/semver/functions/clean.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/parse.js");e.exports=(e,t)=>{const r=s(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},"./node_modules/semver/functions/cmp.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/eq.js"),o=r("./node_modules/semver/functions/neq.js"),n=r("./node_modules/semver/functions/gt.js"),i=r("./node_modules/semver/functions/gte.js"),a=r("./node_modules/semver/functions/lt.js"),c=r("./node_modules/semver/functions/lte.js");e.exports=(e,t,r,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return s(e,r,l);case"!=":return o(e,r,l);case">":return n(e,r,l);case">=":return i(e,r,l);case"<":return a(e,r,l);case"<=":return c(e,r,l);default:throw new TypeError(`Invalid operator: ${t}`)}}},"./node_modules/semver/functions/coerce.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js"),o=r("./node_modules/semver/functions/parse.js"),{safeRe:n,t:i}=r("./node_modules/semver/internal/re.js");e.exports=(e,t)=>{if(e instanceof s)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){const s=t.includePrerelease?n[i.COERCERTLFULL]:n[i.COERCERTL];let o;for(;(o=s.exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&o.index+o[0].length===r.index+r[0].length||(r=o),s.lastIndex=o.index+o[1].length+o[2].length;s.lastIndex=-1}else r=e.match(t.includePrerelease?n[i.COERCEFULL]:n[i.COERCE]);if(null===r)return null;const a=r[2],c=r[3]||"0",l=r[4]||"0",u=t.includePrerelease&&r[5]?`-${r[5]}`:"",d=t.includePrerelease&&r[6]?`+${r[6]}`:"";return o(`${a}.${c}.${l}${u}${d}`,t)}},"./node_modules/semver/functions/compare-build.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js");e.exports=(e,t,r)=>{const o=new s(e,r),n=new s(t,r);return o.compare(n)||o.compareBuild(n)}},"./node_modules/semver/functions/compare-loose.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t)=>s(e,t,!0)},"./node_modules/semver/functions/compare.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js");e.exports=(e,t,r)=>new s(e,r).compare(new s(t,r))},"./node_modules/semver/functions/diff.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/parse.js");e.exports=(e,t)=>{const r=s(e,null,!0),o=s(t,null,!0),n=r.compare(o);if(0===n)return null;const i=n>0,a=i?r:o,c=i?o:r,l=!!a.prerelease.length;if(!!c.prerelease.length&&!l){if(!c.patch&&!c.minor)return"major";if(0===c.compareMain(a))return c.minor&&!c.patch?"minor":"patch"}const u=l?"pre":"";return r.major!==o.major?u+"major":r.minor!==o.minor?u+"minor":r.patch!==o.patch?u+"patch":"prerelease"}},"./node_modules/semver/functions/eq.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>0===s(e,t,r)},"./node_modules/semver/functions/gt.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>s(e,t,r)>0},"./node_modules/semver/functions/gte.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>s(e,t,r)>=0},"./node_modules/semver/functions/inc.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js");e.exports=(e,t,r,o,n)=>{"string"==typeof r&&(n=o,o=r,r=void 0);try{return new s(e instanceof s?e.version:e,r).inc(t,o,n).version}catch(e){return null}}},"./node_modules/semver/functions/lt.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>s(e,t,r)<0},"./node_modules/semver/functions/lte.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>s(e,t,r)<=0},"./node_modules/semver/functions/major.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js");e.exports=(e,t)=>new s(e,t).major},"./node_modules/semver/functions/minor.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js");e.exports=(e,t)=>new s(e,t).minor},"./node_modules/semver/functions/neq.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>0!==s(e,t,r)},"./node_modules/semver/functions/parse.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js");e.exports=(e,t,r=!1)=>{if(e instanceof s)return e;try{return new s(e,t)}catch(e){if(!r)return null;throw e}}},"./node_modules/semver/functions/patch.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js");e.exports=(e,t)=>new s(e,t).patch},"./node_modules/semver/functions/prerelease.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/parse.js");e.exports=(e,t)=>{const r=s(e,t);return r&&r.prerelease.length?r.prerelease:null}},"./node_modules/semver/functions/rcompare.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>s(t,e,r)},"./node_modules/semver/functions/rsort.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare-build.js");e.exports=(e,t)=>e.sort((e,r)=>s(r,e,t))},"./node_modules/semver/functions/satisfies.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/range.js");e.exports=(e,t,r)=>{try{t=new s(t,r)}catch(e){return!1}return t.test(e)}},"./node_modules/semver/functions/sort.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/compare-build.js");e.exports=(e,t)=>e.sort((e,r)=>s(e,r,t))},"./node_modules/semver/functions/valid.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/parse.js");e.exports=(e,t)=>{const r=s(e,t);return r?r.version:null}},"./node_modules/semver/index.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/internal/re.js"),o=r("./node_modules/semver/internal/constants.js"),n=r("./node_modules/semver/classes/semver.js"),i=r("./node_modules/semver/internal/identifiers.js"),a=r("./node_modules/semver/functions/parse.js"),c=r("./node_modules/semver/functions/valid.js"),l=r("./node_modules/semver/functions/clean.js"),u=r("./node_modules/semver/functions/inc.js"),d=r("./node_modules/semver/functions/diff.js"),p=r("./node_modules/semver/functions/major.js"),h=r("./node_modules/semver/functions/minor.js"),m=r("./node_modules/semver/functions/patch.js"),g=r("./node_modules/semver/functions/prerelease.js"),f=r("./node_modules/semver/functions/compare.js"),y=r("./node_modules/semver/functions/rcompare.js"),v=r("./node_modules/semver/functions/compare-loose.js"),w=r("./node_modules/semver/functions/compare-build.js"),E=r("./node_modules/semver/functions/sort.js"),S=r("./node_modules/semver/functions/rsort.js"),b=r("./node_modules/semver/functions/gt.js"),_=r("./node_modules/semver/functions/lt.js"),T=r("./node_modules/semver/functions/eq.js"),C=r("./node_modules/semver/functions/neq.js"),I=r("./node_modules/semver/functions/gte.js"),k=r("./node_modules/semver/functions/lte.js"),P=r("./node_modules/semver/functions/cmp.js"),A=r("./node_modules/semver/functions/coerce.js"),D=r("./node_modules/semver/classes/comparator.js"),O=r("./node_modules/semver/classes/range.js"),$=r("./node_modules/semver/functions/satisfies.js"),R=r("./node_modules/semver/ranges/to-comparators.js"),x=r("./node_modules/semver/ranges/max-satisfying.js"),M=r("./node_modules/semver/ranges/min-satisfying.js"),j=r("./node_modules/semver/ranges/min-version.js"),F=r("./node_modules/semver/ranges/valid.js"),N=r("./node_modules/semver/ranges/outside.js"),L=r("./node_modules/semver/ranges/gtr.js"),U=r("./node_modules/semver/ranges/ltr.js"),G=r("./node_modules/semver/ranges/intersects.js"),q=r("./node_modules/semver/ranges/simplify.js"),B=r("./node_modules/semver/ranges/subset.js");e.exports={parse:a,valid:c,clean:l,inc:u,diff:d,major:p,minor:h,patch:m,prerelease:g,compare:f,rcompare:y,compareLoose:v,compareBuild:w,sort:E,rsort:S,gt:b,lt:_,eq:T,neq:C,gte:I,lte:k,cmp:P,coerce:A,Comparator:D,Range:O,satisfies:$,toComparators:R,maxSatisfying:x,minSatisfying:M,minVersion:j,validRange:F,outside:N,gtr:L,ltr:U,intersects:G,simplifyRange:q,subset:B,SemVer:n,re:s.re,src:s.src,tokens:s.t,SEMVER_SPEC_VERSION:o.SEMVER_SPEC_VERSION,RELEASE_TYPES:o.RELEASE_TYPES,compareIdentifiers:i.compareIdentifiers,rcompareIdentifiers:i.rcompareIdentifiers}},"./node_modules/semver/internal/constants.js":e=>{"use strict";const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},"./node_modules/semver/internal/debug.js":e=>{"use strict";const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},"./node_modules/semver/internal/identifiers.js":e=>{"use strict";const t=/^[0-9]+$/,r=(e,r)=>{if("number"==typeof e&&"number"==typeof r)return e===r?0:e<r?-1:1;const s=t.test(e),o=t.test(r);return s&&o&&(e=+e,r=+r),e===r?0:s&&!o?-1:o&&!s?1:e<r?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},"./node_modules/semver/internal/lrucache.js":e=>{"use strict";e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},"./node_modules/semver/internal/parse-options.js":e=>{"use strict";const t=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:r},"./node_modules/semver/internal/re.js":(e,t,r)=>{"use strict";const{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:o,MAX_LENGTH:n}=r("./node_modules/semver/internal/constants.js"),i=r("./node_modules/semver/internal/debug.js"),a=(t=e.exports={}).re=[],c=t.safeRe=[],l=t.src=[],u=t.safeSrc=[],d=t.t={};let p=0;const h="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",n],[h,o]],g=(e,t,r)=>{const s=(e=>{for(const[t,r]of m)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),o=p++;i(e,o,t),d[e]=o,l[o]=t,u[o]=s,a[o]=new RegExp(t,r?"g":void 0),c[o]=new RegExp(s,r?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),g("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NONNUMERICIDENTIFIER]}|${l[d.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${h}+`),g("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`),g("FULL",`^${l[d.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`),g("LOOSE",`^${l[d.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`),g("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?`),g("COERCE",`${l[d.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",l[d.COERCEPLAIN]+`(?:${l[d.PRERELEASE]})?`+`(?:${l[d.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",l[d.COERCE],!0),g("COERCERTLFULL",l[d.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},"./node_modules/semver/ranges/gtr.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/ranges/outside.js");e.exports=(e,t,r)=>s(e,t,">",r)},"./node_modules/semver/ranges/intersects.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/range.js");e.exports=(e,t,r)=>(e=new s(e,r),t=new s(t,r),e.intersects(t,r))},"./node_modules/semver/ranges/ltr.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/ranges/outside.js");e.exports=(e,t,r)=>s(e,t,"<",r)},"./node_modules/semver/ranges/max-satisfying.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js"),o=r("./node_modules/semver/classes/range.js");e.exports=(e,t,r)=>{let n=null,i=null,a=null;try{a=new o(t,r)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(n&&-1!==i.compare(e)||(n=e,i=new s(n,r)))}),n}},"./node_modules/semver/ranges/min-satisfying.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js"),o=r("./node_modules/semver/classes/range.js");e.exports=(e,t,r)=>{let n=null,i=null,a=null;try{a=new o(t,r)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(n&&1!==i.compare(e)||(n=e,i=new s(n,r)))}),n}},"./node_modules/semver/ranges/min-version.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js"),o=r("./node_modules/semver/classes/range.js"),n=r("./node_modules/semver/functions/gt.js");e.exports=(e,t)=>{e=new o(e,t);let r=new s("0.0.0");if(e.test(r))return r;if(r=new s("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const o=e.set[t];let i=null;o.forEach(e=>{const t=new s(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!n(t,i)||(i=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),!i||r&&!n(r,i)||(r=i)}return r&&e.test(r)?r:null}},"./node_modules/semver/ranges/outside.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/semver.js"),o=r("./node_modules/semver/classes/comparator.js"),{ANY:n}=o,i=r("./node_modules/semver/classes/range.js"),a=r("./node_modules/semver/functions/satisfies.js"),c=r("./node_modules/semver/functions/gt.js"),l=r("./node_modules/semver/functions/lt.js"),u=r("./node_modules/semver/functions/lte.js"),d=r("./node_modules/semver/functions/gte.js");e.exports=(e,t,r,p)=>{let h,m,g,f,y;switch(e=new s(e,p),t=new i(t,p),r){case">":h=c,m=u,g=l,f=">",y=">=";break;case"<":h=l,m=d,g=c,f="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,p))return!1;for(let r=0;r<t.set.length;++r){const s=t.set[r];let i=null,a=null;if(s.forEach(e=>{e.semver===n&&(e=new o(">=0.0.0")),i=i||e,a=a||e,h(e.semver,i.semver,p)?i=e:g(e.semver,a.semver,p)&&(a=e)}),i.operator===f||i.operator===y)return!1;if((!a.operator||a.operator===f)&&m(e,a.semver))return!1;if(a.operator===y&&g(e,a.semver))return!1}return!0}},"./node_modules/semver/ranges/simplify.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/functions/satisfies.js"),o=r("./node_modules/semver/functions/compare.js");e.exports=(e,t,r)=>{const n=[];let i=null,a=null;const c=e.sort((e,t)=>o(e,t,r));for(const e of c){s(e,t,r)?(a=e,i||(i=e)):(a&&n.push([i,a]),a=null,i=null)}i&&n.push([i,null]);const l=[];for(const[e,t]of n)e===t?l.push(e):t||e!==c[0]?t?e===c[0]?l.push(`<=${t}`):l.push(`${e} - ${t}`):l.push(`>=${e}`):l.push("*");const u=l.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},"./node_modules/semver/ranges/subset.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/range.js"),o=r("./node_modules/semver/classes/comparator.js"),{ANY:n}=o,i=r("./node_modules/semver/functions/satisfies.js"),a=r("./node_modules/semver/functions/compare.js"),c=[new o(">=0.0.0-0")],l=[new o(">=0.0.0")],u=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===n){if(1===t.length&&t[0].semver===n)return!0;e=r.includePrerelease?c:l}if(1===t.length&&t[0].semver===n){if(r.includePrerelease)return!0;t=l}const s=new Set;let o,u,h,m,g,f,y;for(const t of e)">"===t.operator||">="===t.operator?o=d(o,t,r):"<"===t.operator||"<="===t.operator?u=p(u,t,r):s.add(t.semver);if(s.size>1)return null;if(o&&u){if(h=a(o.semver,u.semver,r),h>0)return null;if(0===h&&(">="!==o.operator||"<="!==u.operator))return null}for(const e of s){if(o&&!i(e,String(o),r))return null;if(u&&!i(e,String(u),r))return null;for(const s of t)if(!i(e,String(s),r))return!1;return!0}let v=!(!u||r.includePrerelease||!u.semver.prerelease.length)&&u.semver,w=!(!o||r.includePrerelease||!o.semver.prerelease.length)&&o.semver;v&&1===v.prerelease.length&&"<"===u.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,f=f||"<"===e.operator||"<="===e.operator,o)if(w&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===w.major&&e.semver.minor===w.minor&&e.semver.patch===w.patch&&(w=!1),">"===e.operator||">="===e.operator){if(m=d(o,e,r),m===e&&m!==o)return!1}else if(">="===o.operator&&!i(o.semver,String(e),r))return!1;if(u)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(g=p(u,e,r),g===e&&g!==u)return!1}else if("<="===u.operator&&!i(u.semver,String(e),r))return!1;if(!e.operator&&(u||o)&&0!==h)return!1}return!(o&&f&&!u&&0!==h)&&(!(u&&y&&!o&&0!==h)&&(!w&&!v))},d=(e,t,r)=>{if(!e)return t;const s=a(e.semver,t.semver,r);return s>0?e:s<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,r)=>{if(!e)return t;const s=a(e.semver,t.semver,r);return s<0?e:s>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new s(e,r),t=new s(t,r);let o=!1;e:for(const s of e.set){for(const e of t.set){const t=u(s,e,r);if(o=o||null!==t,t)continue e}if(o)return!1}return!0}},"./node_modules/semver/ranges/to-comparators.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/range.js");e.exports=(e,t)=>new s(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},"./node_modules/semver/ranges/valid.js":(e,t,r)=>{"use strict";const s=r("./node_modules/semver/classes/range.js");e.exports=(e,t)=>{try{return new s(e,t).range||"*"}catch(e){return null}}},"./node_modules/steno/lib/index.js":(e,t,r)=>{"use strict";r.d(t,{Writer:()=>i});var s=r("node:fs/promises"),o=r("node:path"),n=r("node:url");class i{#s;#n;#i=!1;#a=null;#c=null;#l=null;#u=null;#d(e){return this.#u=e,this.#l||=new Promise((e,t)=>{this.#c=[e,t]}),new Promise((e,t)=>{this.#l?.then(e).catch(t)})}async#p(e){this.#i=!0;try{await(0,s.writeFile)(this.#n,e,"utf-8"),await async function(e,t,r){for(let s=0;s<t;s++)try{return await e()}catch(e){if(!(s<t-1))throw e;await new Promise(e=>setTimeout(e,r))}}(async()=>{await(0,s.rename)(this.#n,this.#s)},10,100),this.#a?.[0]()}catch(e){throw e instanceof Error&&this.#a?.[1](e),e}finally{if(this.#i=!1,this.#a=this.#c,this.#c=this.#l=null,null!==this.#u){const e=this.#u;this.#u=null,await this.write(e)}}}constructor(e){this.#s=e,this.#n=function(e){const t=e instanceof URL?(0,n.fileURLToPath)(e):e.toString();return(0,o.join)((0,o.dirname)(t),`.${(0,o.basename)(t)}.tmp`)}(e)}async write(e){return this.#i?this.#d(e):this.#p(e)}}},"./node_modules/toad-cache/dist/toad-cache.mjs":(e,t,r)=>{"use strict";r.d(t,{Lru:()=>s});class s{constructor(e=1e3,t=0){if(isNaN(e)||e<0)throw new Error("Invalid max value");if(isNaN(t)||t<0)throw new Error("Invalid ttl value");this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this.max=e,this.ttl=t}bumpLru(e){if(this.last===e)return;const t=this.last,r=e.next,s=e.prev;this.first===e&&(this.first=r),e.next=null,e.prev=t,t.next=e,null!==s&&(s.next=r),null!==r&&(r.prev=s),this.last=e}clear(){this.items=Object.create(null),this.first=null,this.last=null,this.size=0}delete(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){const t=this.items[e];delete this.items[e],this.size--,null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}}deleteMany(e){for(var t=0;t<e.length;t++)this.delete(e[t])}evict(){if(this.size>0){const e=this.first;delete this.items[e.key],0===--this.size?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}}expiresAt(e){if(Object.prototype.hasOwnProperty.call(this.items,e))return this.items[e].expiry}get(e){if(Object.prototype.hasOwnProperty.call(this.items,e)){const t=this.items[e];return this.ttl>0&&t.expiry<=Date.now()?void this.delete(e):(this.bumpLru(t),t.value)}}getMany(e){const t=[];for(var r=0;r<e.length;r++)t.push(this.get(e[r]));return t}keys(){return Object.keys(this.items)}set(e,t){if(Object.prototype.hasOwnProperty.call(this.items,e)){const r=this.items[e];return r.value=t,r.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl,void(this.last!==r&&this.bumpLru(r))}this.max>0&&this.size===this.max&&this.evict();const r={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};this.items[e]=r,1===++this.size?this.first=r:this.last.next=r,this.last=r}}},"./node_modules/universal-github-app-jwt/index.js":(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var s=r("./node_modules/universal-github-app-jwt/lib/get-token.js");async function o({id:e,privateKey:t,now:r=Math.floor(Date.now()/1e3)}){const o=t.replace(/\\n/g,"\n"),n=r-30,i=n+600,a={iat:n,exp:i,iss:e};return{appId:e,expiration:i,token:await(0,s.getToken)({privateKey:o,payload:a})}}},"./node_modules/universal-github-app-jwt/lib/crypto-node.js":(e,t,r)=>{"use strict";r.d(t,{convertPrivateKey:()=>n,subtle:()=>s.subtle});var s=r("node:crypto"),o=r("./node_modules/universal-github-app-jwt/lib/utils.js");function n(e){return(0,o.isPkcs1)(e)?(0,s.createPrivateKey)(e).export({type:"pkcs8",format:"pem"}):e}},"./node_modules/universal-github-app-jwt/lib/get-token.js":(e,t,r)=>{"use strict";r.d(t,{getToken:()=>n});var s=r("./node_modules/universal-github-app-jwt/lib/utils.js"),o=r("./node_modules/universal-github-app-jwt/lib/crypto-node.js");async function n({privateKey:e,payload:t}){const r=(0,o.convertPrivateKey)(e);if((0,s.isPkcs1)(r))throw new Error("[universal-github-app-jwt] Private Key is in PKCS#1 format, but only PKCS#8 is supported. See https://github.com/gr2m/universal-github-app-jwt#private-key-formats");if((0,s.isOpenSsh)(r))throw new Error("[universal-github-app-jwt] Private Key is in OpenSSH format, but only PKCS#8 is supported. See https://github.com/gr2m/universal-github-app-jwt#private-key-formats");const n={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},i=(0,s.getDERfromPEM)(r),a=await o.subtle.importKey("pkcs8",i,n,!1,["sign"]),c=(0,s.getEncodedMessage)({alg:"RS256",typ:"JWT"},t),l=(0,s.string2ArrayBuffer)(c),u=await o.subtle.sign(n.name,a,l);return`${c}.${(0,s.base64encode)(u)}`}},"./node_modules/universal-github-app-jwt/lib/utils.js":(e,t,r)=>{"use strict";function s(e){return e.includes("-----BEGIN RSA PRIVATE KEY-----")}function o(e){return e.includes("-----BEGIN OPENSSH PRIVATE KEY-----")}function n(e){const t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0,s=e.length;t<s;t++)r[t]=e.charCodeAt(t);return t}function i(e){const t=e.trim().split("\n").slice(1,-1).join("");return n(atob(t))}function a(e,t){return`${u(e)}.${u(t)}`}function c(e){for(var t="",r=new Uint8Array(e),s=r.byteLength,o=0;o<s;o++)t+=String.fromCharCode(r[o]);return l(btoa(t))}function l(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function u(e){return l(btoa(JSON.stringify(e)))}r.d(t,{base64encode:()=>c,getDERfromPEM:()=>i,getEncodedMessage:()=>a,isOpenSsh:()=>o,isPkcs1:()=>s,string2ArrayBuffer:()=>n})},"./node_modules/universal-user-agent/index.js":(e,t,r)=>{"use strict";function s(){return"object"==typeof navigator&&"userAgent"in navigator?navigator.userAgent:"object"==typeof process&&void 0!==process.version?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}r.d(t,{getUserAgent:()=>s})},"./node_modules/uuid/index.js":(e,t,r)=>{var s=r("./node_modules/uuid/v1.js"),o=r("./node_modules/uuid/v4.js"),n=o;n.v1=s,n.v4=o,e.exports=n},"./node_modules/uuid/lib/bytesToUuid.js":e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var s=r||0,o=t;return[o[e[s++]],o[e[s++]],o[e[s++]],o[e[s++]],"-",o[e[s++]],o[e[s++]],"-",o[e[s++]],o[e[s++]],"-",o[e[s++]],o[e[s++]],"-",o[e[s++]],o[e[s++]],o[e[s++]],o[e[s++]],o[e[s++]],o[e[s++]]].join("")}},"./node_modules/uuid/lib/rng.js":(e,t,r)=>{var s=r("crypto");e.exports=function(){return s.randomBytes(16)}},"./node_modules/uuid/v1.js":(e,t,r)=>{var s,o,n=r("./node_modules/uuid/lib/rng.js"),i=r("./node_modules/uuid/lib/bytesToUuid.js"),a=0,c=0;e.exports=function(e,t,r){var l=t&&r||0,u=t||[],d=(e=e||{}).node||s,p=void 0!==e.clockseq?e.clockseq:o;if(null==d||null==p){var h=n();null==d&&(d=s=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=o=16383&(h[6]<<8|h[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:c+1,f=m-a+(g-c)/1e4;if(f<0&&void 0===e.clockseq&&(p=p+1&16383),(f<0||m>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=m,c=g,o=p;var y=(1e4*(268435455&(m+=122192928e5))+g)%4294967296;u[l++]=y>>>24&255,u[l++]=y>>>16&255,u[l++]=y>>>8&255,u[l++]=255&y;var v=m/4294967296*1e4&268435455;u[l++]=v>>>8&255,u[l++]=255&v,u[l++]=v>>>24&15|16,u[l++]=v>>>16&255,u[l++]=p>>>8|128,u[l++]=255&p;for(var w=0;w<6;++w)u[l+w]=d[w];return t||i(u)}},"./node_modules/uuid/v4.js":(e,t,r)=>{var s=r("./node_modules/uuid/lib/rng.js"),o=r("./node_modules/uuid/lib/bytesToUuid.js");e.exports=function(e,t,r){var n=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||s)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var a=0;a<16;++a)t[n+a]=i[a];return t||o(i)}},"./src/main/ipcHandlers.ts":(e,t,r)=>{"use strict";r.d(t,{registerIpcHandlers:()=>G,shutdownIpcHandlers:()=>B});var s=r("fs/promises"),o=r("fs"),n=r("path"),i=r("crypto"),a=r("electron"),c=r("./src/main/services/powerShellService.ts"),l=r("./src/main/services/moduleRegistry.ts"),u=r("./src/main/services/environmentDetectionService.ts"),d=r("./src/main/services/mockLogicEngineService.ts"),p=r("./src/main/services/logicEngineService.ts"),h=r("./src/main/services/projectService.ts"),m=r("./src/main/services/dashboardService.ts"),g=r("./src/main/services/profileService.ts"),f=r("./src/main/services/decisionTraceService.ts"),y=r("./src/main/services/consolidationEngine.ts"),v=r("./src/main/services/licenseService.ts"),w=r("./src/main/services/updateService.ts"),E=r("./src/main/services/configService.ts");let S,b,_,T,C,I,k,P,A,D,O,$,R;const x=new class{window=null;eventListeners=new Map;setWindow(e){if(this.cleanup(),this.window=e,e){const t=()=>{this.window=null,this.cleanup()};e.on("closed",t),this.eventListeners.set("closed",t)}}getWindow(){return this.window&&!this.window.isDestroyed()?this.window:null}hasWindow(){return null!==this.window&&!this.window.isDestroyed()}cleanup(){this.eventListeners.forEach((e,t)=>{this.window&&!this.window.isDestroyed()&&this.window.removeListener(t,e)}),this.eventListeners.clear()}};function M(){return x.getWindow()}function j(){return x.hasWindow()}const F=n.join(process.cwd(),"config","app-config.json");let N={};async function L(){try{await s.mkdir(n.dirname(F),{recursive:!0}),await s.writeFile(F,JSON.stringify(N,null,2),"utf-8")}catch(e){throw console.error(`Failed to save config: ${e instanceof Error?e.message:String(e)}`),e}}function U(e){const t=n.normalize(e);return n.resolve(t)}async function G(e){console.error("[IPC] ================================================"),console.error("[IPC] registerIpcHandlers called with window:",!!e),console.error("[IPC] ================================================"),e?(!function(e){x.setWindow(e)}(e),console.error("[IPC]  Window stored, verified:",j())):console.error("[IPC]  CRITICAL WARNING: No window provided to registerIpcHandlers!"),await async function(){console.log("Initializing IPC services...");const e=process.cwd(),t=e.endsWith("guiv2")?n.join(e,".."):"C:\\enterprisediscovery";console.log(`[IPC] PowerShell scripts base directory: ${t}`),S=new c.PowerShellExecutionService({maxPoolSize:10,minPoolSize:2,sessionTimeout:3e5,queueSize:100,enableModuleCaching:!0,defaultTimeout:6e4,scriptsBaseDir:t}),await S.initialize();const o=n.join(process.cwd(),"config","module-registry.json");b=new l.default(S,o);try{await b.loadRegistry()}catch(e){console.warn(`Could not load module registry: ${e instanceof Error?e.message:String(e)}`)}_=new u.default(S),console.log("Environment Detection Service initialized"),T=d.MockLogicEngineService.getInstance(),console.log("Mock Logic Engine Service initialized");const i=n.join("C:","discoverydata","ljpops","Raw");C=p.LogicEngineService.getInstance(i),console.log("Logic Engine Service initialized"),I=new h.ProjectService,console.log("Project Service initialized"),k=new m.DashboardService(C,I),console.log("Dashboard Service initialized"),P=new g.ProfileService,await P.initialize();const{FileSystemService:a}=await r.e("src_main_services_FileSystemService_ts").then(r.bind(r,"./src/main/services/FileSystemService.ts"));new a,console.log("Profile Service initialized"),console.log("FileSystem Service initialized");const f=await P.getCurrentProfile();if(f){console.log(`[ProfileService] Active profile found: ${f.companyName}`);const e=P.getCompanyDataPath(f.companyName),t=n.join(e,"Raw");console.log(`[ProfileService] Loading data from: ${t}`),C=p.LogicEngineService.getInstance(t),C.loadAllAsync(t).then(e=>{e?console.log(`[LogicEngine] Successfully loaded data for profile: ${f.companyName}`):console.warn(`[LogicEngine] Failed to load data for profile: ${f.companyName}`)}).catch(e=>{console.error(`[LogicEngine] Error loading data: ${e}`)})}else console.warn("[ProfileService] No active profile found - Logic Engine will use default hardcoded path");try{const e=await s.readFile(F,"utf-8");N=JSON.parse(e),console.log("Loaded application configuration")}catch(e){e instanceof Error&&"code"in e&&"ENOENT"===e.code?(console.log("No configuration file found, starting with defaults"),N={},await s.mkdir(n.dirname(F),{recursive:!0})):console.error(`Failed to load config: ${e instanceof Error?e.message:String(e)}`)}O=new E.ConfigService,await O.initialize(),console.log("Config Service initialized"),$=new v.LicenseService(O),await $.initialize(),console.log("License Service initialized"),R=new w.UpdateService(O,$),await R.initialize(),console.log("Update Service initialized"),console.log("IPC services initialized successfully")}(),console.error("[IPC] After initializeServices, window still exists:",j()),j()&&(S.on("stream:output",e=>{const t=M();t?.webContents.send("powershell:stream:output",e)}),S.on("stream:error",e=>{const t=M();t?.webContents.send("powershell:stream:error",e)}),S.on("stream:warning",e=>{const t=M();t?.webContents.send("powershell:stream:warning",e)}),S.on("stream:verbose",e=>{const t=M();t?.webContents.send("powershell:stream:verbose",e)}),S.on("stream:debug",e=>{const t=M();t?.webContents.send("powershell:stream:debug",e)}),S.on("stream:information",e=>{const t=M();t?.webContents.send("powershell:stream:information",e)}),S.on("output",e=>{const t=M();t?.webContents.send("powershell:output",e)}),S.on("execution:cancelled",e=>{const t=M();t?.webContents.send("powershell:execution:cancelled",e)}),console.log("PowerShell stream event forwarding configured"),_.on("detection:started",e=>{const t=M();t?.webContents.send("environment:detection:started",e)}),_.on("detection:progress",e=>{const t=M();t?.webContents.send("environment:detection:progress",e)}),_.on("detection:completed",e=>{const t=M();t?.webContents.send("environment:detection:completed",e)}),_.on("detection:failed",e=>{const t=M();t?.webContents.send("environment:detection:failed",e)}),_.on("detection:cancelled",e=>{const t=M();t?.webContents.send("environment:detection:cancelled",e)}),console.log("Environment Detection event forwarding configured")),a.ipcMain.handle("powershell:executeScript",async(e,t)=>{try{if(!("script"in t))return console.log(`IPC: executeScript - ${t.scriptPath}`),await S.executeScript(t.scriptPath,t.args||[],t.options);{console.log(`IPC: executeInlineScript - ${t.script.substring(0,50)}...`);const e=Date.now();try{const r=await S.executeRawCommand(t.script,t.timeout||3e4);return{success:!0,data:r,duration:Date.now()-e,warnings:[]}}catch(t){const r=Date.now()-e;return{success:!1,error:t instanceof Error?t.message:String(t),duration:r,warnings:[]}}}}catch(e){return console.error(`executeScript error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e),duration:0,warnings:[]}}}),a.ipcMain.handle("powershell:executeModule",async(e,t)=>{try{return console.log(`IPC: executeModule - ${t.modulePath} :: ${t.functionName}`),await S.executeModule(t.modulePath,t.functionName,t.parameters||{},t.options)}catch(e){return console.error(`executeModule error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e),duration:0,warnings:[]}}}),a.ipcMain.handle("powershell:executeDiscoveryModule",async(e,t)=>{try{return console.log(`[IPC] executeDiscoveryModule - ${t.moduleName} for ${t.companyName}`),await S.executeDiscoveryModule(t.moduleName,t.companyName,t.additionalParams||{},t.options)}catch(e){return console.error(`executeDiscoveryModule error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e),duration:0,warnings:[]}}}),a.ipcMain.handle("powershell:cancel",async(e,t)=>{try{return console.log(`IPC: cancelExecution - ${t}`),S.cancelExecution(t)}catch(e){return console.error(`cancelExecution error: ${e instanceof Error?e.message:String(e)}`),!1}}),a.ipcMain.handle("powershell:getStatistics",async()=>{try{return S.getStatistics()}catch(e){return console.error(`getStatistics error: ${e instanceof Error?e.message:String(e)}`),null}}),a.ipcMain.handle("powershell:discoverModules",async()=>{try{return console.log("IPC: discoverModules"),await S.discoverModules()}catch(e){return console.error(`discoverModules error: ${e instanceof Error?e.message:String(e)}`),[]}}),a.ipcMain.handle("powershell:executeParallel",async(e,t)=>{try{return console.log(`IPC: executeParallel - ${t.length} scripts`),await S.executeParallel(t)}catch(e){return console.error(`executeParallel error: ${e instanceof Error?e.message:String(e)}`),t.map(()=>({success:!1,error:e instanceof Error?e.message:String(e),duration:0,warnings:[]}))}}),a.ipcMain.handle("powershell:executeWithRetry",async(e,t,r,s)=>{try{return console.log(`IPC: executeWithRetry - ${t.scriptPath} (retries: ${r})`),await S.executeWithRetry(t.scriptPath,t.args||[],t.options,r,s)}catch(e){return console.error(`executeWithRetry error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e),duration:0,warnings:[]}}}),a.ipcMain.handle("modules:getByCategory",async(e,t)=>{try{return b.getModulesByCategory(t)}catch(e){return console.error(`getModulesByCategory error: ${e instanceof Error?e.message:String(e)}`),[]}}),a.ipcMain.handle("modules:getAll",async()=>{try{return b.getAllModules()}catch(e){return console.error(`getAllModules error: ${e instanceof Error?e.message:String(e)}`),[]}}),a.ipcMain.handle("modules:getById",async(e,t)=>{try{return b.getModule(t)}catch(e){return console.error(`getModule error: ${e instanceof Error?e.message:String(e)}`),null}}),a.ipcMain.handle("modules:search",async(e,t)=>{try{return b.searchModules(t)}catch(e){return console.error(`searchModules error: ${e instanceof Error?e.message:String(e)}`),[]}}),a.ipcMain.handle("modules:execute",async(e,t,r,s)=>{try{return console.log(`IPC: executeModule - ${t}`),await b.executeModule(t,r,s)}catch(e){return console.error(`executeModule error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e),duration:0,warnings:[]}}}),a.ipcMain.handle("modules:getStatistics",async()=>{try{return b.getStatistics()}catch(e){return console.error(`getModuleStatistics error: ${e instanceof Error?e.message:String(e)}`),null}}),a.ipcMain.handle("file:read",async(e,t,r="utf-8")=>{try{const e=U(t);return console.log(`IPC: readFile - ${e}`),await s.readFile(e,r)}catch(e){throw console.error(`readFile error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to read file: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("file:write",async(e,t,r,o="utf-8")=>{try{const e=U(t);console.log(`IPC: writeFile - ${e}`),await s.mkdir(n.dirname(e),{recursive:!0}),await s.writeFile(e,r,o)}catch(e){throw console.error(`writeFile error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to write file: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("file:exists",async(e,t)=>{try{const e=U(t);return await s.access(e),!0}catch{return!1}}),a.ipcMain.handle("file:delete",async(e,t)=>{try{const e=U(t);console.log(`IPC: deleteFile - ${e}`),await s.unlink(e)}catch(e){throw console.error(`deleteFile error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to delete file: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("file:list",async(e,t,r)=>{try{const e=U(t);console.log(`IPC: listFiles - ${e}`);let o=await s.readdir(e);if(r){const e=new RegExp(r.replace(/\*/g,".*").replace(/\?/g,"."));o=o.filter(t=>e.test(t))}return o.map(t=>n.join(e,t))}catch(e){throw console.error(`listFiles error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to list files: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("file:stat",async(e,t)=>{try{const e=U(t),r=await s.stat(e);return{size:r.size,isFile:r.isFile(),isDirectory:r.isDirectory(),mtime:r.mtime,atime:r.atime,ctime:r.ctime}}catch(e){if(e instanceof Error&&"code"in e&&"ENOENT"===e.code)return null;throw console.error(`statFile error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to stat file: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("file:countCsvRows",async(e,t)=>{try{const e=U(t),r=(await s.readFile(e,"utf-8")).split("\n").filter(e=>e.trim());return Math.max(0,r.length-1)}catch(e){return e instanceof Error&&"code"in e&&"ENOENT"===e.code||console.error(`countCsvRows error: ${e instanceof Error?e.message:String(e)}`),0}}),a.ipcMain.handle("discovery:getModuleStatus",async(e,t,r)=>{try{const e=n.join("C:\\DiscoveryData",r,"DiscoveryStatus",`${t}.json`),o=await s.readFile(e,"utf-8");return JSON.parse(o)}catch(e){return null}}),a.ipcMain.handle("fs:writeFile",async(e,t)=>{try{const{path:e,content:r,encoding:o="utf8"}=t,i=U(e);return console.log(`IPC: fs:writeFile - ${i}`),await s.mkdir(n.dirname(i),{recursive:!0}),await s.writeFile(i,r,o),{success:!0}}catch(e){return console.error(`fs:writeFile error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("fs:exists",async(e,t)=>{try{const{path:e}=t,r=U(e);return await s.access(r),{success:!0,exists:!0}}catch{return{success:!0,exists:!1}}}),a.ipcMain.handle("fs:mkdir",async(e,t)=>{try{const{path:e,recursive:r=!1}=t,o=U(e);return console.log(`IPC: fs:mkdir - ${o}`),await s.mkdir(o,{recursive:r}),{success:!0}}catch(e){return console.error(`fs:mkdir error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("fs:rmdir",async(e,t)=>{try{const{path:e,recursive:r=!1}=t,o=U(e);return console.log(`IPC: fs:rmdir - ${o}`),await s.rm(o,{recursive:r}),{success:!0}}catch(e){return console.error(`fs:rmdir error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("fs:unlink",async(e,t)=>{try{const{path:e}=t,r=U(e);return console.log(`IPC: fs:unlink - ${r}`),await s.unlink(r),{success:!0}}catch(e){return console.error(`fs:unlink error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("fs:readdir",async(e,t)=>{try{const{path:e,options:r}=t,o=U(e);console.log(`IPC: fs:readdir - ${o}`);return{success:!0,data:await s.readdir(o,r)}}catch(e){return console.error(`fs:readdir error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("fs:stat",async(e,t)=>{try{const{path:e}=t,r=U(e),o=await s.stat(r);return{success:!0,data:{size:o.size,isFile:o.isFile(),isDirectory:o.isDirectory(),isSymbolicLink:o.isSymbolicLink(),created:o.birthtime,modified:o.mtime,accessed:o.atime}}}catch(e){return console.error(`fs:stat error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("config:get",async(e,t)=>N[t]),a.ipcMain.handle("config:set",async(e,t,r)=>{N[t]=r,await L()}),a.ipcMain.handle("config:getAll",async()=>({...N})),a.ipcMain.handle("config:delete",async(e,t)=>{delete N[t],await L()}),a.ipcMain.handle("config:reset",async()=>{N={},await L()}),a.ipcMain.handle("profile:loadSourceProfiles",async()=>{try{const e=await P.getProfiles();return console.log(`Loaded ${e.length} source profiles`),e}catch(e){return console.error(`loadSourceProfiles error: ${e instanceof Error?e.message:String(e)}`),[]}}),a.ipcMain.handle("profile:getActiveSource",async()=>{try{return await P.getCurrentProfile()}catch(e){return console.error(`getActiveSource error: ${e instanceof Error?e.message:String(e)}`),null}}),a.ipcMain.handle("profile:getActiveTarget",async()=>{try{return await P.getCurrentProfile()}catch(e){return console.error(`getActiveTarget error: ${e instanceof Error?e.message:String(e)}`),null}}),a.ipcMain.handle("profile:testConnection",async(e,t)=>{try{let e;console.log("[IPC profile:testConnection] ========================================"),console.log("[IPC profile:testConnection] Starting connection test"),"object"==typeof t?(e=t.profileId,console.log(`[IPC profile:testConnection] Testing with provided credentials for profile: ${e}`)):(e=t,console.log(`[IPC profile:testConnection] Testing stored credentials for profile: ${e}`)),console.log("[IPC profile:testConnection] Initializing CredentialService");const{CredentialService:s}=await Promise.resolve().then(r.bind(r,"./src/main/services/credentialService.ts")),o=new s;await o.initialize(),console.log("[IPC profile:testConnection] Calling credentialService.testConnection()");const n=await o.testConnection(e);return console.log("[IPC profile:testConnection] Test complete: "+(n.success?" SUCCESS":" FAILED")),console.log("[IPC profile:testConnection] ========================================"),{success:n.success,decryptionSuccess:n.decryptionSuccess,connectionSuccess:n.connectionSuccess,message:n.details||(n.success?"Successfully authenticated with Azure":void 0),error:n.error,data:n.success?{connectionType:"AzureAD",hasCredentials:!0,hasSecret:!0}:void 0}}catch(e){return console.error("[IPC profile:testConnection] Unhandled error:",e),console.log("[IPC profile:testConnection] ========================================"),{success:!1,decryptionSuccess:!1,connectionSuccess:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("profile:clearCredentials",async(e,t)=>{try{console.log("[IPC profile:clearCredentials] ========================================"),console.log(`[IPC profile:clearCredentials] Clearing credentials for profile: ${t}`);const{CredentialService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/credentialService.ts")),s=new e;return await s.initialize(),await s.deleteCredential(t),console.log("[IPC profile:clearCredentials]  Credentials cleared successfully"),console.log("[IPC profile:clearCredentials] Next credential load will use DPAPI file"),console.log("[IPC profile:clearCredentials] ========================================"),{success:!0}}catch(e){return console.error("[IPC profile:clearCredentials]  Error:",e),console.log("[IPC profile:clearCredentials] ========================================"),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("profile:createSource",async(e,t)=>{try{const e=await P.createProfile(t);return console.log(`Created source profile: ${e.id}`),{success:!0,profile:e}}catch(e){return console.error(`createSource error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("profile:updateSource",async(e,t,r)=>{try{const e=(await P.getProfiles()).find(e=>e.id===t);if(!e)throw new Error(`Profile with ID "${t}" not found`);const s={...e,...r},o=await P.updateProfile(s);return console.log(`Updated source profile: ${t}`),{success:!0,profile:o}}catch(e){return console.error(`updateSource error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("profile:deleteSource",async(e,t)=>{try{const e=await P.deleteProfile(t);return console.log(`Deleted source profile: ${t}`),{success:e}}catch(e){return console.error(`deleteSource error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("profile:setActiveSource",async(e,t)=>{try{const e=await P.setCurrentProfile(t);console.log(`Set active source profile: ${t}`);const r=P.getCompanyDataPath(t),s=n.join(r,"Raw");return console.log(`Updating Logic Engine data path to: ${s}`),C=p.LogicEngineService.getInstance(s),{success:e,dataPath:s}}catch(e){return console.error(`setActiveSource error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("profile:refresh",async()=>{try{await P.refreshProfiles();const e=await P.getSourceProfiles();return console.log(`Refreshed profiles: ${e.length} source profiles found`),{success:!0,profiles:e}}catch(e){return console.error(`refresh profiles error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("profile:getDataPath",async(e,t)=>{try{const e=(await P.getProfiles()).find(e=>e.id===t);if(!e)throw new Error(`Profile with ID "${t}" not found`);return{success:!0,dataPath:P.getCompanyDataPath(e.companyName)}}catch(e){return console.error(`getDataPath error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("credentials:load",async(e,t)=>{const{profileId:s}=t;try{console.log(`IPC: credentials:load - ${s}`);const{CredentialService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/credentialService.ts")),t=new e;await t.initialize();const o=await t.getCredential(s);return o?{ok:!0,credentials:{tenantId:o.tenantId,clientId:o.clientId,hasSecret:!(!o.clientSecret&&!o.password),connectionType:o.connectionType,username:o.username}}:{ok:!1,error:"No credentials found for profile"}}catch(e){return console.error(`credentials:load error: ${e instanceof Error?e.message:String(e)}`),{ok:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("credentials:save",async(e,t)=>{const{profileId:s,username:o,password:n,connectionType:i,domain:a}=t;try{console.log(`IPC: credentials:save - ${s}`);const{CredentialService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/credentialService.ts")),t=new e;return await t.initialize(),await t.storeCredential(s,o,n,i,a),{ok:!0}}catch(e){return console.error(`credentials:save error: ${e instanceof Error?e.message:String(e)}`),{ok:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("credentials:delete",async(e,t)=>{const{profileId:s}=t;try{console.log(`IPC: credentials:delete - ${s}`);const{CredentialService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/credentialService.ts")),t=new e;return await t.initialize(),await t.deleteCredential(s),{ok:!0}}catch(e){return console.error(`credentials:delete error: ${e instanceof Error?e.message:String(e)}`),{ok:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("credentials:exists",async(e,t)=>{const{profileId:s}=t;try{const{CredentialService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/credentialService.ts")),t=new e;await t.initialize();return{ok:!0,exists:await t.hasCredential(s)}}catch(e){return console.error(`credentials:exists error: ${e instanceof Error?e.message:String(e)}`),{ok:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:activate",async(e,t)=>{try{return await $.activateLicense(t)}catch(e){return console.error(`license:activate error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:getInfo",async()=>{try{return{success:!0,licenseInfo:await $.getLicenseInfo()}}catch(e){return console.error(`license:getInfo error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:isValid",async()=>{try{return{success:!0,isValid:await $.isLicenseValid()}}catch(e){return console.error(`license:isValid error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:getDetails",async()=>{try{return{success:!0,details:await $.getLicenseDetails()}}catch(e){return console.error(`license:getDetails error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:hasFeature",async(e,t)=>{try{return{success:!0,hasFeature:await $.hasFeature(t)}}catch(e){return console.error(`license:hasFeature error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:getCustomerId",async()=>{try{return{success:!0,customerId:await $.getCustomerId()}}catch(e){return console.error(`license:getCustomerId error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:deactivate",async()=>{try{return await $.deactivateLicense(),{success:!0}}catch(e){return console.error(`license:deactivate error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("license:refresh",async()=>{try{return{success:!0,licenseInfo:await $.refreshLicense()}}catch(e){return console.error(`license:refresh error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("update:check",async()=>{try{return{success:!0,updateInfo:await R.checkForUpdates()}}catch(e){return console.error(`update:check error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("update:download",async(e,t)=>{try{return{success:!0,filePath:await R.downloadUpdate(t)}}catch(e){return console.error(`update:download error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("update:apply",async(e,t,r="prompt")=>{try{return await R.applyUpdate(t,r),{success:!0}}catch(e){return console.error(`update:apply error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("update:rollback",async()=>{try{return await R.rollback(),{success:!0}}catch(e){return console.error(`update:rollback error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("update:getHistory",async()=>{try{return{success:!0,history:await R.getUpdateHistory()}}catch(e){return console.error(`update:getHistory error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("update:setAutoUpdate",async(e,t)=>{try{return await R.setAutoUpdateEnabled(t),{success:!0}}catch(e){return console.error(`update:setAutoUpdate error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),R.on("update-available",e=>{const t=M();t&&t.webContents.send("update:available",e)}),R.on("download-progress",e=>{const t=M();t&&t.webContents.send("update:download-progress",e)}),R.on("download-complete",e=>{const t=M();t&&t.webContents.send("update:download-complete",e)}),R.on("install-started",()=>{const e=M();e&&e.webContents.send("update:install-started")}),R.on("install-complete",()=>{const e=M();e&&e.webContents.send("update:install-complete")}),$.on("license-activated",e=>{const t=M();t&&t.webContents.send("license:activated",e)}),$.on("license-deactivated",()=>{const e=M();e&&e.webContents.send("license:deactivated")}),a.ipcMain.handle("system:getAppVersion",async()=>process.env.npm_package_version||"1.0.0"),a.ipcMain.handle("system:getDataPath",async()=>process.cwd()),a.ipcMain.handle("system:openExternal",async(e,t)=>{try{await a.shell.openExternal(t)}catch(e){throw console.error(`openExternal error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to open external: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("system:showOpenDialog",async(e,t)=>{try{const e=await a.dialog.showOpenDialog(t);return e.canceled?null:e.filePaths}catch(e){return console.error(`showOpenDialog error: ${e instanceof Error?e.message:String(e)}`),null}}),a.ipcMain.handle("system:showSaveDialog",async(e,t)=>{try{const e=await a.dialog.showSaveDialog(t);return e.canceled?null:e.filePath}catch(e){return console.error(`showSaveDialog error: ${e instanceof Error?e.message:String(e)}`),null}}),a.ipcMain.handle("window:minimize",async()=>{try{const e=M();return e?(e.minimize(),{success:!0}):{success:!1,error:"Main window not available"}}catch(e){return console.error(`window:minimize error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("window:maximize",async()=>{try{const e=M();return e?(e.isMaximized()?e.unmaximize():e.maximize(),{success:!0}):{success:!1,error:"Main window not available"}}catch(e){return console.error(`window:maximize error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("window:close",async()=>{try{const e=M();return e?(e.close(),{success:!0}):{success:!1,error:"Main window not available"}}catch(e){return console.error(`window:close error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("window:restore",async()=>{try{const e=M();return e?(e.restore(),{success:!0}):{success:!1,error:"Main window not available"}}catch(e){return console.error(`window:restore error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("window:isMaximized",async()=>{try{const e=M();return e?{success:!0,isMaximized:e.isMaximized()}:{success:!1,error:"Main window not available"}}catch(e){return console.error(`window:isMaximized error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("environment:detect",async(e,t)=>{try{return console.log("IPC: detectEnvironment"),await _.detectEnvironment(t)}catch(e){return console.error(`detectEnvironment error: ${e instanceof Error?e.message:String(e)}`),{id:"error",startTime:new Date,endTime:new Date,status:"failed",detectedEnvironment:"unknown",detectedServices:[],recommendations:[],totalServicesFound:0,confidence:0,errors:[{timestamp:new Date,serviceType:"system",message:e instanceof Error?e.message:String(e)}],warnings:[]}}}),a.ipcMain.handle("environment:validateCredentials",async(e,t,r)=>{try{return console.log(`IPC: validateCredentials - ${t}`),await _.validateCredentials(t,r)}catch(e){return console.error(`validateCredentials error: ${e instanceof Error?e.message:String(e)}`),{valid:!1,message:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("environment:cancel",async(e,t)=>{try{return console.log(`IPC: cancelDetection - ${t}`),await _.cancelDetection(t)}catch(e){return console.error(`cancelDetection error: ${e instanceof Error?e.message:String(e)}`),!1}}),a.ipcMain.handle("environment:getStatistics",async()=>{try{return _.getStatistics()}catch(e){return console.error(`getEnvironmentStatistics error: ${e instanceof Error?e.message:String(e)}`),{activeDetections:0,totalDetectionsRun:0}}}),a.ipcMain.handle("filewatcher:start",async(e,t)=>{try{console.log(`IPC: filewatcher:start for profile "${t}"`);const{getFileWatcherService:e}=await r.e("src_main_services_fileWatcherService_ts").then(r.bind(r,"./src/main/services/fileWatcherService.ts")),s=e(),o=M();return o&&s.setMainWindow(o),await s.watchProfile(t),{success:!0,profileId:t}}catch(e){throw console.error(`filewatcher:start error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to start file watcher: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("filewatcher:stop",async(e,t)=>{try{console.log(`IPC: filewatcher:stop for profile "${t}"`);const{getFileWatcherService:e}=await r.e("src_main_services_fileWatcherService_ts").then(r.bind(r,"./src/main/services/fileWatcherService.ts")),s=e();return await s.stopWatching(t),{success:!0,profileId:t}}catch(e){throw console.error(`filewatcher:stop error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to stop file watcher: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("filewatcher:stopAll",async()=>{try{console.log("IPC: filewatcher:stopAll");const{getFileWatcherService:e}=await r.e("src_main_services_fileWatcherService_ts").then(r.bind(r,"./src/main/services/fileWatcherService.ts")),t=e();return await t.stopAll(),{success:!0}}catch(e){throw console.error(`filewatcher:stopAll error: ${e instanceof Error?e.message:String(e)}`),new Error(`Failed to stop all file watchers: ${e instanceof Error?e.message:String(e)}`)}}),a.ipcMain.handle("filewatcher:getWatchedFiles",async()=>{try{const{getFileWatcherService:e}=await r.e("src_main_services_fileWatcherService_ts").then(r.bind(r,"./src/main/services/fileWatcherService.ts"));return e().getWatchedFiles()}catch(e){return console.error(`filewatcher:getWatchedFiles error: ${e instanceof Error?e.message:String(e)}`),[]}}),a.ipcMain.handle("filewatcher:getStatistics",async()=>{try{const{getFileWatcherService:e}=await r.e("src_main_services_fileWatcherService_ts").then(r.bind(r,"./src/main/services/fileWatcherService.ts"));return e().getStatistics()}catch(e){return console.error(`filewatcher:getStatistics error: ${e instanceof Error?e.message:String(e)}`),{activeWatchers:0,watchedDirectories:[],totalEvents:0,eventsByType:{added:0,changed:0,deleted:0}}}}),a.ipcMain.handle("logic-engine:load-all",async(e,t)=>{const{profilePath:r}=t;try{console.log(`IPC: logic-engine:load-all - ${r||"default"}`);const e=e=>{const t=M();t&&t.webContents.send("logic-engine:progress",e)},t=e=>{const t=M();t&&t.webContents.send("logic-engine:loaded",e)},s=e=>{const t=M();t&&t.webContents.send("logic-engine:error",e)};C.on("progress",e),C.on("loaded",t),C.on("error",s);const o=await C.loadAllAsync(r);return C.removeListener("progress",e),C.removeListener("loaded",t),C.removeListener("error",s),{success:o,statistics:o?C.lastLoadStats:null}}catch(e){return console.error("logic-engine:load-all error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logic-engine:get-user-detail",async(e,t)=>{const{userId:r}=t;try{if(console.log(`IPC: logic-engine:get-user-detail - ${r}`),!r||"string"!=typeof r)throw new Error("Invalid userId parameter");const e=await C.buildUserDetailProjection(r);return e?{success:!0,data:e}:{success:!1,error:`User not found: ${r}`}}catch(e){return console.error("logic-engine:get-user-detail error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logic-engine:get-statistics",async()=>{try{return{success:!0,data:{statistics:C.lastLoadStats,lastLoadTime:C.getLastLoadTime(),isLoading:C.getIsLoading()}}}catch(e){return console.error("logic-engine:get-statistics error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logic-engine:invalidate-cache",async()=>{try{return C.fileLoadTimes.clear(),{success:!0}}catch(e){return console.error("logic-engine:invalidate-cache error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("dashboard:getStats",async(e,t)=>{try{console.log("[IPC dashboard:getStats] Received profileName:",t,"type:",typeof t);return{success:!0,data:await k.getStats(t)}}catch(e){return console.error("dashboard:getStats error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("dashboard:getProjectTimeline",async(e,t)=>{try{console.log("[IPC dashboard:getProjectTimeline] Received profileName:",t,"type:",typeof t);return{success:!0,data:await k.getProjectTimeline(t)}}catch(e){return console.error("dashboard:getProjectTimeline error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("dashboard:getSystemHealth",async()=>{try{return{success:!0,data:await k.getSystemHealth()}}catch(e){return console.error("dashboard:getSystemHealth error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("dashboard:getRecentActivity",async(e,t,r=10)=>{try{return{success:!0,data:await k.getRecentActivity(t,r)}}catch(e){return console.error("dashboard:getRecentActivity error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("dashboard:acknowledgeAlert",async(e,t)=>{try{return await k.acknowledgeAlert(t),{success:!0}}catch(e){return console.error("dashboard:acknowledgeAlert error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:analyzeMigrationComplexity",async(e,t)=>{try{if(console.log(`Analyzing migration complexity for user: ${t}`),!t||"string"!=typeof t)throw new Error("Invalid userId parameter");return{success:!0,data:await C.analyzeMigrationComplexity(t)}}catch(e){return console.error("logicEngine:analyzeMigrationComplexity error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:batchAnalyzeMigrationComplexity",async(e,t)=>{try{if(console.log(`Batch analyzing migration complexity for ${t.length} users`),!Array.isArray(t)||0===t.length)throw new Error("Invalid userIds parameter");const e=await C.batchAnalyzeMigrationComplexity(t),r={};return e.forEach((e,t)=>{r[t]=e}),{success:!0,data:r}}catch(e){return console.error("logicEngine:batchAnalyzeMigrationComplexity error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:getComplexityStatistics",async()=>{try{return{success:!0,data:C.getComplexityStatistics()}}catch(e){return console.error("logicEngine:getComplexityStatistics error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:forceReload",async(e,t)=>{try{console.log("[LogicEngine] Force reloading data from CSV files...");return await C.loadAllAsync(t,!0)?(console.log("[LogicEngine] Force reload completed successfully"),{success:!0}):{success:!1,error:"Failed to reload data"}}catch(e){return console.error("logicEngine:forceReload error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:getAllUsers",async()=>{try{const e=C.getAllUsers();return console.log(`[LogicEngine] Retrieved ${e.length} users`),{success:!0,data:e}}catch(e){return console.error("logicEngine:getAllUsers error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:getAllGroups",async()=>{try{const e=C.getAllGroups();return console.log(`[LogicEngine] Retrieved ${e.length} groups`),{success:!0,data:e}}catch(e){return console.error("logicEngine:getAllGroups error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:getAllDevices",async()=>{try{const e=C.getAllDevices();return console.log(`[LogicEngine] Retrieved ${e.length} devices`),{success:!0,data:e}}catch(e){return console.error("logicEngine:getAllDevices error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:getAllApplications",async()=>{try{const e=C.getAllApplications();return console.log(`[LogicEngine] Retrieved ${e.length} applications`),{success:!0,data:e}}catch(e){return console.error("logicEngine:getAllApplications error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("logicEngine:getAllMailboxes",async()=>{try{return{success:!0,data:C.getAllMailboxes()}}catch(e){return console.error("logicEngine:getAllMailboxes error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("project:getConfiguration",async(e,t)=>{try{return{success:!0,data:await I.loadProjectConfig(t)}}catch(e){return console.error("project:getConfiguration error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("project:saveConfiguration",async(e,t,r)=>{try{return await I.saveProjectConfig(t,r),{success:!0}}catch(e){return console.error("project:saveConfiguration error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("project:updateStatus",async(e,t,r)=>{try{return await I.updateProjectStatus(t,r),{success:!0}}catch(e){return console.error("project:updateStatus error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("project:addWave",async(e,t,r)=>{try{return await I.addMigrationWave(t,r),{success:!0}}catch(e){return console.error("project:addWave error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("project:updateWaveStatus",async(e,t,r,s)=>{try{return await I.updateWaveStatus(t,r,s),{success:!0}}catch(e){return console.error("project:updateWaveStatus error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("get-user-detail",async(e,t)=>{const{userId:r}=t;try{if(console.log(`IPC: get-user-detail - ${r}`),!r||"string"!=typeof r)throw new Error("Invalid userId parameter");const e=await T.getUserDetailAsync(r);return e?{success:!0,data:e}:{success:!1,error:`User not found: ${r}`,data:null}}catch(e){return console.error("get-user-detail error:",e),{success:!1,error:(e instanceof Error?e.message:String(e))||"Failed to retrieve user details",data:null}}}),a.ipcMain.handle("clear-user-detail-cache",async(e,t)=>{const{userId:r}=t;try{return console.log(`IPC: clear-user-detail-cache - ${r}`),T.clearUserDetailCache(r),{success:!0}}catch(e){return console.error("clear-user-detail-cache error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("export-user-snapshot",async(e,t)=>{const{userDetail:r,format:o,fileName:i}=t;try{console.log(`IPC: export-user-snapshot - ${i} (${o})`);const e=n.join(process.env.USERPROFILE||process.env.HOME||"","Downloads"),t=n.join(e,n.basename(i));if("json"===o)await s.writeFile(t,JSON.stringify(r,null,2),"utf-8");else{const e=function(e){const t=[];return t.push("Section,Key,Value"),t.push(`User,Display Name,"${q(e.user.displayName)}"`),t.push(`User,UPN,"${q(e.user.userPrincipalName)}"`),t.push(`User,Email,"${q(e.user.mail)}"`),t.push(`User,Department,"${q(e.user.department)}"`),t.push(`User,Job Title,"${q(e.user.jobTitle)}"`),e.groups.forEach((e,r)=>{t.push(`Groups,Group ${r+1},"${q(e.name)}"`)}),e.devices.forEach((e,r)=>{t.push(`Devices,Device ${r+1},"${q(e.name)}"`)}),e.apps.forEach((e,r)=>{t.push(`Apps,App ${r+1},"${q(e.name)}"`)}),e.azureRoles.forEach((e,r)=>{t.push(`Azure Roles,Role ${r+1},"${q(e.roleName)}"`)}),e.risks.forEach((e,r)=>{t.push(`Risks,Risk ${r+1},"${e.severity}: ${q(e.description)}"`)}),t.join("\n")}(r);await s.writeFile(t,e,"utf-8")}return{success:!0,filePath:t}}catch(e){return console.error("export-user-snapshot error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("get-computer-detail",async(e,t)=>{const{computerId:s}=t;try{if(console.log(`IPC: get-computer-detail - ${s}`),!s||"string"!=typeof s)throw new Error("Invalid computerId parameter");const{mockComputerDetailService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/mockLogicEngineService.ts")),t=await e.getComputerDetailAsync(s);return t?{success:!0,data:t}:{success:!1,error:`Computer not found: ${s}`,data:null}}catch(e){return console.error("get-computer-detail error:",e),{success:!1,error:(e instanceof Error?e.message:String(e))||"Failed to retrieve computer details",data:null}}}),a.ipcMain.handle("clear-computer-detail-cache",async(e,t)=>{const{computerId:s}=t;try{console.log(`IPC: clear-computer-detail-cache - ${s}`);const{mockComputerDetailService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/mockLogicEngineService.ts"));return e.clearComputerDetailCache(s),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("export-computer-snapshot",async(e,t)=>{try{const{computerDetail:e,format:r,fileName:o}=t,i=n.join(process.env.USERPROFILE||process.env.HOME||"","Downloads"),a=n.join(i,n.basename(o));if("json"===r)await s.writeFile(a,JSON.stringify(e,null,2),"utf-8");else if("csv"===r){const t=function(e){const t=[];return t.push("Section,Key,Value"),t.push(`Computer,Name,"${q(e.computer.name)}"`),t.push(`Computer,DNS,"${q(e.computer.dns)}"`),t.push(`Computer,Domain,"${q(e.computer.domain)}"`),t.push(`Computer,OS,"${q(e.computer.os)}"`),t.push(`Computer,Status,"${q(e.computer.status)}"`),e.users.forEach((e,r)=>{t.push(`Users,User ${r+1},"${q(e.displayName)}"`)}),e.software.forEach((e,r)=>{t.push(`Software,App ${r+1},"${q(e.name)}"`)}),e.groups.forEach((e,r)=>{t.push(`Groups,Group ${r+1},"${q(e.name)}"`)}),e.risks.forEach((e,r)=>{t.push(`Risks,Risk ${r+1},"${e.severity}: ${q(e.description)}"`)}),t.join("\n")}(e);await s.writeFile(a,t,"utf-8")}return console.log(`Exported computer snapshot: ${a}`),{success:!0,path:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("remote-connect",async(e,t)=>{try{const{computerId:e,connectionType:r}=t;return console.log(`IPC: remote-connect - ${e} (${r})`),{success:!0,message:`${r} connection initiated to ${e}`}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("get-group-detail",async(e,t)=>{const{groupId:s}=t;try{if(console.log(`IPC: get-group-detail - ${s}`),!s||"string"!=typeof s)throw new Error("Invalid groupId parameter");const{mockGroupDetailService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/mockLogicEngineService.ts")),t=await e.getGroupDetailAsync(s);return t?{success:!0,data:t}:{success:!1,error:`Group not found: ${s}`,data:null}}catch(e){return console.error("get-group-detail error:",e),{success:!1,error:(e instanceof Error?e.message:String(e))||"Failed to retrieve group details",data:null}}}),a.ipcMain.handle("clear-group-detail-cache",async(e,t)=>{const{groupId:s}=t;try{console.log(`IPC: clear-group-detail-cache - ${s}`);const{mockGroupDetailService:e}=await Promise.resolve().then(r.bind(r,"./src/main/services/mockLogicEngineService.ts"));return e.clearGroupDetailCache(s),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("export-group-snapshot",async(e,t)=>{try{const{groupDetail:e,format:r,fileName:o}=t,i=n.join(process.env.USERPROFILE||process.env.HOME||"","Downloads"),a=n.join(i,n.basename(o));if("json"===r)await s.writeFile(a,JSON.stringify(e,null,2),"utf-8");else if("csv"===r){const t=function(e){const t=[];return t.push("Section,Key,Value"),t.push(`Group,Name,"${q(e.group.name)}"`),t.push(`Group,Display Name,"${q(e.group.displayName)}"`),t.push(`Group,Type,"${q(e.group.groupType)}"`),t.push(`Group,Scope,"${q(e.group.scope)}"`),t.push(`Group,Email,"${q(e.group.email)}"`),e.members.forEach((e,r)=>{t.push(`Members,Member ${r+1},"${q(e.displayName)} (${e.userPrincipalName})"`)}),e.owners.forEach((e,r)=>{t.push(`Owners,Owner ${r+1},"${q(e.displayName)}"`)}),e.permissions.forEach((e,r)=>{t.push(`Permissions,Permission ${r+1},"${q(e.resourceName)} - ${e.accessLevel}"`)}),e.applications.forEach((e,r)=>{t.push(`Applications,App ${r+1},"${q(e.applicationName)} - ${e.roleName}"`)}),e.risks.forEach((e,r)=>{t.push(`Risks,Risk ${r+1},"${e.severity}: ${q(e.description)}"`)}),t.join("\n")}(e);await s.writeFile(a,t,"utf-8")}return console.log(`Exported group snapshot: ${a}`),{success:!0,path:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("add-group-members",async(e,t)=>{try{const{groupId:e,memberIds:r}=t;return console.log(`IPC: add-group-members - ${e} (${r.length} members)`),{success:!0,message:`Added ${r.length} members to group ${e}`}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("update-group",async(e,t)=>{try{const{groupId:e,updates:r}=t;return console.log(`IPC: update-group - ${e}`,r),{success:!0,message:`Updated group ${e}`}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}),console.log("[IPC] Registering discovery:execute handler..."),a.ipcMain.handle("discovery:execute",async(e,t)=>{console.log("[IPC] ========== discovery:execute RECEIVED PARAMS =========="),console.log("[IPC] args:",JSON.stringify(t,null,2));const r=t.moduleName,s=t.configuration||t.parameters||{},o=t.executionId,n=t.executionOptions||{},a=t.companyName;console.log("[IPC] Extracted parameters:",JSON.stringify(s,null,2)),console.log("[IPC] Extracted executionOptions:",JSON.stringify(n,null,2)),console.log("[IPC] ==============================================="),console.log("[IPC] discovery:execute HANDLER CALLED!"),console.log(`[IPC] Module: ${r}`),console.log(`[IPC] ExecutionId: ${o||"auto-generating..."}`),console.log(`[IPC] mainWindow exists: ${j()}`),console.log("[IPC] ===============================================");try{const e=o||i.randomUUID();console.log(`IPC: discovery:execute - ${r} (executionId: ${e})`);const t={id:e,moduleName:r,parameters:s,startTime:Date.now()},c=[],l=t=>{console.error("[IPC Handler]  Received stream:output event:",t.data?.substring(0,100));const s=M();console.error(`[IPC Handler]  Window exists: ${!!s}, hasWindow: ${j()}`),s&&!s.isDestroyed()?(console.error(`[IPC Handler]  Forwarding output to renderer (execId: ${e})`),s.webContents.send("discovery:output",{executionId:e,timestamp:(new Date).toISOString(),level:"output",message:t.data,source:r})):console.error("[IPC Handler]  Window not available, cannot forward output event")},u=t=>{console.error("[IPC Handler]  Received stream:error event:",t.data?.substring(0,100));const s=M();s&&!s.isDestroyed()?(console.error(`[IPC Handler]  Forwarding error to renderer (execId: ${e})`),s.webContents.send("discovery:output",{executionId:e,timestamp:(new Date).toISOString(),level:"error",message:t.data,source:r})):console.error("[IPC Handler]  Window not available, cannot forward error event")},d=t=>{console.error("[IPC Handler]  Received stream:warning event:",t.data?.substring(0,100));const s=M();s&&!s.isDestroyed()?(console.error(`[IPC Handler]  Forwarding warning to renderer (execId: ${e})`),s.webContents.send("discovery:output",{executionId:e,timestamp:(new Date).toISOString(),level:"warning",message:t.data,source:r})):console.error("[IPC Handler]  Window not available, cannot forward warning event")},p=t=>{console.error("[IPC Handler]  Received stream:verbose event:",t.data?.substring(0,100));const s=M();s&&!s.isDestroyed()?(console.error(`[IPC Handler]  Forwarding verbose to renderer (execId: ${e})`),s.webContents.send("discovery:output",{executionId:e,timestamp:(new Date).toISOString(),level:"verbose",message:t.data,source:r})):console.error("[IPC Handler]  Window not available, cannot forward verbose event")},h=t=>{console.error("[IPC Handler]  Received stream:debug event:",t.data?.substring(0,100));const s=M();s&&!s.isDestroyed()?(console.error(`[IPC Handler]  Forwarding debug to renderer (execId: ${e})`),s.webContents.send("discovery:output",{executionId:e,timestamp:(new Date).toISOString(),level:"debug",message:t.data,source:r})):console.error("[IPC Handler]  Window not available, cannot forward debug event")},m=t=>{console.error("[IPC Handler]  Received stream:information event:",t.data?.substring(0,100));const s=M();s&&!s.isDestroyed()?(console.error(`[IPC Handler]  Forwarding information to renderer (execId: ${e})`),s.webContents.send("discovery:output",{executionId:e,timestamp:(new Date).toISOString(),level:"information",message:t.data,source:r})):console.error("[IPC Handler]  Window not available, cannot forward information event")};console.log(`[IPC Handler]  Registering stream listeners for execId: ${e}`),S.on("stream:output",l),S.on("stream:error",u),S.on("stream:warning",d),S.on("stream:verbose",p),S.on("stream:debug",h),S.on("stream:information",m),console.log(`[IPC Handler]  All stream listeners registered for execId: ${e}`),c.push(()=>S.off("stream:output",l)),c.push(()=>S.off("stream:error",u)),c.push(()=>S.off("stream:warning",d)),c.push(()=>S.off("stream:verbose",p)),c.push(()=>S.off("stream:debug",h)),c.push(()=>S.off("stream:information",m));const g=await P.getCurrentProfile();if(!g)throw new Error("No active profile selected. Please select a company profile first.");console.log(`[IPC:discovery:execute] Starting ${r} discovery`),console.log(`[IPC:discovery:execute] Company: ${g.companyName}`),console.log(`[IPC:discovery:execute] Execution ID: ${e}`),console.log("[IPC:discovery:execute] Parameters:",JSON.stringify(s,null,2));const f=a||g.companyName;console.log(`[IPC:discovery:execute] Using company name: ${f}`);const y=P.getCompanyDataPath(f);console.log(`[IPC:discovery:execute] Resolved profile path: ${y}`);let v=null;if(["ActiveDirectory","DNSDHCP","GPO","Infrastructure"].includes(r))try{v=await P.getDomainCredentialsDecrypted(g.id),v?(console.log(`[IPC:discovery:execute]  Domain credentials loaded for ${r} module`),console.log(`[IPC:discovery:execute] Username: ${v.username.replace(/\\.*$/,"\\***")}`)):console.log("[IPC:discovery:execute]  No domain credentials configured for profile - using integrated auth")}catch(e){console.error(`[IPC:discovery:execute]  Failed to load domain credentials: ${e instanceof Error?e.message:String(e)}`),console.error("[IPC:discovery:execute] Proceeding with integrated authentication")}const w={...s,...v?{domainCredentials:v}:{}},E=await S.executeDiscoveryModule(r,f,w,{cancellationToken:e,streamOutput:!0,timeout:n.timeout||3e5,showWindow:void 0!==n.showWindow&&n.showWindow,outputPath:y});console.log(`[IPC Handler]  Cleaning up stream listeners for execId: ${e}`),c.forEach(e=>e()),console.log(`[IPC Handler]  All stream listeners cleaned up for execId: ${e}`),console.log(`[IPC:discovery:execute]  ${r} completed successfully`),console.log(`[IPC:discovery:execute] Duration: ${Date.now()-t.startTime}ms`),console.log("[IPC:discovery:execute] Result:",E.success?"SUCCESS":"FAILED");const b=M();if(b&&!b.isDestroyed()){console.error("[IPC Handler]  Sending discovery:complete event");const r=E.data,s={...E,totalItems:r?.RecordCount||0,recordCount:r?.RecordCount||0};console.error(`[IPC Handler]  Discovery results: RecordCount=${r?.RecordCount}, Success=${r?.Success}`),b.webContents.send("discovery:complete",{executionId:e,result:s,duration:Date.now()-t.startTime})}else console.error("[IPC Handler]  Window not available for completion event");return{success:!0,executionId:e,result:E}}catch(e){console.error("[IPC:discovery:execute]  Error:",e);const t=M();return t&&!t.isDestroyed()&&o?(console.error("[IPC Handler]  Sending discovery:error event"),t.webContents.send("discovery:error",{executionId:o||"unknown",error:e instanceof Error?e.message:String(e)})):console.error("[IPC Handler]  Window not available for error event"),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("discovery:cancel",async(e,t)=>{const{executionId:r}=t;try{console.log(`IPC: discovery:cancel - ${r}`);const e=await S.cancelExecution(r),t=M();return e&&t&&t.webContents.send("discovery:cancelled",{executionId:r}),{success:e}}catch(e){return console.error("discovery:cancel error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("discovery:get-status",async(e,t)=>{const{executionId:r}=t;try{return console.log(`IPC: discovery:get-status - ${r}`),{success:!0,status:{state:"running",progress:0,message:"Execution in progress"}}}catch(e){return console.error("discovery:get-status error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("discovery:clear-logs",async(e,t)=>{const{executionId:r}=t;try{console.log(`IPC: discovery:clear-logs - ${r}`);const e=M();return e&&e.webContents.send("discovery:logs-cleared",{executionId:r}),{success:!0}}catch(e){return console.error("discovery:clear-logs error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("discovery:get-modules",async()=>{try{console.log("IPC: discovery:get-modules");const e=b.getAllModules();return{success:!0,modules:e.filter(e=>"discovery"===e.category)}}catch(e){return console.error("discovery:get-modules error:",e),{success:!1,error:e instanceof Error?e.message:String(e),modules:[]}}}),a.ipcMain.handle("discovery:get-module-info",async(e,t)=>{const{moduleName:r}=t;try{console.log(`IPC: discovery:get-module-info - ${r}`);const e=b.getModule(r);return e?{success:!0,info:e}:{success:!1,error:`Module not found: ${r}`,info:null}}catch(e){return console.error("discovery:get-module-info error:",e),{success:!1,error:e instanceof Error?e.message:String(e),info:null}}}),a.ipcMain.handle("backup:create",async(e,t)=>{try{const{config:e}=t;console.log("IPC: backup:create",e);const r=`backup-${Date.now()}`;return{success:!0,operationId:r,filePath:`backup-${r}.zip`}}catch(e){return console.error("backup:create error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("backup:cancel",async(e,t)=>{try{const{operationId:e}=t;return console.log("IPC: backup:cancel",e),{success:!0}}catch(e){return console.error("backup:cancel error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("backup:list",async()=>{try{return console.log("IPC: backup:list"),{success:!0,backups:[]}}catch(e){return console.error("backup:list error:",e),{success:!1,error:e instanceof Error?e.message:String(e),backups:[]}}}),a.ipcMain.handle("backup:delete",async(e,t)=>{try{const{operationId:e}=t;return console.log("IPC: backup:delete",e),{success:!0}}catch(e){return console.error("backup:delete error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("backup:validate",async(e,t)=>{try{const{filePath:e}=t;return console.log("IPC: backup:validate",e),{success:!0,isValid:!0,errors:[],warnings:[]}}catch(e){return console.error("backup:validate error:",e),{success:!1,isValid:!1,errors:[e instanceof Error?e.message:String(e)],warnings:[]}}}),a.ipcMain.handle("restore:create",async(e,t)=>{try{const{backupFilePath:e,config:r}=t;console.log("IPC: restore:create",e,r);return{success:!0,operationId:`restore-${Date.now()}`}}catch(e){return console.error("restore:create error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("restore:cancel",async(e,t)=>{try{const{operationId:e}=t;return console.log("IPC: restore:cancel",e),{success:!0}}catch(e){return console.error("restore:cancel error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("migration:plan",async(e,t)=>{try{const{provider:e,profileId:r,args:s}=t;console.log("IPC: migration:plan",e,r);return{runId:`migration-${Date.now()}`}}catch(e){throw console.error("migration:plan error:",e),new Error(e instanceof Error?e.message:String(e))}}),a.ipcMain.handle("migration:execute",async(e,t)=>{try{const{provider:e,profileId:r,runId:s,args:o}=t;console.log("IPC: migration:execute",e,r,s);return{runId:s||`migration-${Date.now()}`}}catch(e){throw console.error("migration:execute error:",e),new Error(e instanceof Error?e.message:String(e))}}),a.ipcMain.handle("migration:cancel",async(e,t)=>{try{const{runId:e}=t;return console.log("IPC: migration:cancel",e),{success:!0}}catch(e){return console.error("migration:cancel error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("migration:pause",async(e,t)=>{try{const{runId:e}=t;return console.log("IPC: migration:pause",e),{success:!0}}catch(e){return console.error("migration:pause error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}),a.ipcMain.handle("migration:resume",async(e,t)=>{try{const{runId:e}=t;return console.log("IPC: migration:resume",e),{success:!0}}catch(e){return console.error("migration:resume error:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}});const{registerMigrationHandlers:t}=await r.e("src_main_ipcHandlers_migration_ts").then(r.bind(r,"./src/main/ipcHandlers.migration.ts"));t(S);const{registerInventoryHandlers:f}=await Promise.all([r.e("src_main_services_inventoryService_ts"),r.e("src_main_ipcHandlers_inventory_ts")]).then(r.bind(r,"./src/main/ipcHandlers.inventory.ts"));f();const{registerMigrationWaveHandlers:y}=await Promise.all([r.e("src_main_services_inventoryService_ts"),r.e("src_main_ipcHandlers_waves_ts")]).then(r.bind(r,"./src/main/ipcHandlers.waves.ts"));y();const{registerAppRegistrationHandlers:A}=await r.e("src_main_ipc_appRegistrationHandlers_ts").then(r.bind(r,"./src/main/ipc/appRegistrationHandlers.ts"));A();const{registerTargetProfileHandlers:D}=await r.e("src_main_ipc_targetProfileHandlers_ts").then(r.bind(r,"./src/main/ipc/targetProfileHandlers.ts"));D();const{registerConnectionTestHandlers:G}=await r.e("src_main_ipc_connectionTestHandlers_ts").then(r.bind(r,"./src/main/ipc/connectionTestHandlers.ts"));G(M()||void 0);const{registerMigrationPlanningHandlers:B}=await r.e("src_main_ipc_migrationPlanningHandlers_ts").then(r.bind(r,"./src/main/ipc/migrationPlanningHandlers.ts"));B();const{registerModuleDiscoveryHandlers:z}=await r.e("src_main_ipc_moduleDiscoveryHandlers_ts").then(r.bind(r,"./src/main/ipc/moduleDiscoveryHandlers.ts"));z();const{registerDataExportImportHandlers:H}=await r.e("src_main_ipc_dataExportImportHandlers_ts").then(r.bind(r,"./src/main/ipc/dataExportImportHandlers.ts"));H();const{registerErrorMonitoringHandlers:W}=await r.e("src_main_ipc_errorMonitoringHandlers_ts").then(r.bind(r,"./src/main/ipc/errorMonitoringHandlers.ts"));W(M()||void 0);const{registerLoggingHandlers:V,initializeLogging:K}=await r.e("src_main_ipc_loggingHandlers_ts").then(r.bind(r,"./src/main/ipc/loggingHandlers.ts"));await K(),V();const{registerAdvancedIpcHandlers:J}=await r.e("src_main_ipc_handlers_ts").then(r.bind(r,"./src/main/ipc/handlers.ts"));J();const{registerApplicationFactSheetHandlers:X}=await r.e("src_main_ipc_applicationFactSheetHandlers_ts").then(r.bind(r,"./src/main/ipc/applicationFactSheetHandlers.ts"));X();const{registerEnterpriseSystemsHandlers:Y}=await r.e("src_main_services_enterpriseSystemsService_ts").then(r.bind(r,"./src/main/services/enterpriseSystemsService.ts"));Y(),a.ipcMain.handle("discovery:get-applications",async(e,t)=>{try{const{sourceProfileId:e}=t,s=await Promise.resolve().then(r.bind(r,"./src/main/services/profileService.ts")),i=await s.getProfileById(e),a=i?.companyName||"default",c=n.join(process.env.DISCOVERY_DATA_PATH||"C:\\DiscoveryData",a,"Raw"),l=n.join(c,"ApplicationCatalog.csv"),u=n.join(c,"Applications.csv");let d="";if(o.existsSync(l))d=l;else{if(!o.existsSync(u))return{success:!1,error:"No application discovery data found"};d=u}const p=o.readFileSync(d,"utf-8").split("\n").filter(e=>e.trim());if(p.length<2)return{success:!1,error:"No application data in file"};const h=p[0].split(",").map(e=>e.replace(/^"|"$/g,"").trim()),m=[];for(let e=1;e<p.length;e++){const t=p[e].match(/("([^"]*)"|[^,]*)/g)||[],r={};h.forEach((e,s)=>{let o=t[s]||"";o=o.replace(/^"|"$/g,"").trim(),r[e]=o}),(r.Name||r.ApplicationName||r.name)&&m.push(r)}return{success:!0,data:m,sourceFile:n.basename(d),count:m.length}}catch(e){return console.error("Error getting discovery applications:",e),{success:!1,error:e.message}}}),a.ipcMain.handle("triggerWebhook",async(e,t)=>{try{const{webhookId:e,event:s,data:o={}}=t,{webhookService:n}=await r.e("src_renderer_services_webhookService_ts").then(r.bind(r,"./src/renderer/services/webhookService.ts"));return n.getWebhook(e)?(await n.trigger(s,o),{success:!0}):{success:!1,error:"Webhook not found"}}catch(e){return console.error(`triggerWebhook error: ${e instanceof Error?e.message:String(e)}`),{success:!1,error:e instanceof Error?e.message:String(e)}}}),console.log("All IPC handlers registered successfully")}function q(e){return e?e.replace(/"/g,'""'):""}async function B(){console.log("Shutting down IPC services..."),S&&await S.shutdown(),A&&A.close(),await L(),console.log("IPC services shutdown complete")}a.ipcMain.handle("get-discovery-files",async()=>{try{console.log("[IPC] get-discovery-files: Scanning for CSV files...");const e=[n.join(process.cwd(),"DiscoveryData"),n.join("C:","DiscoveryData"),n.join(process.cwd(),"Modules","Discovery")],t=[],r=async e=>{try{if(!await s.stat(e).catch(()=>null))return;const o=await s.readdir(e);for(const i of o){const o=n.join(e,i),a=await s.stat(o).catch(()=>null);if(a)if(a.isDirectory()){const e=i.toLowerCase();if(e.includes("rawold")||e.includes("testdata")||e.includes("test_")||e.includes("_test")||e.includes("backup")||e.includes("archive")){console.log("[IPC] get-discovery-files: Skipping test/archive directory:",i);continue}await r(o)}else if(i.endsWith(".csv")){const e=i.toLowerCase();if(e.includes("test")||e.includes("sample")||e.includes("demo")||e.includes("_20")||e.includes("performance")||e.includes("placeholder")){console.log("[IPC] get-discovery-files: Skipping test file:",i);continue}let r="generic";e.includes("user")?r="users":e.includes("group")?r="groups":e.includes("application")?r="applications":e.includes("infrastructure")?r="infrastructure":e.includes("exchange")?r="exchange":e.includes("filesystem")&&(r="filesystem"),t.push({path:o,type:r})}}}catch(t){console.warn("[IPC] get-discovery-files: Error scanning directory:",e,t)}};for(const t of e)await r(t);return console.log("[IPC] get-discovery-files: Found",t.length,"CSV files"),t}catch(e){return console.error("[IPC] get-discovery-files: Error:",e),[]}}),a.ipcMain.handle("read-discovery-file",async(e,t)=>{try{console.log("[IPC] read-discovery-file:",t);return await s.readFile(t,"utf8")}catch(e){throw console.error("[IPC] read-discovery-file: Error reading file:",t,e),e}}),a.ipcMain.handle("decision-trace:initialize",async()=>{try{return A||(A=f.DecisionTraceService.getInstance()),A.initialize(),console.log("[IPC] Decision Trace service initialized"),{success:!0}}catch(e){return console.error("[IPC] decision-trace:initialize error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to initialize Decision Trace service"}}}),a.ipcMain.handle("decision-trace:append",async(e,t)=>{try{if(!A)throw new Error("Decision Trace service not initialized");return await A.appendTrace(t),console.log("[IPC] Decision trace appended:",t.id,t.kind),{success:!0,traceId:t.id}}catch(e){return console.error("[IPC] decision-trace:append error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to append trace"}}}),a.ipcMain.handle("decision-trace:query",async(e,t)=>{try{if(!A)throw new Error("Decision Trace service not initialized");const e=await A.queryTraces(t);return console.log("[IPC] Queried decision traces:",e.length,"results"),{success:!0,data:e}}catch(e){return console.error("[IPC] decision-trace:query error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to query traces"}}}),a.ipcMain.handle("decision-trace:statistics",async(e,t)=>{try{if(!A)throw new Error("Decision Trace service not initialized");const e=await A.getStatistics(t);return console.log("[IPC] Retrieved decision trace statistics:",e.totalTraces,"total traces"),{success:!0,data:e}}catch(e){return console.error("[IPC] decision-trace:statistics error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to get statistics"}}}),a.ipcMain.handle("consolidation:run",async(e,t)=>{try{const{profileId:e,discoveryDataPath:r}=t;D||(D=y.ConsolidationEngine.getInstance()),D.setProfileId(e),console.log("[IPC] Running consolidation:",{profileId:e,discoveryDataPath:r});const s=await D.consolidate(r);return console.log("[IPC] Consolidation complete:",{entities:s.entities.length,relationships:s.relationships.length,timeMs:s.statistics.processingTimeMs}),{success:!0,data:s}}catch(e){return console.error("[IPC] consolidation:run error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to run consolidation"}}})},"./src/main/services/configService.ts":(e,t,r)=>{"use strict";r.d(t,{ConfigService:()=>a});var s=r("fs"),o=r("path"),n=r.n(o),i=r("electron");class a{configPath;config={};initialized=!1;constructor(){const e=i.app.getPath("userData");this.configPath=n().join(e,"config.json")}async initialize(){if(!this.initialized){try{const e=await s.promises.readFile(this.configPath,"utf-8");this.config=JSON.parse(e)}catch(e){"ENOENT"!==e.code&&console.error("Error loading config:",e),this.config=this.getDefaultConfig(),await this.save()}this.initialized=!0}}async get(e){return await this.ensureInitialized(),this.config[e]}async set(e,t){await this.ensureInitialized(),this.config[e]=t,await this.save()}async getAll(){return await this.ensureInitialized(),{...this.config}}async delete(e){await this.ensureInitialized(),delete this.config[e],await this.save()}async reset(){this.config=this.getDefaultConfig(),await this.save()}async save(){try{await s.promises.mkdir(n().dirname(this.configPath),{recursive:!0}),await s.promises.writeFile(this.configPath,JSON.stringify(this.config,null,2),"utf-8")}catch(e){throw console.error("Error saving config:",e),new Error(`Failed to save configuration: ${e}`)}}async ensureInitialized(){this.initialized||await this.initialize()}getDefaultConfig(){return{theme:"light",language:"en",powerShell:{maxPoolSize:10,minPoolSize:2,sessionTimeout:3e5,executionTimeout:6e4},discovery:{defaultTimeout:3e4,maxConcurrentOperations:5},ui:{enableAnimations:!0,compactMode:!1,showSystemStatus:!0},logging:{level:"info",maxLogFiles:10,maxLogSize:10485760},license:{machineId:void 0,key:void 0,customerId:void 0,type:void 0,activatedAt:void 0,expiresAt:void 0,features:[]},updates:{currentVersion:void 0,autoUpdateEnabled:!1,lastCheckTime:void 0,history:[]}}}}},"./src/main/services/consolidationEngine.ts":(e,t,r)=>{"use strict";r.d(t,{ConsolidationEngine:()=>c});var s=r("fs/promises"),o=r("path"),n=r("crypto"),i=r("./node_modules/uuid/index.js"),a=r("./src/main/services/decisionTraceHelpers.ts");class c{static instance;profileId="default";constructor(){}static getInstance(){return c.instance||(c.instance=new c),c.instance}setProfileId(e){this.profileId=e,console.log("[ConsolidationEngine] Profile context set:",e)}async consolidate(e){const t=performance.now();console.log("[ConsolidationEngine] Starting consolidation:",e);const r=await this.discoverCSVFiles(e);console.log(`[ConsolidationEngine] Discovered ${r.length} CSV files`);const s=await this.parseCSVFiles(r),o=Object.values(s).reduce((e,t)=>e+t.length,0);console.log(`[ConsolidationEngine] Parsed ${o} records across ${Object.keys(s).length} types`);const n=await this.createCanonicalEntities(s);console.log(`[ConsolidationEngine] Created ${n.length} canonical entities`);const{mergedEntities:i,mergeCount:c}=await this.performIdentityMatching(n);console.log(`[ConsolidationEngine] Merged ${c} duplicate entities, ${i.length} final entities`);const l=await this.inferRelationships(i,s);console.log(`[ConsolidationEngine] Inferred ${l.length} relationships`);const u=this.detectConflicts(i);console.log(`[ConsolidationEngine] Detected ${u} field conflicts`);const d=performance.now()-t;return await(0,a.traceConsolidationRun)(this.profileId,r.map(e=>({file:e.path,hash:e.hash,recordCount:e.recordCount})),{entitiesCreated:n.length,entitiesMerged:c,relationshipsInferred:l.length,conflictsDetected:u,processingTimeMs:d}),console.log(`[ConsolidationEngine] Consolidation complete in ${d.toFixed(2)}ms`),{entities:i,relationships:l,statistics:{inputFiles:r.length,recordsProcessed:o,entitiesCreated:n.length,entitiesMerged:c,relationshipsInferred:l.length,conflictsDetected:u,processingTimeMs:d}}}async discoverCSVFiles(e){const t=[],r=async e=>{try{const i=await s.readdir(e,{withFileTypes:!0});for(const a of i){const i=o.join(e,a.name);if(a.isDirectory())await r(i);else if(a.isFile()&&a.name.toLowerCase().endsWith(".csv")){const e=await s.readFile(i,"utf8"),r=n.createHash("sha256").update(e).digest("hex").substring(0,16),o=e.split("\n").length-1,{sourceSystem:a,entityType:c}=this.inferFileType(i);t.push({path:i,hash:r,recordCount:o,sourceSystem:a,entityType:c})}}}catch(t){console.warn("[ConsolidationEngine] Error scanning directory:",e,t)}};return await r(e),t}inferFileType(e){const t=o.basename(e).toLowerCase(),r=o.dirname(e).toLowerCase();let s="LOCAL";t.includes("azure")||t.includes("entra")?s="ENTRA":t.includes("intune")?s="INTUNE":t.includes("exchange")?s="EXCHANGE":t.includes("sharepoint")?s="SHAREPOINT":(r.includes("ad")||t.includes("activedirectory"))&&(s="AD");let n="INFRASTRUCTURE";return t.includes("user")?n="USER":t.includes("group")?n="GROUP":t.includes("app")||t.includes("application")?n="APPLICATION":(t.includes("computer")||t.includes("device")||t.includes("server"))&&(n="INFRASTRUCTURE"),{sourceSystem:s,entityType:n}}async parseCSVFiles(e){const t={USER:[],GROUP:[],APPLICATION:[],INFRASTRUCTURE:[]};for(const r of e)try{const e=(await s.readFile(r.path,"utf8")).split("\n").filter(e=>e.trim());if(e.length<2)continue;const o=e=>{const t=[];let r="",s=!1;for(let o=0;o<e.length;o++){const n=e[o];'"'===n?s=!s:","!==n||s?r+=n:(t.push(r.trim().replace(/^"|"$/g,"")),r="")}return t.push(r.trim().replace(/^"|"$/g,"")),t},n=o(e[0]);for(let s=1;s<e.length;s++){const i=o(e[s]);if(i.length<n.length/2)continue;const a={};n.forEach((e,t)=>{a[e]=i[t]||""});const c={data:a,sourceRef:{file:r.path,rowId:String(s),hash:r.hash,observedAt:(new Date).toISOString()},sourceSystem:r.sourceSystem};t[r.entityType].push(c)}}catch(e){console.error("[ConsolidationEngine] Error parsing CSV:",r.path,e)}return t}async createCanonicalEntities(e){const t=[];for(const[r,s]of Object.entries(e))for(const e of s){const s=await this.createCanonicalEntity(r,[e]);s&&t.push(s)}return t}async createCanonicalEntity(e,t){if(0===t.length)return null;const r=t[0].data,s=r.DisplayName||r.Name||r.UserPrincipalName||r.ComputerName||r.ApplicationName||r.GroupName||"";if(!s||""===s.trim())return null;const o=t.map(e=>({system:e.sourceSystem,id:e.data.ObjectId||e.data.Id||e.data.SID||e.data.GUID||s,tenantOrDomain:e.data.Domain||e.data.TenantId})),n={sources:[...new Set(t.map(e=>e.sourceSystem))],sourceRecordRefs:t.map(e=>e.sourceRef),confidence:1===t.length?1:.85,lastObservedAt:(new Date).toISOString()};let a={};switch(e){case"USER":a=this.extractUserAttributes(r);break;case"GROUP":a=this.extractGroupAttributes(r);break;case"APPLICATION":a=this.extractApplicationAttributes(r);break;case"INFRASTRUCTURE":a=this.extractInfrastructureAttributes(r)}return{id:(0,i.v4)(),entityType:e,displayName:s.trim(),externalIds:o,attributes:a,provenance:n,version:1,updatedAt:(new Date).toISOString()}}extractUserAttributes(e){return{userPrincipalName:e.UserPrincipalName||e.UPN,email:e.Mail||e.Email||e.PrimarySmtpAddress,displayName:e.DisplayName||e.Name,firstName:e.GivenName||e.FirstName,lastName:e.Surname||e.LastName,department:e.Department,jobTitle:e.JobTitle||e.Title,manager:e.Manager||e.ManagerDisplayName,accountEnabled:"True"===e.AccountEnabled||"True"===e.Enabled}}extractGroupAttributes(e){return{groupType:e.GroupType||e.Type,scope:e.Scope||e.GroupScope,description:e.Description,email:e.Mail||e.Email,memberCount:parseInt(e.MemberCount||"0",10),isSecurityEnabled:"True"===e.IsSecurityEnabled||"True"===e.SecurityEnabled,isMailEnabled:"True"===e.IsMailEnabled||"True"===e.MailEnabled}}extractApplicationAttributes(e){return{publisher:e.Publisher||e.Vendor,version:e.Version,category:e.Category||e.Type,criticality:e.Criticality,complexity:e.Complexity}}extractInfrastructureAttributes(e){return{computerName:e.ComputerName||e.Name||e.DeviceName,os:e.OperatingSystem||e.OS,osVersion:e.OSVersion||e.Version,manufacturer:e.Manufacturer,model:e.Model,serialNumber:e.SerialNumber,ipAddress:e.IPAddress||e.IP}}async performIdentityMatching(e){const t=[],r=new Set;let s=0;for(const o of e){if(r.has(o.id))continue;const n=e.filter(e=>e.id!==o.id&&!r.has(e.id)&&e.entityType===o.entityType&&this.arePotentialMatches(o,e));if(0===n.length){t.push(o),r.add(o.id);continue}const i=this.calculateIdentityMatch(o,n);if(i.confidence>=.7){const e=await this.mergeEntities(o,n,i);t.push(e),r.add(o.id),n.forEach(e=>r.add(e.id)),s+=n.length,await(0,a.traceIdentityMatch)(this.profileId,e.id,e.entityType,[o,...n].map(e=>({system:e.provenance.sources[0]||"LOCAL",externalId:e.externalIds[0]?.id||e.id,recordRef:e.provenance.sourceRecordRefs[0]||{file:"unknown"}})),i.evidence,i.confidence),await(0,a.traceEntityMerge)(this.profileId,e.id,[o.id,...n.map(e=>e.id)],e.entityType,{type:"SYSTEM",id:"consolidation-engine",displayName:"Consolidation Engine"},`Merged ${n.length+1} entities based on identity matching`,i.confidence)}else t.push(o),r.add(o.id)}return{mergedEntities:t,mergeCount:s}}arePotentialMatches(e,t){if(e.displayName.toLowerCase()===t.displayName.toLowerCase())return!0;for(const r of e.externalIds)for(const e of t.externalIds)if(r.id===e.id&&r.system!==e.system)return!0;if("USER"===e.entityType&&"USER"===t.entityType){const r=e.attributes.userPrincipalName?.toLowerCase(),s=t.attributes.userPrincipalName?.toLowerCase(),o=e.attributes.email?.toLowerCase(),n=t.attributes.email?.toLowerCase();if(r&&r===s||o&&o===n)return!0}return!1}calculateIdentityMatch(e,t){const r=[];let s=0,o=0;for(const n of t){e.displayName.toLowerCase()===n.displayName.toLowerCase()&&(r.push((0,a.createFieldMatchEvidence)("DisplayName",e.displayName,n.displayName,"Source1","Source2",1)),s+=1,o++);for(const t of e.externalIds)for(const e of n.externalIds)t.id===e.id&&t.system!==e.system&&(r.push((0,a.createFieldMatchEvidence)("ExternalId",t.id,e.id,t.system,e.system,.9)),s+=.9,o++);if("USER"===e.entityType&&"USER"===n.entityType){const t=e.attributes.userPrincipalName?.toLowerCase(),i=n.attributes.userPrincipalName?.toLowerCase();t&&t===i&&(r.push((0,a.createFieldMatchEvidence)("UserPrincipalName",t,i,"AD","Entra",.95)),s+=.95,o++)}}return{confidence:o>0?s/o:0,evidence:r,matchedRecords:[]}}async mergeEntities(e,t,r){const s=[e,...t],o=[];for(const e of s)for(const t of e.externalIds)o.some(e=>e.id===t.id&&e.system===t.system)||o.push(t);const n=[...new Set(s.flatMap(e=>e.provenance.sources))],a=s.flatMap(e=>e.provenance.sourceRecordRefs),c={};for(const e of s)for(const[t,r]of Object.entries(e.attributes))(!c[t]||r&&""!==String(r).trim())&&(c[t]=r);return{id:(0,i.v4)(),entityType:e.entityType,displayName:e.displayName,externalIds:o,attributes:c,provenance:{sources:n,sourceRecordRefs:a,confidence:r.confidence,lastObservedAt:(new Date).toISOString()},version:1,updatedAt:(new Date).toISOString()}}async inferRelationships(e,t){const r=[],s=new Map,o=new Map,n=new Map;for(const t of e){if(o.set(t.displayName.toLowerCase(),t),"USER"===t.entityType){const e=t.attributes.userPrincipalName;e&&s.set(e.toLowerCase(),t)}for(const e of t.externalIds)n.set(`${e.system}:${e.id}`,t)}for(const[e,s]of Object.entries(t))for(const t of s){const s=t.data,n=s.DisplayName||s.Name||s.UserPrincipalName||s.ComputerName||"",i=o.get(n.toLowerCase());if(i){if("USER"===e&&s.GroupMemberships){const e=String(s.GroupMemberships).split(";").map(e=>e.trim()).filter(Boolean);for(const s of e){const e=o.get(s.toLowerCase());if(e&&"GROUP"===e.entityType){const o=await this.createRelationship(i,e,"MEMBER_OF",[(0,a.createMembershipEvidence)(s,[i.displayName])],.9,[t.sourceRef]);r.push(o)}}}if("USER"===e&&s.AssignedDevices){const e=String(s.AssignedDevices).split(";").map(e=>e.trim()).filter(Boolean);for(const s of e){const e=o.get(s.toLowerCase());if(e&&"INFRASTRUCTURE"===e.entityType){const o=await this.createRelationship(i,e,"HAS_DEVICE",[(0,a.createOwnershipEvidence)("AssignedDevices",s)],.85,[t.sourceRef]);r.push(o)}}}if("INFRASTRUCTURE"===e&&s.InstalledApplications){const e=String(s.InstalledApplications).split(";").map(e=>e.trim()).filter(Boolean);for(const s of e){const e=o.get(s.toLowerCase());if(e&&"APPLICATION"===e.entityType){const o=await this.createRelationship(i,e,"HOSTS_APPLICATION",[(0,a.createAccessEvidence)("Installed",s)],.8,[t.sourceRef]);r.push(o)}}}}}return console.log(`[ConsolidationEngine] Inferred ${r.length} relationships`),r}async createRelationship(e,t,r,s,o,n){const c=(0,i.v4)(),l={id:c,type:r,fromEntityId:e.id,toEntityId:t.id,attributes:{},provenance:{inferred:!0,sources:[...new Set(n.map(e=>e.file))],sourceRecordRefs:n,confidence:o,rationale:`Inferred ${r} relationship based on ${s.length} pieces of evidence`},version:1,updatedAt:(new Date).toISOString(),isActive:!0};return await(0,a.traceRelationshipInferred)(this.profileId,c,e.id,t.id,r,s,o,n),l}detectConflicts(e){let t=0;for(const r of e)if(r.provenance.sources.length>1){const e=[];e.length>0&&(r.provenance.conflicts=e,t++)}return t}}c.getInstance()},"./src/main/services/credentialService.ts":(e,t,r)=>{"use strict";r.d(t,{CredentialService:()=>a});var s=r("fs"),o=r("path"),n=r.n(o),i=r("electron");class a{credentialsPath;store={credentials:[]};initialized=!1;constructor(){const e=i.app.getPath("userData");this.credentialsPath=n().join(e,"credentials.enc")}async initialize(){if(!this.initialized){if(!i.safeStorage.isEncryptionAvailable())return console.warn("Encryption not available - credentials will not be stored"),void(this.initialized=!0);try{const e=await s.promises.readFile(this.credentialsPath),t=i.safeStorage.decryptString(e);this.store=JSON.parse(t)}catch(e){"ENOENT"!==e.code&&console.error("Error loading credentials:",e),this.store={credentials:[]}}this.initialized=!0}}async storeCredential(e,t,r,s,o,n,a){if(await this.ensureInitialized(),!i.safeStorage.isEncryptionAvailable())throw new Error("Encryption not available - cannot store credentials");const c=i.safeStorage.encryptString(r).toString("base64");this.store.credentials=this.store.credentials.filter(t=>t.profileId!==e),this.store.credentials.push({profileId:e,username:t,encryptedPassword:c,domain:o,connectionType:s,createdAt:(new Date).toISOString(),tenantId:n,clientId:a}),await this.save()}async clearCachedCredential(e){await this.ensureInitialized();const t=this.store.credentials.some(t=>t.profileId===e);this.store.credentials=this.store.credentials.filter(t=>t.profileId!==e),t&&(console.log(`[CredentialService]  Cleared cached credentials for profile: ${e}`),await this.save())}async getCredential(e){await this.ensureInitialized(),console.log("[CredentialService] ========================================"),console.log(`[CredentialService] getCredential called for profile: ${e}`),console.log("[CredentialService] ========================================");const t=this.getCredentialsFromEnv();if(t)return console.log(`[CredentialService]  Using ENV variables for profile: ${e}`),console.log(`[CredentialService] TenantId: ${t.tenantId?.substring(0,8)}...`),console.log(`[CredentialService] ClientId: ${t.clientId?.substring(0,8)}...`),t;console.log("[CredentialService] Checking legacy file FIRST (fresh from disk)...");const r=await this.loadLegacyCredentials(e);if(r){console.log(`[CredentialService]  Successfully loaded FRESH credentials from file for profile: ${e}`),console.log(`[CredentialService] TenantId: ${r.TenantId?.substring(0,8)}...`),console.log(`[CredentialService] ClientId: ${r.ClientId?.substring(0,8)}...`),console.log(`[CredentialService] ClientSecret length: ${r.ClientSecret?.length||0} characters`),console.log(`[CredentialService] Domain: ${r.Domain||"N/A"}`);const t=this.store.credentials.find(t=>t.profileId===e);return t&&t.clientId!==r.ClientId&&(console.warn("[CredentialService]  Cached credentials are STALE (different ClientId)"),console.warn(`[CredentialService] Cached: ${t.clientId}, File: ${r.ClientId}`),console.warn("[CredentialService] Clearing stale cached credentials..."),await this.clearCachedCredential(e)),{username:r.ClientId,password:r.ClientSecret,connectionType:"AzureAD",tenantId:r.TenantId,clientId:r.ClientId,clientSecret:r.ClientSecret}}console.log("[CredentialService] No legacy file found, checking safeStorage cache as fallback...");const s=this.store.credentials.find(t=>t.profileId===e);if(s){if(console.log(`[CredentialService] Found safeStorage credentials for profile: ${e}`),!i.safeStorage.isEncryptionAvailable())throw new Error("Encryption not available - cannot decrypt credentials");try{const e=Buffer.from(s.encryptedPassword,"base64"),t=i.safeStorage.decryptString(e);return s.lastUsed=(new Date).toISOString(),await this.save(),console.log("[CredentialService]  Successfully decrypted safeStorage credentials"),console.log(`[CredentialService] Username: ${s.username}`),console.log(`[CredentialService] Connection type: ${s.connectionType}`),console.log(`[CredentialService] TenantId: ${s.tenantId?.substring(0,8)}...`),console.log(`[CredentialService] ClientId: ${s.clientId?.substring(0,8)}...`),{username:s.username,password:t,domain:s.domain,connectionType:s.connectionType,tenantId:s.tenantId,clientId:s.clientId,clientSecret:t}}catch(e){throw console.error("[CredentialService]  Error decrypting safeStorage credential:",e),new Error("Failed to decrypt credential")}}return console.warn(`[CredentialService]  No credentials found for profile: ${e}`),console.warn(`[CredentialService] Checked legacy path: C:\\DiscoveryData\\${e}\\Credentials\\discoverycredentials.config`),console.log("[CredentialService] ========================================"),null}getCredentialsFromEnv(){const e=process.env.AZURE_TENANT_ID,t=process.env.AZURE_CLIENT_ID,r=process.env.AZURE_CLIENT_SECRET;return e&&t&&r?{username:t,password:r,tenantId:e,clientId:t,clientSecret:r,connectionType:"AzureAD"}:null}async loadLegacyCredentials(e){try{const t=n().join("C:","DiscoveryData",e,"Credentials","discoverycredentials.config");console.log(`[CredentialService] Checking legacy credentials at: ${t}`);try{await s.promises.access(t)}catch{return null}let r=await s.promises.readFile(t,"utf-8");65279===r.charCodeAt(0)&&(r=r.slice(1)),r=r.trim();try{const e=JSON.parse(r);if(e.Encrypted&&e.ClientSecret){console.log("[CredentialService]  Detected encrypted fields in JSON credentials"),console.log("[CredentialService] Decrypting ClientSecret via DPAPI...");const t=await this.decryptStringWithPowerShell(e.ClientSecret);t?(e.ClientSecret=t,e.Encrypted=!1,console.log("[CredentialService]  Successfully decrypted ClientSecret")):console.error("[CredentialService]  Failed to decrypt ClientSecret")}return e.TenantId&&e.ClientId&&e.ClientSecret?(console.log("[CredentialService]  Loaded legacy credentials"),e):(console.warn("[CredentialService] Legacy credentials missing required fields"),null)}catch(e){return console.log("[CredentialService] File is not JSON, attempting whole-file DPAPI decryption..."),await this.decryptLegacyCredentialsDPAPI(t)}}catch(e){return"ENOENT"!==e.code&&console.error("[CredentialService] Error loading legacy credentials:",e),null}}async validateCredentialFile(e){try{const t=await s.promises.stat(e);console.log(`[CredentialService] File size: ${t.size} bytes, modified: ${t.mtime}`);const r=await s.promises.readFile(e,"utf-8"),o=(r.trim(),65279===r.charCodeAt(0));console.log(`[CredentialService] Has BOM: ${o}`);try{const e=JSON.parse(o?r.slice(1):r);return console.log(`[CredentialService] File is valid JSON with keys: ${Object.keys(e).join(", ")}`),{isValid:!0,format:"plain",details:"Valid JSON format"}}catch{return console.log("[CredentialService] File is not JSON, likely DPAPI encrypted"),{isValid:!0,format:"dpapi",details:"Non-JSON content, likely DPAPI encrypted"}}}catch(e){return{isValid:!1,format:"corrupted",details:`File read error: ${e instanceof Error?e.message:String(e)}`}}}async decryptStringWithPowerShell(e){const{spawn:t}=await Promise.resolve().then(r.t.bind(r,"child_process",23)),s=`\n      try {\n        $ss = ConvertTo-SecureString -String '${e}'\n        $bstr = [Runtime.InteropServices.Marshal]::SecureStringToBSTR($ss)\n        $plain = [Runtime.InteropServices.Marshal]::PtrToStringAuto($bstr)\n        [Runtime.InteropServices.Marshal]::ZeroFreeBSTR($bstr)\n        Write-Output $plain\n      } catch {\n        # Silent fail for cleaner logs, caller handles null\n        exit 1\n      }\n    `;return new Promise(e=>{const r=t("powershell.exe",["-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-Command",s]);let o="";r.stdout?.on("data",e=>{o+=e.toString()}),r.on("close",t=>{e(0===t?o.trim():null)}),r.on("error",()=>{e(null)})})}async executePowerShellDecryption(e,t){const{spawn:s}=await Promise.resolve().then(r.t.bind(r,"child_process",23));return new Promise(t=>{const r=s("powershell.exe",["-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-Command",e]);let o="",n="";r.stdout?.on("data",e=>{o+=e.toString()}),r.stderr?.on("data",e=>{n+=e.toString()}),r.on("close",e=>{if(0!==e)return console.error(`[CredentialService] PowerShell exit code: ${e}`),console.error(`[CredentialService] stderr: ${n}`),void t(null);try{const e=o.trim();console.log(`[CredentialService] PowerShell output length: ${e.length} characters`);const r=JSON.parse(e);if(!r.TenantId||!r.ClientId||!r.ClientSecret)return console.warn("[CredentialService] Decrypted credentials missing required fields"),console.warn(`[CredentialService] Has TenantId: ${!!r.TenantId}, Has ClientId: ${!!r.ClientId}, Has ClientSecret: ${!!r.ClientSecret}`),void t(null);console.log("[CredentialService]  Successfully parsed decrypted credentials"),console.log(`[CredentialService] ClientSecret length: ${r.ClientSecret?.length||0} characters`),t(r)}catch(e){console.error("[CredentialService] Failed to parse PowerShell output as JSON:",e),console.error(`[CredentialService] Output was: ${o.substring(0,200)}...`),t(null)}}),r.on("error",e=>{console.error("[CredentialService] PowerShell process error:",e),t(null)})})}async decryptLegacyCredentialsDPAPI(e){try{console.log("[CredentialService] ========================================"),console.log(`[CredentialService] Starting DPAPI decryption for: ${e}`),console.log("[CredentialService] ========================================");const t=await this.validateCredentialFile(e);if(console.log(`[CredentialService] File validation: ${t.format} - ${t.details}`),!t.isValid)return console.error(`[CredentialService]  File validation failed: ${t.details}`),null;const r=e.replace(/\\/g,"\\\\"),s=[{name:"Hex-encoded DPAPI (Enhanced - Roo Fix)",script:`\n            try {\n              $hex = (Get-Content -Raw -Path '${r}').Trim()\n              if ($hex[0] -eq [char]0xFEFF) { $hex = $hex.Substring(1) }\n\n              # Check if it looks like hex (DPAPI blob header: 01000000d08c9ddf...)\n              if ($hex -match '^[0-9A-Fa-f]+$') {\n                 if ($hex.Length % 2 -ne 0) {\n                   Write-Error "Invalid hex string length: $($hex.Length)"\n                   exit 1\n                 }\n\n                 # Convert Hex to Byte[] using .NET for better performance\n                 $byteCount = $hex.Length / 2\n                 $bytes = New-Object byte[] $byteCount\n\n                 for ($i = 0; $i -lt $byteCount; $i++) {\n                   $bytes[$i] = [Convert]::ToByte($hex.Substring($i * 2, 2), 16)\n                 }\n\n                 # Verify DPAPI header (should start with 01000000)\n                 if ($bytes[0] -ne 0x01 -or $bytes[1] -ne 0x00 -or $bytes[2] -ne 0x00 -or $bytes[3] -ne 0x00) {\n                   Write-Error "Invalid DPAPI blob header"\n                   exit 1\n                 }\n\n                 # Decrypt using DPAPI\n                 Add-Type -AssemblyName System.Security\n                 $decryptedBytes = [System.Security.Cryptography.ProtectedData]::Unprotect(\n                   $bytes,\n                   $null,\n                   [System.Security.Cryptography.DataProtectionScope]::CurrentUser\n                 )\n\n                 # Convert to UTF-8 string\n                 $json = [System.Text.Encoding]::UTF8.GetString($decryptedBytes)\n\n                 # Verify it's valid JSON before returning\n                 $null = $json | ConvertFrom-Json -ErrorAction Stop\n\n                 Write-Output $json\n              } else {\n                 Write-Error "Content is not a hex string (expected DPAPI blob)"\n                 exit 1\n              }\n            } catch {\n              Write-Error "Hex DPAPI decryption failed: $($_.Exception.Message)"\n              exit 1\n            }\n          `},{name:"Standard DPAPI SecureString (ConvertTo-SecureString)",script:`\n            try {\n              $enc = (Get-Content -Raw -Path '${r}').Trim()\n              if ($enc[0] -eq [char]0xFEFF) { $enc = $enc.Substring(1) }\n              $ss = $enc | ConvertTo-SecureString\n              $bstr = [Runtime.InteropServices.Marshal]::SecureStringToBSTR($ss)\n              $json = [Runtime.InteropServices.Marshal]::PtrToStringUni($bstr)\n              [Runtime.InteropServices.Marshal]::ZeroFreeBSTR($bstr)\n              Write-Output $json\n            } catch {\n              Write-Error $_.Exception.Message\n              exit 1\n            }\n          `},{name:"DPAPI ProtectedData.Unprotect (Base64)",script:`\n            try {\n              Add-Type -AssemblyName System.Security\n              $encContent = (Get-Content -Raw -Path '${r}').Trim()\n              if ($encContent[0] -eq [char]0xFEFF) { $encContent = $encContent.Substring(1) }\n\n              $encryptedBytes = [System.Convert]::FromBase64String($encContent)\n              $decryptedBytes = [System.Security.Cryptography.ProtectedData]::Unprotect(\n                $encryptedBytes,\n                $null,\n                [System.Security.Cryptography.DataProtectionScope]::CurrentUser\n              )\n              $json = [System.Text.Encoding]::UTF8.GetString($decryptedBytes)\n              Write-Output $json\n            } catch {\n              Write-Error $_.Exception.Message\n              exit 1\n            }\n          `},{name:"Check if already plain JSON",script:`\n            try {\n              $content = (Get-Content -Raw -Path '${r}').Trim()\n              if ($content[0] -eq [char]0xFEFF) { $content = $content.Substring(1) }\n\n              if ($content -match '^\\s*[{\\[]') {\n                Write-Output $content\n              } else {\n                Write-Error "Not plain JSON"\n                exit 1\n              }\n            } catch {\n              Write-Error $_.Exception.Message\n              exit 1\n            }\n          `},{name:"Hybrid approach (try DPAPI, fallback to plain)",script:`\n            try {\n              $content = (Get-Content -Raw -Path '${r}').Trim()\n              if ($content[0] -eq [char]0xFEFF) { $content = $content.Substring(1) }\n\n              # Check if it's plain JSON first\n              if ($content -match '^\\s*[{\\[]') {\n                Write-Output $content\n              } else {\n                # Try DPAPI decryption\n                try {\n                  $ss = $content | ConvertTo-SecureString -ErrorAction Stop\n                  $bstr = [Runtime.InteropServices.Marshal]::SecureStringToBSTR($ss)\n                  $json = [Runtime.InteropServices.Marshal]::PtrToStringUni($bstr)\n                  [Runtime.InteropServices.Marshal]::ZeroFreeBSTR($bstr)\n                  Write-Output $json\n                } catch {\n                  # Try Base64 DPAPI\n                  Add-Type -AssemblyName System.Security\n                  $encryptedBytes = [System.Convert]::FromBase64String($content)\n                  $decryptedBytes = [System.Security.Cryptography.ProtectedData]::Unprotect(\n                    $encryptedBytes,\n                    $null,\n                    [System.Security.Cryptography.DataProtectionScope]::CurrentUser\n                  )\n                  $json = [System.Text.Encoding]::UTF8.GetString($decryptedBytes)\n                  Write-Output $json\n                }\n              }\n            } catch {\n              Write-Error $_.Exception.Message\n              exit 1\n            }\n          `}];for(const[t,r]of s.entries()){console.log("[CredentialService] ----------------------------------------"),console.log(`[CredentialService] Trying approach ${t+1}/${s.length}: ${r.name}`),console.log("[CredentialService] ----------------------------------------");try{const s=await this.executePowerShellDecryption(r.script,e);if(s)return console.log(`[CredentialService]  Decryption approach ${t+1} succeeded: ${r.name}`),console.log("[CredentialService] ========================================"),s;console.warn(`[CredentialService]  Approach ${t+1} returned null: ${r.name}`)}catch(e){console.warn(`[CredentialService]  Approach ${t+1} failed: ${r.name}`,e)}}return console.error(`[CredentialService]  All ${s.length} DPAPI decryption approaches failed`),console.log("[CredentialService] ========================================"),null}catch(e){return console.error("[CredentialService]  Error in DPAPI decryption:",e),null}}async migrateLegacyCredentials(e,t){try{if(console.log("[CredentialService] ========================================"),console.log(`[CredentialService] Starting credential migration for profile: ${e}`),console.log("[CredentialService] ========================================"),!t.TenantId||!t.ClientId||!t.ClientSecret){const e=[];throw t.TenantId||e.push("TenantId"),t.ClientId||e.push("ClientId"),t.ClientSecret||e.push("ClientSecret"),new Error(`Legacy credentials missing required fields: ${e.join(", ")}`)}console.log("[CredentialService] Validation passed - all required fields present"),console.log(`[CredentialService] TenantId: ${t.TenantId.substring(0,8)}...`),console.log(`[CredentialService] ClientId: ${t.ClientId.substring(0,8)}...`),console.log(`[CredentialService] ClientSecret length: ${t.ClientSecret.length} characters`),await this.storeCredential(e,t.ClientId,t.ClientSecret,"AzureAD",t.Domain,t.TenantId,t.ClientId),console.log("[CredentialService]  Credentials stored in safeStorage");try{const t=n().join("C:","DiscoveryData",e,"Credentials","discoverycredentials.config"),r=`${t}.migrated.${(new Date).toISOString().replace(/[:.]/g,"-")}`;await s.promises.copyFile(t,r),console.log(`[CredentialService]  Backed up original credentials to: ${r}`)}catch(e){console.warn("[CredentialService]  Failed to backup original file (non-fatal):",e)}console.log(`[CredentialService]  Successfully migrated credentials for profile: ${e}`),console.log("[CredentialService] ========================================")}catch(e){throw console.error("[CredentialService]  Migration failed:",e),console.error("[CredentialService] Error details:",e instanceof Error?e.message:String(e)),console.log("[CredentialService] ========================================"),new Error(`Failed to migrate credentials: ${e instanceof Error?e.message:String(e)}`)}}async deleteCredential(e){await this.ensureInitialized(),this.store.credentials=this.store.credentials.filter(t=>t.profileId!==e),await this.save()}async hasCredential(e){if(await this.ensureInitialized(),this.getCredentialsFromEnv())return!0;return null!==await this.loadLegacyCredentials(e)||!!this.store.credentials.some(t=>t.profileId===e)}async listProfiles(){return await this.ensureInitialized(),this.store.credentials.map(e=>({profileId:e.profileId,username:e.username,connectionType:e.connectionType,createdAt:e.createdAt,lastUsed:e.lastUsed}))}async clearAll(){this.store={credentials:[]},await this.save()}async save(){if(i.safeStorage.isEncryptionAvailable())try{await s.promises.mkdir(n().dirname(this.credentialsPath),{recursive:!0});const e=JSON.stringify(this.store),t=i.safeStorage.encryptString(e);await s.promises.writeFile(this.credentialsPath,t)}catch(e){throw console.error("Error saving credentials:",e),new Error(`Failed to save credentials: ${e}`)}}validateCredentialStructure(e){return console.log("[CredentialService] Validating credential structure"),e?e.TenantId&&"string"==typeof e.TenantId?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.TenantId)?e.ClientId&&"string"==typeof e.ClientId?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.ClientId)?e.ClientSecret&&"string"==typeof e.ClientSecret?e.ClientSecret.length<8?(console.error("[CredentialService]  ClientSecret too short (minimum 8 characters)"),!1):(console.log("[CredentialService]  Credential structure is valid"),console.log(`[CredentialService]   TenantId: ${e.TenantId.substring(0,8)}...`),console.log(`[CredentialService]   ClientId: ${e.ClientId.substring(0,8)}...`),console.log(`[CredentialService]   ClientSecret length: ${e.ClientSecret.length} chars`),!0):(console.error("[CredentialService]  ClientSecret missing or invalid"),!1):(console.error("[CredentialService]  ClientId is not a valid GUID"),!1):(console.error("[CredentialService]  ClientId missing or invalid"),!1):(console.error("[CredentialService]  TenantId is not a valid GUID"),!1):(console.error("[CredentialService]  TenantId missing or invalid"),!1):(console.error("[CredentialService]  Credentials object is null/undefined"),!1)}async readCredentialsFromFile(e){const t=r("fs"),{execSync:s}=r("child_process");try{const r=n().join("C:\\DiscoveryData",e,"Credentials"),o=n().join(r,"credential_summary.json"),i=n().join(r,"discoverycredentials.config");console.log("[CredentialService] ========================================"),console.log("[CredentialService] Reading FRESH credentials from file system"),console.log(`[CredentialService] Company: ${e}`),console.log(`[CredentialService] Path: ${r}`),console.log("[CredentialService] ========================================");let a=null,c=null,l=null;if(t.existsSync(o)){console.log("[CredentialService] Found credential_summary.json");const e=t.readFileSync(o,"utf-8"),r=JSON.parse(e);a=r.TenantId||r.tenantId,c=r.ClientId||r.clientId,console.log(`[CredentialService] From summary - TenantId: ${a}, ClientId: ${c}`)}else console.log("[CredentialService] credential_summary.json not found");if(t.existsSync(i)){console.log("[CredentialService] Found discoverycredentials.config, decrypting...");try{const e=t.readFileSync(i,"utf-8").trim(),r=s(`powershell -NoProfile -ExecutionPolicy Bypass -Command "${`\n            Add-Type -AssemblyName System.Security\n            $bytes = [Convert]::FromBase64String('${e.replace(/'/g,"''")}')\n            $decrypted = [System.Security.Cryptography.ProtectedData]::Unprotect($bytes, $null, [System.Security.Cryptography.DataProtectionScope]::CurrentUser)\n            $json = [System.Text.Encoding]::UTF8.GetString($decrypted)\n            Write-Output $json\n          `.replace(/"/g,'\\"').replace(/\r?\n/g," ")}"`,{encoding:"utf-8",timeout:3e4}).trim(),o=JSON.parse(r);a=o.TenantId||o.tenantId||a,c=o.ClientId||o.clientId||c,l=o.ClientSecret||o.clientSecret,console.log("[CredentialService]  Decrypted successfully"),console.log(`[CredentialService] TenantId: ${a}`),console.log(`[CredentialService] ClientId: ${c}`),console.log(`[CredentialService] Secret length: ${l?.length||0}`)}catch(e){console.error("[CredentialService]  Failed to decrypt config file:",e)}}else console.log("[CredentialService] discoverycredentials.config not found");return a&&c&&l?(console.log("[CredentialService]  Complete credentials loaded from file system"),{tenantId:a,clientId:c,clientSecret:l}):(console.warn("[CredentialService]  Could not read complete credentials from files"),null)}catch(e){return console.error("[CredentialService]  Error reading credentials from file:",e),null}}async testConnection(e){console.log("[CredentialService] ========================================"),console.log(`[CredentialService] Testing connection for profile: ${e}`),console.log("[CredentialService] CLEARING CACHE and reading FRESH credentials from files"),console.log("[CredentialService] ========================================");try{console.log("[CredentialService] Step 0: Clearing cached credentials to ensure fresh read"),await this.clearCachedCredential(e),console.log("[CredentialService] Step 1: Reading credentials DIRECTLY from file system");const t=await this.readCredentialsFromFile(e);let r=null;if(t)console.log("[CredentialService]  Using FRESH credentials from file system"),console.log(`[CredentialService] ClientId from file: ${t.clientId}`),r=t;else{console.log("[CredentialService]  Direct file read failed, trying getCredential (will read from files)");const t=await this.getCredential(e);t&&(r={tenantId:t.tenantId,clientId:t.clientId,clientSecret:t.clientSecret})}if(!r)return console.error("[CredentialService]  No credentials found"),{success:!1,decryptionSuccess:!1,connectionSuccess:!1,error:"No credentials found for this profile"};console.log("[CredentialService]  Credentials retrieved successfully"),console.log("[CredentialService] Step 2: Validating credential structure");const s=await this.loadLegacyCredentials(e);if(s&&!this.validateCredentialStructure(s))return console.error("[CredentialService]  Credential structure validation failed"),{success:!1,decryptionSuccess:!0,connectionSuccess:!1,error:"Invalid credential structure - missing required fields or invalid format"};console.log("[CredentialService]  Credential structure valid"),console.log("[CredentialService] Step 3: Testing Microsoft Graph API connection");const{tenantId:o,clientId:n,clientSecret:i}=r;if(!o||!n||!i)return console.error("[CredentialService]  Missing required Azure AD credentials"),{success:!1,decryptionSuccess:!0,connectionSuccess:!1,error:"Missing required Azure AD credentials (tenantId, clientId, or clientSecret)"};const a=await this.testGraphAPIConnection(o,n,i);if(a.success){console.log("[CredentialService]  Graph API connection successful");const e=a.expiresIn??3600;return console.log(`[CredentialService] Token expires in: ${e} seconds`),console.log("[CredentialService] ========================================"),{success:!0,decryptionSuccess:!0,connectionSuccess:!0,details:`Authentication successful. Token valid for ${Math.floor(e/60)} minutes.`}}return console.error("[CredentialService]  Graph API connection failed"),console.error(`[CredentialService] Error: ${a.error}`),console.log("[CredentialService] ========================================"),{success:!1,decryptionSuccess:!0,connectionSuccess:!1,error:a.error}}catch(e){return console.error("[CredentialService]  Connection test failed with exception:",e),console.log("[CredentialService] ========================================"),{success:!1,decryptionSuccess:!1,connectionSuccess:!1,error:e instanceof Error?e.message:String(e)}}}async testGraphAPIConnection(e,t,r){try{const s=`https://login.microsoftonline.com/${e}/oauth2/v2.0/token`,o=new URLSearchParams({grant_type:"client_credentials",client_id:t,client_secret:r,scope:"https://graph.microsoft.com/.default"});console.log(`[CredentialService] Requesting token from: ${s}`);const n=await fetch(s,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o.toString()});if(!n.ok){const e=await n.text();console.error(`[CredentialService] Token request failed: ${n.status} ${n.statusText}`),console.error(`[CredentialService] Response: ${e}`);try{const t=JSON.parse(e);return{success:!1,error:`Azure AD authentication failed: ${t.error_description||t.error||"Unknown error"}`}}catch{return{success:!1,error:`HTTP ${n.status}: ${n.statusText}`}}}const i=await n.json();return console.log("[CredentialService] Token acquired successfully"),{success:!0,expiresIn:i.expires_in||3600}}catch(e){return console.error("[CredentialService] Exception during Graph API test:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error during authentication"}}}async ensureInitialized(){this.initialized||await this.initialize()}}},"./src/main/services/dashboardService.ts":(e,t,r)=>{"use strict";r.d(t,{DashboardService:()=>n});var s=r("fs/promises"),o=r("path");class n{logicEngine;projectService;statsCache=new Map;cacheTimeout=1e4;constructor(e,t){this.logicEngine=e,this.projectService=t}async getStats(e){const t=this.statsCache.get(e);if(t&&Date.now()-t.timestamp<this.cacheTimeout)return t.data;const r=o.join("C:","discoverydata",e,"Raw");try{await this.logicEngine.loadAllAsync(r)}catch(e){console.warn("Logic Engine load warning:",e)}const s={totalUsers:this.logicEngine.getUserCount(),totalGroups:this.logicEngine.getGroupCount(),totalComputers:this.logicEngine.getDeviceCount(),totalInfrastructure:this.logicEngine.getInfrastructureCount(),discoveredUsers:this.logicEngine.getDiscoveredUserCount(),discoveredGroups:this.logicEngine.getDiscoveredGroupCount(),discoveredComputers:this.logicEngine.getDiscoveredDeviceCount(),discoveredApplications:this.logicEngine.getApplicationCount(),migratedUsers:await this.getMigratedUserCount(e),migratedGroups:await this.getMigratedGroupCount(e),pendingMigrationUsers:await this.getPendingMigrationUserCount(e),pendingMigrationGroups:await this.getPendingMigrationGroupCount(e),lastDiscoveryRun:this.logicEngine.getLastDiscoveryRun(),lastMigrationRun:await this.getLastMigrationRun(e),lastDataRefresh:(new Date).toISOString(),dataSource:"LogicEngine"};return this.statsCache.set(e,{data:s,timestamp:Date.now()}),s}async getProjectTimeline(e){const t=await this.projectService.loadProjectConfig(e),r=new Date,s=new Date(t.targetCutover),o=new Date(t.startDate),n=(t.waves??[]).filter(e=>"Scheduled"===e.status&&new Date(e.scheduledDate)>r).sort((e,t)=>new Date(e.scheduledDate).getTime()-new Date(t.scheduledDate).getTime()),i=n.length>0?new Date(n[0].scheduledDate):new Date(r.getTime()+6048e5),a=this.calculateDaysDifference(r,s),c=this.calculateDaysDifference(r,i),l=this.calculateDaysDifference(o,r),u=t.waves??[],d=u.filter(e=>"Complete"===e.status).length,p=u.findIndex(e=>"InProgress"===e.status),h=this.calculatePhaseProgress(t.currentPhase,l,t.estimatedDuration),m=p>=0?this.calculateWaveProgress(u[p]):0,g=u.length>0?Math.round(d/u.length*100):0;return{projectId:t.id,projectName:t.name,projectDescription:t.description,projectStartDate:t.startDate,targetCutover:t.targetCutover,nextWave:i.toISOString(),daysToCutover:a,daysToNextWave:c,daysElapsed:l,currentPhase:t.currentPhase,phaseProgress:h,totalWaves:u.length,completedWaves:d,activeWave:p>=0?p+1:void 0,waveProgress:m,overallProgress:g,estimatedCompletionDate:this.calculateEstimatedCompletion(t,l)}}async getSystemHealth(){const e=Date.now(),t=await this.checkLogicEngineStatus(),r=await this.checkPowerShellStatus(),s=await this.checkFileSystemStatus(),o={status:"online",lastCheck:(new Date).toISOString(),responseTimeMs:0},n=process.memoryUsage(),i=Date.now()-e;return{logicEngineStatus:t,powerShellStatus:r,fileSystemStatus:s,networkStatus:o,dataFreshnessMinutes:await this.getDataFreshness(),avgResponseTimeMs:i,memoryUsageMB:Math.round(n.heapUsed/1024/1024),cpuUsagePercent:0,lastErrorCount:0,activeAlerts:[]}}async getRecentActivity(e,t=10){const r=o.join("C:","discoverydata",e,"Logs","activity.log");try{const e=(await s.readFile(r,"utf-8")).split("\n").filter(e=>e.trim());return e.slice(2*-t).reverse().map((e,t)=>{const r=e.match(/\[(.*?)\]\s*\[(.*?)\]\s*(.*)/);if(!r)return null;const[,s,o,n]=r;return{id:`activity-${Date.now()}-${t}`,type:this.mapActivityType(o),title:this.extractActivityTitle(n),description:n,timestamp:new Date(s).toISOString(),status:"info",actionUrl:this.getActivityActionUrl(o)}}).filter(e=>null!==e).slice(0,t)}catch(e){return[{id:"default-1",type:"system",title:"System Ready",description:"Dashboard service initialized successfully",timestamp:(new Date).toISOString(),status:"success"}]}}async acknowledgeAlert(e){console.log(`Alert acknowledged: ${e}`)}async getMigratedUserCount(e){return((await this.projectService.loadProjectConfig(e)).waves??[]).filter(e=>"Complete"===e.status).reduce((e,t)=>e+t.userCount,0)}async getMigratedGroupCount(e){return((await this.projectService.loadProjectConfig(e)).waves??[]).filter(e=>"Complete"===e.status).reduce((e,t)=>e+t.groupCount,0)}async getPendingMigrationUserCount(e){return((await this.projectService.loadProjectConfig(e)).waves??[]).filter(e=>"Scheduled"===e.status||"InProgress"===e.status).reduce((e,t)=>e+t.userCount,0)}async getPendingMigrationGroupCount(e){return((await this.projectService.loadProjectConfig(e)).waves??[]).filter(e=>"Scheduled"===e.status||"InProgress"===e.status).reduce((e,t)=>e+t.groupCount,0)}async getLastMigrationRun(e){const t=((await this.projectService.loadProjectConfig(e)).waves??[]).filter(e=>"Complete"===e.status&&e.completedAt).sort((e,t)=>new Date(t.completedAt).getTime()-new Date(e.completedAt).getTime());return t.length>0?t[0].completedAt:void 0}async checkLogicEngineStatus(){try{const e=Date.now(),t=this.logicEngine.getUserCount(),r=Date.now()-e;return{status:t>=0?"online":"degraded",lastCheck:(new Date).toISOString(),responseTimeMs:r}}catch(e){return{status:"offline",lastCheck:(new Date).toISOString(),errorMessage:e instanceof Error?e.message:"Unknown error"}}}async checkPowerShellStatus(){return{status:"online",lastCheck:(new Date).toISOString(),responseTimeMs:50}}async checkFileSystemStatus(){try{return await s.access(o.join("C:","discoverydata")),{status:"online",lastCheck:(new Date).toISOString()}}catch{return{status:"offline",lastCheck:(new Date).toISOString(),errorMessage:"Data directory not accessible"}}}async getDataFreshness(){const e=this.logicEngine.getLastDiscoveryRun();if(!e)return 0;const t=new Date(e),r=(new Date).getTime()-t.getTime();return Math.floor(r/6e4)}calculateDaysDifference(e,t){const r=t.getTime()-e.getTime();return Math.ceil(r/864e5)}calculatePhaseProgress(e,t,r){return{Discovery:20,Planning:20,Migration:40,Validation:15,Cutover:5,Complete:100}[e]||0}calculateWaveProgress(e){return"Complete"===e.status?100:"InProgress"===e.status?50:0}calculateEstimatedCompletion(e,t){const r=7*(e.waves??[]).filter(e=>"Complete"!==e.status).length;return new Date(Date.now()+24*r*60*60*1e3).toISOString()}mapActivityType(e){return{DISCOVERY:"discovery",MIGRATION:"migration",VALIDATION:"validation",CONFIG:"configuration",CONFIGURATION:"configuration",ERROR:"error",SYSTEM:"system"}[e.toUpperCase()]||"system"}extractActivityTitle(e){const t=e.split(".")[0];return t.length>50?t.substring(0,47)+"...":t}getActivityActionUrl(e){return{DISCOVERY:"/discovery",MIGRATION:"/migration",VALIDATION:"/validation",CONFIG:"/settings",CONFIGURATION:"/settings"}[e.toUpperCase()]}invalidateCache(e){e?this.statsCache.delete(e):this.statsCache.clear()}}},"./src/main/services/decisionTraceHelpers.ts":(e,t,r)=>{"use strict";r.d(t,{createAccessEvidence:()=>h,createFieldMatchEvidence:()=>u,createMembershipEvidence:()=>d,createOwnershipEvidence:()=>p,traceConsolidationRun:()=>i,traceEntityMerge:()=>c,traceIdentityMatch:()=>a,traceRelationshipInferred:()=>l});var s=r("./node_modules/uuid/index.js"),o=r("./src/main/services/decisionTraceService.ts");async function n(e){const t={id:(0,s.v4)(),profileId:e.profileId,occurredAt:(new Date).toISOString(),actor:e.actor,kind:e.kind,subject:{entityId:e.entityId,relationId:e.relationId,entityType:e.entityType},inputs:e.inputs||[],policy:e.policyId?{policyId:e.policyId,policyVersion:e.policyVersion||"1.0",rule:e.policyRule}:void 0,precedent:e.precedentTraceIds&&e.precedentTraceIds.length>0?{traceIds:e.precedentTraceIds,note:e.precedentNote}:void 0,decision:{action:e.action,before:e.before,after:e.after},rationale:{summary:e.summary,evidence:e.evidence||[],confidence:e.confidence,exception:e.exception},outcomes:{entityVersionBumps:e.entityId?[e.entityId]:[],relationVersionBumps:e.relationId?[e.relationId]:[]}};return await o.decisionTraceService.appendTrace(t),t}async function i(e,t,r){return n({profileId:e,kind:"CONSOLIDATION_RUN",actor:{type:"SYSTEM",id:"consolidation-engine",displayName:"Consolidation Engine"},action:"CONSOLIDATE",summary:`Consolidated ${t.length} input files: ${r.entitiesCreated} entities created, ${r.entitiesMerged} merged, ${r.relationshipsInferred} relationships inferred`,confidence:1,inputs:t.map(e=>({system:"LOCAL",ref:{file:e.file},snapshotHash:e.hash})),before:{inputFiles:t.length,entities:0,relations:0},after:{entities:r.entitiesCreated,merged:r.entitiesMerged,relations:r.relationshipsInferred,conflicts:r.conflictsDetected,processingTimeMs:r.processingTimeMs}})}async function a(e,t,r,s,o,i){return n({profileId:e,kind:"IDENTITY_MATCH",actor:{type:"SYSTEM",id:"identity-resolver",displayName:"Identity Resolution Engine"},action:"MATCH",summary:`Matched ${s.length} identity sources with confidence ${(100*i).toFixed(0)}%`,confidence:i,entityId:t,entityType:r,evidence:o,inputs:s.map(e=>({system:e.system,ref:{file:e.recordRef.file,rowId:e.recordRef.rowId,externalId:e.externalId},snapshotHash:e.recordRef.hash})),before:{identitySources:s.map(e=>e.system)},after:{canonicalEntityId:t,confidence:i}})}async function c(e,t,r,s,o,i,a){return n({profileId:e,kind:"ENTITY_MERGE",actor:o,action:"MERGE",summary:i,confidence:a,entityId:t,entityType:s,before:{separateEntities:r},after:{mergedIntoEntity:t},evidence:[{type:"FIELD_MATCH",detail:`Merged ${r.length} duplicate entities into canonical entity ${t}`,weight:1}]})}async function l(e,t,r,s,o,i,a,c){return n({profileId:e,kind:"RELATIONSHIP_INFERRED",actor:{type:"SYSTEM",id:"relationship-engine",displayName:"Relationship Inference Engine"},action:"INFER_RELATIONSHIP",summary:`Inferred ${o} relationship between entities with confidence ${(100*a).toFixed(0)}%`,confidence:a,relationId:t,evidence:i,inputs:c.map(e=>({system:"LOCAL",ref:{file:e.file,rowId:e.rowId},snapshotHash:e.hash})),before:{fromEntity:r,toEntity:s,relationship:null},after:{relationId:t,type:o,inferred:!0}})}function u(e,t,r,s,o,n=.8){return{type:"FIELD_MATCH",detail:`Field '${e}' matches: ${s}='${t}'  ${o}='${r}'`,weight:n}}function d(e,t,r=.7){return{type:"MEMBERSHIP",detail:`Group '${e}' has ${t.length} members: ${t.slice(0,3).join(", ")}${t.length>3?"...":""}`,weight:r}}function p(e,t,r=.9){return{type:"OWNER",detail:`${e} indicates ownership: '${t}'`,weight:r}}function h(e,t,r=.6){return{type:"ACCESS",detail:`${e}: ${t}`,weight:r}}},"./src/main/services/decisionTraceService.ts":(e,t,r)=>{"use strict";r.d(t,{DecisionTraceService:()=>c,decisionTraceService:()=>l});var s=r("./node_modules/better-sqlite3/lib/index.js"),o=r.n(s),n=r("path"),i=r("fs"),a=r("electron");class c{static instance;db=null;dbPath;constructor(){const e=a.app.getPath("userData"),t=n.join(e,"DecisionTraces");i.existsSync(t)||i.mkdirSync(t,{recursive:!0}),this.dbPath=n.join(t,"decision-traces.db"),console.log("[DecisionTraceService] Database path:",this.dbPath)}static getInstance(){return c.instance||(c.instance=new c),c.instance}initialize(){this.db?console.log("[DecisionTraceService] Already initialized"):(console.log("[DecisionTraceService] Initializing database..."),this.db=new(o())(this.dbPath),this.db.pragma("journal_mode = WAL"),this.createSchema(),console.log("[DecisionTraceService] Initialized successfully"))}createSchema(){if(!this.db)throw new Error("Database not initialized");this.db.exec("\n      CREATE TABLE IF NOT EXISTS decision_traces (\n        id TEXT PRIMARY KEY,\n        profile_id TEXT NOT NULL,\n        occurred_at TEXT NOT NULL,\n\n        -- Actor\n        actor_type TEXT NOT NULL CHECK(actor_type IN ('HUMAN', 'AGENT', 'SYSTEM')),\n        actor_id TEXT,\n        actor_display_name TEXT,\n\n        -- Decision\n        kind TEXT NOT NULL,\n        subject_entity_id TEXT,\n        subject_relation_id TEXT,\n        subject_entity_type TEXT,\n\n        -- Core decision data\n        decision_action TEXT NOT NULL,\n        decision_before TEXT,  -- JSON\n        decision_after TEXT,   -- JSON\n\n        -- Rationale\n        rationale_summary TEXT NOT NULL,\n        rationale_confidence REAL NOT NULL CHECK(rationale_confidence >= 0 AND rationale_confidence <= 1),\n\n        -- Full trace as JSON (for complex queries)\n        trace_json TEXT NOT NULL,\n\n        -- Metadata\n        created_at TEXT NOT NULL DEFAULT (datetime('now')),\n\n        -- Indexes for common queries\n        CHECK (json_valid(trace_json))\n      );\n\n      CREATE INDEX IF NOT EXISTS idx_traces_profile ON decision_traces(profile_id);\n      CREATE INDEX IF NOT EXISTS idx_traces_occurred ON decision_traces(occurred_at);\n      CREATE INDEX IF NOT EXISTS idx_traces_kind ON decision_traces(kind);\n      CREATE INDEX IF NOT EXISTS idx_traces_entity ON decision_traces(subject_entity_id);\n      CREATE INDEX IF NOT EXISTS idx_traces_relation ON decision_traces(subject_relation_id);\n      CREATE INDEX IF NOT EXISTS idx_traces_actor ON decision_traces(actor_type, actor_id);\n      CREATE INDEX IF NOT EXISTS idx_traces_composite ON decision_traces(profile_id, subject_entity_id, kind);\n    "),this.db.exec("\n      CREATE TABLE IF NOT EXISTS decision_evidence (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        trace_id TEXT NOT NULL,\n        evidence_type TEXT NOT NULL,\n        detail TEXT NOT NULL,\n        weight REAL,\n\n        FOREIGN KEY (trace_id) REFERENCES decision_traces(id)\n      );\n\n      CREATE INDEX IF NOT EXISTS idx_evidence_trace ON decision_evidence(trace_id);\n      CREATE INDEX IF NOT EXISTS idx_evidence_type ON decision_evidence(evidence_type);\n    "),this.db.exec("\n      CREATE TABLE IF NOT EXISTS decision_inputs (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        trace_id TEXT NOT NULL,\n        system TEXT NOT NULL,\n        ref_file TEXT,\n        ref_row_id TEXT,\n        ref_external_id TEXT,\n        snapshot_hash TEXT,\n\n        FOREIGN KEY (trace_id) REFERENCES decision_traces(id)\n      );\n\n      CREATE INDEX IF NOT EXISTS idx_inputs_trace ON decision_inputs(trace_id);\n      CREATE INDEX IF NOT EXISTS idx_inputs_hash ON decision_inputs(snapshot_hash);\n    "),this.db.exec("\n      CREATE TABLE IF NOT EXISTS decision_policies (\n        id INTEGER PRIMARY KEY AUTOINCREMENT,\n        trace_id TEXT NOT NULL,\n        policy_id TEXT NOT NULL,\n        policy_version TEXT NOT NULL,\n        rule TEXT,\n\n        FOREIGN KEY (trace_id) REFERENCES decision_traces(id)\n      );\n\n      CREATE INDEX IF NOT EXISTS idx_policies_trace ON decision_policies(trace_id);\n      CREATE INDEX IF NOT EXISTS idx_policies_policy ON decision_policies(policy_id);\n    "),console.log("[DecisionTraceService] Schema created/verified")}async appendTrace(e){if(!this.db)throw new Error("Database not initialized");const t=this.db.prepare("\n      INSERT INTO decision_traces (\n        id, profile_id, occurred_at,\n        actor_type, actor_id, actor_display_name,\n        kind, subject_entity_id, subject_relation_id, subject_entity_type,\n        decision_action, decision_before, decision_after,\n        rationale_summary, rationale_confidence,\n        trace_json\n      ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ");try{this.db.transaction(()=>{if(t.run(e.id,e.profileId,e.occurredAt,e.actor.type,e.actor.id||null,e.actor.displayName||null,e.kind,e.subject.entityId||null,e.subject.relationId||null,e.subject.entityType||null,e.decision.action,e.decision.before?JSON.stringify(e.decision.before):null,e.decision.after?JSON.stringify(e.decision.after):null,e.rationale.summary,e.rationale.confidence,JSON.stringify(e)),e.rationale.evidence&&e.rationale.evidence.length>0){const t=this.db.prepare("\n            INSERT INTO decision_evidence (trace_id, evidence_type, detail, weight)\n            VALUES (?, ?, ?, ?)\n          ");for(const r of e.rationale.evidence)t.run(e.id,r.type,r.detail,r.weight||null)}if(e.inputs&&e.inputs.length>0){const t=this.db.prepare("\n            INSERT INTO decision_inputs (trace_id, system, ref_file, ref_row_id, ref_external_id, snapshot_hash)\n            VALUES (?, ?, ?, ?, ?, ?)\n          ");for(const r of e.inputs)t.run(e.id,r.system,r.ref.file||null,r.ref.rowId||null,r.ref.externalId||null,r.snapshotHash||null)}if(e.policy){this.db.prepare("\n            INSERT INTO decision_policies (trace_id, policy_id, policy_version, rule)\n            VALUES (?, ?, ?, ?)\n          ").run(e.id,e.policy.policyId,e.policy.policyVersion,e.policy.rule||null)}})(),console.log("[DecisionTraceService] Trace appended:",{id:e.id,kind:e.kind,profileId:e.profileId})}catch(e){throw console.error("[DecisionTraceService] Failed to append trace:",e),e}}async queryTraces(e={}){if(!this.db)throw new Error("Database not initialized");let t="SELECT trace_json FROM decision_traces WHERE 1=1";const r=[];e.profileId&&(t+=" AND profile_id = ?",r.push(e.profileId)),e.entityId&&(t+=" AND subject_entity_id = ?",r.push(e.entityId)),e.relationId&&(t+=" AND subject_relation_id = ?",r.push(e.relationId)),e.kind&&(Array.isArray(e.kind)?(t+=` AND kind IN (${e.kind.map(()=>"?").join(",")})`,r.push(...e.kind)):(t+=" AND kind = ?",r.push(e.kind))),e.actorType&&(t+=" AND actor_type = ?",r.push(e.actorType)),e.actorId&&(t+=" AND actor_id = ?",r.push(e.actorId)),e.startDate&&(t+=" AND occurred_at >= ?",r.push(e.startDate)),e.endDate&&(t+=" AND occurred_at <= ?",r.push(e.endDate)),t+=" ORDER BY occurred_at DESC",e.limit&&(t+=" LIMIT ?",r.push(e.limit)),e.offset&&(t+=" OFFSET ?",r.push(e.offset));return this.db.prepare(t).all(...r).map(e=>JSON.parse(e.trace_json))}async getStatistics(e){if(!this.db)throw new Error("Database not initialized");let t="";const r=[];e&&(t="WHERE profile_id = ?",r.push(e));const s=this.db.prepare(`SELECT COUNT(*) as count FROM decision_traces ${t}`).get(...r),o=this.db.prepare(`SELECT kind, COUNT(*) as count FROM decision_traces ${t} GROUP BY kind`).all(...r),n=this.db.prepare(`SELECT actor_type, COUNT(*) as count FROM decision_traces ${t} GROUP BY actor_type`).all(...r),i=this.db.prepare(`SELECT MIN(occurred_at) as earliest, MAX(occurred_at) as latest FROM decision_traces ${t}`).get(...r);return{totalTraces:s.count,byKind:o.reduce((e,t)=>({...e,[t.kind]:t.count}),{}),byActor:n.reduce((e,t)=>({...e,[t.actor_type]:t.count}),{}),dateRange:{earliest:i.earliest||(new Date).toISOString(),latest:i.latest||(new Date).toISOString()}}}close(){this.db&&(this.db.close(),this.db=null,console.log("[DecisionTraceService] Database closed"))}}const l=c.getInstance()},"./src/main/services/environmentDetectionService.ts":(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var s=r("events"),o=r("path");class n extends s.EventEmitter{psService;activeDetections=new Map;constructor(e){super(),this.psService=e}async detectEnvironment(e={}){const t=this.generateDetectionId(),r=new Date;this.activeDetections.set(t,!0),this.emit("detection:started",{detectionId:t,startTime:r});const s={id:t,startTime:r,status:"detecting",detectedEnvironment:"unknown",detectedServices:[],recommendations:[],totalServicesFound:0,confidence:0,errors:[],warnings:[]};try{const r=await Promise.allSettled([!1!==e.detectAzure?this.detectAzureEnvironment(e,t):null,!1!==e.detectOnPremises?this.detectOnPremisesEnvironment(e,t):null,!0===e.detectAWS?this.detectAWSEnvironment(e,t):null,!0===e.detectGCP?this.detectGCPEnvironment(e,t):null]),o=[],n=[];return r.forEach((e,t)=>{if("fulfilled"===e.status&&e.value)o.push(...e.value.services),n.push(...e.value.errors);else if("rejected"===e.status){const r=["azure","on-premises","aws","gcp"][t];n.push({timestamp:new Date,serviceType:r,message:e.reason?.message||"Detection failed"})}}),s.detectedServices=o,s.errors=n,s.totalServicesFound=o.filter(e=>e.detected).length,s.detectedEnvironment=this.determineEnvironmentType(o),s.confidence=this.calculateConfidence(o,n),s.recommendations=this.generateRecommendations(o,s.detectedEnvironment),s.status="completed",s.endTime=new Date,this.emit("detection:completed",s),s}catch(e){return s.status="failed",s.endTime=new Date,s.errors.push({timestamp:new Date,serviceType:"system",message:e.message}),this.emit("detection:failed",s),s}finally{this.activeDetections.delete(t)}}async detectAzureEnvironment(e,t){const r=[],s=[];this.emitProgress(t,"Detecting Azure environment...",10);try{const e=await this.psService.executeScript(o.join("..","Modules","Discovery","AzureDiscovery.psm1"),["-FunctionName","Test-AzureADConnection"],{timeout:3e4,streamOutput:!1}),s=e.data;e.success&&s?.Connected&&r.push({id:"azure-ad",name:"Azure Active Directory",type:"Identity",provider:"azure",detected:!0,version:s.Version,endpoint:s.TenantId,authentication:"OAuth2",features:["SSO","MFA","Conditional Access","PIM"],status:"available",capabilities:[{name:"User Management",available:!0},{name:"Group Management",available:!0},{name:"Application Registration",available:!0},{name:"Conditional Access",available:s.HasPremium??!1,requiresLicense:!0,licenseType:"Azure AD Premium"}]}),this.emitProgress(t,"Detecting Microsoft 365 services...",30);const n=await this.psService.executeScript(o.join("..","Modules","Discovery","ExchangeDiscovery.psm1"),["-FunctionName","Test-ExchangeOnlineConnection"],{timeout:3e4,streamOutput:!1}),i=n.data;n.success&&i?.Connected&&r.push({id:"exchange-online",name:"Exchange Online",type:"Email",provider:"microsoft365",detected:!0,version:i.Version,endpoint:i.Endpoint,authentication:"Modern Auth",features:["Mailboxes","Distribution Groups","Shared Mailboxes","Mail Flow Rules"],status:"available",capabilities:[{name:"Mailbox Management",available:!0},{name:"Advanced Threat Protection",available:i.HasATP??!1,requiresLicense:!0,licenseType:"Exchange Online Plan 2"}]}),this.emitProgress(t,"Detecting SharePoint Online...",50);const a=await this.psService.executeScript(o.join("..","Modules","Discovery","SharePointDiscovery.psm1"),["-FunctionName","Test-SharePointOnlineConnection"],{timeout:3e4,streamOutput:!1}),c=a.data;a.success&&c?.Connected&&r.push({id:"sharepoint-online",name:"SharePoint Online",type:"Collaboration",provider:"microsoft365",detected:!0,version:c.Version,endpoint:c.AdminUrl,authentication:"OAuth2",features:["Sites","Libraries","Lists","Content Types"],status:"available",capabilities:[{name:"Site Collection Management",available:!0},{name:"Advanced DLP",available:c.HasAdvancedDLP??!1,requiresLicense:!0,licenseType:"Microsoft 365 E5"}]});const l=await this.psService.executeScript(o.join("..","Modules","Discovery","TeamsDiscovery.psm1"),["-FunctionName","Test-TeamsConnection"],{timeout:3e4,streamOutput:!1}),u=l.data;l.success&&u?.Connected&&r.push({id:"microsoft-teams",name:"Microsoft Teams",type:"Communication",provider:"microsoft365",detected:!0,version:u.Version,authentication:"OAuth2",features:["Teams","Channels","Calls","Meetings"],status:"available",capabilities:[{name:"Team Management",available:!0},{name:"Phone System",available:u.HasPhoneSystem??!1,requiresLicense:!0,licenseType:"Teams Phone"}]}),this.emitProgress(t,"Azure detection complete",70)}catch(e){s.push({timestamp:new Date,serviceType:"azure",message:`Azure detection error: ${e.message}`})}return{services:r,errors:s}}async detectOnPremisesEnvironment(e,t){const r=[],s=[];this.emitProgress(t,"Detecting on-premises environment...",15);try{const e=await this.psService.executeScript(o.join("..","Modules","Discovery","ActiveDirectoryDiscovery.psm1"),["-FunctionName","Test-ActiveDirectoryConnection"],{timeout:3e4,streamOutput:!1}),s=e.data;e.success&&s?.Connected&&r.push({id:"active-directory",name:"Active Directory",type:"Identity",provider:"on-premises",detected:!0,version:s.ForestFunctionalLevel,endpoint:s.DomainController,authentication:"Kerberos/NTLM",features:["Users","Groups","OUs","GPOs","Trusts"],status:"available",capabilities:[{name:"User Management",available:!0},{name:"Group Policy Management",available:!0},{name:"Fine-Grained Password Policies",available:s.SupportsFGPP??!1}]}),this.emitProgress(t,"Detecting Exchange Server...",35);const n=await this.psService.executeScript(o.join("..","Modules","Discovery","ExchangeDiscovery.psm1"),["-FunctionName","Test-ExchangeServerConnection"],{timeout:3e4,streamOutput:!1}),i=n.data;n.success&&i?.Connected&&r.push({id:"exchange-server",name:"Exchange Server",type:"Email",provider:"on-premises",detected:!0,version:i.Version,endpoint:i.Server,authentication:"NTLM/Kerberos",features:["Mailboxes","DAGs","Public Folders","Transport Rules"],status:"available",capabilities:[{name:"Mailbox Management",available:!0},{name:"Database Availability Groups",available:i.HasDAG}]}),this.emitProgress(t,"Detecting SharePoint Server...",55);const a=await this.psService.executeScript(o.join("..","Modules","Discovery","SharePointDiscovery.psm1"),["-FunctionName","Test-SharePointServerConnection"],{timeout:3e4,streamOutput:!1}),c=a.data;a.success&&c?.Connected&&r.push({id:"sharepoint-server",name:"SharePoint Server",type:"Collaboration",provider:"on-premises",detected:!0,version:c.Version,endpoint:c.WebApplication,authentication:"Windows/SAML",features:["Sites","Service Applications","Search","Workflows"],status:"available",capabilities:[{name:"Site Collection Management",available:!0},{name:"Hybrid Configuration",available:c.IsHybrid}]}),this.emitProgress(t,"On-premises detection complete",75)}catch(e){s.push({timestamp:new Date,serviceType:"on-premises",message:`On-premises detection error: ${e.message}`})}return{services:r,errors:s}}async detectAWSEnvironment(e,t){const r=[],s=[];this.emitProgress(t,"Detecting AWS environment...",20);try{const s=await this.psService.executeScript(o.join("..","Modules","Discovery","AWSDiscovery.psm1"),["-FunctionName","Test-AWSConnection","-AccessKey",e.credentials?.awsAccessKey||"","-SecretKey",e.credentials?.awsSecretKey||""],{timeout:3e4,streamOutput:!1}),n=s.data;s.success&&n?.Connected&&r.push({id:"aws-iam",name:"AWS IAM",type:"Identity",provider:"aws",detected:!0,version:n.Version,endpoint:n.Region,authentication:"AWS Signature",features:["Users","Roles","Policies","Federation"],status:"available",capabilities:[{name:"User Management",available:!0},{name:"Role-Based Access",available:!0},{name:"SSO Integration",available:n.HasSSO}]}),this.emitProgress(t,"AWS detection complete",80)}catch(e){s.push({timestamp:new Date,serviceType:"aws",message:`AWS detection error: ${e.message}`})}return{services:r,errors:s}}async detectGCPEnvironment(e,t){const r=[],s=[];this.emitProgress(t,"Detecting GCP environment...",25);try{const s=await this.psService.executeScript(o.join("..","Modules","Discovery","GCPDiscovery.psm1"),["-FunctionName","Test-GCPConnection","-ProjectId",e.credentials?.gcpProjectId||"","-ServiceAccountKey",e.credentials?.gcpServiceAccountKey||""],{timeout:3e4,streamOutput:!1}),n=s.data;s.success&&n?.Connected&&r.push({id:"gcp-iam",name:"GCP IAM",type:"Identity",provider:"gcp",detected:!0,version:n.Version,endpoint:n.ProjectId,authentication:"OAuth 2.0",features:["Service Accounts","Roles","Policies","Federation"],status:"available",capabilities:[{name:"Service Account Management",available:!0},{name:"Custom Role Creation",available:!0}]}),this.emitProgress(t,"GCP detection complete",85)}catch(e){s.push({timestamp:new Date,serviceType:"gcp",message:`GCP detection error: ${e.message}`})}return{services:r,errors:s}}determineEnvironmentType(e){const t=e.some(e=>"azure"===e.provider&&e.detected),r=e.some(e=>"on-premises"===e.provider&&e.detected),s=e.some(e=>"aws"===e.provider&&e.detected),o=e.some(e=>"gcp"===e.provider&&e.detected);return t&&r?"hybrid":t?"azure":r?"on-premises":s?"aws":o?"gcp":"unknown"}calculateConfidence(e,t){const r=e.length+t.length;if(0===r)return 0;const s=e.filter(e=>e.detected).length;return Math.round(s/r*100)}generateRecommendations(e,t){const r=[];if("hybrid"===t){const t=e.some(e=>"azure-ad"===e.id&&e.detected),s=e.some(e=>"active-directory"===e.id&&e.detected);t&&s&&r.push({id:"hybrid-identity-sync",category:"configuration",priority:"high",title:"Configure Azure AD Connect for Identity Synchronization",description:"Detected both Azure AD and on-premises Active Directory. Implement Azure AD Connect for seamless identity sync.",impact:"Enables single sign-on and unified identity management across cloud and on-premises resources.",effort:"medium",steps:["Install Azure AD Connect on a domain-joined server","Configure synchronization settings","Enable password hash synchronization or federation","Validate user synchronization"],relatedServices:["azure-ad","active-directory"]})}"on-premises"===t&&r.push({id:"cloud-migration-assessment",category:"migration",priority:"critical",title:"Assess Cloud Migration Readiness",description:"On-premises environment detected. Evaluate workloads for cloud migration opportunities.",impact:"Modernize infrastructure, reduce costs, and improve scalability.",effort:"high",steps:["Inventory all applications and dependencies","Assess cloud compatibility","Develop migration roadmap","Pilot migration for non-critical workloads"],relatedServices:e.filter(e=>"on-premises"===e.provider).map(e=>e.id)});e.some(e=>e.capabilities.some(e=>e.requiresLicense&&!e.available))&&r.push({id:"license-optimization",category:"optimization",priority:"medium",title:"Optimize License Assignments",description:"Some detected services have capabilities requiring additional licenses.",impact:"Unlock advanced features and improve security posture.",effort:"low",steps:["Review current license inventory","Identify required licenses for advanced features","Optimize license assignments based on user needs","Monitor license usage"],relatedServices:e.filter(e=>e.capabilities.some(e=>e.requiresLicense)).map(e=>e.id)});return e.some(e=>"azure-ad"===e.id&&e.capabilities.some(e=>"Conditional Access"===e.name&&e.available))&&r.push({id:"conditional-access-policies",category:"security",priority:"high",title:"Implement Conditional Access Policies",description:"Azure AD Premium detected with Conditional Access capability. Enhance security with policy-based access control.",impact:"Improve security posture by enforcing MFA, device compliance, and location-based access.",effort:"medium",steps:["Define access policies for different user groups","Configure MFA requirements","Set up device compliance policies","Test policies with pilot group before rollout"],relatedServices:["azure-ad"]}),r}async validateCredentials(e,t){try{let r;switch(e){case"azure":r=await this.psService.executeScript(o.join("..","Modules","Discovery","AzureDiscovery.psm1"),["-FunctionName","Test-AzureCredentials","-TenantId",t.tenantId||"","-ClientId",t.clientId||"","-ClientSecret",t.clientSecret||""],{timeout:3e4,streamOutput:!1});break;case"on-premises":r=await this.psService.executeScript(o.join("..","Modules","Discovery","ActiveDirectoryDiscovery.psm1"),["-FunctionName","Test-ADCredentials","-Domain",t.domain||"","-Username",t.username||"","-Password",t.password||""],{timeout:3e4,streamOutput:!1});break;case"aws":r=await this.psService.executeScript(o.join("..","Modules","Discovery","AWSDiscovery.psm1"),["-FunctionName","Test-AWSCredentials","-AccessKey",t.accessKey||"","-SecretKey",t.secretKey||""],{timeout:3e4,streamOutput:!1});break;case"gcp":r=await this.psService.executeScript(o.join("..","Modules","Discovery","GCPDiscovery.psm1"),["-FunctionName","Test-GCPCredentials","-ProjectId",t.projectId||"","-ServiceAccountKey",t.serviceAccountKey||""],{timeout:3e4,streamOutput:!1});break;default:return{valid:!1,message:`Unsupported provider: ${e}`}}const s=r.data;return r.success&&s?.Valid?{valid:!0,message:"Credentials validated successfully",details:s}:{valid:!1,message:s?.Message||r.error||"Credential validation failed"}}catch(e){return{valid:!1,message:`Validation error: ${e.message}`}}}async cancelDetection(e){return!!this.activeDetections.has(e)&&(this.activeDetections.delete(e),this.emit("detection:cancelled",{detectionId:e}),!0)}getStatistics(){return{activeDetections:this.activeDetections.size,totalDetectionsRun:0}}generateDetectionId(){return`detection_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}emitProgress(e,t,r){this.emit("detection:progress",{detectionId:e,message:t,percentage:r,timestamp:new Date})}}},"./src/main/services/licenseService.ts":(e,t,r)=>{"use strict";r.d(t,{LicenseService:()=>i});var s=r("events"),o=r("crypto"),n=r("electron");class i extends s.EventEmitter{configService;initialized=!1;machineId=null;currentLicense=null;constructor(e){super(),this.configService=e}async initialize(){this.initialized||(this.machineId=await this.configService.get("license.machineId")??null,this.machineId||(this.machineId=this.generateMachineId(),await this.configService.set("license.machineId",this.machineId)),await this.loadLicense(),this.initialized=!0,this.emit("initialized"))}async activateLicense(e){if(await this.ensureInitialized(),!this.validateKeyFormat(e))return{success:!1,error:"Invalid license key format"};let t;try{t=this.decodeLicenseKey(e)}catch(e){return{success:!1,error:`License validation failed: ${e instanceof Error?e.message:String(e)}`}}if(new Date(t.expiresAt)<new Date)return{success:!1,error:"License has expired"};if(!this.verifyChecksum(e,t.checksum))return{success:!1,error:"License key integrity check failed"};if(!n.safeStorage.isEncryptionAvailable())return{success:!1,error:"Secure storage not available"};const r=n.safeStorage.encryptString(e);return await this.configService.set("license.key",r.toString("base64")),await this.configService.set("license.customerId",t.customerId),await this.configService.set("license.type",t.type),await this.configService.set("license.activatedAt",(new Date).toISOString()),await this.configService.set("license.expiresAt",t.expiresAt),await this.configService.set("license.features",t.features),await this.loadLicense(),this.emit("license-activated",this.currentLicense),{success:!0,licenseInfo:this.currentLicense}}async getLicenseInfo(){return await this.ensureInitialized(),this.currentLicense?{...this.currentLicense}:{status:"not_activated",type:"trial",customerId:"",features:[],machineId:this.machineId}}async isLicenseValid(){return"active"===(await this.getLicenseInfo()).status}async getLicenseDetails(){return this.getLicenseInfo()}async hasFeature(e){const t=await this.getLicenseInfo();return"active"===t.status&&(t.features.includes(e)||t.features.includes("*"))}async getCustomerId(){return await this.ensureInitialized(),this.currentLicense?.customerId||null}async deactivateLicense(){await this.configService.delete("license.key"),await this.configService.delete("license.customerId"),await this.configService.delete("license.type"),await this.configService.delete("license.activatedAt"),await this.configService.delete("license.expiresAt"),await this.configService.delete("license.features"),this.currentLicense=null,this.emit("license-deactivated")}async refreshLicense(){return await this.loadLicense(),this.currentLicense}async loadLicense(){const e=await this.configService.get("license.key");if(e)try{const t=Buffer.from(e,"base64"),r=n.safeStorage.decryptString(t),s=this.decodeLicenseKey(r),o=new Date(s.expiresAt),i=new Date,a=Math.ceil((o.getTime()-i.getTime())/864e5),c=o<i?"expired":"active";this.currentLicense={status:c,type:s.type,customerId:s.customerId,activatedAt:await this.configService.get("license.activatedAt"),expiresAt:s.expiresAt,features:s.features,machineId:this.machineId,daysRemaining:a>0?a:0}}catch(e){console.error("Failed to load license:",e),this.currentLicense=null}else this.currentLicense=null}validateKeyFormat(e){return/^[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}$/.test(e)}decodeLicenseKey(e){const t=e.split("-"),r=`customer-${parseInt(t[0],36)}`,s={TR:"trial",ST:"standard",EN:"enterprise"}[t[1].substring(0,2)]||"trial",o=1e3*parseInt(t[2],36),n=new Date(o).toISOString(),i=parseInt(t[3],36);return{customerId:r,type:s,expiresAt:n,features:this.decodeFeatureFlags(i),checksum:t[4]}}decodeFeatureFlags(e){return["discovery","migration","analytics","reporting","api-access","priority-support"].filter((t,r)=>!!(e&1<<r))}verifyChecksum(e,t){const r=e.substring(0,e.lastIndexOf("-"));return(0,o.createHash)("sha256").update(r).digest("hex").substring(0,4).toUpperCase()===t}generateMachineId(){return(0,o.randomBytes)(16).toString("hex")}async ensureInitialized(){this.initialized||await this.initialize()}async verifyOnline(e,t){return!0}}},"./src/main/services/logicEngineService.ts":(e,t,r)=>{"use strict";r.d(t,{LogicEngineService:()=>l});var s=r("events"),o=r("fs/promises"),n=r("path"),i=r("./node_modules/papaparse/papaparse.js"),a=r("glob"),c=r("./src/renderer/types/models/logicEngine.ts");class l extends s.EventEmitter{static instance;dataRoot;fuzzyConfig;memoryCache=new Map;isLoading=!1;lastLoadTime;fileLoadTimes=new Map;usersBySid=new Map;usersByUpn=new Map;groupsBySid=new Map;membersByGroupSid=new Map;groupsByUserSid=new Map;devicesByName=new Map;devicesByPrimaryUserSid=new Map;appsById=new Map;appsByDevice=new Map;aclByIdentitySid=new Map;drivesByUserSid=new Map;gposByGuid=new Map;gposBySidFilter=new Map;gposByOu=new Map;mailboxByUpn=new Map;rolesByPrincipalId=new Map;sqlDbsByKey=new Map;fileSharesByPath=new Map;threatsByThreatId=new Map;threatsByAsset=new Map;threatsByCategory=new Map;threatsBySeverity=new Map;governanceByAssetId=new Map;governanceByOwner=new Map;governanceByCompliance=new Map;lineageByLineageId=new Map;lineageBySourceAsset=new Map;lineageByTargetAsset=new Map;externalIdentitiesById=new Map;externalIdentitiesByUpn=new Map;externalIdentitiesByProvider=new Map;externalIdentitiesByMappingStatus=new Map;servicePrincipalsById=new Map;directoryRolesById=new Map;sharePointSitesById=new Map;teamsById=new Map;tenantsById=new Map;applicationSecretsById=new Map;nodes=new Map;edges=[];entityRelationships=new Map;entityMetadata=new Map;appliedInferenceRules=[];lastLoadStats;constructor(e){super(),this.dataRoot=e||"C:\\discoverydata\\ljpops\\Raw",this.fuzzyConfig={LevenshteinThreshold:.8,JaroWinklerThreshold:.85,SoundexEnabled:!1,MetaphoneEnabled:!1,BigramAnalysisEnabled:!1}}static getInstance(e){return l.instance||(l.instance=new l(e)),l.instance}getIsLoading(){return this.isLoading}getLastLoadTime(){return this.lastLoadTime}async loadAllAsync(e,t=!1){if(this.isLoading)return console.warn("Load already in progress, skipping duplicate request"),!1;try{this.isLoading=!0;const r=new Date;this.appliedInferenceRules=[];const s=e||this.dataRoot;console.log(`Starting LogicEngine data load from ${s}${t?" (force reload)":""}`),this.emit("progress",{stage:"init",message:"Initializing data load",percentage:0});try{await o.access(s)}catch{const e=new Error(`Data directory not found: ${s}`);return console.error(`Data directory not found: ${s}`),this.emit("error",{Error:e,Message:e.message}),!1}const i=(await o.readdir(s)).filter(e=>e.toLowerCase().endsWith(".csv")).map(e=>n.join(s,e));if(t)console.log("[LogicEngine] Force reload requested, bypassing cache");else{if(!await this.checkForFileChanges(i)&&this.lastLoadTime)return console.log("No CSV changes detected. Using cached data"),this.emit("progress",{stage:"cached",message:"Using cached data",percentage:100}),!0}await this.clearDataStores(),this.emit("progress",{stage:"loading",message:"Loading CSV files",percentage:10});const a=[this.loadUsersStreamingAsync(s),this.loadGroupsStreamingAsync(s),this.loadDevicesStreamingAsync(s),this.loadApplicationsStreamingAsync(s),this.loadGposStreamingAsync(s),this.loadAclsStreamingAsync(s),this.loadMappedDrivesStreamingAsync(s),this.loadMailboxesStreamingAsync(s),this.loadAzureRolesStreamingAsync(s),this.loadSqlDatabasesStreamingAsync(s),this.loadThreatDetectionStreamingAsync(s),this.loadDataGovernanceStreamingAsync(s),this.loadDataLineageStreamingAsync(s),this.loadExternalIdentitiesStreamingAsync(s)];await Promise.all(a),this.emit("progress",{stage:"indexing",message:"Building indices",percentage:60}),await this.buildIndicesAsync(),this.emit("progress",{stage:"inference",message:"Applying inference rules",percentage:80}),await this.applyInferenceRulesAsync();const c=(new Date).getTime()-r.getTime();this.lastLoadStats={UserCount:this.usersBySid.size,GroupCount:this.groupsBySid.size,DeviceCount:this.devicesByName.size,AppCount:this.appsById.size,GpoCount:this.gposByGuid.size,AclEntryCount:Array.from(this.aclByIdentitySid.values()).reduce((e,t)=>e+t.length,0),MappedDriveCount:Array.from(this.drivesByUserSid.values()).reduce((e,t)=>e+t.length,0),MailboxCount:this.mailboxByUpn.size,AzureRoleCount:Array.from(this.rolesByPrincipalId.values()).reduce((e,t)=>e+t.length,0),SqlDbCount:this.sqlDbsByKey.size,ThreatCount:this.threatsByThreatId.size,GovernanceAssetCount:this.governanceByAssetId.size,LineageFlowCount:this.lineageByLineageId.size,ExternalIdentityCount:this.externalIdentitiesById.size,InferenceRulesApplied:this.appliedInferenceRules.length,FuzzyMatchesFound:this.getFuzzyMatchCount(),LoadDuration:c,LoadTimestamp:r};for(const e of i){const t=await o.stat(e);this.fileLoadTimes.set(e,t.mtime)}return this.lastLoadTime=new Date,console.log(`LogicEngine data load completed successfully in ${c}ms`),this.emit("progress",{stage:"complete",message:"Data load complete",percentage:100}),this.emit("loaded",{Statistics:this.lastLoadStats,AppliedInferenceRules:this.appliedInferenceRules}),!0}catch(e){return console.error("Failed to load LogicEngine data:",e),this.emit("error",{Error:e instanceof Error?e:new Error(String(e)),Message:e.message||String(e)}),!1}finally{this.isLoading=!1}}async buildUserDetailProjection(e){const t=this.usersBySid.get(e)||this.usersByUpn.get(e);if(!t)return console.warn(`User not found: ${e}`),null;const r=this.getGroupsForUser(t.Sid),s=this.getDevicesForUser(t.Sid),o=this.getAppsForUser(t.Sid,s),n=this.drivesByUserSid.get(t.Sid)||[],i=this.getSharesForUser(t.Sid),a=this.getGpoLinksForUser(t),c=this.getGpoFiltersForUser(t.Sid),l=this.mailboxByUpn.get(t.UPN)||this.mailboxByUpn.get(t.Mail||""),u=this.rolesByPrincipalId.get(t.AzureObjectId||"")||[],d=this.getSqlDatabasesForUser(t.Sid),p=this.calculateRisksForUser(t),h=this.generateMigrationHintsForUser(t),m=this.getThreatsForAsset(t.Sid),g=this.getGovernanceForAsset(t.Sid),f=this.getLineageForAsset(t.Sid),y=this.getExternalIdentitiesForUser(t.Sid);return{User:t,Groups:r,Devices:s,Apps:o,Drives:n,Shares:i,GpoLinks:a,GpoFilters:c,Mailbox:l,AzureRoles:u,SqlDatabases:d,Risks:p,MigrationHints:h,MemberOfGroups:r.map(e=>e.Name||e.Dn||"").filter(e=>e),ManagedGroups:r.filter(e=>e.ManagedBy===t.Dn).map(e=>e.Name||e.Dn||""),ManagerUpn:t.Manager||"",OwnedGroups:r.filter(e=>e.ManagedBy===t.Dn).map(e=>e.Name||e.Dn||""),Threats:m,GovernanceIssues:g?[g]:[],DataLineage:f,ExternalIdentities:y}}async checkForFileChanges(e){for(const t of e){const e=this.fileLoadTimes.get(t);if(!e)return!0;if((await o.stat(t)).mtime>e)return!0}return!1}async clearDataStores(){this.usersBySid.clear(),this.usersByUpn.clear(),this.groupsBySid.clear(),this.membersByGroupSid.clear(),this.groupsByUserSid.clear(),this.devicesByName.clear(),this.devicesByPrimaryUserSid.clear(),this.appsById.clear(),this.appsByDevice.clear(),this.aclByIdentitySid.clear(),this.drivesByUserSid.clear(),this.gposByGuid.clear(),this.gposBySidFilter.clear(),this.gposByOu.clear(),this.mailboxByUpn.clear(),this.rolesByPrincipalId.clear(),this.sqlDbsByKey.clear(),this.threatsByThreatId.clear(),this.threatsByAsset.clear(),this.threatsByCategory.clear(),this.threatsBySeverity.clear(),this.governanceByAssetId.clear(),this.governanceByOwner.clear(),this.governanceByCompliance.clear(),this.lineageByLineageId.clear(),this.lineageBySourceAsset.clear(),this.lineageByTargetAsset.clear(),this.externalIdentitiesById.clear(),this.externalIdentitiesByUpn.clear(),this.externalIdentitiesByProvider.clear(),this.externalIdentitiesByMappingStatus.clear(),this.servicePrincipalsById.clear(),this.directoryRolesById.clear(),this.sharePointSitesById.clear(),this.teamsById.clear(),this.tenantsById.clear(),this.applicationSecretsById.clear(),this.nodes.clear(),this.edges=[],this.entityRelationships.clear(),this.entityMetadata.clear(),this.memoryCache.clear()}async loadUsersStreamingAsync(e){console.log(`[LogicEngine] Loading users from: ${e}`);const t=[n.join(e,"*Users*.csv").replace(/\\/g,"/"),n.join(e,"AzureUsers.csv").replace(/\\/g,"/"),n.join(e,"ActiveDirectoryUsers.csv").replace(/\\/g,"/")],r=[];for(const e of t)try{const t=await(0,a.glob)(e,{nocase:!0});console.log(`[LogicEngine] Pattern "${e}" matched ${t.length} files:`,t),r.push(...t)}catch(t){console.debug(`[LogicEngine] No files matched pattern: ${e}`)}const s=[...new Set(r)];console.log(`[LogicEngine] Loading ${s.length} unique user files:`,s);for(const e of s)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseUserFromCsv(e);t&&(this.usersBySid.set(t.Sid,t),t.UPN&&this.usersByUpn.set(t.UPN,t))})}}),console.log(`Loaded ${this.usersBySid.size} users from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseUserFromCsv(e){try{const t=e.UPN||e.UserPrincipalName||e.Mail||"",r=e.Sam||e.SamAccountName||e.SAMAccountName||e.OnPremisesSamAccountName||"",s=e.Sid||e.SID||e.ObjectSid||e.Id||t||r;if(!s)return null;const o=e.Groups?e.Groups.split(";").filter(e=>e):e.GroupMemberships?e.GroupMemberships.split(";").filter(e=>e):[];return{UPN:t,Sam:r,Sid:s,Mail:e.Mail||e.EmailAddress,DisplayName:e.DisplayName||e.Name||r,Enabled:"true"===e.Enabled||"True"===e.Enabled||"1"===e.Enabled||"True"===e.AccountEnabled||"true"===e.AccountEnabled,OU:e.OU||e.OrganizationalUnit,ManagerSid:e.ManagerSid||e.ManagerId||e.Manager,Dept:e.Department||e.Dept,AzureObjectId:e.AzureObjectId||e.ObjectId||e.Id,Groups:o,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e._DiscoveryModule||e.DiscoveryModule||"UserDiscovery",SessionId:e._SessionId||e.SessionId||this.generateSessionId(),Manager:e.Manager,Dn:e.DN||e.DistinguishedName||s}}catch(e){return console.warn("Failed to parse user from CSV:",e),null}}async loadGroupsStreamingAsync(e){console.log(`[LogicEngine] Loading groups from: ${e}`);const t=[n.join(e,"*Groups*.csv").replace(/\\/g,"/"),n.join(e,"AzureGroups.csv").replace(/\\/g,"/"),n.join(e,"ActiveDirectoryGroups.csv").replace(/\\/g,"/")],r=[];for(const e of t)try{const t=await(0,a.glob)(e,{nocase:!0});console.log(`[LogicEngine] Pattern "${e}" matched ${t.length} files:`,t),r.push(...t)}catch(t){console.debug(`[LogicEngine] No files matched pattern: ${e}`)}const s=[...new Set(r)];console.log(`[LogicEngine] Loading ${s.length} unique group files:`,s);for(const e of s)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseGroupFromCsv(e);t&&this.groupsBySid.set(t.Sid,t)})}}),console.log(`Loaded ${this.groupsBySid.size} groups from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseGroupFromCsv(e){try{const t=e.Sid||e.SID||e.ObjectSid||e.Id||e.PrimarySmtpAddress||e.Alias,r=e.Name||e.GroupName||e.CN||e.DisplayName||e.Alias||"";if(!t||!r)return null;const s=e.Members?e.Members.split(";").filter(e=>e):e.SampleMembers?e.SampleMembers.split(";").filter(e=>e):[],o=e.NestedGroups?e.NestedGroups.split(";").filter(e=>e):[];return{Sid:t,Name:r,Type:e.Type||e.GroupType||"Security",Members:s,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e._DiscoveryModule||e.DiscoveryModule||"GroupDiscovery",SessionId:e._SessionId||e.SessionId||this.generateSessionId(),NestedGroups:o,Dn:e.DN||e.DistinguishedName||t,ManagedBy:e.ManagedBy||e.Manager}}catch(e){return console.warn("Failed to parse group from CSV:",e),null}}async loadDevicesStreamingAsync(e){console.log(`[LogicEngine] Loading devices/infrastructure from: ${e}`);const t=[n.join(e,"*Computer*.csv").replace(/\\/g,"/"),n.join(e,"*VM*.csv").replace(/\\/g,"/"),n.join(e,"*Server*.csv").replace(/\\/g,"/"),n.join(e,"*Infrastructure*.csv").replace(/\\/g,"/"),n.join(e,"NetworkInfrastructure*.csv").replace(/\\/g,"/"),n.join(e,"Infrastructure.csv").replace(/\\/g,"/")],r=[];for(const e of t)try{const t=await(0,a.glob)(e,{nocase:!0});console.log(`[LogicEngine] Pattern "${e}" matched ${t.length} files:`,t),r.push(...t)}catch(t){console.debug(`[LogicEngine] No files matched pattern: ${e}`)}const s=[...new Set(r)];console.log(`[LogicEngine] Loading ${s.length} unique device/infrastructure files:`,s);for(const e of s)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseDeviceFromCsv(e);t&&this.devicesByName.set(t.Name,t)})}}),console.log(`Loaded ${this.devicesByName.size} devices from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseDeviceFromCsv(e){try{const t=e.Name||e.ComputerName||e.DNSHostName||"";if(!t)return null;const r=e.InstalledApps?e.InstalledApps.split(";").filter(e=>e):e.InstalledSoftware?e.InstalledSoftware.split(";").filter(e=>e):[];return{Name:t,DNS:e.DNS||e.DNSHostName||e.FQDN,OU:e.OU||e.OrganizationalUnit,OS:e.OS||e.OperatingSystem||e.OSVersion,PrimaryUserSid:e.PrimaryUserSid||e.PrimaryUser||e.LastLoggedOnUser,InstalledApps:r,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"ComputerDiscovery",SessionId:e.SessionId||this.generateSessionId()}}catch(e){return console.warn("Failed to parse device from CSV:",e),null}}async loadApplicationsStreamingAsync(e){const t=[n.join(e,"Applications.csv"),n.join(e,"Software.csv"),n.join(e,"InstalledSoftware.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseApplicationFromCsv(e);t&&this.appsById.set(t.Id,t)})}}),console.log(`Loaded ${this.appsById.size} applications from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseApplicationFromCsv(e){try{const t=e.Id||e.AppId||e.Name||"",r=e.Name||e.ApplicationName||e.DisplayName||"";if(!t||!r)return null;const s=e.Executables?e.Executables.split(";").filter(e=>e):[],o=e.Publishers?e.Publishers.split(";").filter(e=>e):[];return{Id:t,Name:r,Source:e.Source||e.InstallSource,InstallCounts:parseInt(e.InstallCounts||e.InstallCount||"0"),Executables:s,Publishers:o,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"ApplicationDiscovery",SessionId:e.SessionId||this.generateSessionId()}}catch(e){return console.warn("Failed to parse application from CSV:",e),null}}async loadGposStreamingAsync(e){const t=[n.join(e,"GroupPolicies.csv"),n.join(e,"GPOs.csv"),n.join(e,"GroupPolicyObjects.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseGpoFromCsv(e);t&&this.gposByGuid.set(t.Guid,t)})}}),console.log(`Loaded ${this.gposByGuid.size} GPOs from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseGpoFromCsv(e){try{const t=e.Guid||e.GUID||e.Id||"",r=e.Name||e.DisplayName||"";if(!t||!r)return null;const s=e.Links?e.Links.split(";").filter(e=>e):[];return{Guid:t,Name:r,Links:s,SecurityFilter:e.SecurityFilter?e.SecurityFilter.split(";").filter(e=>e):[],WmiFilter:e.WmiFilter||e.WMIFilter,Enabled:"true"===e.Enabled||"True"===e.Enabled||"1"===e.Enabled,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"GPODiscovery",SessionId:e.SessionId||this.generateSessionId()}}catch(e){return console.warn("Failed to parse GPO from CSV:",e),null}}async loadAclsStreamingAsync(e){const t=[n.join(e,"ACLs.csv"),n.join(e,"FilePermissions.csv"),n.join(e,"SharePermissions.csv"),n.join(e,"NTFSPermissions.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseAclFromCsv(e);if(t){const e=this.aclByIdentitySid.get(t.IdentitySid)||[];e.push(t),this.aclByIdentitySid.set(t.IdentitySid,e)}})}}),console.log(`Loaded ACL entries from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseAclFromCsv(e){try{const t=e.Path||e.FilePath||e.SharePath||"",r=e.IdentitySid||e.Identity||e.UserSid||"";return t&&r?{Path:t,IdentitySid:r,Rights:e.Rights||e.Permissions||e.AccessRights||"",Inherited:"true"===e.Inherited||"True"===e.Inherited||"1"===e.Inherited,IsShare:"true"===e.IsShare||"Share"===e.Type,IsNTFS:"true"===e.IsNTFS||"NTFS"===e.Type,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"ACLDiscovery",SessionId:e.SessionId||this.generateSessionId()}:null}catch(e){return console.warn("Failed to parse ACL from CSV:",e),null}}async loadMappedDrivesStreamingAsync(e){const t=[n.join(e,"MappedDrives.csv"),n.join(e,"NetworkDrives.csv"),n.join(e,"UserDrives.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseMappedDriveFromCsv(e);if(t){const e=this.drivesByUserSid.get(t.UserSid)||[];e.push(t),this.drivesByUserSid.set(t.UserSid,e)}})}}),console.log(`Loaded mapped drives from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseMappedDriveFromCsv(e){try{const t=e.UserSid||e.UserSID||e.User||"",r=e.Letter||e.DriveLetter||"",s=e.UNC||e.UNCPath||e.NetworkPath||"";return t&&r&&s?{UserSid:t,Letter:r,UNC:s,Label:e.Label||e.DriveLabel,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"DriveDiscovery",SessionId:e.SessionId||this.generateSessionId()}:null}catch(e){return console.warn("Failed to parse mapped drive from CSV:",e),null}}async loadMailboxesStreamingAsync(e){const t=[n.join(e,"Mailboxes.csv"),n.join(e,"ExchangeMailboxes.csv"),n.join(e,"UserMailboxes.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseMailboxFromCsv(e);t&&(this.mailboxByUpn.set(t.UPN,t),t.UserPrincipalName&&t.UserPrincipalName!==t.UPN&&this.mailboxByUpn.set(t.UserPrincipalName,t))})}}),console.log(`Loaded ${this.mailboxByUpn.size} mailboxes from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseMailboxFromCsv(e){try{const t=e.UPN||e.UserPrincipalName||e.Email||"";if(!t)return null;const r=e.Permissions?e.Permissions.split(";").filter(e=>e):[];return{UPN:t,MailboxGuid:e.MailboxGuid||e.MailboxGUID||e.Guid,SizeMB:parseFloat(e.SizeMB||e.MailboxSize||"0"),Type:e.Type||e.MailboxType||"UserMailbox",DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"MailboxDiscovery",SessionId:e.SessionId||this.generateSessionId(),Permissions:r,UserPrincipalName:e.UserPrincipalName,EffectiveUPN:e.UserPrincipalName||t}}catch(e){return console.warn("Failed to parse mailbox from CSV:",e),null}}async loadAzureRolesStreamingAsync(e){const t=[n.join(e,"AzureRoles.csv"),n.join(e,"AzureRoleAssignments.csv"),n.join(e,"RoleAssignments.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseAzureRoleFromCsv(e);if(t){const e=this.rolesByPrincipalId.get(t.PrincipalObjectId)||[];e.push(t),this.rolesByPrincipalId.set(t.PrincipalObjectId,e)}})}}),console.log(`Loaded Azure roles from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseAzureRoleFromCsv(e){try{const t=e.PrincipalObjectId||e.PrincipalId||e.ObjectId||"",r=e.RoleName||e.Role||"";return t&&r?{PrincipalObjectId:t,RoleName:r,Scope:e.Scope||e.RoleScope||"/",DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"AzureRoleDiscovery",SessionId:e.SessionId||this.generateSessionId()}:null}catch(e){return console.warn("Failed to parse Azure role from CSV:",e),null}}async loadSqlDatabasesStreamingAsync(e){const t=[n.join(e,"SqlDatabases.csv"),n.join(e,"Databases.csv"),n.join(e,"SQLServers.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseSqlDbFromCsv(e);if(t){const e=`${t.Server}_${t.Database}`;this.sqlDbsByKey.set(e,t)}})}}),console.log(`Loaded ${this.sqlDbsByKey.size} SQL databases from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseSqlDbFromCsv(e){try{const t=e.Server||e.ServerName||"",r=e.Database||e.DatabaseName||e.DB||"";if(!t||!r)return null;const s=e.Owners?e.Owners.split(";").filter(e=>e):[],o=e.AppHints?e.AppHints.split(";").filter(e=>e):[];return{Server:t,Instance:e.Instance||e.InstanceName,Database:r,Owners:s,AppHints:o,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"SqlDiscovery",SessionId:e.SessionId||this.generateSessionId(),Name:r}}catch(e){return console.warn("Failed to parse SQL database from CSV:",e),null}}async loadThreatDetectionStreamingAsync(e){const t=[n.join(e,"ThreatDetection.csv"),n.join(e,"Threats.csv"),n.join(e,"SecurityThreats.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseThreatFromCsv(e);t&&this.threatsByThreatId.set(t.ThreatId,t)})}}),console.log(`Loaded ${this.threatsByThreatId.size} threats from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseThreatFromCsv(e){try{const t=e.ThreatId||e.Id||this.generateSessionId(),r=e.ThreatName||e.Name||"";if(!r)return null;const s=e.AffectedAssets?e.AffectedAssets.split(";").filter(e=>e):[],o=e.IndicatorsOfCompromise?e.IndicatorsOfCompromise.split(";").filter(e=>e):[];let n={};if(e.ThreatDetails)try{n=JSON.parse(e.ThreatDetails)}catch{n={raw:e.ThreatDetails}}return{ThreatId:t,ThreatName:r,Category:e.Category||"Unknown",Severity:e.Severity||"Medium",Confidence:parseFloat(e.Confidence||"0.5"),MitreAttackId:e.MitreAttackId,MitreTactic:e.MitreTactic,MitreTechnique:e.MitreTechnique,AffectedAssets:s,IndicatorsOfCompromise:o,ThreatDetails:n,DetectionTimestamp:new Date(e.DetectionTimestamp||Date.now()),DetectionSource:e.DetectionSource||"Unknown",SessionId:e.SessionId||this.generateSessionId(),DiscoveryModule:e.DiscoveryModule||"ThreatDetectionEngine",ThreatScore:parseFloat(e.ThreatScore||"50")}}catch(e){return console.warn("Failed to parse threat from CSV:",e),null}}async loadDataGovernanceStreamingAsync(e){const t=[n.join(e,"DataGovernance.csv"),n.join(e,"GovernanceAssets.csv"),n.join(e,"Compliance.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseGovernanceFromCsv(e);t&&this.governanceByAssetId.set(t.AssetId,t)})}}),console.log(`Loaded ${this.governanceByAssetId.size} governance records from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseGovernanceFromCsv(e){try{const t=e.AssetId||e.Id||this.generateSessionId(),r=e.AssetName||e.Name||"";if(!r)return null;const s=e.RetentionPolicies?e.RetentionPolicies.split(";").filter(e=>e):[],o=e.ComplianceFrameworks?e.ComplianceFrameworks.split(";").filter(e=>e):[],n=e.ViolationsFound?e.ViolationsFound.split(";").filter(e=>e):[];let i={};if(e.Metadata)try{i=JSON.parse(e.Metadata)}catch{e.Metadata.split(";").forEach(e=>{const[t,r]=e.split("=");t&&r&&(i[t]=r)})}return{AssetId:t,AssetName:r,AssetType:e.AssetType||"Unknown",Classification:e.Classification||"Unclassified",Owner:e.Owner||"Unknown",Custodian:e.Custodian||"Unknown",RetentionPolicies:s,ComplianceFrameworks:o,Metadata:i,HasPersonalData:"true"===e.HasPersonalData||"1"===e.HasPersonalData,HasSensitiveData:"true"===e.HasSensitiveData||"1"===e.HasSensitiveData,LastAuditDate:new Date(e.LastAuditDate||Date.now()),ComplianceStatus:e.ComplianceStatus||"Unknown",ViolationsFound:n,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"DataGovernanceMetadataManagement",SessionId:e.SessionId||this.generateSessionId(),ComplianceScore:parseFloat(e.ComplianceScore||"0"),RiskLevel:e.RiskLevel,GovernanceRisk:parseFloat(e.GovernanceRisk||"0")}}catch(e){return console.warn("Failed to parse governance from CSV:",e),null}}async loadDataLineageStreamingAsync(e){const t=[n.join(e,"DataLineage.csv"),n.join(e,"DataFlows.csv"),n.join(e,"LineageMapping.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseLineageFromCsv(e);t&&this.lineageByLineageId.set(t.LineageId,t)})}}),console.log(`Loaded ${this.lineageByLineageId.size} lineage records from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseLineageFromCsv(e){try{const t=e.LineageId||e.Id||this.generateSessionId(),r=e.SourceAssetId||e.Source||"",s=e.TargetAssetId||e.Target||"";if(!r||!s)return null;const o=e.TransformationSteps?e.TransformationSteps.split(";").filter(e=>e):[],n=e.Dependencies?e.Dependencies.split(";").filter(e=>e):[],i=e.Issues?e.Issues.split(";").filter(e=>e):[];let a={};if(e.FlowMetadata)try{a=JSON.parse(e.FlowMetadata)}catch{e.FlowMetadata.split(";").forEach(e=>{const[t,r]=e.split("=");t&&r&&(a[t]=r)})}return{LineageId:t,SourceAssetId:r,SourceAssetName:e.SourceAssetName||r,SourceAssetType:e.SourceAssetType||"Unknown",TargetAssetId:s,TargetAssetName:e.TargetAssetName||s,TargetAssetType:e.TargetAssetType||"Unknown",TransformationType:e.TransformationType||"Unknown",TransformationSteps:o,DataFlow:e.DataFlow||"Unknown",FlowMetadata:a,Dependencies:n,IsOrphaned:"true"===e.IsOrphaned||"1"===e.IsOrphaned,HasBrokenLinks:"true"===e.HasBrokenLinks||"1"===e.HasBrokenLinks,LastValidated:new Date(e.LastValidated||Date.now()),DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"DataLineageDependencyEngine",SessionId:e.SessionId||this.generateSessionId(),Issues:i,LineageRisk:parseFloat(e.LineageRisk||"0")}}catch(e){return console.warn("Failed to parse lineage from CSV:",e),null}}async loadExternalIdentitiesStreamingAsync(e){const t=[n.join(e,"ExternalIdentities.csv"),n.join(e,"FederatedIdentities.csv"),n.join(e,"B2BUsers.csv")];for(const e of t)try{await o.access(e);const t=await o.readFile(e,"utf-8");i.parse(t,{header:!0,skipEmptyLines:!0,complete:e=>{e.data.forEach(e=>{const t=this.parseExternalIdentityFromCsv(e);t&&(this.externalIdentitiesById.set(t.ExternalIdentityId,t),t.ExternalUserEmail&&this.externalIdentitiesByUpn.set(t.ExternalUserEmail,t))})}}),console.log(`Loaded ${this.externalIdentitiesById.size} external identities from ${n.basename(e)}`)}catch(t){console.debug(`File not found (expected): ${e}`)}}parseExternalIdentityFromCsv(e){try{const t=e.ExternalIdentityId||e.Id||this.generateSessionId(),r=e.ExternalProvider||e.Provider||"Unknown",s=e.ExternalUserId||e.UserId||"";if(!s)return null;const o=e.AssignedRoles?e.AssignedRoles.split(";").filter(e=>e):[],n=e.Permissions?e.Permissions.split(";").filter(e=>e):[],i=e.SyncErrors?e.SyncErrors.split(";").filter(e=>e):[];return{ExternalIdentityId:t,ExternalProvider:r,ExternalUserId:s,ExternalUserEmail:e.ExternalUserEmail||e.Email,ExternalDisplayName:e.ExternalDisplayName||e.DisplayName,InternalUserSid:e.InternalUserSid||e.MappedUserSid,MappingStatus:e.MappingStatus||"Unmapped",MappingConfidence:parseFloat(e.MappingConfidence||"0"),AssignedRoles:o,Permissions:n,LastSynchronized:new Date(e.LastSynchronized||Date.now()),SyncErrors:i,DiscoveryTimestamp:new Date(e.DiscoveryTimestamp||Date.now()),DiscoveryModule:e.DiscoveryModule||"ExternalIdentityMapping",SessionId:e.SessionId||this.generateSessionId(),IdentityRisk:parseFloat(e.IdentityRisk||"0")}}catch(e){return console.warn("Failed to parse external identity from CSV:",e),null}}applyAclGroupUserInference(){console.log("Applying ACLGroupUser inference rules");let e=0;Array.from(this.aclByIdentitySid.entries()).forEach(([t,r])=>{const s=this.groupsBySid.get(t);if(s){(this.membersByGroupSid.get(t)||[]).forEach(t=>{const s=this.aclByIdentitySid.get(t)||[];r.forEach(e=>{const r={...e,IdentitySid:t};s.push(r)}),this.aclByIdentitySid.set(t,s),e++}),s.NestedGroups&&s.NestedGroups.forEach(t=>{(this.membersByGroupSid.get(t)||[]).forEach(t=>{const s=this.aclByIdentitySid.get(t)||[];r.forEach(e=>{const r={...e,IdentitySid:t,Inherited:!0};s.push(r)}),this.aclByIdentitySid.set(t,s),e++})})}}),this.appliedInferenceRules.push(`ACLGroupUser expansion: ${e} derived permissions`),console.log(`Expanded ${e} ACL entries through group memberships`)}applyPrimaryDeviceInference(){console.log("Applying primary device inference rules");let e=0;this.devicesByName.forEach(t=>{if(t.PrimaryUserSid){const r=this.devicesByPrimaryUserSid.get(t.PrimaryUserSid)||[];r.includes(t)||(r.push(t),this.devicesByPrimaryUserSid.set(t.PrimaryUserSid,r),e++);const s=`User_${t.PrimaryUserSid}`,o=`Device_${t.Name}`;this.edges.push({SourceId:s,TargetId:o,Type:c.EdgeType.PrimaryUser})}}),this.appliedInferenceRules.push(`Primary device inference: ${e} assignments`),console.log(`Assigned ${e} primary device relationships`)}applyGpoSecurityFilterInference(){console.log("Applying GPO security filter inference rules");let e=0;this.gposByGuid.forEach(t=>{t.SecurityFilter.forEach(r=>{if(this.groupsBySid.get(r)){(this.membersByGroupSid.get(r)||[]).forEach(r=>{const s=this.gposBySidFilter.get(r)||[];s.includes(t)||(s.push(t),this.gposBySidFilter.set(r,s),e++)})}else{const s=this.gposBySidFilter.get(r)||[];s.includes(t)||(s.push(t),this.gposBySidFilter.set(r,s),e++)}}),t.Links.forEach(e=>{const r=this.gposByOu.get(e)||[];r.includes(t)||(r.push(t),this.gposByOu.set(e,r))})}),this.appliedInferenceRules.push(`GPO security filter inference: ${e} user-GPO links`),console.log(`Created ${e} user-GPO relationships through security filters`)}applyApplicationUsageInference(){console.log("Applying application usage inference rules");let e=0;this.devicesByName.forEach(t=>{t.InstalledApps.forEach(r=>{let s=this.appsById.get(r);if(s||(s=this.fuzzyMatchApplication(r,Array.from(this.appsById.keys()))),s){const r=`Device_${t.Name}`,o=`App_${s.Id}`;if(this.edges.push({SourceId:r,TargetId:o,Type:c.EdgeType.HasApp}),t.PrimaryUserSid){const r=`User_${t.PrimaryUserSid}`;this.edges.push({SourceId:r,TargetId:o,Type:c.EdgeType.HasApp,Properties:{via:t.Name}}),e++}}})}),this.appliedInferenceRules.push(`Application usage inference: ${e} user-app links`),console.log(`Created ${e} user-application relationships`)}applyAzureRoleInference(){console.log("Applying Azure role inference rules");let e=0,t=0;this.usersBySid.forEach(r=>{if(r.AzureObjectId){const s=this.rolesByPrincipalId.get(r.AzureObjectId);s&&s.length>0&&(e+=s.length,t++,s.forEach(e=>{const t=`User_${r.Sid}`,s=`Role_${e.RoleName}_${e.Scope}`;this.nodes.has(s)||this.nodes.set(s,{Id:s,Type:c.NodeType.Role,Properties:{name:e.RoleName,scope:e.Scope}}),this.edges.push({SourceId:t,TargetId:s,Type:c.EdgeType.AssignedRole})}))}}),this.appliedInferenceRules.push(`Azure role inference: ${e} roles linked to ${t} users`),console.log(`Linked ${e} Azure roles to ${t} users`)}applySqlOwnershipInference(){console.log("Applying SQL database ownership inference rules");let e=0;this.sqlDbsByKey.forEach(t=>{t.Owners.forEach(r=>{const s=this.usersBySid.get(r);if(s){const r=`Db_${t.Server}_${t.Database}`,o=`User_${s.Sid}`;this.nodes.has(r)||this.nodes.set(r,{Id:r,Type:c.NodeType.Db,Properties:{server:t.Server,database:t.Database,instance:t.Instance}}),this.edges.push({SourceId:o,TargetId:r,Type:c.EdgeType.OwnsDb}),e++}const o=this.groupsBySid.get(r);if(o){(this.membersByGroupSid.get(r)||[]).forEach(r=>{const s=`Db_${t.Server}_${t.Database}`,n=`User_${r}`;this.edges.push({SourceId:n,TargetId:s,Type:c.EdgeType.OwnsDb,Properties:{viaGroup:o.Name}}),e++})}})}),this.appliedInferenceRules.push(`SQL ownership inference: ${e} ownership relationships`),console.log(`Created ${e} database ownership relationships`)}applyThreatAssetCorrelationInference(){console.log("Applying threat-asset correlation inference rules");let e=0;this.threatsByThreatId.forEach(t=>{t.AffectedAssets.forEach(r=>{const s=this.threatsByAsset.get(r)||[];s.includes(t)||(s.push(t),this.threatsByAsset.set(r,s));const o=this.usersBySid.get(r)||this.usersByUpn.get(r);if(o){const r=`User_${o.Sid}`,s=`Threat_${t.ThreatId}`;this.nodes.has(s)||this.nodes.set(s,{Id:s,Type:c.NodeType.Threat,Properties:{name:t.ThreatName,severity:t.Severity,category:t.Category}}),this.edges.push({SourceId:s,TargetId:r,Type:c.EdgeType.Threatens}),e++}const n=this.devicesByName.get(r);if(n){const r=`Device_${n.Name}`,s=`Threat_${t.ThreatId}`;this.edges.push({SourceId:s,TargetId:r,Type:c.EdgeType.Threatens}),e++}});const r=this.threatsByCategory.get(t.Category)||[];r.includes(t)||(r.push(t),this.threatsByCategory.set(t.Category,r));const s=this.threatsBySeverity.get(t.Severity)||[];s.includes(t)||(s.push(t),this.threatsBySeverity.set(t.Severity,s))}),this.appliedInferenceRules.push(`Threat-asset correlation: ${e} correlations`),console.log(`Created ${e} threat-asset correlations`)}applyGovernanceRiskInference(){console.log("Applying governance risk inference rules");let e=0;this.governanceByAssetId.forEach(t=>{if(t.Owner){const r=this.usersBySid.get(t.Owner)||this.usersByUpn.get(t.Owner);if(r){const s=this.governanceByOwner.get(r.Sid)||[];s.includes(t)||(s.push(t),this.governanceByOwner.set(r.Sid,s),e++);const o=`User_${r.Sid}`,n=`DataAsset_${t.AssetId}`;this.nodes.has(n)||this.nodes.set(n,{Id:n,Type:c.NodeType.DataAsset,Properties:{name:t.AssetName,type:t.AssetType,classification:t.Classification}}),this.edges.push({SourceId:o,TargetId:n,Type:c.EdgeType.HasGovernanceIssue})}}const r=this.governanceByCompliance.get(t.ComplianceStatus)||[];r.includes(t)||(r.push(t),this.governanceByCompliance.set(t.ComplianceStatus,r))}),this.appliedInferenceRules.push(`Governance risk inference: ${e} owner-asset links`),console.log(`Created ${e} governance-owner relationships`)}applyLineageIntegrityInference(){console.log("Applying data lineage integrity inference rules");let e=0,t=0,r=0;this.lineageByLineageId.forEach(s=>{const o=`DataAsset_${s.SourceAssetId}`,n=`DataAsset_${s.TargetAssetId}`,i=`LineageFlow_${s.LineageId}`;this.nodes.has(o)||this.nodes.set(o,{Id:o,Type:c.NodeType.DataAsset,Properties:{name:s.SourceAssetName,type:s.SourceAssetType}}),this.nodes.has(n)||this.nodes.set(n,{Id:n,Type:c.NodeType.DataAsset,Properties:{name:s.TargetAssetName,type:s.TargetAssetType}}),this.nodes.has(i)||this.nodes.set(i,{Id:i,Type:c.NodeType.LineageFlow,Properties:{transformationType:s.TransformationType,dataFlow:s.DataFlow}}),this.edges.push({SourceId:o,TargetId:i,Type:c.EdgeType.DataFlowTo}),this.edges.push({SourceId:i,TargetId:n,Type:c.EdgeType.DataFlowTo}),e+=2;const a=this.lineageBySourceAsset.get(s.SourceAssetId)||[];a.includes(s)||(a.push(s),this.lineageBySourceAsset.set(s.SourceAssetId,a));const l=this.lineageByTargetAsset.get(s.TargetAssetId)||[];l.includes(s)||(l.push(s),this.lineageByTargetAsset.set(s.TargetAssetId,l)),s.IsOrphaned&&t++,s.HasBrokenLinks&&r++}),this.appliedInferenceRules.push(`Lineage integrity: ${e} flows, ${t} orphaned, ${r} broken`),console.log(`Created ${e} lineage relationships, found ${t} orphaned flows and ${r} broken links`)}applyExternalIdentityMappingInference(){console.log("Applying external identity mapping inference rules");let e=0,t=0;this.externalIdentitiesById.forEach(r=>{let s;if(r.ExternalUserEmail&&(s=this.usersByUpn.get(r.ExternalUserEmail)),!s&&r.ExternalDisplayName&&(s=this.fuzzyMatchUser(r.ExternalDisplayName,"DisplayName")),s){r.InternalUserSid=s.Sid,r.MappingStatus="Mapped",e++;const t=`User_${s.Sid}`,o=`ExternalIdentity_${r.ExternalIdentityId}`;this.nodes.has(o)||this.nodes.set(o,{Id:o,Type:c.NodeType.ExternalIdentity,Properties:{provider:r.ExternalProvider,userId:r.ExternalUserId,email:r.ExternalUserEmail}}),this.edges.push({SourceId:t,TargetId:o,Type:c.EdgeType.ExternalMapping})}else r.MappingStatus="Unmapped";const o=this.externalIdentitiesByProvider.get(r.ExternalProvider)||[];o.includes(r)||(o.push(r),this.externalIdentitiesByProvider.set(r.ExternalProvider,o));const n=this.externalIdentitiesByMappingStatus.get(r.MappingStatus)||[];n.includes(r)||(n.push(r),this.externalIdentitiesByMappingStatus.set(r.MappingStatus,n)),"Unmapped"===r.MappingStatus&&t++}),this.appliedInferenceRules.push(`External identity mapping: ${e} mapped, ${t} conflicts`),console.log(`Mapped ${e} external identities, found ${t} conflicts`)}fuzzyMatchApplication(e,t){let r,s=0;return t.forEach(t=>{const o=this.appsById.get(t);if(o){const t=this.calculateLevenshteinSimilarity(e,o.Name);t>=.8&&t>s&&(s=t,r=o)}}),r&&this.appliedInferenceRules.push(`Fuzzy app match: '${e}' -> '${r.Name}' (similarity: ${(100*s).toFixed(1)}%)`),r}fuzzyMatchUser(e,t="DisplayName"){let r,s=0;return this.usersBySid.forEach(o=>{const n="UPN"===t?o.UPN:"Mail"===t?o.Mail:o.DisplayName;if(n){const t=this.calculateLevenshteinSimilarity(e,n);t>=.8&&t>s&&(s=t,r=o)}}),r&&this.appliedInferenceRules.push(`Fuzzy user match: '${e}' -> '${r.DisplayName}' (similarity: ${(100*s).toFixed(1)}%)`),r}calculateLevenshteinSimilarity(e,t){if(!e||!t)return e||t?0:1;const r=e.length,s=t.length,o=[];for(let e=0;e<=r;e++)o[e]=[e];for(let e=0;e<=s;e++)o[0][e]=e;for(let n=1;n<=r;n++)for(let r=1;r<=s;r++){const s=e[n-1]===t[r-1]?0:1;o[n][r]=Math.min(o[n-1][r]+1,o[n][r-1]+1,o[n-1][r-1]+s)}const n=o[r][s],i=Math.max(r,s);return 0===i?1:1-n/i}async buildIndicesAsync(){this.groupsBySid.forEach((e,t)=>{e.Members.forEach(e=>{const r=this.membersByGroupSid.get(t)||[];r.push(e),this.membersByGroupSid.set(t,r);const s=this.groupsByUserSid.get(e)||[];s.push(t),this.groupsByUserSid.set(e,s)})}),this.devicesByName.forEach(e=>{if(e.PrimaryUserSid){const t=this.devicesByPrimaryUserSid.get(e.PrimaryUserSid)||[];t.push(e),this.devicesByPrimaryUserSid.set(e.PrimaryUserSid,t)}}),console.log("Indices built successfully")}async applyInferenceRulesAsync(){console.log("Applying inference rules..."),this.applyAclGroupUserInference(),this.applyPrimaryDeviceInference(),this.applyGpoSecurityFilterInference(),this.applyApplicationUsageInference(),this.applyAzureRoleInference(),this.applySqlOwnershipInference(),this.applyThreatAssetCorrelationInference(),this.applyGovernanceRiskInference(),this.applyLineageIntegrityInference(),this.applyExternalIdentityMappingInference(),this.appliedInferenceRules.push("Fuzzy matching enabled for identity resolution"),this.appliedInferenceRules.push("File share loader implemented with ACL correlation"),console.log(`Applied ${this.appliedInferenceRules.length} inference rules`)}getGroupsForUser(e){return(this.groupsByUserSid.get(e)||[]).map(e=>this.groupsBySid.get(e)).filter(e=>e)}getDevicesForUser(e){return this.devicesByPrimaryUserSid.get(e)||[]}getAppsForUser(e,t){const r=new Set;return t.forEach(e=>{e.InstalledApps.forEach(e=>{const t=this.appsById.get(e);t&&r.add(t)})}),Array.from(r)}getSharesForUser(e){return this.aclByIdentitySid.get(e)||[]}getGpoLinksForUser(e){const t=[];if(e.OU){const r=this.gposByOu.get(e.OU)||[];t.push(...r)}return t}getGpoFiltersForUser(e){return this.gposBySidFilter.get(e)||[]}getSqlDatabasesForUser(e){const t=[];return this.sqlDbsByKey.forEach(r=>{r.Owners.includes(e)&&t.push(r)}),t}calculateRisksForUser(e){const t=[],r=[];return e.AzureObjectId||r.push("No Azure AD mapping"),this.mailboxByUpn.has(e.UPN)||r.push("No mailbox found"),r.length>0&&t.push({EntityId:e.Sid,EntityType:"User",MissingMappings:r,OrphanedAcls:[],UnresolvableSidRefs:[],Severity:r.length>1?"High":"Medium",Type:"User",Description:`Risk assessment for User ${e.DisplayName||e.Sam}`,Recommendation:r.length>1?"Requires immediate attention before migration":"Should be reviewed and resolved during migration planning"}),t}generateMigrationHintsForUser(e){const t=[];return e.Manager&&t.push({EntityId:e.Sid,EntityType:"User",HintType:"ManagerMapping",Description:"User has a manager that needs to be mapped in target",RequiredActions:{"Map Manager":`Ensure manager ${e.Manager} is migrated first`,"Update Hierarchy":"Update reporting structure after migration"}}),t}getThreatsForAsset(e){return this.threatsByAsset.get(e)||[]}getGovernanceForAsset(e){return this.governanceByAssetId.get(e)}getLineageForAsset(e){return[...this.lineageBySourceAsset.get(e)||[],...this.lineageByTargetAsset.get(e)||[]]}getExternalIdentitiesForUser(e){const t=[];return this.externalIdentitiesById.forEach(r=>{r.InternalUserSid===e&&t.push(r)}),t}getFuzzyMatchCount(){return this.appliedInferenceRules.filter(e=>e.toLowerCase().includes("fuzzy")||e.toLowerCase().includes("similarity")||e.toLowerCase().includes("match")).length}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}getUserCount(){return this.usersBySid.size}getGroupCount(){return this.groupsBySid.size}getDeviceCount(){return this.devicesByName.size}getInfrastructureCount(){return this.sqlDbsByKey.size+this.fileSharesByPath.size}getApplicationCount(){return this.appsById.size}getDiscoveredUserCount(e=7){const t=new Date(Date.now()-24*e*60*60*1e3);let r=0;return this.usersBySid.forEach(e=>{e.DiscoveryTimestamp&&new Date(e.DiscoveryTimestamp)>t&&r++}),r}getDiscoveredGroupCount(e=7){const t=new Date(Date.now()-24*e*60*60*1e3);let r=0;return this.groupsBySid.forEach(e=>{e.DiscoveryTimestamp&&new Date(e.DiscoveryTimestamp)>t&&r++}),r}getDiscoveredDeviceCount(e=7){const t=new Date(Date.now()-24*e*60*60*1e3);let r=0;return this.devicesByName.forEach(e=>{e.DiscoveryTimestamp&&new Date(e.DiscoveryTimestamp)>t&&r++}),r}getLastDiscoveryRun(){let e;return this.usersBySid.forEach(t=>{if(t.DiscoveryTimestamp){const r=new Date(t.DiscoveryTimestamp);(!e||r>e)&&(e=r)}}),e?.toISOString()}getAllUsers(){return Array.from(this.usersBySid.values())}getAllGroups(){return Array.from(this.groupsBySid.values())}getAllDevices(){return Array.from(this.devicesByName.values())}getAllApplications(){return Array.from(this.appsById.values())}getAllMailboxes(){return Array.from(this.mailboxByUpn.values())}async analyzeMigrationComplexity(e){const t=this.usersBySid.get(e)||this.usersByUpn.get(e);if(!t)return console.warn(`User not found for complexity analysis: ${e}`),{score:0,level:"Low",factors:["User not found in discovery data"]};let r=0;const s=[],o=this.getGroupsForUser(t.Sid),n=this.getDevicesForUser(t.Sid),i=this.mailboxByUpn.get(t.UPN)||this.mailboxByUpn.get(t.Mail||""),a=this.rolesByPrincipalId.get(t.AzureObjectId||"")||[],c=this.drivesByUserSid.get(t.Sid)||[],l=this.aclByIdentitySid.get(t.Sid)||[];o.length>20?(r+=10,s.push(`High group membership count (${o.length} groups)`)):o.length>10?(r+=5,s.push(`Moderate group membership count (${o.length} groups)`)):o.length>5&&(r+=2,s.push(`Several group memberships (${o.length} groups)`));const u=o.filter(e=>e.Name?.toLowerCase().includes("admin")||e.Name?.toLowerCase().includes("domain")||e.Type?.toLowerCase().includes("privileged"));u.length>0&&(r+=15,s.push(`Administrative permissions detected (${u.length} admin groups)`)),a.length>5?(r+=10,s.push(`Multiple Azure role assignments (${a.length} roles)`)):a.length>0&&(r+=5,s.push(`Azure role assignments (${a.length} roles)`));const d=!!i,p=n.length>0,h=c.length>0;d&&p&&(r+=4,s.push("Multiple Microsoft 365 services (Mailbox + Devices)")),h&&(r+=2,s.push(`Mapped network drives (${c.length} drives)`)),p&&n.length>1&&(r+=2,s.push(`Multiple devices (${n.length} devices)`)),l.length>10?(r+=7,s.push(`Extensive file share permissions (${l.length} ACL entries)`)):l.length>0&&(r+=3,s.push(`File share permissions (${l.length} ACL entries)`));const m=o.filter(e=>("Team"===e.Type||e.Name?.toLowerCase().includes("team"))&&e.ManagedBy===t.Dn);if(m.length>0&&(r+=5,s.push(`Teams owner (${m.length} teams)`)),t.Manager){const e=Array.from(this.usersBySid.values()).filter(e=>e.Manager===t.Dn||e.ManagerSid===t.Sid);e.length>0&&(r+=5,s.push(`Manager with direct reports (${e.length} reports)`))}let g;return g=r<=15?"Low":r<=35?"Medium":"High",0===s.length&&s.push("Minimal dependencies - straightforward migration"),console.log(`Complexity analysis for ${t.DisplayName||t.Sam}: Score=${r}, Level=${g}, Factors=${s.length}`),{score:r,level:g,factors:s}}async batchAnalyzeMigrationComplexity(e){const t=new Map;for(const r of e){const e=await this.analyzeMigrationComplexity(r);t.set(r,e)}return t}getComplexityStatistics(){return{total:this.usersBySid.size,low:0,medium:0,high:0,analyzed:0}}}},"./src/main/services/mockLogicEngineService.ts":(e,t,r)=>{"use strict";r.d(t,{MockLogicEngineService:()=>o,mockComputerDetailService:()=>a,mockGroupDetailService:()=>c});var s=r("./src/renderer/types/models/group.ts");class o{static instance;cache=new Map;static getInstance(){return o.instance||(o.instance=new o),o.instance}async getUserDetailAsync(e){if(this.cache.has(e))return console.log(`[MockLogicEngine] Returning cached user detail for ${e}`),this.cache.get(e);console.log(`[MockLogicEngine] Generating mock user detail for ${e}`);const t=this.generateMockUserDetail(e);return this.cache.set(e,t),setTimeout(()=>this.cache.delete(e),9e5),t}clearUserDetailCache(e){this.cache.delete(e),console.log(`[MockLogicEngine] Cleared cache for ${e}`)}clearAllCache(){this.cache.clear(),console.log("[MockLogicEngine] Cleared all cache")}isLoaded(){return!0}generateMockUserDetail(e){const t=this.generateMockUser(e),r=this.generateMockGroups(5),s=this.generateMockDevices(3),o=this.generateMockApplications(12),n=this.generateMockDrives(2),i=this.generateMockFileAccess(8),a=this.generateMockGpos(4,"link"),c=this.generateMockGpos(2,"filter"),l=this.generateMockMailbox(t.userPrincipalName),u=this.generateMockAzureRoles(3),d=this.generateMockSqlDatabases(2),p=this.generateMockRisks(4),h=this.generateMockMigrationHints(5),m=this.generateMockTeams(4),g=this.generateMockSharePointSites(6),f=r.map(e=>e.name),y=r.filter((e,t)=>t<1).map(e=>e.name),v=t.managerDisplayName||"manager@company.com",w=y,E={totalGroups:r.length,totalDevices:s.length,totalApplications:o.length,totalFileAccess:i.length,totalGpos:a.length+c.length,totalAzureRoles:u.length,totalSqlDatabases:d.length,totalRisks:p.length,highRiskCount:p.filter(e=>"High"===e.severity).length,criticalRiskCount:p.filter(e=>"Critical"===e.severity).length};return{user:t,groups:r,devices:s,apps:o,drives:n,fileAccess:i,gpoLinks:a,gpoFilters:c,mailbox:l,azureRoles:u,sqlDatabases:d,risks:p,migrationHints:h,teams:m,sharepointSites:g,memberOfGroups:f,managedGroups:y,managerUpn:v,ownedGroups:w,stats:E}}generateMockUser(e){const t=e.includes("@")?e:`${e}@company.com`,r=`User ${e.split("@")[0]}`;return{id:e,name:r,displayName:r,userPrincipalName:t,mail:t,email:t,department:"IT Department",jobTitle:"Senior Engineer",accountEnabled:!0,samAccountName:e.split("@")[0],companyName:"Contoso Corporation",managerDisplayName:"Manager Smith",createdDateTime:new Date("2020-01-15"),userSource:"ActiveDirectory",firstName:"John",lastName:"Doe",country:"United States",company:"Contoso Corporation",givenName:"John",surname:"Doe",city:"New York",mobilePhone:"+1-555-0123",lastSignInDateTime:new Date("2024-10-03"),groupMembershipCount:"5",assignedLicenses:"Office 365 E3, Project Plan 3",enabled:!0,title:"Senior Engineer",isPrivileged:!1,passwordExpiryDate:new Date("2025-01-15"),lastLogonDate:new Date("2024-10-03"),createdDate:new Date("2020-01-15"),canEdit:!0,canResetPassword:!0,canToggleAccount:!0,status:"Enabled",officeLocation:"Building A",manager:"Manager Smith",groups:"IT Admins, Developers",objectType:"User",isSelected:!1,domain:"contoso.com",createdAt:new Date("2020-01-15")}}generateMockGroups(e){const t=[s.GroupType.Security,s.GroupType.Distribution,s.GroupType.Office365],r=[s.GroupScope.Universal,s.GroupScope.Global,s.GroupScope.DomainLocal];return Array.from({length:e},(e,o)=>({id:`group-${o}`,objectId:`obj-group-${o}`,name:`Group ${o+1}`,displayName:`Group ${o+1}`,description:`Mock group ${o+1} for testing`,email:`group${o}@company.com`,groupType:t[o%t.length],scope:r[o%r.length],membershipType:s.MembershipType.Static,memberCount:Math.floor(50*Math.random())+5,owners:[`owner-${o}@company.com`],createdDate:new Date(2020,o%12,o%28+1).toISOString(),lastModified:new Date(2024,9,o%28+1).toISOString(),source:"ActiveDirectory",distinguishedName:`CN=Group ${o+1},OU=Groups,DC=contoso,DC=com`,managedBy:0===o?"CN=User Test,OU=Users,DC=contoso,DC=com":void 0,isSecurityEnabled:o%2==0,isMailEnabled:o%3==0}))}generateMockDevices(e){const t=["Windows 11 Pro","Windows 10 Enterprise","Windows Server 2022"],r=["Dell","HP","Lenovo"],s=["Intune","AD","ConfigMgr"];return Array.from({length:e},(e,o)=>({id:`device-${o}`,name:`DESKTOP-${1e3+o}`,dns:`desktop-${1e3+o}.contoso.com`,os:t[o%t.length],ou:"OU=Workstations,DC=contoso,DC=com",primaryUserSid:"S-1-5-21-123456789-123456789-123456789-1001",lastSeen:new Date(2024,9,3-o),ipAddress:`192.168.1.${100+o}`,manufacturer:r[o%r.length],model:"OptiPlex "+(7e3+10*o),serialNumber:`SN${1e4+o}`,domain:"contoso.com",isEnabled:!0,source:s[o%s.length]}))}generateMockApplications(e){const t=["InstalledSoftware","EnterpriseApp","LicenseService"],r=["Intune","ConfigMgr","AzureAD","License"];return[{name:"Microsoft Office 365",publisher:"Microsoft",version:"16.0.12345"},{name:"Google Chrome",publisher:"Google LLC",version:"120.0.6099"},{name:"Adobe Acrobat Reader",publisher:"Adobe Inc.",version:"2024.001"},{name:"Slack",publisher:"Slack Technologies",version:"4.35.121"},{name:"Visual Studio Code",publisher:"Microsoft",version:"1.84.2"},{name:"Zoom",publisher:"Zoom Video Communications",version:"5.16.5"},{name:"7-Zip",publisher:"7-Zip",version:"23.01"},{name:"VLC Media Player",publisher:"VideoLAN",version:"3.0.20"},{name:"Microsoft Teams",publisher:"Microsoft",version:"1.6.00.36174"},{name:"Notepad++",publisher:"Notepad++ Team",version:"8.6.0"},{name:"Postman",publisher:"Postman Inc.",version:"10.19.0"},{name:"Docker Desktop",publisher:"Docker Inc.",version:"4.25.2"}].slice(0,e).map((e,s)=>({name:e.name,version:e.version,publisher:e.publisher,type:"Application",userCount:Math.floor(10*Math.random())+1,groupCount:Math.floor(3*Math.random()),deviceCount:Math.floor(5*Math.random())+1,lastSeen:new Date(2024,9,4-s%30),id:`app-${s}`,installDate:new Date(2023,s%12,s%28+1),installCount:Math.floor(20*Math.random())+5,status:"Installed",category:s%3==0?"Productivity":s%3==1?"Development":"Communication",assignmentType:t[s%t.length],source:r[s%r.length]}))}generateMockDrives(e){const t=["Z:","Y:","X:","W:"],r=["\\\\fileserver\\users","\\\\fileserver\\shared","\\\\fileserver\\projects","\\\\fileserver\\department"];return Array.from({length:Math.min(e,t.length)},(e,s)=>({driveLetter:t[s],uncPath:r[s],userSid:"S-1-5-21-123456789-123456789-123456789-1001",persistent:!0,label:`Network Drive ${s+1}`,connected:!0}))}generateMockFileAccess(e){const t=["\\\\fileserver\\users\\johndoe","\\\\fileserver\\shared\\documents","\\\\fileserver\\projects\\project-alpha","C:\\Shared\\TeamFiles","\\\\fileserver\\department\\IT","\\\\fileserver\\archives\\2024","C:\\Users\\Public\\Documents","\\\\fileserver\\software\\installers"],r=["FullControl","Modify","ReadAndExecute","Read","Write"];return Array.from({length:Math.min(e,t.length)},(e,s)=>({path:t[s],rights:r[s%r.length],inherited:s%3!=0,isShare:t[s].startsWith("\\\\"),isNtfs:!t[s].startsWith("\\\\"),identitySid:"S-1-5-21-123456789-123456789-123456789-1001",accessType:"Allow",appliesTo:"This folder, subfolders and files"}))}generateMockGpos(e,t){const r="link"===t?["Default Domain Policy","IT Security Policy","Password Policy","Desktop Settings"]:["User Configuration Filter","Security Settings Filter"];return Array.from({length:Math.min(e,r.length)},(e,s)=>({name:r[s],guid:`{${crypto.randomUUID()}}`,enabled:!0,wmiFilter:"filter"===t?'SELECT * FROM Win32_OperatingSystem WHERE Version LIKE "10.%"':void 0,linkedOu:"OU=Users,DC=contoso,DC=com",gpoStatus:"Enabled",description:`Mock GPO ${t} ${s+1}`,createdDate:new Date(2020,s%12,1),modifiedDate:new Date(2024,9,1)}))}generateMockMailbox(e){return e?{mailboxGuid:crypto.randomUUID(),userPrincipalName:e,sizeMb:4567.89,type:"UserMailbox",itemCount:12345,database:"EXCH-DB01",serverName:"EXCH-SERVER01",quotaGB:50,prohibitSendQuotaGB:49,issueWarningQuotaGB:45,lastLogonTime:new Date("2024-10-03T14:30:00Z")}:null}generateMockAzureRoles(e){return[{name:"User",scope:"Directory"},{name:"Application Developer",scope:"Directory"},{name:"Reader",scope:"/subscriptions/12345678-1234-1234-1234-123456789012"}].slice(0,e).map((e,t)=>({roleName:e.name,scope:e.scope,principalObjectId:`obj-${crypto.randomUUID()}`,principalType:"User",assignmentId:crypto.randomUUID(),roleDefinitionId:crypto.randomUUID(),createdOn:new Date(2023,t%12,t%28+1),isInherited:!1}))}generateMockSqlDatabases(e){return[{server:"SQL-SERVER01",instance:"PROD",database:"CRM_Database",role:"db_datareader"},{server:"SQL-SERVER02",instance:"DEV",database:"Analytics_DB",role:"db_owner"}].slice(0,e).map((e,t)=>({server:e.server,instance:e.instance,database:e.database,role:e.role,loginType:"Windows",hasAccess:!0,permissions:["SELECT","INSERT","UPDATE"],appHints:"SSMS, Power BI",lastAccessed:new Date(2024,9,4-t)}))}generateMockRisks(e){return[{type:"StaleAccount",severity:"Medium",description:"User has not logged in for 90+ days",recommendation:"Review account activity and consider disabling if no longer needed",category:"Security"},{type:"OverprivilegedUser",severity:"High",description:"User has excessive permissions across multiple systems",recommendation:"Review and reduce permissions following principle of least privilege",category:"Security"},{type:"MissingMFA",severity:"High",description:"Multi-factor authentication is not enabled for this account",recommendation:"Enable MFA to enhance account security",category:"Security"},{type:"ExpiredPassword",severity:"Low",description:"Password is set to never expire",recommendation:"Implement password expiration policy",category:"Compliance"}].slice(0,e).map((e,t)=>({...e,affectedEntity:`user-${t}`,detectedAt:new Date(2024,9,1),remediation:e.recommendation,cvssScore:"High"===e.severity?7.5:"Medium"===e.severity?5:2}))}generateMockMigrationHints(e){return[{category:"Device",priority:"High",message:"User has 3 devices that need to be migrated. Coordinate device handoff.",actionRequired:!0,impact:"High",complexity:"Medium",estimatedEffort:"4 hours",dependencies:["Device inventory","User coordination"]},{category:"Application",priority:"Medium",message:"2 applications (Adobe Acrobat, Visual Studio) require license transfer",actionRequired:!0,impact:"Medium",complexity:"Low",estimatedEffort:"1 hour",dependencies:["License management"]},{category:"Group",priority:"High",message:"User is member of 5 groups - map to target directory groups",actionRequired:!0,impact:"High",complexity:"Medium",estimatedEffort:"2 hours",dependencies:["Group mapping","Access validation"]},{category:"Mailbox",priority:"High",message:"Mailbox size is 4.5GB - plan for migration window",actionRequired:!0,impact:"High",complexity:"Medium",estimatedEffort:"6 hours",dependencies:["Bandwidth availability","User notification"]},{category:"FileAccess",priority:"Medium",message:"User has 8 file share permissions - verify access in target environment",actionRequired:!1,impact:"Medium",complexity:"Low",estimatedEffort:"1 hour",dependencies:["File share mapping"]}].slice(0,e)}generateMockTeams(e){const t=["Engineering Team","Marketing Department","Sales Operations","IT Support","Project Alpha","Customer Success"];return Array.from({length:Math.min(e,t.length)},(e,r)=>({teamName:t[r],teamId:`team-${r}-${Date.now()}`,userRole:0===r?"Owner":"Member",channelCount:Math.floor(10*Math.random())+3,channels:0===r?["General","Announcements","Private-Leadership"]:void 0,source:"Teams"}))}generateMockSharePointSites(e){return[{name:"Company Intranet",url:"https://contoso.sharepoint.com/sites/intranet",isOneDrive:!1,access:"Member"},{name:"Engineering Hub",url:"https://contoso.sharepoint.com/sites/engineering",isOneDrive:!1,access:"Owner"},{name:"Project Documentation",url:"https://contoso.sharepoint.com/sites/projects",isOneDrive:!1,access:"Member"},{name:"HR Portal",url:"https://contoso.sharepoint.com/sites/hr",isOneDrive:!1,access:"Visitor"},{name:"Sales Resources",url:"https://contoso.sharepoint.com/sites/sales",isOneDrive:!1,access:"Member"},{name:"OneDrive - John Doe",url:"https://contoso-my.sharepoint.com/personal/jdoe",isOneDrive:!0,access:"Owner"}].slice(0,e).map((e,t)=>({siteName:e.name,siteUrl:e.url,accessLevel:e.access,isOneDrive:e.isOneDrive,source:"SharePointOnline",lastAccessed:new Date(2024,11,20-t)}))}}class n{static instance;cache=new Map;static getInstance(){return n.instance||(n.instance=new n),n.instance}async getComputerDetailAsync(e){if(this.cache.has(e))return console.log(`[MockComputerDetail] Returning cached computer detail for ${e}`),this.cache.get(e);console.log(`[MockComputerDetail] Generating mock computer detail for ${e}`);const t=this.generateMockComputerDetail(e);return this.cache.set(e,t),setTimeout(()=>this.cache.delete(e),9e5),t}clearComputerDetailCache(e){this.cache.delete(e),console.log(`[MockComputerDetail] Cleared cache for ${e}`)}generateMockComputerDetail(e){const t=this.generateMockComputer(e),r=this.generateMockComputerUsers(3),s=this.generateMockSoftware(45),o=this.generateMockHardwareSpec(),n=this.generateMockSecurityStatus(),i=this.generateMockNetworkInfo(),a=this.generateMockComputerGroups(5),c=this.generateMockComputerApps(12),l=this.generateMockComputerRisks(4),u=this.generateMockComputerMigrationHints(5);return{computer:t,overview:{userCount:r.length,softwareCount:s.length,groupCount:a.length,networkAdapterCount:i.adapters.length,lastBootTime:new Date(Date.now()-2592e5),uptime:"3 days, 12 hours, 45 minutes",installDate:new Date(2023,0,15)},users:r,software:s,hardware:o,security:n,network:i,groups:a,apps:c,risks:l,migrationHints:u,primaryUser:r[0]?.userPrincipalName||null,assignedUsers:r.map(e=>e.userPrincipalName),memberOfGroups:a.map(e=>e.name),stats:{totalUsers:r.length,totalSoftware:s.length,totalGroups:a.length,totalRisks:l.length,highRiskCount:l.filter(e=>"High"===e.severity).length,criticalRiskCount:l.filter(e=>"Critical"===e.severity).length,diskUsagePercentage:Math.floor(100*(1-o.freeDiskGB/o.totalDiskGB)),complianceScore:85}}}generateMockComputer(e){const t=["Windows 11 Pro","Windows 10 Enterprise","Windows Server 2022","Windows Server 2019"],r=t[e.charCodeAt(0)%t.length];return{id:e,name:`WKS-${e.padStart(6,"0")}`,dns:`wks-${e}.contoso.com`,domain:"contoso.com",ou:"OU=Workstations,OU=Computers,DC=contoso,DC=com",os:r,osVersion:r.includes("11")?"10.0.22631":r.includes("10")?"10.0.19045":"10.0.20348",status:e.charCodeAt(0)%3==0?"Online":e.charCodeAt(0)%3==1?"Offline":"Unknown",lastSeen:new Date(Date.now()-7*Math.random()*24*60*60*1e3),ipAddress:`192.168.${Math.floor(255*Math.random())}.${Math.floor(255*Math.random())}`,macAddress:`00:15:5D:${Math.floor(256*Math.random()).toString(16).toUpperCase().padStart(2,"0")}:${Math.floor(256*Math.random()).toString(16).toUpperCase().padStart(2,"0")}:${Math.floor(256*Math.random()).toString(16).toUpperCase().padStart(2,"0")}`,manufacturer:["Dell","HP","Lenovo"][e.charCodeAt(0)%3],model:["OptiPlex 7090","EliteDesk 800","ThinkCentre M90"][e.charCodeAt(0)%3],serialNumber:`SN${Math.random().toString(36).substring(2,12).toUpperCase()}`,isEnabled:!0,createdDate:new Date(2023,0,15),modifiedDate:new Date,description:"Corporate workstation"}}generateMockComputerUsers(e){return Array.from({length:e},(e,t)=>({userSid:`S-1-5-21-123456789-123456789-123456789-${1e3+t}`,userPrincipalName:`user${t}@contoso.com`,displayName:`User ${t}`,assignmentType:0===t?"Primary":1===t?"Secondary":"LastLogon",lastLogon:new Date(Date.now()-24*t*60*60*1e3),profilePath:`C:\\Users\\user${t}`,isPrimaryUser:0===t}))}generateMockSoftware(e){const t=[{name:"Microsoft Office 365",publisher:"Microsoft",category:"Productivity"},{name:"Google Chrome",publisher:"Google LLC",category:"Browser"},{name:"Adobe Acrobat Reader",publisher:"Adobe Inc.",category:"Productivity"},{name:"Zoom",publisher:"Zoom Video Communications",category:"Communication"},{name:"Microsoft Teams",publisher:"Microsoft",category:"Communication"},{name:"Visual Studio Code",publisher:"Microsoft",category:"Development"},{name:"Slack",publisher:"Slack Technologies",category:"Communication"},{name:"Notepad++",publisher:"Notepad++ Team",category:"Development"},{name:"7-Zip",publisher:"7-Zip",category:"Utility"},{name:"VLC Media Player",publisher:"VideoLAN",category:"Media"}];return Array.from({length:Math.min(e,50)},(e,r)=>{const s=t[r%t.length];return{name:s.name,version:`${Math.floor(10*Math.random())+1}.${Math.floor(100*Math.random())}.${Math.floor(1e3*Math.random())}`,publisher:s.publisher,installDate:new Date(2023,Math.floor(12*Math.random()),Math.floor(28*Math.random())+1),installPath:`C:\\Program Files\\${s.name.replace(/\s+/g,"")}`,category:s.category,size:Math.floor(500*Math.random())+10,licenseKey:null,licenseType:"Commercial"}})}generateMockHardwareSpec(){return{processor:"Intel Core i7-11700 @ 2.50GHz",processorCores:8,processorSpeed:"2.50 GHz",ramGB:16,totalDiskGB:512,freeDiskGB:168,diskType:"SSD",graphicsCard:"Intel UHD Graphics 750",biosVersion:"A12",biosDate:new Date(2023,5,15),systemType:"64-bit",virtualMachine:!1,hypervisor:null}}generateMockSecurityStatus(){return{antivirusInstalled:!0,antivirusProduct:"Windows Defender",antivirusUpToDate:!0,antivirusLastUpdate:new Date(Date.now()-1728e5),firewallEnabled:!0,firewallProfile:"Domain",encryptionEnabled:!0,encryptionType:"BitLocker",tpmEnabled:!0,secureBoot:!0,lastPatchDate:new Date(Date.now()-6048e5),patchLevel:"Fully Patched",complianceStatus:"Compliant",complianceIssues:[],vulnerabilityCount:2,criticalVulnerabilityCount:0}}generateMockNetworkInfo(){return{ipAddress:`192.168.1.${Math.floor(255*Math.random())}`,macAddress:`00:15:5D:${Math.floor(256*Math.random()).toString(16).toUpperCase().padStart(2,"0")}:${Math.floor(256*Math.random()).toString(16).toUpperCase().padStart(2,"0")}:${Math.floor(256*Math.random()).toString(16).toUpperCase().padStart(2,"0")}`,subnet:"255.255.255.0",gateway:"192.168.1.1",dnsServers:["192.168.1.10","192.168.1.11"],dhcpEnabled:!0,dhcpServer:"192.168.1.1",vlan:null,connectionType:"Wired",wifiSSID:null,networkSpeed:"1 Gbps",adapters:[{name:"Ethernet",type:"Ethernet",macAddress:"00:15:5D:AB:CD:EF",status:"Connected",speed:"1 Gbps",ipAddresses:["192.168.1.100"]},{name:"Wi-Fi",type:"WiFi",macAddress:"00:15:5D:12:34:56",status:"Disconnected",speed:null,ipAddresses:[]}]}}generateMockComputerGroups(e){const t=["Domain Computers","Workstations","Finance-Computers","IT-Admin-Computers","VPN Users"];return Array.from({length:Math.min(e,t.length)},(e,r)=>({id:`group-${r}`,objectId:`obj-group-${r}`,name:t[r],displayName:t[r],description:`Computer group ${r}`,email:null,groupType:s.GroupType.Security,scope:s.GroupScope.Global,membershipType:s.MembershipType.Static,memberCount:Math.floor(100*Math.random())+10,owners:["admin@contoso.com"],createdDate:new Date(2020,r%12,1).toISOString(),lastModified:(new Date).toISOString(),source:"ActiveDirectory",distinguishedName:`CN=${t[r]},OU=Groups,DC=contoso,DC=com`,managedBy:void 0,isSecurityEnabled:!0,isMailEnabled:!1}))}generateMockComputerApps(e){return[{name:"Microsoft Office 365",publisher:"Microsoft",version:"16.0.12345"},{name:"Google Chrome",publisher:"Google LLC",version:"120.0.6099"},{name:"Adobe Acrobat Reader",publisher:"Adobe Inc.",version:"2024.001"},{name:"Slack",publisher:"Slack Technologies",version:"4.35.121"},{name:"Visual Studio Code",publisher:"Microsoft",version:"1.84.2"},{name:"Zoom",publisher:"Zoom Video Communications",version:"5.16.5"},{name:"7-Zip",publisher:"7-Zip",version:"23.01"},{name:"VLC Media Player",publisher:"VideoLAN",version:"3.0.20"},{name:"Microsoft Teams",publisher:"Microsoft",version:"1.6.00.36174"},{name:"Notepad++",publisher:"Notepad++ Team",version:"8.6.0"},{name:"Postman",publisher:"Postman Inc.",version:"10.19.0"},{name:"Docker Desktop",publisher:"Docker Inc.",version:"4.25.2"}].slice(0,e).map((e,t)=>({name:e.name,version:e.version,publisher:e.publisher,type:"Application",userCount:Math.floor(10*Math.random())+1,groupCount:Math.floor(3*Math.random()),deviceCount:Math.floor(5*Math.random())+1,lastSeen:new Date(2024,9,4-t%30),id:`app-${t}`,installDate:new Date(2023,t%12,t%28+1),installCount:Math.floor(20*Math.random())+5,status:"Installed",category:t%3==0?"Productivity":t%3==1?"Development":"Communication"}))}generateMockComputerRisks(e){return[{type:"OutdatedOS",severity:"High",description:"Operating system version is outdated and should be upgraded",recommendation:"Schedule OS upgrade to latest version",category:"Security"},{type:"MissingPatches",severity:"Medium",description:"3 critical security patches are missing",recommendation:"Apply missing patches during next maintenance window",category:"Security"},{type:"LowDiskSpace",severity:"Low",description:"Free disk space is below 20% threshold",recommendation:"Clean up temporary files or expand disk capacity",category:"Performance"},{type:"NoBackup",severity:"High",description:"Computer has not been backed up in 30+ days",recommendation:"Enable automated backup schedule",category:"Configuration"}].slice(0,e).map((e,t)=>({...e,affectedComponent:`computer-${t}`,detectedAt:new Date(2024,9,1),remediation:e.recommendation}))}generateMockComputerMigrationHints(e){return[{category:"Hardware",priority:"Medium",message:"Computer meets minimum requirements for target environment",actionRequired:!1,impact:"Low",complexity:"Low",estimatedEffort:"30 minutes",dependencies:["Hardware inventory"]},{category:"Software",priority:"High",message:"45 applications installed - verify compatibility with target OS",actionRequired:!0,impact:"High",complexity:"High",estimatedEffort:"8 hours",dependencies:["Application compatibility testing"]},{category:"User",priority:"High",message:"3 users assigned - coordinate migration schedule",actionRequired:!0,impact:"High",complexity:"Medium",estimatedEffort:"2 hours",dependencies:["User coordination","Calendar scheduling"]},{category:"Network",priority:"Low",message:"Network configuration is standard - minimal changes required",actionRequired:!1,impact:"Low",complexity:"Low",estimatedEffort:"15 minutes",dependencies:[]},{category:"Security",priority:"Medium",message:"BitLocker enabled - ensure recovery keys are backed up",actionRequired:!0,impact:"Medium",complexity:"Low",estimatedEffort:"30 minutes",dependencies:["Recovery key backup"]}].slice(0,e)}}class i{static instance;cache=new Map;static getInstance(){return i.instance||(i.instance=new i),i.instance}async getGroupDetailAsync(e){if(this.cache.has(e))return console.log(`[MockGroupDetail] Returning cached group detail for ${e}`),this.cache.get(e);console.log(`[MockGroupDetail] Generating mock group detail for ${e}`);const t=this.generateMockGroupDetail(e);return this.cache.set(e,t),setTimeout(()=>this.cache.delete(e),9e5),t}clearGroupDetailCache(e){this.cache.delete(e),console.log(`[MockGroupDetail] Cleared cache for ${e}`)}generateMockGroupDetail(e){const t=this.generateMockGroup(e),r=this.generateMockGroupMembers(25),s=this.generateMockGroupOwners(2),o=this.generateMockGroupPermissions(12),n=this.generateMockGroupApplications(8),i=this.generateMockNestedGroups(5),a=this.generateMockGroupPolicies(3),c=this.generateMockGroupRisks(3),l=this.generateMockGroupMigrationHints(5),u=this.generateMockSyncStatus();return{group:t,overview:{memberCount:r.length,ownerCount:s.length,permissionCount:o.length,applicationCount:n.length,nestedGroupCount:i.length,createdDate:new Date(2022,0,1),modifiedDate:new Date,description:"Security group for department access",notes:null,isHybrid:!0,isDynamic:!1,dynamicMembershipRule:null},members:r,owners:s,permissions:o,applications:n,nestedGroups:i,policies:a,risks:c,migrationHints:l,syncStatus:u,directMembers:r.filter(e=>"Direct"===e.memberType).map(e=>e.userPrincipalName),allMembers:r.map(e=>e.userPrincipalName),primaryOwner:s.find(e=>"Primary"===e.ownershipType)?.userPrincipalName||null,allOwners:s.map(e=>e.userPrincipalName||e.displayName),parentGroups:i.filter(e=>"Parent"===e.relationshipType).map(e=>e.groupName),childGroups:i.filter(e=>"Child"===e.relationshipType).map(e=>e.groupName),stats:{totalMembers:r.length,totalOwners:s.length,totalPermissions:o.length,totalApplications:n.length,totalNestedGroups:i.length,totalRisks:c.length,highRiskCount:c.filter(e=>"High"===e.severity).length,criticalRiskCount:c.filter(e=>"Critical"===e.severity).length,activeMembers:r.filter(e=>e.accountEnabled).length,staleMembers:r.filter(e=>!e.accountEnabled).length,securityScore:82}}}generateMockGroup(e){return{id:e,objectId:`obj-${e}`,name:`Group-${e}`,displayName:`Department Group ${e}`,description:"Mock group for testing",email:`group-${e}@contoso.com`,groupType:s.GroupType.Security,scope:s.GroupScope.Universal,membershipType:s.MembershipType.Static,memberCount:25,owners:["admin@contoso.com"],createdDate:new Date(2022,0,1).toISOString(),lastModified:(new Date).toISOString(),source:"ActiveDirectory",distinguishedName:`CN=Group-${e},OU=Groups,DC=contoso,DC=com`,managedBy:"CN=Admin,OU=Users,DC=contoso,DC=com",isSecurityEnabled:!0,isMailEnabled:!1}}generateMockGroupMembers(e){return Array.from({length:e},(e,t)=>({id:`member-${t}`,userPrincipalName:`user${t}@contoso.com`,displayName:`User ${t}`,email:`user${t}@contoso.com`,memberType:t<20?"Direct":t<23?"Nested":"Dynamic",addedDate:new Date(2023,t%12,t%28+1),department:["IT","Finance","HR","Sales"][t%4],jobTitle:["Engineer","Manager","Analyst","Director"][t%4],accountEnabled:t<23,membershipSource:t<20?"Manual":"Inherited",isDirectMember:t<20}))}generateMockGroupOwners(e){return Array.from({length:e},(e,t)=>({id:`owner-${t}`,displayName:`Owner ${t}`,type:"User",userPrincipalName:`owner${t}@contoso.com`,email:`owner${t}@contoso.com`,ownershipType:0===t?"Primary":"Secondary",assignedDate:new Date(2022,0,1),isPrimaryOwner:0===t}))}generateMockGroupPermissions(e){const t=["SharePoint Site","Exchange Mailbox","Azure Subscription","File Share"],r=["Full Control","Contribute","Read","Owner"];return Array.from({length:e},(e,s)=>({resourceType:t[s%t.length],resourceName:`Resource-${s}`,permissionLevel:r[s%r.length],accessLevel:r[s%r.length],permissionType:s%2==0?"Direct":"Inherited",scope:s%3==0?"Global":"Limited",isInherited:s%2!=0,inherited:s%2!=0,grantedDate:new Date(2023,s%12,s%28+1),assignedDate:new Date(2023,s%12,s%28+1),assignedBy:"admin@contoso.com",source:["Azure","ActiveDirectory","Exchange","SharePoint"][s%4]}))}generateMockGroupApplications(e){const t=["Microsoft 365","Salesforce","Azure DevOps","GitHub","Jira","Confluence","Slack","Zoom"],r=["Admin","User","Contributor","Reader"];return Array.from({length:e},(e,s)=>({applicationId:`app-${s}`,applicationName:t[s%t.length],accessLevel:r[s%r.length],roleName:r[s%r.length],accessType:s%2==0?"Direct":"Inherited",roles:[r[s%r.length]],grantedDate:new Date(2023,s%12,s%28+1),grantedBy:"admin@contoso.com",source:["Azure","ActiveDirectory"][s%2],isConditionalAccess:s%3==0,isConditional:s%3==0,conditions:s%3==0?["MFA Required","Compliant Device"]:[]}))}generateMockNestedGroups(e){return Array.from({length:e},(e,t)=>({groupId:`nested-group-${t}`,groupName:`Nested Group ${t}`,relationshipType:t<3?"Child":"Parent",relationship:t<3?"Child":"Parent",groupType:"Security",scope:"Global",memberCount:Math.floor(50*Math.random())+5,nestingLevel:t%2==0?1:2,addedDate:new Date(2023,t%12,t%28+1),isCircular:4===t}))}generateMockGroupPolicies(e){return Array.from({length:e},(e,t)=>({policyName:`Group Policy ${t}`,policyGuid:crypto.randomUUID(),policyType:["User","Computer","Both"][t%3],enabled:!0,linkedOu:"OU=Groups,DC=contoso,DC=com",order:t+1,enforced:0===t,appliesTo:"All Users"}))}generateMockGroupRisks(e){return[{type:"StaleMembership",severity:"Medium",description:"2 members have inactive accounts",recommendation:"Review and remove inactive members",category:"Security"},{type:"OverprivilegedGroup",severity:"High",description:"Group has excessive permissions across multiple resources",recommendation:"Review and reduce permissions following principle of least privilege",category:"Security"},{type:"CircularNesting",severity:"High",description:"Circular group nesting detected",recommendation:"Resolve circular dependencies in group membership",category:"Configuration"}].slice(0,e).map((e,t)=>({...e,affectedMembers:[`member-${t}`],affectedResources:[`resource-${t}`],detectedAt:new Date(2024,9,1),remediation:e.recommendation}))}generateMockGroupMigrationHints(e){return[{category:"Membership",priority:"High",message:"Group has 25 members - verify all should be migrated",actionRequired:!0,impact:"High",complexity:"Medium",estimatedEffort:"3 hours",dependencies:["Member verification","Access validation"]},{category:"Permissions",priority:"High",message:"12 permissions assigned - map to target environment",actionRequired:!0,impact:"High",complexity:"High",estimatedEffort:"4 hours",dependencies:["Permission mapping","Resource availability"]},{category:"NestedGroups",priority:"Medium",message:"5 nested group relationships - verify hierarchy in target",actionRequired:!0,impact:"Medium",complexity:"Medium",estimatedEffort:"2 hours",dependencies:["Group hierarchy mapping"]},{category:"Applications",priority:"High",message:"8 application access assignments - verify in target environment",actionRequired:!0,impact:"High",complexity:"Medium",estimatedEffort:"3 hours",dependencies:["Application availability","Role mapping"]},{category:"Sync",priority:"Low",message:"Group is hybrid synced - ensure sync is configured in target",actionRequired:!1,impact:"Low",complexity:"Low",estimatedEffort:"1 hour",dependencies:["Hybrid sync configuration"]}].slice(0,e)}generateMockSyncStatus(){return{isSynced:!0,lastSyncTime:new Date(Date.now()-72e5),syncSource:"ActiveDirectory",syncErrors:[],deltaChanges:0,syncEnabled:!0}}}o.getInstance();const a=n.getInstance(),c=i.getInstance()},"./src/main/services/moduleRegistry.ts":(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var s=r("fs/promises"),o=r("path");const n=class{modules;categories;psService;registryPath;loaded;constructor(e,t){this.modules=new Map,this.categories=new Map,this.psService=e,this.registryPath=t||o.join(process.cwd(),"module-registry.json"),this.loaded=!1}async loadRegistry(e){const t=e||this.registryPath;try{const e=await s.readFile(t,"utf-8"),r=JSON.parse(e);if(r.modules&&Array.isArray(r.modules)){for(const e of r.modules)await this.registerModule(e);console.log(`Loaded ${this.modules.size} modules from registry`),this.loaded=!0}else console.warn("Invalid registry format, expected { modules: [...] }")}catch(e){if("ENOENT"!==e.code)throw console.error(`Failed to load module registry: ${e.message}`),e;console.log(`No module registry found at ${t}, starting with empty registry`),this.loaded=!0}}async saveRegistry(e){const t=e||this.registryPath,r=Array.from(this.modules.values()),o={version:"1.0.0",lastUpdated:(new Date).toISOString(),modules:r};try{await s.writeFile(t,JSON.stringify(o,null,2),"utf-8"),console.log(`Saved ${r.length} modules to registry`)}catch(e){throw console.error(`Failed to save module registry: ${e.message}`),e}}async registerModule(e){if(!e.id||!e.displayName||!e.scriptPath)throw new Error("Module must have id, displayName, and scriptPath");this.modules.has(e.id)&&console.warn(`Module ${e.id} already registered, overwriting`);const t={...e,enabled:!1!==e.enabled,priority:e.priority||100,timeout:e.timeout||6e4,requiredPermissions:e.requiredPermissions||[],parameters:e.parameters||[],version:e.version||"1.0.0",tags:e.tags||[]};this.modules.set(e.id,t),this.categories.has(e.category)||this.categories.set(e.category,[]);const r=this.categories.get(e.category),s=r.findIndex(t=>t.id===e.id);s>=0&&r.splice(s,1),r.push(t),r.sort((e,t)=>t.priority-e.priority),console.log(`Registered module: ${e.id} (${e.category})`)}async unregisterModule(e){const t=this.modules.get(e);if(!t)return!1;this.modules.delete(e);const r=this.categories.get(t.category);if(r){const t=r.findIndex(t=>t.id===e);t>=0&&r.splice(t,1)}return console.log(`Unregistered module: ${e}`),!0}getModule(e){return this.modules.get(e)}getAllModules(){return Array.from(this.modules.values())}getModulesByCategory(e){return this.categories.get(e)||[]}getCategories(){return Array.from(this.categories.entries()).map(([e,t])=>({category:e,count:t.length}))}validateModuleParameters(e,t){const r=this.modules.get(e);if(!r)return{valid:!1,errors:[{parameter:"_module",message:`Module ${e} not found`}]};const s=[];for(const e of r.parameters){const r=t[e.name];if(e.required&&null==r){s.push({parameter:e.name,message:`Parameter '${e.name}' is required`});continue}if(null==r)continue;const o=Array.isArray(r)?"array":typeof r;if(e.type===o||"object"===e.type){if(e.validation){const{validation:t}=e;"number"===e.type&&(void 0!==t.min&&r<t.min&&s.push({parameter:e.name,message:`Parameter '${e.name}' must be >= ${t.min}`,value:r}),void 0!==t.max&&r>t.max&&s.push({parameter:e.name,message:`Parameter '${e.name}' must be <= ${t.max}`,value:r})),"string"===e.type&&(void 0!==t.minLength&&r.length<t.minLength&&s.push({parameter:e.name,message:`Parameter '${e.name}' must have at least ${t.minLength} characters`,value:r}),void 0!==t.maxLength&&r.length>t.maxLength&&s.push({parameter:e.name,message:`Parameter '${e.name}' must have at most ${t.maxLength} characters`,value:r}),t.pattern&&!new RegExp(t.pattern).test(r)&&s.push({parameter:e.name,message:`Parameter '${e.name}' does not match required pattern`,value:r})),"array"===e.type&&(void 0!==t.minLength&&r.length<t.minLength&&s.push({parameter:e.name,message:`Parameter '${e.name}' must have at least ${t.minLength} items`,value:r}),void 0!==t.maxLength&&r.length>t.maxLength&&s.push({parameter:e.name,message:`Parameter '${e.name}' must have at most ${t.maxLength} items`,value:r})),t.enum&&!t.enum.includes(r)&&s.push({parameter:e.name,message:`Parameter '${e.name}' must be one of: ${t.enum.join(", ")}`,value:r})}}else s.push({parameter:e.name,message:`Parameter '${e.name}' must be of type ${e.type}, got ${o}`,value:r})}return{valid:0===s.length,errors:s}}applyDefaults(e,t){const r={...t};for(const t of e.parameters)void 0===r[t.name]&&void 0!==t.default&&(r[t.name]=t.default);return r}async executeModule(e,t={},r){const s=this.modules.get(e);if(!s)return{success:!1,error:`Module ${e} not found in registry`,duration:0,warnings:[]};if(!s.enabled)return{success:!1,error:`Module ${e} is disabled`,duration:0,warnings:[]};const o=this.applyDefaults(s,t),n=this.validateModuleParameters(e,o);if(!n.valid){return{success:!1,error:`Parameter validation failed:\n${n.errors.map(e=>`  - ${e.parameter}: ${e.message}`).join("\n")}`,duration:0,warnings:[]}}const i={timeout:s.timeout,...r},a=[];for(const[e,t]of Object.entries(o))a.push(`-${e}`),"object"==typeof t?a.push(JSON.stringify(t)):a.push(String(t));return console.log(`Executing module ${e} with args:`,a),this.psService.executeScript(s.scriptPath,a,i)}searchModules(e){const t=e.toLowerCase(),r=[];for(const e of this.modules.values())(e.id.toLowerCase().includes(t)||e.displayName.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.tags&&e.tags.some(e=>e.toLowerCase().includes(t)))&&r.push(e);return r.sort((e,t)=>t.priority-e.priority),r}getModulesByTags(e){const t=[],r=e.map(e=>e.toLowerCase());for(const e of this.modules.values())e.tags&&e.tags.some(e=>r.includes(e.toLowerCase()))&&t.push(e);return t.sort((e,t)=>t.priority-e.priority),t}getStatistics(){const e=this.modules.size,t=Array.from(this.modules.values()).filter(e=>e.enabled).length;return{totalModules:e,enabledModules:t,disabledModules:e-t,categories:this.getCategories(),loaded:this.loaded}}}},"./src/main/services/powerShellService.ts":(e,t,r)=>{"use strict";r.d(t,{PowerShellExecutionService:()=>h});var s=r("child_process"),o=r("events"),n=r("path"),i=r("crypto"),a=r("fs/promises"),c=r("./src/main/services/credentialService.ts");class l extends Error{constructor(e){super(e),this.name="PowerShellError"}}class u extends l{script;constructor(e,t){super(e),this.script=t,this.name="PowerShellSyntaxError"}}class d extends l{exitCode;stderr;constructor(e,t,r){super(e),this.exitCode=t,this.stderr=r,this.name="PowerShellRuntimeError"}}class p extends l{scriptPath;constructor(e,t){super(`Script execution timed out after ${e}ms: ${t}`),this.scriptPath=t,this.name="PowerShellTimeoutError"}}class h extends o.EventEmitter{config;sessionPool;requestQueue;activeExecutions;moduleCache;scriptLibrary;cleanupInterval;initialized;queuePaused;credentialService;constructor(e={},t){super(),this.config={maxPoolSize:e.maxPoolSize||10,minPoolSize:e.minPoolSize||2,sessionTimeout:e.sessionTimeout||3e5,queueSize:e.queueSize||100,enableModuleCaching:!1!==e.enableModuleCaching,defaultTimeout:e.defaultTimeout||6e4,scriptsBaseDir:e.scriptsBaseDir||n.join(process.cwd(),"..")},this.sessionPool=new Map,this.requestQueue=[],this.activeExecutions=new Map,this.moduleCache=new Map,this.scriptLibrary=new Map,this.cleanupInterval=null,this.initialized=!1,this.queuePaused=!1,this.credentialService=t||new c.CredentialService,this.processQueue=this.processQueue.bind(this),this.cleanupIdleSessions=this.cleanupIdleSessions.bind(this)}async initialize(){if(this.initialized)return void console.warn("PowerShellExecutionService already initialized");console.log(`Initializing PowerShell Execution Service (min: ${this.config.minPoolSize}, max: ${this.config.maxPoolSize})`);const e=[];for(let t=0;t<this.config.minPoolSize;t++)e.push(this.createSession());await Promise.all(e),this.cleanupInterval=setInterval(this.cleanupIdleSessions,6e4),this.initialized=!0,console.log(`PowerShell Execution Service initialized with ${this.sessionPool.size} sessions`)}async createSession(){const e=i.randomUUID(),t=`runspace_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,r="win32"===process.platform?"powershell.exe":"pwsh",o=(0,s.spawn)(r,["-NoExit","-Command","-"],{cwd:this.config.scriptsBaseDir,env:{...process.env,PSModulePath:process.env.PSModulePath||""},stdio:["pipe","pipe","pipe"]}),n={id:e,process:o,status:"idle",lastUsed:Date.now(),runspaceId:t,executionCount:0};o.on("exit",t=>{console.log(`PowerShell session ${e} exited with code ${t}`),this.sessionPool.delete(e)}),o.on("error",t=>{console.error(`PowerShell session ${e} error:`,t),this.sessionPool.delete(e)}),this.sessionPool.set(e,n),console.log(`Created PowerShell session: ${e}`)}async getAvailableSession(){for(const e of this.sessionPool.values())if("idle"===e.status)return e.status="busy",e.lastUsed=Date.now(),e;if(this.sessionPool.size<this.config.maxPoolSize){await this.createSession();for(const e of this.sessionPool.values())if("idle"===e.status)return e.status="busy",e.lastUsed=Date.now(),e}return null}releaseSession(e){const t=this.sessionPool.get(e);t&&(t.status="idle",t.lastUsed=Date.now(),t.executionCount++,this.processQueue())}cleanupIdleSessions(){const e=Date.now(),t=[];for(const[r,s]of this.sessionPool.entries())"idle"===s.status&&this.sessionPool.size>this.config.minPoolSize&&e-s.lastUsed>this.config.sessionTimeout&&t.push(r);for(const e of t){const t=this.sessionPool.get(e);t?.process&&t.process.kill(),this.sessionPool.delete(e),console.log(`Terminated idle session: ${e}`)}}async processQueue(){if(!this.queuePaused)for(;this.requestQueue.length>0;){const e=await this.getAvailableSession();if(!e)break;const t=this.requestQueue.shift();t?this.executeScriptWithSession(e,t.scriptPath,t.args,t.options).then(t.resolve).catch(t.reject):this.releaseSession(e.id)}}resolveScriptPath(e){if(n.isAbsolute(e))return e;const t=[n.join(this.config.scriptsBaseDir,"Scripts"),n.join(this.config.scriptsBaseDir,"Modules"),n.join(this.config.scriptsBaseDir,"Core")];for(const r of t){return n.join(r,e)}return n.join(this.config.scriptsBaseDir,e)}async executeScriptWithSession(e,t,o,n={}){const a=n.cancellationToken||i.randomUUID(),c=this.resolveScriptPath(t),l=n.timeout||this.config.defaultTimeout,h=Date.now();return new Promise((t,i)=>{try{const m=["-NoProfile","-ExecutionPolicy","Bypass","-File",c,...o],g="win32"===process.platform?"powershell.exe":"pwsh";let f;if(n.showWindow&&"win32"===process.platform){console.log(`[PowerShellService.executeScriptWithSession] Spawning VISIBLE PowerShell window for: ${c}`);const e=["/c","start",'""',g,"-NoProfile","-ExecutionPolicy","Bypass","-NoExit","-File",`"${c}"`,...o.map(e=>`"${e}"`)];f=(0,s.spawn)("cmd.exe",e,{cwd:n.workingDirectory||this.config.scriptsBaseDir,env:{...process.env,...n.environmentVariables,PSModulePath:process.env.PSModulePath||""},shell:!0,windowsHide:!1})}else f=(0,s.spawn)(g,m,{cwd:n.workingDirectory||this.config.scriptsBaseDir,env:{...process.env,...n.environmentVariables,PSModulePath:process.env.PSModulePath||""}});this.activeExecutions.set(a,f);let y="",v="";const w=[],E=[],S=[],b=[];let _=setTimeout(()=>{f.kill("SIGTERM");const t=new p(l,c);this.activeExecutions.delete(a),this.releaseSession(e.id),i(t)},l);f.stdout?.on("data",e=>{const t=e.toString();y+=t,this.parseAndEmitStreams(t,a,n.streamOutput||!1)}),f.stderr?.on("data",e=>{const t=e.toString();v+=t,this.parseStderrStreams(t,a,n.streamOutput||!1,w,E,S,b)}),f.on("close",s=>{_&&(clearTimeout(_),_=null),this.activeExecutions.delete(a),this.releaseSession(e.id);const o=Date.now()-h;if(0!==s){if(v.includes("ParserError")||v.includes("Unexpected token")){const e={success:!1,error:new u(`Script contains syntax errors:\n${v}`,c).message,duration:o,warnings:w,stdout:y,stderr:v,exitCode:s||-1};return void t(e)}const e={success:!1,error:new d(`Script failed with exit code ${s}`,s||-1,v).message,duration:o,warnings:w,stdout:y,stderr:v,exitCode:s||-1};return void t(e)}try{const e="<<<JSON_RESULT_START>>>",n="<<<JSON_RESULT_END>>>";let i=y.trim();const a=y.indexOf(e),c=y.indexOf(n);-1!==a&&-1!==c&&(i=y.substring(a+e.length,c).trim());const l=r("fs"),u="C:\\discoverydata\\powershell_debug_output.txt";try{const e=["========== POWERSHELL DEBUG OUTPUT ==========",`Timestamp: ${(new Date).toISOString()}`,`stdout length: ${y.length}`,`stderr length: ${v.length}`,`jsonContent length: ${i.length}`,"","========== FULL STDOUT ==========",y,"","========== STDERR ==========",v,"","========== EXTRACTED JSON CONTENT ==========",i,"","=========================================="].join("\n");l.writeFileSync(u,e,"utf8"),console.log(`[PowerShellService] Full output written to: ${u}`)}catch(e){console.error("[PowerShellService] Failed to write debug log:",e)}console.log("[PowerShellService] ========== STDOUT DEBUG =========="),console.log("[PowerShellService] stdout length:",y.length),console.log("[PowerShellService] Last 2000 chars of stdout:\n",y.substring(Math.max(0,y.length-2e3))),console.log("[PowerShellService] stderr length:",v.length),v.length>0&&console.log("[PowerShellService] stderr:\n",v),console.log("[PowerShellService] jsonContent length:",i.length),console.log("[PowerShellService] jsonContent:",i),console.log("[PowerShellService] ====================================");const d=i?JSON.parse(i):{};t({success:!0,data:d,duration:o,warnings:w,stdout:y,stderr:v,exitCode:s||0})}catch(e){const r={success:!1,error:`Failed to parse JSON output: ${e.message}\n\nOutput:\n${y}`,duration:o,warnings:w,stdout:y,stderr:v,exitCode:s||0};t(r)}}),f.on("error",r=>{_&&clearTimeout(_),this.activeExecutions.delete(a),this.releaseSession(e.id);const s={success:!1,error:`Process error: ${r.message}`,duration:Date.now()-h,warnings:w,stderr:r.message};t(s)})}catch(r){this.releaseSession(e.id);const s={success:!1,error:`Execution error: ${r.message}`,duration:Date.now()-h,warnings:[]};t(s)}})}parseAndEmitStreams(e,t,r){if(!r)return;const s={executionId:t,data:e,type:"output",timestamp:new Date};this.emit("output",s),this.emit("stream:output",s)}parseStderrStreams(e,t,r,s,o,n,i){const a=e.split("\n");for(const e of a)if(e.trim())if(e.startsWith("WARNING: ")){const o=e.replace("WARNING: ","");if(s.push(o),r){const e={executionId:t,data:o,type:"warning",timestamp:new Date};this.emit("output",e),this.emit("stream:warning",e)}}else if(e.startsWith("VERBOSE: ")){const s=e.replace("VERBOSE: ","");if(o.push(s),r){const e={executionId:t,data:s,type:"verbose",timestamp:new Date};this.emit("output",e),this.emit("stream:verbose",e)}}else if(e.startsWith("DEBUG: ")){const s=e.replace("DEBUG: ","");if(n.push(s),r){const e={executionId:t,data:s,type:"debug",timestamp:new Date};this.emit("output",e),this.emit("stream:debug",e)}}else if(e.startsWith("INFORMATION: ")||e.startsWith("INFO: ")){const s=e.replace(/^(INFORMATION|INFO): /,"");if(i.push(s),r){console.log(`[PowerShellService]  Emitting INFORMATION stream event: ${s.substring(0,100)}...`);const e={executionId:t,data:s,type:"information",timestamp:new Date};this.emit("output",e),this.emit("stream:information",e)}else console.log(`[PowerShellService]  streamOutput is FALSE, not emitting: ${s.substring(0,100)}...`)}else if(e.includes("ERROR:")||e.includes("Exception")){if(r){const r={executionId:t,data:e,type:"error",timestamp:new Date};this.emit("output",r),this.emit("stream:error",r)}}else{const s=e;if(i.push(s),r){const e={executionId:t,data:s,type:"information",timestamp:new Date};this.emit("output",e),this.emit("stream:information",e)}}}async discoverModules(){try{const e=n.join(process.env.TEMP||"/tmp",`discover_modules_${i.randomUUID()}.ps1`);await a.writeFile(e,"\n      Get-Module -ListAvailable | Select-Object Name, Version, Path, Description, Author, CompanyName, Guid, @{\n        Name='ExportedCommands';\n        Expression={ ($_.ExportedCommands.Keys | Sort-Object) -join ',' }\n      } | ConvertTo-Json -Depth 3\n    ","utf-8");const t=await this.executeScript(e,[],{timeout:3e4});if(await a.unlink(e).catch(()=>{}),!t.success||!t.data)return console.warn("Module discovery failed:",t.error),[];return(Array.isArray(t.data)?t.data:[t.data]).map(e=>({name:e.Name,version:e.Version?.ToString()||e.Version||"Unknown",path:e.Path,description:e.Description,author:e.Author,companyName:e.CompanyName,guid:e.Guid,exportedCommands:e.ExportedCommands?e.ExportedCommands.split(",").filter(Boolean):[]}))}catch(e){return console.error("Error discovering modules:",e),[]}}async executeParallel(e){if(!this.initialized)throw new Error("PowerShellExecutionService not initialized. Call initialize() first.");const t=this.config.maxPoolSize,r=new Array(e.length);for(let s=0;s<e.length;s+=t){const o=e.slice(s,s+t).map(async(e,t)=>{const r=await this.executeScript(e.scriptPath,e.args,e.options);return{index:s+t,result:r}}),n=await Promise.all(o);for(const{index:e,result:t}of n)r[e]=t}return r}async executeWithRetry(e,t=[],r={},s=3,o=1e3){let n=null,i=0;for(;i<=s;){try{const o=await this.executeScript(e,t,r);if(o.success)return i>0&&console.log(`Script succeeded on attempt ${i+1}/${s+1}`),o;if(!this.isTransientError(o.error||"")||i===s)return o;n=new Error(o.error)}catch(e){if(n=e,!this.isTransientError(e.message)||i===s)throw e}const a=o*Math.pow(2,i);console.log(`Script failed, retrying in ${a}ms (attempt ${i+1}/${s+1})...`),await new Promise(e=>setTimeout(e,a)),i++}throw n||new Error("Script execution failed after retries")}isTransientError(e){return[/timeout/i,/connection/i,/network/i,/temporarily unavailable/i,/too many requests/i,/service unavailable/i,/ECONNRESET/i,/ETIMEDOUT/i,/throttl/i].some(t=>t.test(e))}async executeScript(e,t=[],r={}){if(!this.initialized)throw new Error("PowerShellExecutionService not initialized. Call initialize() first.");const s=await this.getAvailableSession();return s?this.executeScriptWithSession(s,e,t,r):this.requestQueue.length>=this.config.queueSize?{success:!1,error:"Request queue is full. Too many concurrent executions.",duration:0,warnings:[]}:new Promise((s,o)=>{const n={id:i.randomUUID(),scriptPath:e,args:t,options:r,resolve:s,reject:o,timestamp:Date.now()};this.requestQueue.push(n),console.log(`Queued request ${n.id}, queue size: ${this.requestQueue.length}`)})}async executeRawCommand(e,t=3e4){if(!this.initialized)throw new Error("PowerShellExecutionService not initialized. Call initialize() first.");const r=await this.getAvailableSession();if(!r)throw new Error("No PowerShell sessions available");try{r.lastUsed=Date.now();const s=`###COMMAND_COMPLETE_${Date.now()}_${Math.random().toString(36).substr(2,9)}###`;return new Promise((o,n)=>{if(!r.process)return void n(new Error("Session process is not available"));const i=setTimeout(()=>{r.process.stdout?.off("data",u),r.process.stderr?.off("data",d),r.status="idle",n(new Error("Command execution timed out"))},t);let a="",c="",l=!1;const u=e=>{const t=e.toString();if(a+=t,t.includes(s)){l=!0,clearTimeout(i),r.process.stdout?.off("data",u),r.process.stderr?.off("data",d),r.status="idle";const e=a.replace(s,"").trim();c?n(new Error(c)):o(e)}},d=e=>{c+=e.toString()};r.process.stdout?.on("data",u),r.process.stderr?.on("data",d),r.process.stdin?.write(e+"\n"),r.process.stdin?.write(`Write-Host "${s}"\n`)})}catch(e){throw r.status="idle",e}}async executeModule(e,t,r={},s={}){try{console.log(`[PowerShellService.executeModule] showWindow: ${s.showWindow}, function: ${t}`);const o=JSON.stringify(r),c=n.join(process.env.TEMP||"/tmp",`ps_result_${i.randomUUID()}.json`),l=s.showWindow?`\n        # Discovery Module Execution Window\n        $Host.UI.RawUI.WindowTitle = "Discovery Module: ${t}"\n\n        Write-Host '========================================' -ForegroundColor Cyan\n        Write-Host 'Discovery Module - PowerShell Execution' -ForegroundColor Cyan\n        Write-Host '========================================' -ForegroundColor Cyan\n        Write-Host ''\n        Write-Host "Module: ${e}" -ForegroundColor Yellow\n        Write-Host "Function: ${t}" -ForegroundColor Yellow\n        Write-Host ''\n        Write-Host '========================================' -ForegroundColor Cyan\n        Write-Host ''\n\n        # Enable ONLY Information stream for clean, summary-level output\n        # Suppress verbose/debug to avoid HTTP request spam from Graph SDK\n        $InformationPreference = 'Continue'\n        $VerbosePreference = 'SilentlyContinue'  # Suppress verbose HTTP logs\n        $DebugPreference = 'SilentlyContinue'    # Suppress debug HTTP logs\n        $WarningPreference = 'Continue'          # Keep warnings visible\n\n        Import-Module '${e}' -Force -ErrorAction Stop\n\n        # Convert JSON to hashtable recursively\n        function ConvertTo-HashtableRecursive {\n            param([Parameter(ValueFromPipeline)] $InputObject)\n\n            if ($null -eq $InputObject) {\n                return $null\n            }\n\n            if ($InputObject -is [System.Collections.IEnumerable] -and $InputObject -isnot [string]) {\n                $collection = @()\n                foreach ($item in $InputObject) {\n                    $collection += ConvertTo-HashtableRecursive $item\n                }\n                return $collection\n            }\n\n            if ($InputObject -is [PSCustomObject]) {\n                $hash = @{}\n                $InputObject.PSObject.Properties | ForEach-Object {\n                    $hash[$_.Name] = ConvertTo-HashtableRecursive $_.Value\n                }\n                return $hash\n            }\n\n            return $InputObject\n        }\n\n        $paramsObj = '${o.replace(/'/g,"''")}' | ConvertFrom-Json\n        $params = ConvertTo-HashtableRecursive $paramsObj\n\n        Write-Host 'Starting discovery execution...' -ForegroundColor Green\n        Write-Host ''\n\n        # Execute function - all Write-Information, Write-Verbose output will be visible\n        try {\n            $result = ${t} @params\n\n            Write-Host ''\n            Write-Host '========================================' -ForegroundColor Green\n            Write-Host 'Discovery Complete!' -ForegroundColor Green\n            Write-Host '========================================' -ForegroundColor Green\n\n            # Write result to temp file for Node.js to read\n            $resultFile = '${c.replace(/\\/g,"\\\\")}'\n            Write-Host "Writing result to: $resultFile" -ForegroundColor Cyan\n\n            if ($null -eq $result) {\n              @{Success=$true} | ConvertTo-Json -Depth 20 | Out-File -FilePath $resultFile -Encoding UTF8\n            } else {\n              $result | ConvertTo-Json -Depth 20 | Out-File -FilePath $resultFile -Encoding UTF8\n            }\n\n            Write-Host 'Result written successfully!' -ForegroundColor Green\n\n            # Also output to stdout for compatibility (though it won't be captured)\n            Write-Output "<<<JSON_RESULT_START>>>"\n            if ($null -eq $result) {\n              @{Success=$true} | ConvertTo-Json -Compress\n            } else {\n              $result | ConvertTo-Json -Depth 20 -Compress\n            }\n            Write-Output "<<<JSON_RESULT_END>>>"\n\n            Write-Host ''\n            Write-Host 'Press any key to close this window...' -ForegroundColor Yellow\n            $null = $Host.UI.RawUI.ReadKey('NoEcho,IncludeKeyDown')\n        } catch {\n            Write-Host ''\n            Write-Host '========================================' -ForegroundColor Red\n            Write-Host 'Discovery Failed!' -ForegroundColor Red\n            Write-Host "Error: $_" -ForegroundColor Red\n            Write-Host '========================================' -ForegroundColor Red\n\n            # Write error to result file\n            $resultFile = '${c.replace(/\\/g,"\\\\")}'\n            @{\n              Success = $false\n              Error = $_.Exception.Message\n              StackTrace = $_.ScriptStackTrace\n            } | ConvertTo-Json -Depth 5 | Out-File -FilePath $resultFile -Encoding UTF8\n\n            Write-Host ''\n            Write-Host 'Press any key to close this window...' -ForegroundColor Yellow\n            $null = $Host.UI.RawUI.ReadKey('NoEcho,IncludeKeyDown')\n            throw\n        }\n      `:`\n        # Hidden execution mode with clean summary output\n        $InformationPreference = 'Continue'\n        $VerbosePreference = 'SilentlyContinue'  # Suppress verbose HTTP logs\n        $DebugPreference = 'SilentlyContinue'    # Suppress debug HTTP logs\n        $WarningPreference = 'Continue'          # Keep warnings visible\n\n        Import-Module '${e}' -Force -ErrorAction Stop\n\n        # Convert JSON to hashtable recursively (PowerShell 5.1 compatible)\n        function ConvertTo-HashtableRecursive {\n            param([Parameter(ValueFromPipeline)] $InputObject)\n\n            if ($null -eq $InputObject) {\n                return $null\n            }\n\n            if ($InputObject -is [System.Collections.IEnumerable] -and $InputObject -isnot [string]) {\n                $collection = @()\n                foreach ($item in $InputObject) {\n                    $collection += ConvertTo-HashtableRecursive $item\n                }\n                return $collection\n            }\n\n            if ($InputObject -is [PSCustomObject]) {\n                $hash = @{}\n                $InputObject.PSObject.Properties | ForEach-Object {\n                    $hash[$_.Name] = ConvertTo-HashtableRecursive $_.Value\n                }\n                return $hash\n            }\n\n            return $InputObject\n        }\n\n        $paramsObj = '${o.replace(/'/g,"''")}' | ConvertFrom-Json\n        $params = ConvertTo-HashtableRecursive $paramsObj\n\n        # Execute function and capture result\n        # Note: All output streams (including Information) are already configured above\n        $result = & { ${t} @params }\n\n        # Output JSON result marker and data\n        Write-Output "<<<JSON_RESULT_START>>>"\n        if ($null -eq $result) {\n          @{} | ConvertTo-Json -Compress\n        } else {\n          $result | ConvertTo-Json -Depth 20 -Compress\n        }\n        Write-Output "<<<JSON_RESULT_END>>>"\n      `,u=n.join(process.env.TEMP||"/tmp",`ps_module_${i.randomUUID()}.ps1`);await a.writeFile(u,l,"utf-8");const d=await this.executeScript(u,[],s);if(!s.showWindow)return await a.unlink(u).catch(()=>{}),d;console.log(`[PowerShellService.executeModule] Reading result from file: ${c}`);try{await new Promise(e=>setTimeout(e,500));if(await a.access(c).then(()=>!0).catch(()=>!1)){let e=await a.readFile(c,"utf-8");console.log(`[PowerShellService.executeModule] Read ${e.length} bytes from result file`),65279===e.charCodeAt(0)&&(e=e.substring(1),console.log("[PowerShellService.executeModule] Stripped BOM from file content"));const t=JSON.parse(e);return await a.unlink(u).catch(()=>{}),await a.unlink(c).catch(()=>{}),{success:!1!==t.Success,data:t,duration:d.duration,warnings:d.warnings||[],stdout:d.stdout,stderr:d.stderr,exitCode:d.exitCode}}return console.warn(`[PowerShellService.executeModule] Result file not found: ${c}`),await a.unlink(u).catch(()=>{}),d}catch(e){return console.error(`[PowerShellService.executeModule] Error reading result file: ${e.message}`),await a.unlink(u).catch(()=>{}),await a.unlink(c).catch(()=>{}),d}}catch(e){return{success:!1,error:`Module execution error: ${e.message}`,duration:0,warnings:[]}}}async executeDiscoveryModule(e,t,r={},s={}){try{console.log(`[PowerShellService] Loading credentials for company: ${t}`);const o=await this.credentialService.getCredential(t);if(!o)return{success:!1,error:`No credentials found for company "${t}". Please configure credentials first.`,duration:0,warnings:[]};console.log("[PowerShellService] Credentials loaded:",{tenantId:o.tenantId||"MISSING",clientId:o.clientId||"MISSING",hasClientSecret:!!o.clientSecret,connectionType:o.connectionType});const a=["Azure","AzureResource","Exchange","SharePoint","OneDrive","Teams","Application","Graph","Licensing","ConditionalAccess","ActiveDirectory","DLP","EntraIDApp","ExternalIdentity","Intune","Office365","PowerPlatform","SecurityInfrastructure","SQL"].includes(e),c={...r};if(c.CompanyName=t,"companyName"in c&&void 0!==c.companyName&&delete c.companyName,"profileId"in c&&delete c.profileId,"config"in c&&"object"==typeof c.config){const e=c.config;delete c.config,Object.assign(c,e)}a?(c.TenantId=o.tenantId,c.ClientId=o.clientId,c.ClientSecret=o.clientSecret,console.log(`[PowerShellService] Azure credentials added to Configuration for ${e} module`)):console.log(`[PowerShellService] Local module ${e} - skipping Azure credentials`);const l=s.outputPath?n.resolve(s.outputPath):n.join("C:\\DiscoveryData",t),u=n.join(l,"Raw"),d=n.join(l,"Logs");console.log("[PowerShellService] Output configuration:"),console.log(`[PowerShellService]   Base: ${l}`),console.log(`[PowerShellService]   Raw:  ${u}`),console.log(`[PowerShellService]   Logs: ${d}`);const p={Paths:{RawDataOutput:u,Logs:d},CompanyName:t},h=i.randomUUID(),m={Configuration:c,Context:p,SessionId:h};console.log(`[PowerShellService] Executing ${e} discovery for ${t}`),console.log(`[PowerShellService] SessionId: ${h}`),console.log(`[PowerShellService] Output path: ${p.Paths.RawDataOutput}`),console.log("[PowerShellService] Configuration keys:",Object.keys(c));const g=n.join(this.config.scriptsBaseDir,"Modules","Discovery",`${e}Discovery.psm1`),f=`Invoke-${e}Discovery`,y=await this.executeModule(g,f,m,{...s,timeout:s.timeout||18e5});return y.success?console.log(`[PowerShellService]  ${e} discovery completed successfully`):(console.error(`[PowerShellService]  ${e} discovery failed:`,y.error),y.stderr&&console.error(`[PowerShellService] PowerShell Error Output:\n${y.stderr}`),y.stdout&&console.log(`[PowerShellService] PowerShell Standard Output:\n${y.stdout}`)),y}catch(e){return console.error("[PowerShellService] Discovery module execution error:",e),{success:!1,error:`Discovery module execution error: ${e.message}`,duration:0,warnings:[]}}}cancelExecution(e){const t=this.activeExecutions.get(e);return!!t&&(console.log(`Cancelling execution: ${e}`),t.kill("SIGTERM"),this.activeExecutions.delete(e),this.emit("execution:cancelled",{executionId:e}),!0)}getStatistics(){const e=Array.from(this.sessionPool.values()).filter(e=>"idle"===e.status).length,t=Array.from(this.sessionPool.values()).filter(e=>"busy"===e.status).length;return{poolSize:this.sessionPool.size,idleSessions:e,busySessions:t,activeExecutions:this.activeExecutions.size,queuedRequests:this.requestQueue.length,queuePaused:this.queuePaused,cacheSize:this.moduleCache.size,scriptLibrarySize:this.scriptLibrary.size,totalExecutions:Array.from(this.sessionPool.values()).reduce((e,t)=>e+t.executionCount,0)}}async pauseQueue(){this.queuePaused=!0,console.log("PowerShell execution queue paused"),this.emit("queue:paused")}async resumeQueue(){this.queuePaused=!1,console.log("PowerShell execution queue resumed"),this.emit("queue:resumed"),await this.processQueue()}async clearQueue(){const e=this.requestQueue.length;for(const e of this.requestQueue)e.reject(new Error("Request cancelled - queue cleared"));return this.requestQueue=[],console.log(`Cleared ${e} requests from queue`),this.emit("queue:cleared",{count:e}),e}getQueueStatus(){return{paused:this.queuePaused,length:this.requestQueue.length,oldestRequest:this.requestQueue[0]?.timestamp||null,requests:this.requestQueue.map(e=>({id:e.id,scriptPath:e.scriptPath,timestamp:e.timestamp,waitTime:Date.now()-e.timestamp}))}}async queueScript(e){return this.executeScript(e.scriptPath,e.args,e.options)}async getScriptLibrary(e){const t=Array.from(this.scriptLibrary.values());return e?t.filter(t=>t.category===e):t}async saveScript(e){const t=new Date,r={...e,id:i.randomUUID(),createdAt:t,updatedAt:t,executionCount:0};return this.scriptLibrary.set(r.id,r),console.log(`Saved script to library: ${r.name} (${r.id})`),this.emit("script:saved",r),r}async updateScript(e,t){const r=this.scriptLibrary.get(e);if(!r)return console.warn(`Script not found in library: ${e}`),null;const s={...r,...t,updatedAt:new Date};return this.scriptLibrary.set(e,s),console.log(`Updated script in library: ${s.name} (${e})`),this.emit("script:updated",s),s}async deleteScript(e){const t=this.scriptLibrary.get(e);return t?(this.scriptLibrary.delete(e),console.log(`Deleted script from library: ${t.name} (${e})`),this.emit("script:deleted",{id:e,name:t.name}),!0):(console.warn(`Script not found in library: ${e}`),!1)}async getScript(e){return this.scriptLibrary.get(e)||null}async searchScripts(e){const t=e.toLowerCase();return Array.from(this.scriptLibrary.values()).filter(e=>e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t)))}async executeFromLibrary(e,t={},r={}){const s=this.scriptLibrary.get(e);if(!s)return{success:!1,error:`Script not found in library: ${e}`,duration:0,warnings:[]};try{const o=n.join(process.env.TEMP||"/tmp",`library_${e}_${Date.now()}.ps1`);await a.writeFile(o,s.content,"utf-8");const i=Object.entries(t).flatMap(([e,t])=>[`-${e}`,"string"==typeof t?t:JSON.stringify(t)]),c=await this.executeScript(o,i,r);return await a.unlink(o).catch(()=>{}),c.success&&(s.executionCount++,this.scriptLibrary.set(e,s)),c}catch(e){return{success:!1,error:`Library script execution error: ${e.message}`,duration:0,warnings:[]}}}async getInstalledModules(){return this.discoverModules()}async importModule(e){const t=`Import-Module '${e}' -Force -PassThru | ConvertTo-Json`,r=n.join(process.env.TEMP||"/tmp",`import_${i.randomUUID()}.ps1`);try{await a.writeFile(r,t,"utf-8");const e=await this.executeScript(r,[],{timeout:1e4});return await a.unlink(r).catch(()=>{}),e}catch(e){return{success:!1,error:`Module import error: ${e.message}`,duration:0,warnings:[]}}}async removeModule(e){const t=`Remove-Module '${e}' -Force -ErrorAction SilentlyContinue`,r=n.join(process.env.TEMP||"/tmp",`remove_${i.randomUUID()}.ps1`);try{await a.writeFile(r,t,"utf-8");const e=await this.executeScript(r,[],{timeout:5e3});return await a.unlink(r).catch(()=>{}),e}catch(e){return{success:!1,error:`Module removal error: ${e.message}`,duration:0,warnings:[]}}}async shutdown(){console.log("Shutting down PowerShell Execution Service..."),this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null);for(const[e,t]of this.activeExecutions.entries())console.log(`Killing active execution: ${e}`),t.kill("SIGTERM");this.activeExecutions.clear();for(const[e,t]of this.sessionPool.entries())t.process&&(console.log(`Terminating session: ${e}`),t.process.kill("SIGTERM"));this.sessionPool.clear(),this.moduleCache.clear(),this.requestQueue=[],this.initialized=!1,console.log("PowerShell Execution Service shutdown complete")}}},"./src/main/services/profileService.ts":(e,t,r)=>{"use strict";r.d(t,{ProfileService:()=>l,getProfileById:()=>d});var s=r("path"),o=r("fs/promises"),n=r("electron"),i=r("./node_modules/lowdb/lib/index.js"),a=r("./node_modules/lowdb/lib/node.js"),c=r("glob");class l{db;isInitialized=!1;profilesPath;dataRootPath;constructor(){this.profilesPath=s.join(n.app.getPath("appData"),"MandADiscoverySuite","profiles.json"),this.dataRootPath=process.env.MANDA_DISCOVERY_PATH||("win32"===process.platform?s.join("C:","DiscoveryData"):s.join(n.app.getPath("userData"),"DiscoveryData"))}async initialize(){if(this.isInitialized)return;await o.mkdir(s.dirname(this.profilesPath),{recursive:!0});const e=new a.JSONFile(this.profilesPath);this.db=new i.Low(e,{profiles:[],version:1}),await this.db.read(),this.ensureData(),this.db.data=this.db.data||{profiles:[],version:1},this.db.data?.profiles?.length||await this.autoDiscoverProfiles(),this.isInitialized=!0,this.registerIPCHandlers()}registerIPCHandlers(){n.ipcMain.handle("profile:getAll",()=>this.getProfiles()),n.ipcMain.handle("profile:getCurrent",()=>this.getCurrentProfile()),n.ipcMain.handle("profile:setCurrent",(e,t)=>this.setCurrentProfile(t)),n.ipcMain.handle("profile:create",(e,t)=>this.createProfile(t)),n.ipcMain.handle("profile:update",(e,t)=>this.updateProfile(t)),n.ipcMain.handle("profile:delete",(e,t)=>this.deleteProfile(t)),n.ipcMain.handle("profile:import",(e,t)=>this.importProfile(t)),n.ipcMain.handle("profile:export",(e,t,r)=>this.exportProfile(t,r)),n.ipcMain.handle("profile:getStats",(e,t)=>this.getProfileStatistics(t)),n.ipcMain.handle("profile:validate",(e,t)=>this.validateProfile(t)),n.ipcMain.handle("profile:getConnectionConfig",(e,t)=>this.getConnectionConfig(t)),n.ipcMain.handle("profile:setConnectionConfig",(e,t,r)=>this.setConnectionConfig(t,r)),n.ipcMain.handle("profile:saveDomainCredentials",(e,t,r,s)=>this.saveDomainCredentials(t,r,s)),n.ipcMain.handle("profile:clearDomainCredentials",(e,t)=>this.clearDomainCredentials(t)),n.ipcMain.handle("profile:testDomainCredentials",(e,t)=>this.testDomainCredentials(t)),n.ipcMain.handle("profile:testDomainCredentialsWithValues",(e,t,r)=>this.testDomainCredentialsWithValues(t,r)),n.ipcMain.handle("profile:getDomainCredentialStatus",(e,t)=>this.getDomainCredentialStatus(t)),n.ipcMain.handle("profile:getADDomainFromDiscovery",(e,t)=>this.getADDomainFromDiscovery(t)),n.ipcMain.handle("profile:getAzureTenantDomain",(e,t)=>this.getAzureTenantDomain(t)),n.ipcMain.handle("profile:getAzureDataFromDiscovery",(e,t)=>this.getAzureDataFromDiscovery(t))}ensureData(){this.db.data||(this.db.data={profiles:[],version:1}),this.db.data.profiles||(this.db.data.profiles=[]),this.db.data.version||(this.db.data.version=1)}async getProfiles(){return await this.db.read(),this.ensureData(),[...this.db.data?.profiles??[]].sort((e,t)=>e.companyName.localeCompare(t.companyName))}async getCurrentProfile(){return(await this.getProfiles()).find(e=>e.isActive)||null}async getProfileById(e){return(await this.getProfiles()).find(t=>t.id===e||t.companyName===e)||null}async setCurrentProfile(e){await this.db.read(),this.ensureData();const t=this.db.data.profiles,r=t.find(t=>t.id===e||t.companyName===e);return!!r&&(t.forEach(e=>e.isActive=!1),r.isActive=!0,r.lastModified=(new Date).toISOString(),await this.db.write(),this.broadcastProfileChange(),!0)}async createProfile(e){await this.db.read(),this.ensureData();if(this.db.data.profiles.find(t=>t.companyName.toLowerCase()===e.companyName.toLowerCase()))throw new Error(`Profile with company name "${e.companyName}" already exists`);const t={...e,id:this.generateId(),created:(new Date).toISOString(),lastModified:(new Date).toISOString(),isActive:0===this.db.data.profiles.length};return await this.createProfileDirectories(t.companyName),this.db.data.profiles.push(t),await this.db.write(),t.isActive&&this.broadcastProfileChange(),t}async updateProfile(e){await this.db.read(),this.ensureData();const t=this.db.data.profiles.findIndex(t=>t.id===e.id);if(-1===t)throw new Error(`Profile with ID "${e.id}" not found`);const r=this.db.data.profiles[t],s=r.companyName;if(this.db.data.profiles.find(t=>t.id!==e.id&&t.companyName.toLowerCase()===e.companyName.toLowerCase()))throw new Error(`Profile with company name "${e.companyName}" already exists`);return this.db.data.profiles[t]={...e,created:r.created,lastModified:(new Date).toISOString()},s!==e.companyName&&await this.renameProfileDirectory(s,e.companyName),await this.db.write(),e.isActive&&this.broadcastProfileChange(),this.db.data.profiles[t]}async deleteProfile(e){await this.db.read(),this.ensureData();const t=this.db.data.profiles.findIndex(t=>t.id===e);if(-1===t)return!1;const r=this.db.data.profiles[t],s=r.isActive;return this.db.data.profiles.splice(t,1),await this.deleteProfileDirectory(r.companyName),s&&this.db.data.profiles.length>0&&(this.db.data.profiles[0].isActive=!0),await this.db.write(),s&&this.broadcastProfileChange(),!0}async importProfile(e){const t=await o.readFile(e,"utf-8"),r=JSON.parse(t);if(!r.companyName)throw new Error("Invalid profile file: missing company name");let s=r.companyName,n=1;for(await this.db.read(),this.ensureData();this.db.data.profiles.some(e=>e.companyName.toLowerCase()===s.toLowerCase());)s=`${r.companyName} (${n})`,n++;const i={companyName:s,description:r.description||"",domainController:r.domainController||"",tenantId:r.tenantId||"",isActive:!1,configuration:r.configuration||{}};return this.createProfile(i)}async exportProfile(e,t){const r=(await this.getProfiles()).find(t=>t.id===e);if(!r)throw new Error(`Profile with ID "${e}" not found`);const s=JSON.stringify(r,null,2);await o.writeFile(t,s,"utf-8")}async getProfileStatistics(e){const t=(await this.getProfiles()).find(t=>t.id===e);if(!t)return null;const r=this.getCompanyDataPath(t.companyName);return{profileId:t.id,companyName:t.companyName,created:t.created,lastModified:t.lastModified,lastDiscoveryRun:await this.getLastDiscoveryRun(r),totalDiscoveryRuns:await this.getTotalDiscoveryRuns(r),dataSizeBytes:await this.getDirectorySize(r)}}validateProfile(e){const t={isValid:!0,errors:[],warnings:[],recommendations:[]};return e.companyName?.trim()||(t.errors.push("Company name is required"),t.isValid=!1),e.companyName&&e.companyName.length>100&&(t.errors.push("Company name cannot exceed 100 characters"),t.isValid=!1),e.domainController?.trim()||t.warnings.push("Domain controller is not specified"),e.tenantId?.trim()||t.warnings.push("Tenant ID is not specified"),e.tenantId&&!this.isValidGuid(e.tenantId)&&t.warnings.push("Tenant ID should be a valid GUID"),t.recommendations.push("Consider adding a detailed description for better identification"),t}getCompanyDataPath(e){return s.join(this.dataRootPath,e)}async getConnectionConfig(e){const t=(await this.getProfiles()).find(t=>t.id===e);if(!t)return null;const r=s.join(this.getCompanyDataPath(t.companyName),"connection.json");try{const e=await o.readFile(r,"utf-8");return JSON.parse(e)}catch{return null}}async setConnectionConfig(e,t){const r=(await this.getProfiles()).find(t=>t.id===e);if(!r)throw new Error(`Profile with ID "${e}" not found`);const n=s.join(this.getCompanyDataPath(r.companyName),"connection.json"),i=JSON.stringify(t,null,2);await o.writeFile(n,i,"utf-8")}async refreshProfiles(){await this.autoDiscoverProfiles()}async getSourceProfiles(){return this.getProfiles()}async saveDomainCredentials(e,t,r){if(!n.safeStorage.isEncryptionAvailable())throw new Error("Secure credential encryption is not available on this system. Please ensure your system keystore is properly configured.");if(!/^([^\\]+)\\([^\\]+)$/.test(t))throw new Error("Username must be in DOMAIN\\username format (e.g., CONTOSO\\jdoe)");if(!r||r.length<8)throw new Error("Password must be at least 8 characters");await this.db.read(),this.ensureData();const s=this.db.data.profiles.find(t=>t.id===e);if(!s)throw new Error(`Profile with ID "${e}" not found`);const o=n.safeStorage.encryptString(r).toString("base64");s.configuration||(s.configuration={}),s.configuration.domainCredentials={username:t,password:o,encrypted:!0,validationStatus:"unknown",lastValidated:(new Date).toISOString()},s.lastModified=(new Date).toISOString(),await this.db.write(),console.log(`[ProfileService] Domain credentials saved for profile: ${e}, user: ${this.maskUsername(t)}`)}async clearDomainCredentials(e){await this.db.read(),this.ensureData();const t=this.db.data.profiles.find(t=>t.id===e);if(!t)throw new Error(`Profile with ID "${e}" not found`);t.configuration?.domainCredentials&&(delete t.configuration.domainCredentials,t.lastModified=(new Date).toISOString(),await this.db.write(),console.log(`[ProfileService] Domain credentials cleared for profile: ${e}`))}async getDomainCredentialsDecrypted(e){await this.db.read(),this.ensureData();const t=this.db.data.profiles.find(t=>t.id===e);if(!t)return null;const r=t.configuration?.domainCredentials;if(!r?.password||!r?.username)return null;if(!n.safeStorage.isEncryptionAvailable())throw new Error("Encryption not available - cannot decrypt credentials");try{const e=Buffer.from(r.password,"base64"),t=n.safeStorage.decryptString(e);return{username:r.username,password:t}}catch(e){throw console.error("[ProfileService] Failed to decrypt domain credentials:",e),new Error("Failed to decrypt credentials - they may be corrupted")}}async setDomainCredentialValidation(e,t,r){await this.db.read(),this.ensureData();const s=this.db.data.profiles.find(t=>t.id===e);if(!s)throw new Error(`Profile with ID "${e}" not found`);const o=s.configuration?.domainCredentials;if(!o)throw new Error("No domain credentials found for this profile");o.validationStatus=t,o.validationError=r?.slice(0,500),o.lastValidated=(new Date).toISOString(),s.lastModified=(new Date).toISOString(),await this.db.write(),console.log(`[ProfileService] Domain credential validation updated: ${e} -> ${t}`)}async getDomainCredentialStatus(e){await this.db.read(),this.ensureData();const t=this.db.data.profiles.find(t=>t.id===e);if(!t)return{hasCredentials:!1};const r=t.configuration?.domainCredentials;return r?{hasCredentials:!0,username:r.username,validationStatus:r.validationStatus||"unknown",lastValidated:r.lastValidated,validationError:r.validationError}:{hasCredentials:!1}}async testDomainCredentials(e){const t=await this.getDomainCredentialsDecrypted(e);if(!t)return{valid:!1,error:"No credentials found"};try{const r=await this.executePowerShellCredentialTest(t.username,t.password);return r.valid?await this.setDomainCredentialValidation(e,"valid"):await this.setDomainCredentialValidation(e,"invalid",r.error),r}catch(t){const r=t instanceof Error?t.message:String(t);return await this.setDomainCredentialValidation(e,"invalid",r),{valid:!1,error:r}}}async testDomainCredentialsWithValues(e,t){if(console.log("=".repeat(80)),console.log("[ProfileService]  testDomainCredentialsWithValues CALLED"),console.log(`[ProfileService] Testing domain credentials for ${this.maskUsername(e)}`),console.log(`[ProfileService] Username length: ${e.length}, Password length: ${t.length}`),console.log("=".repeat(80)),!e||!t)return console.error("[ProfileService]  Username or password missing"),{valid:!1,error:"Username and password are required"};if(!/^([^\\]+)\\([^\\]+)$/.test(e))return{valid:!1,error:"Username must be in DOMAIN\\username format"};try{const r=await this.executePowerShellCredentialTest(e,t);return console.log("[ProfileService] Credential test result: "+(r.valid?"valid":"invalid")),r}catch(e){const t=e instanceof Error?e.message:String(e);return console.error("[ProfileService] Credential test failed:",t),{valid:!1,error:t}}}async executePowerShellCredentialTest(e,t,s){const{spawn:o}=await Promise.resolve().then(r.t.bind(r,"child_process",23)),n=e.replace(/'/g,"''"),i=t.replace(/'/g,"''"),a=(s?.replace(/'/g,"''"),`\n$ErrorActionPreference = "Stop"\ntry {\n  $Username = '${n}'\n  $Password = '${i}'\n\n  $sec = ConvertTo-SecureString $Password -AsPlainText -Force\n  $cred = New-Object System.Management.Automation.PSCredential($Username, $sec)\n\n  # Auto-detect domain from domain-joined machine\n  $computerSystem = Get-WmiObject Win32_ComputerSystem\n  $domainName = $computerSystem.Domain\n\n  # Try AD module first\n  if (Get-Module -ListAvailable -Name ActiveDirectory) {\n    Import-Module ActiveDirectory -ErrorAction Stop\n    # Only pass -Server if we have a valid domain name\n    if ($domainName -and $domainName -ne 'WORKGROUP') {\n      $d = Get-ADDomain -Credential $cred -Server $domainName -ErrorAction Stop\n      $result = @{ valid = $true; domain = $d.DNSRoot }\n    } else {\n      # No domain detected, try without server parameter\n      $d = Get-ADDomain -Credential $cred -ErrorAction Stop\n      $result = @{ valid = $true; domain = $d.DNSRoot }\n    }\n  }\n  else {\n    # LDAP bind fallback\n    $ldapPath = if ($domainName -and $domainName -ne 'WORKGROUP') { "LDAP://$domainName/RootDSE" } else { "LDAP://RootDSE" }\n    $root = New-Object System.DirectoryServices.DirectoryEntry($ldapPath, $Username, $Password)\n    $null = $root.Properties["defaultNamingContext"].Value\n    $result = @{ valid = $true; domain = $domainName }\n  }\n\n  $result | ConvertTo-Json -Depth 6 -Compress\n} catch {\n  @{ valid = $false; error = $_.Exception.Message } | ConvertTo-Json -Depth 6 -Compress\n}\n`);return new Promise(e=>{const t=o("powershell.exe",["-NoProfile","-NonInteractive","-ExecutionPolicy","Bypass","-Command",a]);let r="",s="";t.stdout?.on("data",e=>{r+=e.toString()}),t.stderr?.on("data",e=>{s+=e.toString()}),t.on("close",t=>{if(console.log(`[ProfileService] PowerShell test completed with exit code: ${t}`),console.log(`[ProfileService] stdout length: ${r.length}`),console.log(`[ProfileService] stderr length: ${s.length}`),0!==t)return console.error(`[ProfileService] Credential test failed with exit code: ${t}`),console.error(`[ProfileService] stdout: ${r}`),console.error(`[ProfileService] stderr: ${s}`),void e({valid:!1,error:s||"PowerShell execution failed"});console.log(`[ProfileService] Raw PowerShell stdout: ${r}`);try{const t=r.match(/\{[^}]*"valid"\s*:\s*(true|false)[^}]*\}/);if(!t)throw new Error("No JSON result found in output");const s=t[0];console.log(`[ProfileService] Extracted JSON: ${s}`);const o=JSON.parse(s);console.log("[ProfileService] Parsed result:",o),e(o)}catch(t){console.error("[ProfileService] Failed to parse PowerShell output:",t),console.error("[ProfileService] Raw stdout was:",r),console.error("[ProfileService] Raw stderr was:",s),e({valid:!1,error:`Failed to parse test result. Output: ${r.substring(0,200)}`})}}),t.on("error",t=>{console.error("[ProfileService] PowerShell process error:",t),e({valid:!1,error:t.message})})})}maskUsername(e){if(!e)return"***";const t=e.split("\\");return 2===t.length?`${t[0]}\\***`:"***"}async getADDomainFromDiscovery(e){try{const t=await this.getProfileById(e);if(!t)return{domain:null};const r=t.companyName,n=this.getCompanyDataPath(r),i=s.join(n,"Raw"),a=await(0,c.glob)(s.join(i,"*{ActiveDirectory,AD}*.csv"));if(0===a.length)return{domain:null};const l=a.find(e=>e.includes("User")||e.includes("Domain"))||a[0];if(l)try{const e=(await o.readFile(l,"utf-8")).split("\n").filter(e=>e.trim());if(e.length>1){const t=e[0].toLowerCase(),r=e[1].split(","),s=t.split(",").findIndex(e=>e.includes("domain")||e.includes("dns"));if(s>=0&&r[s])return{domain:r[s].trim().replace(/"/g,"")};const o=t.split(",").findIndex(e=>e.includes("userprincipalname"));if(o>=0&&r[o]){const e=r[o].trim().replace(/"/g,"").match(/@(.+)$/);if(e)return{domain:e[1]}}}}catch(e){console.error("[ProfileService] Failed to parse AD domain file:",e)}return{domain:null}}catch(e){return console.error("[ProfileService] getADDomainFromDiscovery error:",e),{domain:null}}}async getAzureTenantDomain(e){try{const t=await this.getProfileById(e);if(!t)return{domain:null};const r=t.companyName,n=this.getCompanyDataPath(r),i=s.join(n,"Raw"),a=await(0,c.glob)(s.join(i,"*{EntraID,Azure,AzureAD}*.csv"));if(0===a.length)return{domain:null};const l=a.find(e=>e.includes("EntraIDDomain")||e.includes("Domain"));if(l)try{const e=(await o.readFile(l,"utf-8")).split("\n").filter(e=>e.trim());if(e.length>1){const t=e[1].split(","),r=t.find(e=>e.includes(".")&&!e.includes("@"))||t[0];if(r)return{domain:r.trim().replace(/"/g,"")}}}catch(e){console.error("[ProfileService] Failed to parse domain file:",e)}return{domain:null}}catch(e){return console.error("[ProfileService] getAzureTenantDomain error:",e),{domain:null}}}async getAzureDataFromDiscovery(e){try{const t=await this.getProfileById(e);if(!t)return{domain:null,tenantId:null};const r=t.companyName,n=this.getCompanyDataPath(r),i=s.join(n,"Raw"),a=await(0,c.glob)(s.join(i,"*{EntraID,Azure,AzureAD}*.csv"));if(0===a.length)return{domain:null,tenantId:null};let l=null,u=null;const d=a.find(e=>e.includes("EntraIDDomain")||e.includes("Domain"));if(d)try{const e=(await o.readFile(d,"utf-8")).split("\n").filter(e=>e.trim());if(e.length>1){const t=e[1].split(","),r=t.find(e=>e.includes(".")&&!e.includes("@"))||t[0];r&&(l=r.trim().replace(/"/g,""))}}catch(e){console.error("[ProfileService] Failed to parse domain file:",e)}const p=a[0];try{const e=(await o.readFile(p,"utf-8")).split("\n").filter(e=>e.trim());if(e.length>1){const t=e[0].toLowerCase(),r=e[1].split(","),s=t.split(",").findIndex(e=>e.includes("tenantid")||e.includes("tenant_id"));s>=0&&r[s]&&(u=r[s].trim().replace(/"/g,""))}}catch(e){console.error("[ProfileService] Failed to parse Azure file for tenant ID:",e)}return{domain:l,tenantId:u}}catch(e){return console.error("[ProfileService] getAzureDataFromDiscovery error:",e),{domain:null,tenantId:null}}}async autoDiscoverProfiles(){const e=[];try{const t=await o.readdir(this.dataRootPath);for(const r of t){const t=r;if("profiles"===t.toLowerCase())continue;const n=s.join(this.dataRootPath,r);if(!(await o.stat(n)).isDirectory())continue;const i=s.join(n,"Raw");await this.hasCSVFiles(i)&&e.push(this.createDefaultProfile(t,0===e.length))}const r=s.join(this.dataRootPath,"Profiles"),n=await(0,c.glob)(s.join(r,"*"));for(const t of n){const r=s.basename(t);if(!e.some(e=>e.companyName.toLowerCase()===r.toLowerCase())){const o=s.join(t,"Raw");await this.hasCSVFiles(o)&&e.push(this.createDefaultProfile(r,0===e.length))}}}catch(e){console.warn("Auto-discovery failed:",e)}e.length||e.push(this.createDefaultProfile("Sample Corporation",!0)),this.db.data.profiles=e,await this.db.write()}createDefaultProfile(e,t){return{id:this.generateId(),companyName:e,description:`Auto-discovered profile for ${e}`,domainController:`dc.${e.toLowerCase().replace(/\s+/g,"")}.com`,tenantId:this.generateId(),isActive:t,created:(new Date).toISOString(),lastModified:(new Date).toISOString(),configuration:{}}}async hasCSVFiles(e){try{const t=s.join(e,"*.csv").split(s.sep).join("/");console.log("[ProfileService] hasCSVFiles checking:",t);const r=await(0,c.glob)(t);return console.log("[ProfileService]   Found:",r.length,"files"),r.length>0}catch(e){return console.log("[ProfileService] hasCSVFiles error:",e),!1}}async createProfileDirectories(e){const t=this.getCompanyDataPath(e),r=["Raw","Output","Reports","Logs"];for(const e of r)await o.mkdir(s.join(t,e),{recursive:!0})}async renameProfileDirectory(e,t){const r=this.getCompanyDataPath(e),s=this.getCompanyDataPath(t);try{await o.rename(r,s)}catch(r){console.warn(`Failed to rename profile directory from ${e} to ${t}:`,r)}}async deleteProfileDirectory(e){const t=this.getCompanyDataPath(e);try{await o.rm(t,{recursive:!0,force:!0})}catch(t){console.warn(`Failed to delete profile directory ${e}:`,t)}}async getLastDiscoveryRun(e){try{const t=await(0,c.glob)(s.join(e,"**","*.csv"));if(!t.length)return null;const r=await Promise.all(t.map(async e=>(await o.stat(e)).mtime));return Math.max(...r.map(e=>e.getTime())).toString()}catch{return null}}async getTotalDiscoveryRuns(e){try{const t=await(0,c.glob)(s.join(e,"**","*.csv"));if(!t.length)return 0;const r=new Set;for(const e of t){const t=await o.stat(e);r.add(t.mtime.toDateString())}return r.size}catch{return 0}}async getDirectorySize(e){try{const t=await(0,c.glob)(s.join(e,"**","*"),{nodir:!0});let r=0;for(const e of t){r+=(await o.stat(e)).size}return r}catch{return 0}}generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}isValidGuid(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)}broadcastProfileChange(){r("electron").BrowserWindow.getAllWindows().forEach(e=>{e.webContents.send("profile:changed")})}}let u=null;async function d(e){return(await async function(){return u||(u=new l,await u.initialize()),u}()).getProfileById(e)}},"./src/main/services/projectService.ts":(e,t,r)=>{"use strict";r.d(t,{ProjectService:()=>n});var s=r("fs/promises"),o=r("path");class n{projectCache=new Map;getProjectPath(e){return o.join("C:","discoverydata",e,"Project.json")}async loadProjectConfig(e){if(this.projectCache.has(e))return this.projectCache.get(e);const t=this.getProjectPath(e);try{const r=await s.readFile(t,"utf-8"),o=JSON.parse(r);return this.projectCache.set(e,o),o}catch(t){return console.log(`Creating default project for ${e}`),this.createDefaultProject(e)}}async saveProjectConfig(e,t){const r=this.getProjectPath(e);await s.mkdir(o.dirname(r),{recursive:!0}),t.updatedAt=(new Date).toISOString(),await s.writeFile(r,JSON.stringify(t,null,2),"utf-8"),this.projectCache.set(e,t)}createDefaultProject(e){const t=new Date,r=new Date(t.getTime()+7776e6);return{id:`project-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:`${e} Migration Project`,description:"M&A migration project",createdAt:t.toISOString(),updatedAt:t.toISOString(),sourceProfile:{name:e,type:"ActiveDirectory",lastValidated:t.toISOString()},targetProfile:{name:"Target Environment",type:"AzureAD"},startDate:t.toISOString(),targetCutover:r.toISOString(),estimatedDuration:90,status:"Planning",currentPhase:"Discovery",waves:[],settings:{autoRefreshInterval:30,enableNotifications:!0,retentionDays:90,logLevel:"info"}}}async updateProjectStatus(e,t){const r=await this.loadProjectConfig(e);r.status=t,await this.saveProjectConfig(e,r)}async updateProjectPhase(e,t){const r=await this.loadProjectConfig(e);r.currentPhase=t,await this.saveProjectConfig(e,r)}async addMigrationWave(e,t){const r=await this.loadProjectConfig(e);r.waves.push(t),await this.saveProjectConfig(e,r)}async updateWaveStatus(e,t,r){const s=await this.loadProjectConfig(e),o=s.waves.find(e=>e.id===t);o&&(o.status=r,"Complete"===r&&(o.completedAt=(new Date).toISOString()),await this.saveProjectConfig(e,s))}invalidateCache(e){e?this.projectCache.delete(e):this.projectCache.clear()}}},"./src/main/services/updateService.ts":(e,t,r)=>{"use strict";r.d(t,{UpdateService:()=>u});var s=r("events"),o=r("fs"),n=r("path"),i=r("crypto"),a=r("electron"),c=r("./node_modules/octokit/dist-bundle/index.js"),l=r("./node_modules/semver/index.js");class u extends s.EventEmitter{configService;licenseService;octokit;initialized=!1;currentVersion;updateCheckInterval=null;constructor(e,t){super(),this.configService=e,this.licenseService=t,this.octokit=new c.Octokit({auth:process.env.GITHUB_UPDATE_TOKEN||void 0}),this.currentVersion=a.app.getVersion()}async initialize(){if(this.initialized)return;await this.configService.get("updates.currentVersion")!==this.currentVersion&&await this.configService.set("updates.currentVersion",this.currentVersion);(await this.configService.get("updates.autoUpdateEnabled")??!1)&&(this.updateCheckInterval=setInterval(()=>{this.checkForUpdates().catch(e=>{console.error("Auto update check failed:",e)})},144e5),setTimeout(()=>{this.checkForUpdates().catch(e=>{console.error("Startup update check failed:",e)})},3e4)),this.initialized=!0,this.emit("initialized")}async checkForUpdates(){await this.ensureInitialized();const e=await this.licenseService.getCustomerId();if(!e)throw new Error("No active license - cannot determine update channel");const t=this.getUpdateChannel(e);await this.configService.set("updates.lastCheckTime",(new Date).toISOString());try{const{data:e}=await this.octokit.rest.repos.getLatestRelease({owner:this.parseRepoOwner(t.repository),repo:this.parseRepoName(t.repository)}),r=e.tag_name.replace(/^v/,""),s=l.gt(r,this.currentVersion),o={available:s,currentVersion:this.currentVersion,latestVersion:r,releaseNotes:e.body||void 0,publishedAt:e.published_at||void 0,isBreaking:l.major(r)>l.major(this.currentVersion)};if(s){const t=e.assets.find(e=>e.name.endsWith(".nupkg"));t&&(o.downloadUrl=t.browser_download_url);const r=e.assets.find(e=>"CHECKSUMS.txt"===e.name||"SHA256SUMS"===e.name);r&&(o.checksumUrl=r.browser_download_url),this.emit("update-available",o)}return o}catch(e){throw console.error("Failed to check for updates:",e),new Error(`Update check failed: ${e instanceof Error?e.message:String(e)}`)}}async downloadUpdate(e){if(!e.downloadUrl)throw new Error("No download URL provided");const t=n.join(a.app.getPath("userData"),"updates");await o.promises.mkdir(t,{recursive:!0});const r=n.basename(e.downloadUrl),s=n.join(t,r);this.emit("download-started",{url:e.downloadUrl});try{const t=await fetch(e.downloadUrl);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const r=parseInt(t.headers.get("content-length")||"0",10);let n=0;const i=await o.promises.open(s,"w"),a=i.createWriteStream(),c=t.body?.getReader();if(!c)throw new Error("No response body");for(;;){const{done:e,value:t}=await c.read();if(e)break;a.write(t),n+=t.length;const s={phase:"downloading",percentage:r>0?Math.floor(n/r*100):0,bytesDownloaded:n,totalBytes:r};this.emit("download-progress",s)}return await new Promise((e,t)=>{a.end(r=>{r?t(r):e(void 0)})}),await i.close(),e.checksumUrl&&(this.emit("download-progress",{phase:"verifying",percentage:0}),await this.verifyChecksum(s,e.checksumUrl)),this.emit("download-complete",{filePath:s}),s}catch(e){try{await o.promises.unlink(s)}catch{}throw new Error(`Download failed: ${e instanceof Error?e.message:String(e)}`)}}async applyUpdate(e,t="prompt"){const r={from:this.currentVersion,to:"(applying...)",timestamp:(new Date).toISOString(),status:"success",channel:await this.licenseService.getCustomerId()||"unknown"};try{if(await this.createBackup(),this.emit("install-started"),!e.endsWith(".nupkg")&&!e.endsWith(".exe"))throw new Error("Unsupported installer format");await this.runSquirrelInstaller(e),await this.recordUpdate(r),this.emit("install-complete"),("silent"===t||confirm("Update installed. Restart now?"))&&(a.app.relaunch(),a.app.exit(0))}catch(e){throw r.status="failed",r.error=e instanceof Error?e.message:String(e),await this.recordUpdate(r),this.emit("install-failed",{error:e instanceof Error?e.message:String(e)}),e}}async rollback(){const e=n.join(a.app.getPath("userData"),"backup");try{if(!await o.promises.access(e).then(()=>!0).catch(()=>!1))throw new Error("No backup found");this.emit("rollback-started");const t={from:this.currentVersion,to:"(rolled back)",timestamp:(new Date).toISOString(),status:"rolled_back"};await this.recordUpdate(t),this.emit("rollback-complete"),a.app.relaunch(),a.app.exit(0)}catch(e){throw this.emit("rollback-failed",{error:e instanceof Error?e.message:String(e)}),e}}async getUpdateHistory(){return await this.configService.get("updates.history")||[]}async setAutoUpdateEnabled(e){await this.configService.set("updates.autoUpdateEnabled",e),e&&!this.updateCheckInterval?this.updateCheckInterval=setInterval(()=>{this.checkForUpdates().catch(e=>{console.error("Auto update check failed:",e)})},144e5):!e&&this.updateCheckInterval&&(clearInterval(this.updateCheckInterval),this.updateCheckInterval=null)}getUpdateChannel(e){const t={"customer-001":{name:"customer-001-stable",repository:"yourorg/discovery-suite-customer001",branch:"main"},"customer-002":{name:"customer-002-stable",repository:"yourorg/discovery-suite-customer002",branch:"main"},internal:{name:"internal-dev",repository:"yourorg/discovery-suite",branch:"develop"}};return t[e]||t.internal}parseRepoOwner(e){return e.split("/")[0]}parseRepoName(e){return e.split("/")[1]}async verifyChecksum(e,t){const r=await fetch(t);if(!r.ok)throw new Error(`Failed to download checksum: ${r.status}`);const s=await r.text(),a=n.basename(e),c=s.split("\n").find(e=>e.includes(a));if(!c)throw new Error(`Checksum not found for ${a}`);const l=c.split(/\s+/)[0],u=await o.promises.readFile(e),d=i.createHash("sha256").update(u).digest("hex");if(d!==l)throw new Error(`Checksum mismatch: expected ${l}, got ${d}`)}async createBackup(){const e=n.join(a.app.getPath("userData"),"backup");await o.promises.mkdir(e,{recursive:!0});const t=a.app.getAppPath();if(t.endsWith(".asar")){const r=n.join(e,`app-${this.currentVersion}.asar`);await o.promises.copyFile(t,r)}}async runSquirrelInstaller(e){const{spawn:t}=r("child_process");return new Promise((r,s)=>{const o=t(e,["--silent"],{detached:!0,stdio:"ignore"});o.on("exit",e=>{0===e?r():s(new Error(`Installer exited with code ${e}`))}),o.on("error",e=>{s(e)}),o.unref()})}async recordUpdate(e){const t=await this.getUpdateHistory();t.unshift(e),t.length>20&&t.splice(20),await this.configService.set("updates.history",t)}async ensureInitialized(){this.initialized||await this.initialize()}destroy(){this.updateCheckInterval&&(clearInterval(this.updateCheckInterval),this.updateCheckInterval=null)}}},"./src/renderer/types/models/group.ts":(e,t,r)=>{"use strict";var s,o,n;r.d(t,{GroupScope:()=>o,GroupType:()=>s,MembershipType:()=>n}),function(e){e.Security="Security",e.Distribution="Distribution",e.MailEnabled="MailEnabled",e.Office365="Office365",e.Dynamic="Dynamic"}(s||(s={})),function(e){e.Universal="Universal",e.Global="Global",e.DomainLocal="DomainLocal",e.None="None"}(o||(o={})),function(e){e.Static="Static",e.Dynamic="Dynamic",e.RuleBased="RuleBased"}(n||(n={}))},"./src/renderer/types/models/logicEngine.ts":(e,t,r)=>{"use strict";var s,o;r.d(t,{EdgeType:()=>o,NodeType:()=>s}),function(e){e.User="User",e.Group="Group",e.Device="Device",e.App="App",e.Share="Share",e.Path="Path",e.Gpo="Gpo",e.Mailbox="Mailbox",e.Role="Role",e.Db="Db",e.Threat="Threat",e.DataAsset="DataAsset",e.LineageFlow="LineageFlow",e.ExternalIdentity="ExternalIdentity"}(s||(s={})),function(e){e.MemberOf="MemberOf",e.PrimaryUser="PrimaryUser",e.HasApp="HasApp",e.AclOn="AclOn",e.MapsTo="MapsTo",e.LinkedByGpo="LinkedByGpo",e.HasMailbox="HasMailbox",e.AssignedRole="AssignedRole",e.OwnsDb="OwnsDb",e.DependsOn="DependsOn",e.Threatens="Threatens",e.HasGovernanceIssue="HasGovernanceIssue",e.DataFlowTo="DataFlowTo",e.ExternalMapping="ExternalMapping",e.Correlates="Correlates",e.Violates="Violates"}(o||(o={}))},child_process:e=>{"use strict";e.exports=require("child_process")},chokidar:e=>{"use strict";e.exports=require("chokidar")},crypto:e=>{"use strict";e.exports=require("crypto")},electron:e=>{"use strict";e.exports=require("electron")},events:e=>{"use strict";e.exports=require("events")},fs:e=>{"use strict";e.exports=require("fs")},"fs/promises":e=>{"use strict";e.exports=require("fs/promises")},glob:e=>{"use strict";e.exports=require("glob")},https:e=>{"use strict";e.exports=require("https")},net:e=>{"use strict";e.exports=require("net")},"node:buffer":e=>{"use strict";e.exports=require("buffer")},"node:crypto":e=>{"use strict";e.exports=require("node:crypto")},"node:fs":e=>{"use strict";e.exports=require("fs")},"node:fs/promises":e=>{"use strict";e.exports=require("fs/promises")},"node:path":e=>{"use strict";e.exports=require("path")},"node:url":e=>{"use strict";e.exports=require("url")},os:e=>{"use strict";e.exports=require("os")},path:e=>{"use strict";e.exports=require("path")},stream:e=>{"use strict";e.exports=require("stream")},tty:e=>{"use strict";e.exports=require("tty")},util:e=>{"use strict";e.exports=require("util")}},__webpack_module_cache__={},leafPrototypes,getProto,installedChunks;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.m=__webpack_modules__,void 0!==__webpack_require__&&(__webpack_require__.ab=__dirname+"/native_modules/"),__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var r=Object.create(null);__webpack_require__.r(r);var s={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var o=2&t&&e;("object"==typeof o||"function"==typeof o)&&!~leafPrototypes.indexOf(o);o=getProto(o))Object.getOwnPropertyNames(o).forEach(t=>s[t]=()=>e[t]);return s.default=()=>e,__webpack_require__.d(r,s),r},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce((t,r)=>(__webpack_require__.f[r](e,t),t),[])),__webpack_require__.u=e=>e+".main.js",__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},installedChunks={main:1},__webpack_require__.f.require=(e,t)=>{if(!installedChunks[e]){var r=require("./"+__webpack_require__.u(e));installedChunks[e]||(e=>{var t=e.modules,r=e.ids,s=e.runtime;for(var o in t)__webpack_require__.o(t,o)&&(__webpack_require__.m[o]=t[o]);s&&s(__webpack_require__);for(var n=0;n<r.length;n++)installedChunks[r[n]]=1})(r)}};var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__);var e=__webpack_require__("electron"),t=__webpack_require__("path"),r=__webpack_require__("./src/main/ipcHandlers.ts");const s="file://"+t.resolve(__dirname,"../renderer/main_window/index.html"),o=t.resolve(__dirname,"../preload/index.js");__webpack_require__("./node_modules/electron-squirrel-startup/index.js")&&e.app.quit();const n=async()=>{console.log("[MAIN] ========================================"),console.log("[MAIN] Webpack Entry Points:"),console.log("[MAIN] MAIN_WINDOW_WEBPACK_ENTRY:",s),console.log("[MAIN] MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY:",o),console.log("[MAIN] ========================================");const t=new e.BrowserWindow({title:"Enterprise Discovery & Migration Suite",height:900,width:1400,minHeight:700,minWidth:1200,webPreferences:{preload:o,contextIsolation:!0,nodeIntegration:!1,sandbox:!1},backgroundColor:"#1a1a1a",show:!0});t.once("ready-to-show",()=>{t.show()}),t.webContents.session.webRequest.onHeadersReceived((e,t)=>{t({responseHeaders:{...e.responseHeaders,"Content-Security-Policy":["default-src 'self'; img-src 'self' data: blob:; font-src 'self' data: blob:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'; connect-src 'self' ws: wss:;"]}})}),t.webContents.session.setPreloads([]),t.webContents.session.setSpellCheckerLanguages([]),t.webContents.session.setSpellCheckerEnabled(!1),t.webContents.setWindowOpenHandler(()=>({action:"deny"})),t.webContents.on("will-navigate",(e,t)=>{const r=new URL(t);"file://"!==r.origin&&"http://localhost:3000"!==r.origin&&e.preventDefault()}),t.loadURL(s);return console.log("[MAIN] Opening DevTools (debug mode enabled)"),t.webContents.openDevTools(),t};e.app.on("ready",async()=>{const e=await n();await(0,r.registerIpcHandlers)(e)}),e.app.on("window-all-closed",()=>{"darwin"!==process.platform&&e.app.quit()}),e.app.on("before-quit",async t=>{t.preventDefault(),await(0,r.shutdownIpcHandlers)(),e.app.exit(0)}),e.app.on("activate",()=>{0===e.BrowserWindow.getAllWindows().length&&n()})})(),module.exports=__webpack_exports__})();
//# sourceMappingURL=main.js.map