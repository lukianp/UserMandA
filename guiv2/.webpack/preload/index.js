(()=>{"use strict";const e=require("electron"),r={executeScript:r=>e.ipcRenderer.invoke("powershell:executeScript",r),executeModule:r=>e.ipcRenderer.invoke("powershell:executeModule",r),executeDiscoveryModule:(r,n,o,i)=>{console.log("[PRELOAD] ========== executeDiscoveryModule CALLED =========="),console.log("[PRELOAD] moduleName:",r),console.log("[PRELOAD] companyName:",n),console.log("[PRELOAD] additionalParams:",JSON.stringify(o,null,2)),console.log("[PRELOAD] options:",JSON.stringify(i,null,2));const t={moduleName:r,companyName:n,additionalParams:o,options:i};console.log("[PRELOAD] Calling ipcRenderer.invoke with channel: powershell:executeDiscoveryModule"),console.log("[PRELOAD] Full params object:",JSON.stringify(t,null,2));const c=e.ipcRenderer.invoke("powershell:executeDiscoveryModule",t);return console.log("[PRELOAD] ipcRenderer.invoke called, promise created"),c.then(e=>{console.log("[PRELOAD] âœ… executeDiscoveryModule promise resolved"),console.log("[PRELOAD] Result type:",typeof e),console.log("[PRELOAD] Result keys:",e?Object.keys(e):"NULL"),console.log("[PRELOAD] Result.success:",e?.success),console.log("[PRELOAD] Result.error:",e?.error)}).catch(e=>{console.error("[PRELOAD] âŒ executeDiscoveryModule promise rejected"),console.error("[PRELOAD] Error:",e),console.error("[PRELOAD] Error message:",e?.message)}),c},cancelExecution:r=>e.ipcRenderer.invoke("powershell:cancel",r),discoverModules:()=>e.ipcRenderer.invoke("powershell:discoverModules"),executeParallel:r=>e.ipcRenderer.invoke("powershell:executeParallel",r),executeWithRetry:(r,n,o)=>e.ipcRenderer.invoke("powershell:executeWithRetry",r,n,o),fs:{readFile:(r,n)=>e.ipcRenderer.invoke("file:read",r,n),writeFile:(r,n,o)=>e.ipcRenderer.invoke("file:write",r,n,o),exists:r=>e.ipcRenderer.invoke("file:exists",r),mkdir:r=>e.ipcRenderer.invoke("file:mkdir",r),rmdir:r=>e.ipcRenderer.invoke("file:rmdir",r),unlink:r=>e.ipcRenderer.invoke("file:delete",r),readdir:r=>e.ipcRenderer.invoke("file:readdir",r),stat:r=>e.ipcRenderer.invoke("file:stat",r),getRawDataPath:r=>e.ipcRenderer.invoke("file:getRawDataPath",r),getCSVPath:(r,n)=>e.ipcRenderer.invoke("file:getCSVPath",r,n),watchDirectory:(r,n,o)=>{const i=(e,r)=>{o&&o(r)};return e.ipcRenderer.on("file:changed",i),()=>e.ipcRenderer.removeListener("file:changed",i)},listFiles:(r,n)=>e.ipcRenderer.invoke("file:list",r,n)},readFile:(r,n)=>e.ipcRenderer.invoke("file:read",r,n),writeFile:(r,n,o)=>e.ipcRenderer.invoke("file:write",r,n,o),fileExists:r=>e.ipcRenderer.invoke("file:exists",r),deleteFile:r=>e.ipcRenderer.invoke("file:delete",r),listFiles:(r,n)=>e.ipcRenderer.invoke("file:list",r,n),logToFile:r=>e.ipcRenderer.invoke("logging:write",r),logging:{debug:(r,n,o)=>e.ipcRenderer.invoke("log:message",{level:"DEBUG",component:r,message:n,context:o}),info:(r,n,o)=>e.ipcRenderer.invoke("log:message",{level:"INFO",component:r,message:n,context:o}),warn:(r,n,o)=>e.ipcRenderer.invoke("log:message",{level:"WARN",component:r,message:n,context:o}),error:(r,n,o,i)=>e.ipcRenderer.invoke("log:error",{component:r,message:n,stack:o,context:i}),fatal:(r,n,o,i)=>e.ipcRenderer.invoke("log:message",{level:"FATAL",component:r,message:n,context:i}),getRecent:r=>e.ipcRenderer.invoke("log:getRecent",r),getByLevel:(r,n)=>e.ipcRenderer.invoke("log:getByLevel",{level:r,count:n}),getByComponent:(r,n)=>e.ipcRenderer.invoke("log:getByComponent",{component:r,count:n}),clear:()=>e.ipcRenderer.invoke("log:clear"),updateConfig:r=>e.ipcRenderer.invoke("log:updateConfig",r),getConfig:()=>e.ipcRenderer.invoke("log:getConfig")},getConfig:r=>e.ipcRenderer.invoke("config:get",r),setConfig:(r,n)=>e.ipcRenderer.invoke("config:set",r,n),getAllConfig:()=>e.ipcRenderer.invoke("config:getAll"),deleteConfig:r=>e.ipcRenderer.invoke("config:delete",r),profile:{getAll:()=>e.ipcRenderer.invoke("profile:getAll"),getCurrent:()=>e.ipcRenderer.invoke("profile:getCurrent"),setCurrent:r=>e.ipcRenderer.invoke("profile:setCurrent",r),create:r=>e.ipcRenderer.invoke("profile:create",r),update:r=>e.ipcRenderer.invoke("profile:update",r),delete:r=>e.ipcRenderer.invoke("profile:delete",r),import:r=>e.ipcRenderer.invoke("profile:import",r),export:(r,n)=>e.ipcRenderer.invoke("profile:export",r,n),getStats:r=>e.ipcRenderer.invoke("profile:getStats",r),validate:r=>e.ipcRenderer.invoke("profile:validate",r),getConnectionConfig:r=>e.ipcRenderer.invoke("profile:getConnectionConfig",r),setConnectionConfig:(r,n)=>e.ipcRenderer.invoke("profile:setConnectionConfig",r,n),testConnection:r=>e.ipcRenderer.invoke("profile:testConnection",r),onProfileChanged:r=>(e.ipcRenderer.on("profile:changed",r),()=>e.ipcRenderer.removeListener("profile:changed",r))},loadSourceProfiles:()=>e.ipcRenderer.invoke("profile:getAll"),loadTargetProfiles:()=>e.ipcRenderer.invoke("profile:getAll"),updateSourceProfile:(r,n)=>e.ipcRenderer.invoke("profile:update",{id:r,...n}),updateTargetProfile:(r,n)=>e.ipcRenderer.invoke("profile:update",{id:r,...n}),deleteSourceProfile:r=>e.ipcRenderer.invoke("profile:deleteSource",r),deleteTargetProfile:r=>e.ipcRenderer.invoke("profile:deleteTarget",r),createSourceProfile:r=>e.ipcRenderer.invoke("profile:createSource",r),createTargetProfile:r=>e.ipcRenderer.invoke("profile:createTarget",r),setActiveProfile:r=>e.ipcRenderer.invoke("profile:setCurrent",r),setActiveSourceProfile:r=>e.ipcRenderer.invoke("profile:setActiveSource",r),setActiveTargetProfile:r=>e.ipcRenderer.invoke("profile:setActiveTarget",r),loadCredentials:r=>e.ipcRenderer.invoke("credentials:load",{profileId:r}),saveCredentials:(r,n,o,i,t)=>e.ipcRenderer.invoke("credentials:save",{profileId:r,username:n,password:o,connectionType:i,domain:t}),deleteCredentials:r=>e.ipcRenderer.invoke("credentials:delete",{profileId:r}),credentialsExist:r=>e.ipcRenderer.invoke("credentials:exists",{profileId:r}),onProgress:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:progress",n),()=>{e.ipcRenderer.removeListener("powershell:progress",n)}},onOutput:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:output",n),()=>{e.ipcRenderer.removeListener("powershell:output",n)}},onOutputStream:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:stream:output",n),()=>e.ipcRenderer.removeListener("powershell:stream:output",n)},onErrorStream:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:stream:error",n),()=>e.ipcRenderer.removeListener("powershell:stream:error",n)},onWarningStream:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:stream:warning",n),()=>e.ipcRenderer.removeListener("powershell:stream:warning",n)},onVerboseStream:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:stream:verbose",n),()=>e.ipcRenderer.removeListener("powershell:stream:verbose",n)},onDebugStream:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:stream:debug",n),()=>e.ipcRenderer.removeListener("powershell:stream:debug",n)},onInformationStream:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:stream:information",n),()=>e.ipcRenderer.removeListener("powershell:stream:information",n)},onExecutionCancelled:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("powershell:execution:cancelled",n),()=>e.ipcRenderer.removeListener("powershell:execution:cancelled",n)},startFileWatcher:r=>e.ipcRenderer.invoke("filewatcher:start",r),stopFileWatcher:r=>e.ipcRenderer.invoke("filewatcher:stop",r),stopAllFileWatchers:()=>e.ipcRenderer.invoke("filewatcher:stopAll"),getWatchedFiles:()=>e.ipcRenderer.invoke("filewatcher:getWatchedFiles"),getFileWatcherStatistics:()=>e.ipcRenderer.invoke("filewatcher:getStatistics"),onFileChanged:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("file:changed",n),()=>e.ipcRenderer.removeListener("file:changed",n)},getAppVersion:()=>e.ipcRenderer.invoke("system:getAppVersion"),getDataPath:()=>e.ipcRenderer.invoke("system:getDataPath"),openExternal:r=>e.ipcRenderer.invoke("system:openExternal",r),showOpenDialog:r=>e.ipcRenderer.invoke("system:showOpenDialog",r),showSaveDialog:r=>e.ipcRenderer.invoke("system:showSaveDialog",r),window:{minimize:()=>e.ipcRenderer.invoke("window:minimize"),maximize:()=>e.ipcRenderer.invoke("window:maximize"),close:()=>e.ipcRenderer.invoke("window:close"),restore:()=>e.ipcRenderer.invoke("window:restore"),isMaximized:()=>e.ipcRenderer.invoke("window:isMaximized")},invoke:(r,n)=>e.ipcRenderer.invoke(r,n),detectEnvironment:r=>e.ipcRenderer.invoke("environment:detect",r),validateEnvironmentCredentials:(r,n)=>e.ipcRenderer.invoke("environment:validateCredentials",r,n),cancelEnvironmentDetection:r=>e.ipcRenderer.invoke("environment:cancel",r),getEnvironmentStatistics:()=>e.ipcRenderer.invoke("environment:getStatistics"),onEnvironmentDetectionStarted:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("environment:detection:started",n),()=>e.ipcRenderer.removeListener("environment:detection:started",n)},onEnvironmentDetectionProgress:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("environment:detection:progress",n),()=>e.ipcRenderer.removeListener("environment:detection:progress",n)},onEnvironmentDetectionCompleted:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("environment:detection:completed",n),()=>e.ipcRenderer.removeListener("environment:detection:completed",n)},onEnvironmentDetectionFailed:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("environment:detection:failed",n),()=>e.ipcRenderer.removeListener("environment:detection:failed",n)},onEnvironmentDetectionCancelled:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("environment:detection:cancelled",n),()=>e.ipcRenderer.removeListener("environment:detection:cancelled",n)},executeDiscovery:r=>{console.log("[PRELOAD] ========== executeDiscovery CALLED =========="),console.log("[PRELOAD] params:",JSON.stringify(r,null,2)),console.log("[PRELOAD] Calling ipcRenderer.invoke with channel: discovery:execute");const n=e.ipcRenderer.invoke("discovery:execute",r);return console.log("[PRELOAD] ipcRenderer.invoke called, promise created"),n.then(e=>{console.log("[PRELOAD] âœ… executeDiscovery promise resolved"),console.log("[PRELOAD] Result type:",typeof e),console.log("[PRELOAD] Result keys:",e?Object.keys(e):"NULL"),console.log("[PRELOAD] Result.success:",e?.success),console.log("[PRELOAD] Result.error:",e?.error)}).catch(e=>{console.error("[PRELOAD] âŒ executeDiscovery promise rejected"),console.error("[PRELOAD] Error:",e),console.error("[PRELOAD] Error message:",e?.message)}),n},cancelDiscovery:r=>e.ipcRenderer.invoke("discovery:cancel",{executionId:r}),getDiscoveryModules:()=>e.ipcRenderer.invoke("discovery:get-modules"),getDiscoveryModuleInfo:r=>e.ipcRenderer.invoke("discovery:get-module-info",{moduleName:r}),onDiscoveryOutput:r=>{const n=(e,n)=>{console.log("[PRELOAD] ðŸ“© Received discovery:output event from main process:",n),r(n)};return e.ipcRenderer.on("discovery:output",n),console.log("[PRELOAD] âœ… Registered listener for discovery:output events"),()=>{console.log("[PRELOAD] ðŸ§¹ Removing listener for discovery:output"),e.ipcRenderer.removeListener("discovery:output",n)}},onDiscoveryProgress:r=>{const n=(e,n)=>{console.log("[PRELOAD] ðŸ“Š Received discovery:progress event from main process:",n),r(n)};return e.ipcRenderer.on("discovery:progress",n),console.log("[PRELOAD] âœ… Registered listener for discovery:progress events"),()=>{console.log("[PRELOAD] ðŸ§¹ Removing listener for discovery:progress"),e.ipcRenderer.removeListener("discovery:progress",n)}},onDiscoveryComplete:r=>{const n=(e,n)=>{console.log("[PRELOAD] âœ… Received discovery:complete event from main process:",n),r(n)};return e.ipcRenderer.on("discovery:complete",n),console.log("[PRELOAD] âœ… Registered listener for discovery:complete events"),()=>{console.log("[PRELOAD] ðŸ§¹ Removing listener for discovery:complete"),e.ipcRenderer.removeListener("discovery:complete",n)}},onDiscoveryError:r=>{const n=(e,n)=>{console.log("[PRELOAD] âŒ Received discovery:error event from main process:",n),r(n)};return e.ipcRenderer.on("discovery:error",n),console.log("[PRELOAD] âœ… Registered listener for discovery:error events"),()=>{console.log("[PRELOAD] ðŸ§¹ Removing listener for discovery:error"),e.ipcRenderer.removeListener("discovery:error",n)}},onDiscoveryCancelled:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("discovery:cancelled",n),()=>e.ipcRenderer.removeListener("discovery:cancelled",n)},logicEngine:{loadAll:r=>e.ipcRenderer.invoke("logic-engine:load-all",{profilePath:r}),getUserDetail:r=>e.ipcRenderer.invoke("logic-engine:get-user-detail",{userId:r}),getStatistics:()=>e.ipcRenderer.invoke("logic-engine:get-statistics"),invalidateCache:()=>e.ipcRenderer.invoke("logic-engine:invalidate-cache"),onProgress:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("logic-engine:progress",n),()=>e.ipcRenderer.removeListener("logic-engine:progress",n)},onLoaded:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("logic-engine:loaded",n),()=>e.ipcRenderer.removeListener("logic-engine:loaded",n)},onError:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("logic-engine:error",n),()=>e.ipcRenderer.removeListener("logic-engine:error",n)},analyzeMigrationComplexity:r=>e.ipcRenderer.invoke("logicEngine:analyzeMigrationComplexity",r),batchAnalyzeMigrationComplexity:r=>e.ipcRenderer.invoke("logicEngine:batchAnalyzeMigrationComplexity",r),getComplexityStatistics:()=>e.ipcRenderer.invoke("logicEngine:getComplexityStatistics")},dashboard:{getStats:r=>e.ipcRenderer.invoke("dashboard:getStats",r),getProjectTimeline:r=>e.ipcRenderer.invoke("dashboard:getProjectTimeline",r),getSystemHealth:()=>e.ipcRenderer.invoke("dashboard:getSystemHealth"),getRecentActivity:(r,n)=>e.ipcRenderer.invoke("dashboard:getRecentActivity",r,n),acknowledgeAlert:r=>e.ipcRenderer.invoke("dashboard:acknowledgeAlert",r)},appRegistration:{launch:r=>e.ipcRenderer.invoke("app-registration:launch",r),hasCredentials:r=>e.ipcRenderer.invoke("app-registration:has-credentials",r),readSummary:r=>e.ipcRenderer.invoke("app-registration:read-summary",r),decryptCredential:r=>e.ipcRenderer.invoke("app-registration:decrypt-credential",r),readStatus:r=>e.ipcRenderer.invoke("app-registration:read-status",r),clearStatus:r=>e.ipcRenderer.invoke("app-registration:clear-status",r)},connectionTest:{testActiveDirectory:(r,n)=>e.ipcRenderer.invoke("connection-test:active-directory",r,n),testExchange:(r,n)=>e.ipcRenderer.invoke("connection-test:exchange",r,n),testAzureAD:(r,n,o)=>e.ipcRenderer.invoke("connection-test:azure-ad",r,n,o),testEnvironment:r=>e.ipcRenderer.invoke("connection-test:environment",r),cancel:r=>e.ipcRenderer.invoke("connection-test:cancel",r),getStatistics:()=>e.ipcRenderer.invoke("connection-test:statistics"),onTestStarted:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("connection-test:started",n),()=>e.ipcRenderer.removeListener("connection-test:started",n)},onTestProgress:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("connection-test:progress",n),()=>e.ipcRenderer.removeListener("connection-test:progress",n)},onTestCompleted:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("connection-test:completed",n),()=>e.ipcRenderer.removeListener("connection-test:completed",n)},onTestFailed:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("connection-test:failed",n),()=>e.ipcRenderer.removeListener("connection-test:failed",n)},onTestCancelled:r=>{const n=(e,n)=>r(n);return e.ipcRenderer.on("connection-test:cancelled",n),()=>e.ipcRenderer.removeListener("connection-test:cancelled",n)}},project:{getConfiguration:r=>e.ipcRenderer.invoke("project:getConfiguration",r),saveConfiguration:(r,n)=>e.ipcRenderer.invoke("project:saveConfiguration",r,n),updateStatus:(r,n)=>e.ipcRenderer.invoke("project:updateStatus",r,n),addWave:(r,n)=>e.ipcRenderer.invoke("project:addWave",r,n),updateWaveStatus:(r,n,o)=>e.ipcRenderer.invoke("project:updateWaveStatus",r,n,o)}};e.contextBridge.exposeInMainWorld("electron",r),e.contextBridge.exposeInMainWorld("electronAPI",r),console.log("========================================"),console.log("[PRELOAD] âœ… Preload script loaded successfully - Secure bridge established"),console.log("[PRELOAD] electronAPI exposed to window.electronAPI"),console.log("[PRELOAD] electronAPI keys:",Object.keys(r).slice(0,10).join(", "),"..."),console.log("[PRELOAD] Total API methods:",Object.keys(r).length),console.log("[PRELOAD] dashboard methods:",r.dashboard?Object.keys(r.dashboard).length:"UNDEFINED"),console.log("[PRELOAD] logicEngine methods:",r.logicEngine?Object.keys(r.logicEngine).length:"UNDEFINED"),console.log("[PRELOAD] project methods:",r.project?Object.keys(r.project).length:"UNDEFINED"),console.log("[PRELOAD] profile methods:",r.profile?Object.keys(r.profile).length:"UNDEFINED"),console.log("[PRELOAD] Context isolation:",!0),console.log("========================================")})();