"use strict";exports.id=940,exports.ids=[940],exports.modules={940:(t,e,a)=>{a.d(e,{FileSystemService:()=>h});var r=a(943),i=a(928),s=a(482),n=a(231),o=a(410);class h{watchers=new Map;constructor(){this.registerIPCHandlers()}registerIPCHandlers(){s.ipcMain.handle("fs:getCSVPath",(t,e,a)=>this.getCSVPath(e,a)),s.ipcMain.handle("fs:getRawDataPath",(t,e)=>this.getRawDataPath(e)),s.ipcMain.handle("fs:readFile",(t,e)=>this.readFile(e)),s.ipcMain.handle("fs:listCSVFiles",(t,e)=>this.listCSVFiles(e)),s.ipcMain.handle("fs:watchDirectory",(t,e,a,r)=>this.watchDirectory(e,a,r)),s.ipcMain.handle("fs:unwatchDirectory",(t,e)=>this.unwatchDirectory(e))}getDataRootPath(){return"win32"===process.platform?"C:\\DiscoveryData":i.join(a(857).homedir(),"DiscoveryData")}getCSVPath(t,e){return i.join(this.getDataRootPath(),t,"Raw",e)}getRawDataPath(t){return i.join(this.getDataRootPath(),t,"Raw")}async readFile(t){try{return await r.readFile(t,"utf-8")}catch(e){throw new Error(`Failed to read file ${t}: ${e instanceof Error?e.message:String(e)}`)}}async listCSVFiles(t){const e=this.getRawDataPath(t);try{return(await(0,o.glob)(i.join(e,"*.csv"))).map(t=>i.basename(t))}catch(e){return console.warn(`Failed to list CSV files for ${t}:`,e),[]}}watchDirectory(t,e,a){try{const r=(0,n.watch)(i.join(t,e),{ignoreInitial:!0,persistent:!0});return r.on("add",()=>{this.broadcastFileChange(a,"add")}),r.on("change",()=>{this.broadcastFileChange(a,"change")}),r.on("unlink",()=>{this.broadcastFileChange(a,"unlink")}),this.watchers.set(a,r),!0}catch(e){return console.error(`Failed to watch directory ${t}:`,e),!1}}unwatchDirectory(t){const e=this.watchers.get(t);return!!e&&(e.close(),this.watchers.delete(t),!0)}broadcastFileChange(t,e){a(482).BrowserWindow.getAllWindows().forEach(a=>{a.webContents.send("fs:fileChanged",{watchId:t,event:e})})}}}};