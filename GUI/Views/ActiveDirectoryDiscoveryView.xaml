<UserControl x:Class="MandADiscoverySuite.Views.ActiveDirectoryDiscoveryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Name="ADDiscoveryControl"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="1200"
             Background="{DynamicResource SurfaceBrush}">

        <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Resources/Converters.xaml" />
                <ResourceDictionary Source="../Resources/DataGridTheme.xaml" />
                <ResourceDictionary Source="../Themes/ThemeStyles.xaml" />
                <ResourceDictionary Source="../Themes/Colors.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
            <TextBlock Text="{Binding ModuleIcon}" FontSize="32" Margin="0,0,8,0" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding ModuleTitle}" FontSize="20" FontWeight="SemiBold" VerticalAlignment="Center"/>
            <TextBlock Text="{Binding SelectedResults.Count, StringFormat=' ({0} records)'}" FontSize="16" Foreground="Gray" VerticalAlignment="Center" Margin="16,0,0,0"/>
        </StackPanel>

        <!-- Summary Cards Region -->
        <UniformGrid Columns="4" Margin="0,0,0,16" Grid.Row="1">
            <Border Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1" Padding="16" Margin="4">
                <StackPanel>
                    <TextBlock Text="??" FontSize="24" HorizontalAlignment="Center"/>
                    <TextBlock Text="Total Users" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding TotalUsers}" FontSize="24" FontWeight="SemiBold" Foreground="Blue" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
            <Border Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1" Padding="16" Margin="4">
                <StackPanel>
                    <TextBlock Text="??" FontSize="24" HorizontalAlignment="Center"/>
                    <TextBlock Text="Total Groups" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding TotalGroups}" FontSize="24" FontWeight="SemiBold" Foreground="Green" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
            <Border Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1" Padding="16" Margin="4">
                <StackPanel>
                    <TextBlock Text="??" FontSize="24" HorizontalAlignment="Center"/>
                    <TextBlock Text="Total Computers" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding TotalComputers}" FontSize="24" FontWeight="SemiBold" Foreground="Orange" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
            <Border Background="#F8FAFC" BorderBrush="#E2E8F0" BorderThickness="1" Padding="16" Margin="4">
                <StackPanel>
                    <TextBlock Text="??" FontSize="24" HorizontalAlignment="Center"/>
                    <TextBlock Text="Total OUs" FontWeight="Bold" FontSize="14" HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding TotalOUs}" FontSize="24" FontWeight="SemiBold" Foreground="Purple" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
        </UniformGrid>

        <!-- Toolbar Region -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,16">
            <Button Content="Refresh" Padding="12,6" Margin="0,0,8,0" Command="{Binding RefreshDataCommand}"/>
            <Button Content="Export" Padding="12,6" Margin="0,0,8,0" Command="{Binding ExportCommand}"/>
            <Button Content="Run Discovery" Padding="12,6" Command="{Binding RunDiscoveryCommand}"/>
        </StackPanel>

        <!-- Main Content Grid -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Main DataGrid -->
            <DataGrid Grid.Column="0" ItemsSource="{Binding SelectedResults}" AutoGenerateColumns="False" CanUserAddRows="False" GridLinesVisibility="Horizontal" HeadersVisibility="Column" Margin="20,0,20,20" SelectedItem="{Binding SelectedItem}" VirtualizingStackPanel.IsVirtualizing="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Display Name" Binding="{Binding displayname}" Width="200"/>
                    <DataGridTextColumn Header="User Principal Name" Binding="{Binding userprincipalname}" Width="250"/>
                    <DataGridTextColumn Header="SAM Account Name" Binding="{Binding samaccountname}" Width="150"/>
                    <DataGridTextColumn Header="Email" Binding="{Binding mail}" Width="200"/>
                    <DataGridTextColumn Header="Department" Binding="{Binding department}" Width="150"/>
                    <DataGridTextColumn Header="Job Title" Binding="{Binding jobtitle}" Width="150"/>
                    <DataGridTextColumn Header="Company" Binding="{Binding company}" Width="150"/>
                    <DataGridTextColumn Header="Manager" Binding="{Binding manager}" Width="150"/>
                    <DataGridTextColumn Header="Created Date" Binding="{Binding createddatetime}" Width="120"/>
                    <DataGridTextColumn Header="Distinguished Name" Binding="{Binding distinguishedname}" Width="250"/>
                    <DataGridTemplateColumn Header="Actions" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="View Details" Command="{Binding DataContext.ViewDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>

            <GridSplitter Grid.Column="1" Width="5" Background="Gray" HorizontalAlignment="Stretch" ResizeBehavior="PreviousAndNext"/>

            <!-- Right-hand Details Panel -->
            <Border Grid.Column="2" Background="#1A202C" BorderBrush="#E2E8F0" BorderThickness="1" Margin="0,0,20,20">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="16">
                        <TextBlock Text="Details" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        <ListView ItemsSource="{Binding SelectedItemDetails}" BorderThickness="0" Background="Transparent">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="0,0,0,10">
                                        <TextBlock Text="{Binding Key}" FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding Value}" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Footer Region -->
        <Border Grid.Row="4" Background="#1A202C" Padding="16" Margin="0,16,0,0">
            <TextBlock Text="Footer/Empty State Content" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="#4A5568"/>
        </Border>
    </Grid>
</UserControl>
