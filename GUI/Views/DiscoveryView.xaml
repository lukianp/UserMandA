<UserControl x:Class="MandADiscoverySuite.Views.DiscoveryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters="clr-namespace:MandADiscoverySuite.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200"
             Background="#FF1A202C">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
            
            <!-- Modern Card Style -->
            <Style x:Key="ModernCardStyle" TargetType="Border">
                <Setter Property="Background" Value="#FF2D3748"/>
                <Setter Property="CornerRadius" Value="12"/>
                <Setter Property="Padding" Value="24"/>
                <Setter Property="Effect">
                    <Setter.Value>
                        <DropShadowEffect Color="Black" BlurRadius="20" Opacity="0.1" ShadowDepth="8" Direction="270"/>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Header Style -->
            <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="28"/>
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Foreground" Value="#FFF7FAFC"/>
            </Style>

            <!-- Section Header Style -->
            <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Setter Property="Foreground" Value="#FFE2E8F0"/>
                <Setter Property="Margin" Value="0,0,0,16"/>
            </Style>

            <!-- Modern Button Style -->
            <Style x:Key="ModernButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="#FF4299E1"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="16,12"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontWeight" Value="Medium"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" 
                                    CornerRadius="8"
                                    x:Name="ButtonBorder">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="ButtonBorder" Property="Background" Value="#FF3182CE"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="ButtonBorder" Property="Background" Value="#FF2C5282"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

            <!-- Module Card Style -->
            <Style x:Key="ModuleCardStyle" TargetType="Border">
                <Setter Property="Background" Value="#FF2D3748"/>
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="Padding" Value="16"/>
                <Setter Property="Margin" Value="8"/>
                <Setter Property="MinWidth" Value="280"/>
                <Setter Property="MinHeight" Value="160"/>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header Section -->
            <StackPanel Grid.Row="0" Margin="0,0,0,32">
                <TextBlock Text="Discovery Modules" Style="{StaticResource HeaderTextStyle}"/>
                <TextBlock Text="Run discovery modules to gather comprehensive organizational data for migration planning" 
                           Foreground="#FFA0AEC0" FontSize="16" Margin="0,8,0,0"/>
            </StackPanel>

            <!-- Quick Actions Section -->
            <Border Grid.Row="1" Style="{StaticResource ModernCardStyle}" Margin="0,0,0,24">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Quick Actions" Style="{StaticResource SectionHeaderStyle}"/>
                        <TextBlock Text="Execute discovery operations and manage data collection" 
                                   Foreground="#FFA0AEC0" FontSize="14"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Content="ðŸ”„ Refresh Data" 
                                Style="{StaticResource ModernButtonStyle}" 
                                Background="#FF38A169"
                                Command="{Binding RefreshDataCommand}" 
                                Margin="0,0,12,0"
                                ToolTip="Reload discovery data from CSV files"/>
                        
                        <Button Content="â–¶ï¸ Run All Modules" 
                                Style="{StaticResource ModernButtonStyle}"
                                Command="{Binding StartDiscoveryCommand}"
                                ToolTip="Execute all enabled discovery modules"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Discovery Modules Grid -->
            <Border Grid.Row="2" Style="{StaticResource ModernCardStyle}">
                <StackPanel>
                    <TextBlock Text="Available Discovery Modules" Style="{StaticResource SectionHeaderStyle}"/>
                    
                    <ItemsControl ItemsSource="{Binding DiscoveryModules}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal" HorizontalAlignment="Stretch"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ModuleCardStyle}">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <!-- Module Header -->
                                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                                            <TextBlock Text="{Binding Icon}" FontSize="24" Margin="0,0,12,0"/>
                                            <StackPanel>
                                                <TextBlock Text="{Binding DisplayName}" 
                                                           FontSize="16" FontWeight="SemiBold" 
                                                           Foreground="#FFE2E8F0"/>
                                                <TextBlock Text="{Binding Category}" 
                                                           FontSize="12" 
                                                           Foreground="#FFA0AEC0"/>
                                            </StackPanel>
                                        </StackPanel>

                                        <!-- Module Status -->
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,8">
                                            <Ellipse Width="8" Height="8" Margin="0,0,8,0">
                                                <Ellipse.Style>
                                                    <Style TargetType="Ellipse">
                                                        <Setter Property="Fill" Value="#FF48BB78"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Status}" Value="Running">
                                                                <Setter Property="Fill" Value="#FFED8936"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding Status}" Value="Failed">
                                                                <Setter Property="Fill" Value="#FFF56565"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Ellipse.Style>
                                            </Ellipse>
                                            <TextBlock Text="{Binding Status}" 
                                                       FontSize="12" FontWeight="Medium"
                                                       Foreground="#FFE2E8F0"/>
                                        </StackPanel>

                                        <!-- Module Description -->
                                        <TextBlock Grid.Row="2" 
                                                   Text="{Binding Description}" 
                                                   FontSize="12" 
                                                   Foreground="#FFA0AEC0"
                                                   TextWrapping="Wrap"
                                                   Margin="0,0,0,12"/>

                                        <!-- Progress Bar -->
                                        <ProgressBar Grid.Row="3" 
                                                     Value="{Binding Progress}" 
                                                     Maximum="100"
                                                     Height="4" 
                                                     Background="#FF1A202C" 
                                                     Foreground="#FF4299E1" 
                                                     BorderThickness="0"
                                                     Margin="0,0,0,12"
                                                     Visibility="{Binding IsRunning, Converter={StaticResource BoolToVisibilityConverter}}"/>

                                        <!-- Module Actions -->
                                        <StackPanel Grid.Row="3" Orientation="Horizontal">
                                            <CheckBox Content="Enabled" 
                                                      IsChecked="{Binding Enabled}"
                                                      Foreground="#FFE2E8F0" 
                                                      Margin="0,0,12,0"/>
                                            <Button Content="Run" 
                                                    Command="{Binding RunDiscoveryCommand}"
                                                    Style="{StaticResource ModernButtonStyle}"
                                                    Background="#FF38A169"
                                                    Padding="12,6"
                                                    FontSize="12"
                                                    IsEnabled="{Binding IsEnabled}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <!-- Empty State -->
                    <Border Background="#FF1A202C" 
                            CornerRadius="8" 
                            Padding="32" 
                            Margin="0,24,0,0"
                            Visibility="{Binding HasNoModules, Converter={StaticResource BoolToVisibilityConverter}}">
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="ðŸ”" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                            <TextBlock Text="No Discovery Modules Found" 
                                       FontSize="18" FontWeight="SemiBold" 
                                       Foreground="#FFE2E8F0" 
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,8"/>
                            <TextBlock Text="Check that discovery modules are properly configured and enabled" 
                                       FontSize="14" 
                                       Foreground="#FFA0AEC0" 
                                       HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>