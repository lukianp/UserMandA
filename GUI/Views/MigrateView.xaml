<UserControl x:Class="MandADiscoverySuite.Views.MigrateView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1200"
             Background="#FF0F1419">
    
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        
        <!-- ShareGate-inspired Styles -->
        <Style x:Key="MigrationCard" TargetType="Border">
            <Setter Property="Background" Value="#FF1A202C"/>
            <Setter Property="BorderBrush" Value="#FF2D3748"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" Opacity="0.2" ShadowDepth="2" BlurRadius="8"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="#FF3B82F6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="6" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF2563EB"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF1D4ED8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#FF6B7280"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#FF60A5FA"/>
            <Setter Property="BorderBrush" Value="#FF60A5FA"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF1E3A8A"/>
                                <Setter Property="BorderBrush" Value="#FF3B82F6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="MetricCard" TargetType="Border">
            <Setter Property="Background" Value="#FF1E293B"/>
            <Setter Property="BorderBrush" Value="#FF334155"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="8"/>
        </Style>
        
        <Style x:Key="TabButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource SecondaryTextBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border Background="{TemplateBinding Background}" 
                                    CornerRadius="6,6,0,0" 
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <Rectangle Name="ActiveIndicator" 
                                     Height="3" 
                                     Fill="#FF3B82F6" 
                                     VerticalAlignment="Bottom" 
                                     Visibility="Collapsed"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="#FFE2E8F0"/>
                                <Setter Property="Background" Value="#FF2D3748"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="Active">
                                <Setter Property="Foreground" Value="#FFE2E8F0"/>
                                <Setter Property="Background" Value="#FF1A202C"/>
                                <Setter TargetName="ActiveIndicator" Property="Visibility" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#FF1A202C" BorderBrush="#FF2D3748" BorderThickness="0,0,0,1" Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Migration Orchestrator" 
                               FontSize="28" 
                               FontWeight="Bold"
                               Foreground="#FFE2E8F0"/>
                    <TextBlock Text="Enterprise migration planning, execution, and monitoring" 
                               FontSize="14" 
                               Foreground="{StaticResource SecondaryTextBrush}" 
                               Margin="0,4,0,0"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="📝 New Project" 
                            Command="{Binding NewProjectCommand}" 
                            Style="{StaticResource PrimaryButton}" 
                            Margin="0,0,8,0"/>
                    <Button Content="📂 Load Project" 
                            Command="{Binding LoadProjectCommand}" 
                            Style="{StaticResource SecondaryButton}"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Tab Navigation -->
        <Border Grid.Row="1" Background="#FF1A202C" BorderBrush="#FF2D3748" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal" Margin="24,0">
                <Button Content="📊 Dashboard" 
                        Command="{Binding SwitchTabCommand}" 
                        CommandParameter="Dashboard"
                        Style="{StaticResource TabButton}"
                        Tag="{Binding DashboardTabActive}"/>
                <Button Content="🔍 Discovery" 
                        Command="{Binding SwitchTabCommand}" 
                        CommandParameter="Discovery"
                        Style="{StaticResource TabButton}"
                        Tag="{Binding DiscoveryTabActive}"/>
                <Button Content="⚙️ Configuration" 
                        Command="{Binding SwitchTabCommand}" 
                        CommandParameter="Configuration"
                        Style="{StaticResource TabButton}"
                        Tag="{Binding ConfigurationTabActive}"/>
                <Button Content="🎯 Planning" 
                        Command="{Binding SwitchTabCommand}" 
                        CommandParameter="Planning"
                        Style="{StaticResource TabButton}"
                        Tag="{Binding PlanningTabActive}"/>
                <Button Content="🚀 Execution" 
                        Command="{Binding SwitchTabCommand}" 
                        CommandParameter="Execution"
                        Style="{StaticResource TabButton}"
                        Tag="{Binding ExecutionTabActive}"/>
                <Button Content="✅ Validation" 
                        Command="{Binding SwitchTabCommand}" 
                        CommandParameter="Validation"
                        Style="{StaticResource TabButton}"
                        Tag="{Binding ValidationTabActive}"/>
                <Button Content="📈 Reporting" 
                        Command="{Binding SwitchTabCommand}" 
                        CommandParameter="Reporting"
                        Style="{StaticResource TabButton}"
                        Tag="{Binding ReportingTabActive}"/>
            </StackPanel>
        </Border>
        
        <!-- Loading Indicator -->
        <Grid Grid.Row="2" 
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border Background="#AA000000"/>
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar Width="200" Height="6" IsIndeterminate="True" 
                           Foreground="#FF3B82F6" Background="#FF2D3748" 
                           BorderThickness="0" Margin="0,0,0,16"/>
                <TextBlock Text="{Binding LoadingMessage}" 
                           FontSize="16" 
                           Foreground="#FFE2E8F0" 
                           HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
        
        <!-- Dashboard Tab -->
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Visibility="{Binding IsDashboardTabVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel Margin="24">
                
                <!-- Dashboard Metrics -->
                <TextBlock Text="Overview" 
                           FontSize="22" 
                           FontWeight="SemiBold" 
                           Foreground="#FFE2E8F0" 
                           Margin="0,0,0,16"/>
                
                <UniformGrid Columns="4" Margin="0,0,0,24">
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding Metrics.TotalProjects}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#FF60A5FA"/>
                            <TextBlock Text="Total Projects" 
                                       FontSize="14" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding Metrics.ActiveMigrations}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#FF10B981"/>
                            <TextBlock Text="Active Migrations" 
                                       FontSize="14" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding Metrics.CompletedMigrations}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#FF34D399"/>
                            <TextBlock Text="Completed" 
                                       FontSize="14" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding Metrics.OverallCompletionPercentage, StringFormat={}{0:F1}%}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#FFF59E0B"/>
                            <TextBlock Text="Overall Progress" 
                                       FontSize="14" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                </UniformGrid>
                
                <!-- Active Migrations -->
                <TextBlock Text="Active Migrations" 
                           FontSize="22" 
                           FontWeight="SemiBold" 
                           Foreground="#FFE2E8F0" 
                           Margin="0,0,0,16"/>
                
                <Border Style="{StaticResource MigrationCard}">
                    <DataGrid ItemsSource="{Binding ActiveMigrations}" 
                              AutoGenerateColumns="False" 
                              CanUserAddRows="False" 
                              CanUserDeleteRows="False" 
                              IsReadOnly="True"
                              GridLinesVisibility="None"
                              Background="Transparent"
                              Foreground="#FFE2E8F0"
                              HeadersVisibility="Column"
                              RowBackground="Transparent"
                              AlternatingRowBackground="#FF2A3441">
                        
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Project" Binding="{Binding ProjectName}" Width="200"/>
                            <DataGridTextColumn Header="Wave" Binding="{Binding WaveName}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding MigrationType}" Width="120"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTemplateColumn Header="Progress" Width="200">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <ProgressBar Value="{Binding CompletionPercentage}" 
                                                       Maximum="100" 
                                                       Height="20" 
                                                       Foreground="#FF3B82F6" 
                                                       Background="#FF2D3748"/>
                                            <TextBlock Text="{Binding CompletionPercentage, StringFormat={}{0:F1}%}" 
                                                     HorizontalAlignment="Center" 
                                                     VerticalAlignment="Center" 
                                                     FontSize="12" 
                                                     FontWeight="Bold" 
                                                     Foreground="White"/>
                                        </Grid>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Started" Binding="{Binding StartTime, StringFormat=yyyy-MM-dd HH:mm}" Width="120"/>
                            <DataGridTextColumn Header="ETA" Binding="{Binding EstimatedCompletion, StringFormat=yyyy-MM-dd HH:mm}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
                
                <!-- Quick Actions -->
                <TextBlock Text="Quick Actions" 
                           FontSize="22" 
                           FontWeight="SemiBold" 
                           Foreground="#FFE2E8F0" 
                           Margin="0,24,0,16"/>
                
                <UniformGrid Columns="3">
                    <Button Content="🚀 Start Next Wave" 
                            Command="{Binding StartNextWaveCommand}" 
                            Style="{StaticResource PrimaryButton}" 
                            Margin="8"/>
                    <Button Content="⏸️ Pause All" 
                            Command="{Binding PauseAllCommand}" 
                            Style="{StaticResource SecondaryButton}" 
                            Margin="8"/>
                    <Button Content="📊 Generate Report" 
                            Command="{Binding GenerateReportCommand}" 
                            Style="{StaticResource SecondaryButton}" 
                            Margin="8"/>
                </UniformGrid>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Discovery Tab -->
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Visibility="{Binding IsDiscoveryTabVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel Margin="24">
                
                <!-- Discovery Overview -->
                <TextBlock Text="Environment Discovery" 
                           FontSize="22" 
                           FontWeight="SemiBold" 
                           Foreground="#FFE2E8F0" 
                           Margin="0,0,0,16"/>
                
                <!-- Environment Scanning -->
                <Border Style="{StaticResource MigrationCard}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                            <TextBlock Text="🔍 Environment Scanning" 
                                       FontSize="18" 
                                       FontWeight="SemiBold" 
                                       Foreground="#FFE2E8F0" 
                                       VerticalAlignment="Center"/>
                            <Button Content="Start Discovery" 
                                    Command="{Binding StartDiscoveryCommand}" 
                                    Style="{StaticResource PrimaryButton}" 
                                    Margin="16,0,0,0"/>
                        </StackPanel>
                        
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Source Environment -->
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <TextBlock Text="Source Environment" 
                                           FontSize="14" 
                                           FontWeight="SemiBold" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding SourceEnvironmentTypes}" 
                                          SelectedItem="{Binding SelectedSourceEnvironment}" 
                                          Margin="0,0,0,8"
                                          Background="#FF2D3748" 
                                          Foreground="#FFE2E8F0" 
                                          BorderBrush="#FF4A5568"/>
                                <TextBox Text="{Binding SourceConnectionString}" 
                                         Background="#FF2D3748" 
                                         Foreground="#FFE2E8F0" 
                                         BorderBrush="#FF4A5568" 
                                         Margin="0,0,0,8"/>
                                <Button Content="Test Connection" 
                                        Command="{Binding TestSourceConnectionCommand}" 
                                        Style="{StaticResource SecondaryButton}"/>
                            </StackPanel>
                            
                            <!-- Target Environment -->
                            <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                <TextBlock Text="Target Environment" 
                                           FontSize="14" 
                                           FontWeight="SemiBold" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding TargetEnvironmentTypes}" 
                                          SelectedItem="{Binding SelectedTargetEnvironment}" 
                                          Margin="0,0,0,8"
                                          Background="#FF2D3748" 
                                          Foreground="#FFE2E8F0" 
                                          BorderBrush="#FF4A5568"/>
                                <TextBox Text="{Binding TargetConnectionString}" 
                                         Background="#FF2D3748" 
                                         Foreground="#FFE2E8F0" 
                                         BorderBrush="#FF4A5568" 
                                         Margin="0,0,0,8"/>
                                <Button Content="Test Connection" 
                                        Command="{Binding TestTargetConnectionCommand}" 
                                        Style="{StaticResource SecondaryButton}"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                </Border>
                
                <!-- Discovery Results -->
                <TextBlock Text="Discovery Results" 
                           FontSize="18" 
                           FontWeight="SemiBold" 
                           Foreground="#FFE2E8F0" 
                           Margin="0,24,0,16"/>
                
                <UniformGrid Columns="4" Margin="0,0,0,16">
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding DiscoveryMetrics.UserCount}" 
                                       FontSize="24" 
                                       FontWeight="Bold" 
                                       Foreground="#FF60A5FA"/>
                            <TextBlock Text="Users Found" 
                                       FontSize="12" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding DiscoveryMetrics.MailboxCount}" 
                                       FontSize="24" 
                                       FontWeight="Bold" 
                                       Foreground="#FF10B981"/>
                            <TextBlock Text="Mailboxes" 
                                       FontSize="12" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding DiscoveryMetrics.FileShareCount}" 
                                       FontSize="24" 
                                       FontWeight="Bold" 
                                       Foreground="#FF34D399"/>
                            <TextBlock Text="File Shares" 
                                       FontSize="12" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource MetricCard}">
                        <StackPanel>
                            <TextBlock Text="{Binding DiscoveryMetrics.DependencyCount}" 
                                       FontSize="24" 
                                       FontWeight="Bold" 
                                       Foreground="#FFF59E0B"/>
                            <TextBlock Text="Dependencies" 
                                       FontSize="12" 
                                       Foreground="{StaticResource SecondaryTextBrush}"/>
                        </StackPanel>
                    </Border>
                </UniformGrid>
                
                <!-- Dependency Analysis -->
                <Border Style="{StaticResource MigrationCard}">
                    <StackPanel>
                        <TextBlock Text="🔗 Dependency Analysis" 
                                   FontSize="16" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        <DataGrid ItemsSource="{Binding DiscoveredDependencies}" 
                                  AutoGenerateColumns="False" 
                                  CanUserAddRows="False" 
                                  CanUserDeleteRows="False" 
                                  IsReadOnly="True"
                                  GridLinesVisibility="None"
                                  Background="Transparent"
                                  Foreground="#FFE2E8F0"
                                  HeadersVisibility="Column"
                                  RowBackground="Transparent"
                                  AlternatingRowBackground="#FF2A3441"
                                  MaxHeight="300">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="200"/>
                                <DataGridTextColumn Header="Target" Binding="{Binding Target}" Width="200"/>
                                <DataGridTextColumn Header="Type" Binding="{Binding DependencyType}" Width="120"/>
                                <DataGridTextColumn Header="Complexity" Binding="{Binding Complexity}" Width="100"/>
                                <DataGridTextColumn Header="Risk Level" Binding="{Binding RiskLevel}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Configuration Tab -->
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Visibility="{Binding IsConfigurationTabVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel Margin="24">
                
                <!-- Migration Type Selection -->
                <TextBlock Text="Migration Configuration" 
                           FontSize="22" 
                           FontWeight="SemiBold" 
                           Foreground="#FFE2E8F0" 
                           Margin="0,0,0,16"/>

                <!-- Source and Target Environment Selection -->
                <Border Style="{StaticResource MigrationCard}">
                    <StackPanel>
                        <TextBlock Text="🌐 Source and Target Environment Selection" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Source Environment -->
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Source Environment" 
                                           FontSize="14" 
                                           FontWeight="Medium" 
                                           Foreground="#FFE2E8F0" 
                                           Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding SourceProfiles}"
                                          SelectedItem="{Binding SelectedSourceProfile}"
                                          DisplayMemberPath="CompanyName"
                                          Background="#FF2D3748" 
                                          Foreground="#FFE2E8F0" 
                                          BorderBrush="#FF4A5568"
                                          Height="32"
                                          Margin="0,0,0,8"/>
                                <TextBlock Text="{Binding SelectedSourceProfile.CompanyName, StringFormat='Source: {0}'}" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           Margin="0,0,0,0"/>
                            </StackPanel>
                            
                            <!-- Arrow -->
                            <TextBlock Grid.Column="1" 
                                       Text="→" 
                                       FontSize="24" 
                                       FontWeight="Bold" 
                                       Foreground="#FF60A5FA" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"/>
                            
                            <!-- Target Environment -->
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Target Environment" 
                                           FontSize="14" 
                                           FontWeight="Medium" 
                                           Foreground="#FFE2E8F0" 
                                           Margin="0,0,0,8"/>
                                <ComboBox ItemsSource="{Binding TargetProfiles}"
                                          SelectedItem="{Binding SelectedTargetProfile}"
                                          DisplayMemberPath="Name"
                                          Background="#FF2D3748" 
                                          Foreground="#FFE2E8F0" 
                                          BorderBrush="#FF4A5568"
                                          Height="32"
                                          Margin="0,0,0,8"/>
                                <TextBlock Text="{Binding SelectedTargetProfile.Name, StringFormat='Target: {0}'}" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           Margin="0,0,0,0"/>
                            </StackPanel>
                        </Grid>
                        
                        <!-- Environment Status -->
                        <Grid Margin="0,8,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" Background="#FF1E3A8A" CornerRadius="4" Padding="8,4">
                                <TextBlock Text="Source Ready" FontSize="12" Foreground="White" HorizontalAlignment="Center"/>
                            </Border>
                            
                            <Border Grid.Column="2" Background="#FF059669" CornerRadius="4" Padding="8,4">
                                <TextBlock Text="Target Ready" FontSize="12" Foreground="White" HorizontalAlignment="Center"/>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="📋 Migration Type Selection" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <UniformGrid Columns="3" Margin="0,0,0,16">
                            <CheckBox Content="Exchange Mailboxes" 
                                      IsChecked="{Binding IsExchangeMigrationEnabled}" 
                                      Foreground="#FFE2E8F0" 
                                      Margin="8"/>
                            <CheckBox Content="SharePoint Sites" 
                                      IsChecked="{Binding IsSharePointMigrationEnabled}" 
                                      Foreground="#FFE2E8F0" 
                                      Margin="8"/>
                            <CheckBox Content="File Systems" 
                                      IsChecked="{Binding IsFileSystemMigrationEnabled}" 
                                      Foreground="#FFE2E8F0" 
                                      Margin="8"/>
                            <CheckBox Content="Virtual Machines" 
                                      IsChecked="{Binding IsVMMigrationEnabled}" 
                                      Foreground="#FFE2E8F0" 
                                      Margin="8"/>
                            <CheckBox Content="User Profiles" 
                                      IsChecked="{Binding IsUserProfileMigrationEnabled}" 
                                      Foreground="#FFE2E8F0" 
                                      Margin="8"/>
                            <CheckBox Content="Security Groups" 
                                      IsChecked="{Binding IsSecurityGroupMigrationEnabled}" 
                                      Foreground="#FFE2E8F0" 
                                      Margin="8"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>
                
                <!-- Migration Policies -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="📝 Migration Policies" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <CheckBox Content="Enable Rollback" 
                                          IsChecked="{Binding MigrationSettings.EnableRollback}" 
                                          Foreground="#FFE2E8F0" 
                                          Margin="0,0,0,8"/>
                                <CheckBox Content="Validate Before Migration" 
                                          IsChecked="{Binding MigrationSettings.ValidateBeforeMigration}" 
                                          Foreground="#FFE2E8F0" 
                                          Margin="0,0,0,8"/>
                                <CheckBox Content="Preserve Permissions" 
                                          IsChecked="{Binding MigrationSettings.PreservePermissions}" 
                                          Foreground="#FFE2E8F0" 
                                          Margin="0,0,0,8"/>
                                <CheckBox Content="Pause on Error" 
                                          IsChecked="{Binding MigrationSettings.PauseOnError}" 
                                          Foreground="#FFE2E8F0" 
                                          Margin="0,0,0,8"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="Max Concurrent Migrations:" 
                                               Foreground="#FFE2E8F0" 
                                               VerticalAlignment="Center" 
                                               Margin="0,0,8,0"/>
                                    <TextBox Text="{Binding MigrationSettings.MaxConcurrentMigrations}" 
                                             Width="60" 
                                             Background="#FF2D3748" 
                                             Foreground="#FFE2E8F0" 
                                             BorderBrush="#FF4A5568"/>
                                </StackPanel>
                                
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="Retry Attempts:" 
                                               Foreground="#FFE2E8F0" 
                                               VerticalAlignment="Center" 
                                               Margin="0,0,8,0"/>
                                    <TextBox Text="{Binding MigrationSettings.RetryAttempts}" 
                                             Width="60" 
                                             Background="#FF2D3748" 
                                             Foreground="#FFE2E8F0" 
                                             BorderBrush="#FF4A5568"/>
                                </StackPanel>
                                
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="Notification Email:" 
                                               Foreground="#FFE2E8F0" 
                                               VerticalAlignment="Center" 
                                               Margin="0,0,8,0"/>
                                    <TextBox Text="{Binding MigrationSettings.NotificationEmail}" 
                                             Width="200" 
                                             Background="#FF2D3748" 
                                             Foreground="#FFE2E8F0" 
                                             BorderBrush="#FF4A5568"/>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Planning Tab -->
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Visibility="{Binding IsPlanningTabVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel Margin="24">
                
                <!-- Planning Overview -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" 
                               Text="Migration Planning &amp; Wave Management" 
                               FontSize="22" 
                               FontWeight="SemiBold" 
                               Foreground="#FFE2E8F0" 
                               Margin="0,0,0,16"/>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Content="📊 Generate Waves" 
                                Command="{Binding GenerateWavesCommand}" 
                                Style="{StaticResource PrimaryButton}" 
                                Margin="0,0,8,0"/>
                        <Button Content="📧 Exchange Planning" 
                                Command="{Binding NavigateToExchangePlanningCommand}" 
                                Style="{StaticResource PrimaryButton}" 
                                Background="#FF059669"
                                Margin="0,0,8,0"/>
                        <Button Content="📄 SharePoint Planning" 
                                Command="{Binding NavigateToSharePointPlanningCommand}" 
                                Style="{StaticResource PrimaryButton}" 
                                Background="#FF0891B2"
                                Margin="0,0,8,0"/>
                        <Button Content="📁 OneDrive Planning" 
                                Command="{Binding NavigateToOneDrivePlanningCommand}" 
                                Style="{StaticResource PrimaryButton}" 
                                Background="#FF1B4392"
                                Margin="0,0,8,0"/>
                        <Button Content="👥 Teams Planning" 
                                Command="{Binding NavigateToTeamsPlanningCommand}" 
                                Style="{StaticResource PrimaryButton}" 
                                Background="#FF6264A7"
                                Margin="0,0,8,0"/>
                        <Button Content="💾 Save Plan" 
                                Command="{Binding SavePlanCommand}" 
                                Style="{StaticResource SecondaryButton}"/>
                    </StackPanel>
                </Grid>
                
                <!-- Wave Summary -->
                <Border Style="{StaticResource MigrationCard}">
                    <StackPanel>
                        <TextBlock Text="🌊 Wave Summary" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <UniformGrid Columns="4">
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding PlanningMetrics.TotalWaves}" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="#FF60A5FA" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Total Waves" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding PlanningMetrics.TotalItems}" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="#FF10B981" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Items to Migrate" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding PlanningMetrics.EstimatedDuration, StringFormat={}{0:dd\\:hh\\:mm}}" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="#FF34D399" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Estimated Duration" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding PlanningMetrics.ComplexityScore}" 
                                           FontSize="20" 
                                           FontWeight="Bold" 
                                           Foreground="#FFF59E0B" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Complexity Score" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </UniformGrid>
                    </StackPanel>
                </Border>
                
                <!-- Wave Configuration -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" 
                                       Text="🔄 Migration Waves" 
                                       FontSize="18" 
                                       FontWeight="SemiBold" 
                                       Foreground="#FFE2E8F0" 
                                       Margin="0,0,0,16"/>
                            
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button Content="+ Add Wave" 
                                        Command="{Binding AddWaveCommand}" 
                                        Style="{StaticResource SecondaryButton}" 
                                        Margin="0,0,8,0"/>
                                <Button Content="📋 Batch Generator" 
                                        Command="{Binding OpenBatchGeneratorCommand}" 
                                        Style="{StaticResource SecondaryButton}"/>
                            </StackPanel>
                        </Grid>
                        
                        <DataGrid ItemsSource="{Binding MigrationWaves}" 
                                  SelectedItem="{Binding SelectedWave}" 
                                  AutoGenerateColumns="False" 
                                  CanUserAddRows="False" 
                                  CanUserDeleteRows="False" 
                                  GridLinesVisibility="None"
                                  Background="Transparent"
                                  Foreground="#FFE2E8F0"
                                  HeadersVisibility="Column"
                                  RowBackground="Transparent"
                                  AlternatingRowBackground="#FF2A3441"
                                  MaxHeight="300">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Wave" Binding="{Binding Name}" Width="150"/>
                                <DataGridTextColumn Header="Order" Binding="{Binding Order}" Width="60"/>
                                <DataGridTextColumn Header="Items" Binding="{Binding TotalItems}" Width="80"/>
                                <DataGridTextColumn Header="Planned Start" Binding="{Binding PlannedStartDate, StringFormat=yyyy-MM-dd}" Width="120"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTemplateColumn Header="Progress" Width="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <ProgressBar Value="{Binding ProgressPercentage}" 
                                                           Maximum="100" 
                                                           Height="16" 
                                                           Foreground="#FF3B82F6" 
                                                           Background="#FF2D3748"/>
                                                <TextBlock Text="{Binding ProgressPercentage, StringFormat={}{0:F1}%}" 
                                                         HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center" 
                                                         FontSize="10" 
                                                         FontWeight="Bold" 
                                                         Foreground="White"/>
                                            </Grid>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Actions" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="✏️" 
                                                        Command="{Binding DataContext.EditWaveCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                        CommandParameter="{Binding}" 
                                                        Style="{StaticResource SecondaryButton}" 
                                                        Margin="2"
                                                        Padding="6,2"/>
                                                <Button Content="🗑️" 
                                                        Command="{Binding DataContext.DeleteWaveCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                        CommandParameter="{Binding}" 
                                                        Style="{StaticResource SecondaryButton}" 
                                                        Margin="2"
                                                        Padding="6,2"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
                <!-- Wave Details -->
                <Border Style="{StaticResource MigrationCard}" 
                        Margin="0,16,0,0"
                        Visibility="{Binding HasSelectedWave, Converter={StaticResource BoolToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock Text="{Binding SelectedWave.Name, StringFormat=🔍 Wave Details: {0}}" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Wave Info -->
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <TextBlock Text="Wave Information" 
                                           FontSize="14" 
                                           FontWeight="SemiBold" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           Margin="0,0,0,8"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Order:" Foreground="{StaticResource SecondaryTextBrush}" Margin="0,0,8,4"/>
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedWave.Order}" Foreground="#FFE2E8F0" Margin="0,0,0,4"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Status:" Foreground="{StaticResource SecondaryTextBrush}" Margin="0,0,8,4"/>
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedWave.Status}" Foreground="#FFE2E8F0" Margin="0,0,0,4"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Start Date:" Foreground="{StaticResource SecondaryTextBrush}" Margin="0,0,8,4"/>
                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedWave.PlannedStartDate, StringFormat=yyyy-MM-dd HH:mm}" Foreground="#FFE2E8F0" Margin="0,0,0,4"/>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="Items:" Foreground="{StaticResource SecondaryTextBrush}" Margin="0,0,8,4"/>
                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedWave.TotalItems}" Foreground="#FFE2E8F0" Margin="0,0,0,4"/>
                                </Grid>
                            </StackPanel>
                            
                            <!-- Prerequisites -->
                            <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                <TextBlock Text="Prerequisites" 
                                           FontSize="14" 
                                           FontWeight="SemiBold" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           Margin="0,0,0,8"/>
                                
                                <ListBox ItemsSource="{Binding SelectedWave.Prerequisites}" 
                                         Background="Transparent" 
                                         BorderThickness="0" 
                                         Foreground="#FFE2E8F0" 
                                         MaxHeight="100"/>
                            </StackPanel>
                        </Grid>
                        
                        <!-- Batch Details -->
                        <TextBlock Text="Migration Batches" 
                                   FontSize="14" 
                                   FontWeight="SemiBold" 
                                   Foreground="{StaticResource SecondaryTextBrush}" 
                                   Margin="0,16,0,8"/>
                        
                        <DataGrid ItemsSource="{Binding SelectedWave.Batches}" 
                                  AutoGenerateColumns="False" 
                                  CanUserAddRows="False" 
                                  CanUserDeleteRows="False" 
                                  GridLinesVisibility="None"
                                  Background="Transparent"
                                  Foreground="#FFE2E8F0"
                                  HeadersVisibility="Column"
                                  RowBackground="Transparent"
                                  AlternatingRowBackground="#FF2A3441"
                                  MaxHeight="200">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Batch" Binding="{Binding Name}" Width="150"/>
                                <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120"/>
                                <DataGridTextColumn Header="Items" Binding="{Binding TotalItems}" Width="80"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTemplateColumn Header="Progress" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <ProgressBar Value="{Binding ProgressPercentage}" 
                                                           Maximum="100" 
                                                           Height="14" 
                                                           Foreground="#FF3B82F6" 
                                                           Background="#FF2D3748"/>
                                                <TextBlock Text="{Binding ProgressPercentage, StringFormat={}{0:F0}%}" 
                                                         HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center" 
                                                         FontSize="9" 
                                                         FontWeight="Bold" 
                                                         Foreground="White"/>
                                            </Grid>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Execution Tab -->
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Visibility="{Binding IsExecutionTabVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel Margin="24">
                
                <!-- Execution Overview -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" 
                               Text="Migration Execution &amp; Monitoring" 
                               FontSize="22" 
                               FontWeight="SemiBold" 
                               Foreground="#FFE2E8F0" 
                               Margin="0,0,0,16"/>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Content="▶️ Start All" 
                                Command="{Binding StartAllExecutionCommand}" 
                                Style="{StaticResource PrimaryButton}" 
                                Margin="0,0,8,0"/>
                        <Button Content="⏸️ Pause All" 
                                Command="{Binding PauseAllExecutionCommand}" 
                                Style="{StaticResource SecondaryButton}" 
                                Margin="0,0,8,0"/>
                        <Button Content="🔄 Refresh" 
                                Command="{Binding RefreshExecutionCommand}" 
                                Style="{StaticResource SecondaryButton}"/>
                    </StackPanel>
                </Grid>
                
                <!-- Real-time Metrics -->
                <Border Style="{StaticResource MigrationCard}">
                    <StackPanel>
                        <TextBlock Text="📈 Real-time Execution Metrics" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <UniformGrid Columns="5">
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ExecutionMetrics.ActiveStreams}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FF60A5FA" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Active Streams" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ExecutionMetrics.ItemsPerMinute}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FF10B981" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Items/Min" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ExecutionMetrics.DataThroughputMBps, StringFormat={}{0:F1} MB/s}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FF34D399" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Throughput" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ExecutionMetrics.ErrorCount}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FFEF4444" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Errors" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ExecutionMetrics.EtaMinutes, StringFormat={}{0:F0} min}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FFF59E0B" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="ETA" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </UniformGrid>
                    </StackPanel>
                </Border>
                
                <!-- Active Migration Streams -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="🌊 Active Migration Streams" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <DataGrid ItemsSource="{Binding ActiveMigrationStreams}" 
                                  AutoGenerateColumns="False" 
                                  CanUserAddRows="False" 
                                  CanUserDeleteRows="False" 
                                  GridLinesVisibility="None"
                                  Background="Transparent"
                                  Foreground="#FFE2E8F0"
                                  HeadersVisibility="Column"
                                  RowBackground="Transparent"
                                  AlternatingRowBackground="#FF2A3441"
                                  MaxHeight="300">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Stream" Binding="{Binding StreamId}" Width="80"/>
                                <DataGridTextColumn Header="Wave" Binding="{Binding WaveName}" Width="100"/>
                                <DataGridTextColumn Header="Batch" Binding="{Binding BatchName}" Width="120"/>
                                <DataGridTextColumn Header="Type" Binding="{Binding MigrationType}" Width="100"/>
                                <DataGridTextColumn Header="Current Item" Binding="{Binding CurrentItem}" Width="200"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTemplateColumn Header="Progress" Width="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <ProgressBar Value="{Binding ProgressPercentage}" 
                                                           Maximum="100" 
                                                           Height="16" 
                                                           Foreground="#FF3B82F6" 
                                                           Background="#FF2D3748"/>
                                                <TextBlock Text="{Binding ProgressPercentage, StringFormat={}{0:F1}%}" 
                                                         HorizontalAlignment="Center" 
                                                         VerticalAlignment="Center" 
                                                         FontSize="10" 
                                                         FontWeight="Bold" 
                                                         Foreground="White"/>
                                            </Grid>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Rate" Binding="{Binding ItemsPerMinute, StringFormat={}{0:F1}/min}" Width="80"/>
                                <DataGridTextColumn Header="ETA" Binding="{Binding EstimatedCompletion, StringFormat=HH:mm}" Width="60"/>
                                <DataGridTemplateColumn Header="Actions" Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="⏸️" 
                                                        Command="{Binding DataContext.PauseStreamCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                        CommandParameter="{Binding}" 
                                                        Style="{StaticResource SecondaryButton}" 
                                                        Margin="2"
                                                        Padding="4,2"/>
                                                <Button Content="📊" 
                                                        Command="{Binding DataContext.ViewStreamDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                        CommandParameter="{Binding}" 
                                                        Style="{StaticResource SecondaryButton}" 
                                                        Margin="2"
                                                        Padding="4,2"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
                <!-- Performance Chart Placeholder -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="📉 Performance Trends" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <Grid Height="200">
                            <!-- Placeholder for charts - would integrate with a charting library -->
                            <Border Background="#FF2D3748" 
                                    BorderBrush="#FF4A5568" 
                                    BorderThickness="1" 
                                    CornerRadius="4">
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <TextBlock Text="Performance Chart" 
                                               FontSize="16" 
                                               Foreground="{StaticResource SecondaryTextBrush}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Real-time throughput and error rate tracking" 
                                               FontSize="12" 
                                               Foreground="#FF718096" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- Recent Events Log -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="📜 Recent Events" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <ListBox ItemsSource="{Binding RecentExecutionEvents}" 
                                 Background="Transparent" 
                                 BorderThickness="0" 
                                 MaxHeight="200"
                                 ScrollViewer.VerticalScrollBarVisibility="Auto">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#FF2A3441" 
                                            BorderBrush="#FF4A5568" 
                                            BorderThickness="0,0,0,1" 
                                            Padding="12,8">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Column="0" 
                                                       Text="{Binding EventType}" 
                                                       FontWeight="SemiBold" 
                                                       Foreground="{Binding EventColor}" 
                                                       Margin="0,0,12,0"/>
                                            
                                            <TextBlock Grid.Column="1" 
                                                       Text="{Binding Message}" 
                                                       Foreground="#FFE2E8F0" 
                                                       TextWrapping="Wrap"/>
                                            
                                            <TextBlock Grid.Column="2" 
                                                       Text="{Binding Timestamp, StringFormat=HH:mm:ss}" 
                                                       Foreground="{StaticResource SecondaryTextBrush}" 
                                                       FontSize="11"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Validation Tab -->
        <ScrollViewer Grid.Row="2" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled"
                      Visibility="{Binding IsValidationTabVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel Margin="24">
                
                <!-- Validation Overview -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" 
                               Text="Migration Validation &amp; Quality Assurance" 
                               FontSize="22" 
                               FontWeight="SemiBold" 
                               Foreground="#FFE2E8F0" 
                               Margin="0,0,0,16"/>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Content="✅ Run Pre-Validation" 
                                Command="{Binding RunPreValidationCommand}" 
                                Style="{StaticResource PrimaryButton}" 
                                Margin="0,0,8,0"/>
                        <Button Content="🔍 Run Post-Validation" 
                                Command="{Binding RunPostValidationCommand}" 
                                Style="{StaticResource SecondaryButton}"/>
                    </StackPanel>
                </Grid>
                
                <!-- Validation Summary -->
                <Border Style="{StaticResource MigrationCard}">
                    <StackPanel>
                        <TextBlock Text="📈 Validation Summary" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <UniformGrid Columns="4">
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ValidationMetrics.TotalChecks}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FF60A5FA" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Total Checks" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ValidationMetrics.PassedChecks}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FF10B981" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Passed" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ValidationMetrics.FailedChecks}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FFEF4444" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Failed" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Margin="8">
                                <TextBlock Text="{Binding ValidationMetrics.SuccessRate, StringFormat={}{0:F1}%}" 
                                           FontSize="24" 
                                           FontWeight="Bold" 
                                           Foreground="#FF34D399" 
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Success Rate" 
                                           FontSize="12" 
                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </UniformGrid>
                    </StackPanel>
                </Border>
                
                <!-- Validation Tests -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="⚙️ Validation Tests" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <DataGrid ItemsSource="{Binding ValidationTests}" 
                                  AutoGenerateColumns="False" 
                                  CanUserAddRows="False" 
                                  CanUserDeleteRows="False" 
                                  GridLinesVisibility="None"
                                  Background="Transparent"
                                  Foreground="#FFE2E8F0"
                                  HeadersVisibility="Column"
                                  RowBackground="Transparent"
                                  AlternatingRowBackground="#FF2A3441"
                                  MaxHeight="300">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Test Category" Binding="{Binding Category}" Width="150"/>
                                <DataGridTextColumn Header="Test Name" Binding="{Binding Name}" Width="250"/>
                                <DataGridTextColumn Header="Type" Binding="{Binding TestType}" Width="100"/>
                                <DataGridTemplateColumn Header="Status" Width="80">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Status}" 
                                                       Foreground="{Binding StatusColor}" 
                                                       FontWeight="SemiBold"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Items Tested" Binding="{Binding ItemsTested}" Width="100"/>
                                <DataGridTextColumn Header="Issues Found" Binding="{Binding IssuesFound}" Width="100"/>
                                <DataGridTextColumn Header="Last Run" Binding="{Binding LastRun, StringFormat=yyyy-MM-dd HH:mm}" Width="120"/>
                                <DataGridTemplateColumn Header="Actions" Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="▶️" 
                                                        Command="{Binding DataContext.RunSingleTestCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                        CommandParameter="{Binding}" 
                                                        Style="{StaticResource SecondaryButton}" 
                                                        Margin="2"
                                                        Padding="4,2"/>
                                                <Button Content="📝" 
                                                        Command="{Binding DataContext.ViewTestDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                        CommandParameter="{Binding}" 
                                                        Style="{StaticResource SecondaryButton}" 
                                                        Margin="2"
                                                        Padding="4,2"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
                <!-- Validation Issues -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="⚠️ Validation Issues" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <DataGrid ItemsSource="{Binding ValidationIssues}" 
                                  AutoGenerateColumns="False" 
                                  CanUserAddRows="False" 
                                  CanUserDeleteRows="False" 
                                  GridLinesVisibility="None"
                                  Background="Transparent"
                                  Foreground="#FFE2E8F0"
                                  HeadersVisibility="Column"
                                  RowBackground="Transparent"
                                  AlternatingRowBackground="#FF2A3441"
                                  MaxHeight="250">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="Severity" Width="80">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Severity}" 
                                                       Foreground="{Binding SeverityColor}" 
                                                       FontWeight="SemiBold"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="120"/>
                                <DataGridTextColumn Header="Item" Binding="{Binding ItemName}" Width="200"/>
                                <DataGridTextColumn Header="Issue" Binding="{Binding Description}" Width="300"/>
                                <DataGridTextColumn Header="Recommended Action" Binding="{Binding RecommendedAction}" Width="250"/>
                                <DataGridTemplateColumn Header="Actions" Width="80">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="🔧" 
                                                    Command="{Binding DataContext.FixIssueCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" 
                                                    CommandParameter="{Binding}" 
                                                    Style="{StaticResource SecondaryButton}" 
                                                    Padding="4,2"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
                <!-- Pre-migration Checklist -->
                <Border Style="{StaticResource MigrationCard}" Margin="0,16,0,0">
                    <StackPanel>
                        <TextBlock Text="📋 Pre-Migration Checklist" 
                                   FontSize="18" 
                                   FontWeight="SemiBold" 
                                   Foreground="#FFE2E8F0" 
                                   Margin="0,0,0,16"/>
                        
                        <ItemsControl ItemsSource="{Binding PreMigrationChecklist}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#FF2A3441" 
                                            BorderBrush="#FF4A5568" 
                                            BorderThickness="0,0,0,1" 
                                            Padding="12,8">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <CheckBox Grid.Column="0" 
                                                      IsChecked="{Binding IsCompleted}" 
                                                      Margin="0,0,12,0"/>
                                            
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="{Binding Title}" 
                                                           FontWeight="SemiBold" 
                                                           Foreground="#FFE2E8F0"/>
                                                <TextBlock Text="{Binding Description}" 
                                                           Foreground="{StaticResource SecondaryTextBrush}" 
                                                           FontSize="12" 
                                                           Margin="0,2,0,0"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Column="2" 
                                                       Text="{Binding Priority}" 
                                                       Foreground="{Binding PriorityColor}" 
                                                       FontWeight="SemiBold" 
                                                       FontSize="11"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- Reporting Tab -->
        <Grid Grid.Row="2" 
              Visibility="{Binding IsReportingTabVisible, Converter={StaticResource BoolToVisibilityConverter}}">
            <TextBlock Text="Reporting tab content - Coming soon" 
                       HorizontalAlignment="Center" 
                       VerticalAlignment="Center" 
                       FontSize="18" 
                       Foreground="{StaticResource SecondaryTextBrush}"/>
        </Grid>
        
        <!-- Error Display -->
        <Border Grid.Row="2" 
                Style="{StaticResource MigrationCard}"
                Visibility="{Binding HasError, Converter={StaticResource BoolToVisibilityConverter}}"
                Background="#FF7F1D1D" 
                BorderBrush="#FFEF4444" 
                VerticalAlignment="Top"
                Margin="24">
            <StackPanel>
                <TextBlock Text="❌ Error" 
                           FontSize="18" 
                           FontWeight="Bold" 
                           Foreground="#FFEF4444" 
                           Margin="0,0,0,8"/>
                <TextBlock Text="{Binding LastError}" 
                           Foreground="#FFFECACA" 
                           TextWrapping="Wrap"/>
                <Button Content="Dismiss" 
                        Command="{Binding DismissErrorCommand}" 
                        Style="{StaticResource SecondaryButton}" 
                        HorizontalAlignment="Right" 
                        Margin="0,12,0,0"/>
            </StackPanel>
        </Border>
        
    </Grid>
</UserControl>