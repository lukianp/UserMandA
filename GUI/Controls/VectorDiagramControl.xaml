<UserControl x:Class="MandADiscoverySuite.Controls.VectorDiagramControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="400">

    <UserControl.Resources>
        <!-- Animation for diagram entrance -->
        <Storyboard x:Key="DiagramEntranceAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.8">
                <DoubleAnimation.EasingFunction>
                    <QuadraticEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                           From="0.8" To="1" Duration="0:0:0.8">
                <DoubleAnimation.EasingFunction>
                    <BackEase EasingMode="EaseOut" Amplitude="0.2"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                           From="0.8" To="1" Duration="0:0:0.8">
                <DoubleAnimation.EasingFunction>
                    <BackEase EasingMode="EaseOut" Amplitude="0.2"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <!-- Hover animation -->
        <Storyboard x:Key="HoverAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                           To="1.05" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                           To="1.05" Duration="0:0:0.2"/>
        </Storyboard>

        <Storyboard x:Key="UnhoverAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                           To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                           To="1" Duration="0:0:0.2"/>
        </Storyboard>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" 
                Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,0,0,1"
                Padding="16,12"
                Margin="0,0,0,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Diagram type icon -->
                <Image Grid.Column="0"
                       x:Name="DiagramIcon"
                       Source="{StaticResource ProcessFlowDiagram}"
                       Width="24" Height="24"
                       Margin="0,0,12,0"/>

                <!-- Title and description -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <TextBlock x:Name="DiagramTitle"
                             Text="Process Flow Diagram"
                             FontSize="16"
                             FontWeight="SemiBold"
                             Foreground="{DynamicResource ForegroundBrush}"/>
                    <TextBlock x:Name="DiagramDescription"
                             Text="Visual representation of process flow"
                             FontSize="12"
                             Foreground="{DynamicResource ForegroundSecondaryBrush}"
                             Margin="0,2,0,0"/>
                </StackPanel>

                <!-- Actions -->
                <StackPanel Grid.Column="2" 
                          Orientation="Horizontal">
                    <Button Content="🔍"
                            Style="{StaticResource FluentIconButtonStyle}"
                            Width="32" Height="32"
                            FontSize="14"
                            ToolTip="Zoom In"
                            Click="ZoomIn_Click"/>
                    <Button Content="🔎"
                            Style="{StaticResource FluentIconButtonStyle}"
                            Width="32" Height="32"
                            FontSize="14"
                            ToolTip="Zoom Out"
                            Margin="4,0,0,0"
                            Click="ZoomOut_Click"/>
                    <Button Content="⟲"
                            Style="{StaticResource FluentIconButtonStyle}"
                            Width="32" Height="32"
                            FontSize="14"
                            ToolTip="Reset Zoom"
                            Margin="4,0,0,0"
                            Click="ResetZoom_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Diagram container -->
        <Border Grid.Row="1"
                Background="{DynamicResource CardBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="8">
            <ScrollViewer x:Name="DiagramScrollViewer"
                         HorizontalScrollBarVisibility="Auto"
                         VerticalScrollBarVisibility="Auto">
                
                <!-- Diagram content -->
                <Grid x:Name="DiagramContainer"
                      Background="Transparent"
                      RenderTransformOrigin="0.5,0.5"
                      MinWidth="400"
                      MinHeight="300">
                    
                    <Grid.RenderTransform>
                        <ScaleTransform/>
                    </Grid.RenderTransform>

                    <!-- Main diagram image -->
                    <Image x:Name="MainDiagram"
                           Source="{StaticResource ProcessFlowDiagram}"
                           Stretch="Uniform"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"/>

                    <!-- Interactive overlay for hotspots -->
                    <Canvas x:Name="InteractiveOverlay"
                            Background="Transparent">
                        
                        <!-- Example hotspots for interactive diagrams -->
                        <Ellipse x:Name="Hotspot1"
                               Width="20" Height="20"
                               Fill="Transparent"
                               Stroke="{DynamicResource AccentBrush}"
                               StrokeThickness="2"
                               Canvas.Left="100" Canvas.Top="50"
                               Visibility="Collapsed"
                               MouseEnter="Hotspot_MouseEnter"
                               MouseLeave="Hotspot_MouseLeave"
                               ToolTip="Process Start Node"/>
                        
                        <Ellipse x:Name="Hotspot2"
                               Width="20" Height="20"
                               Fill="Transparent"
                               Stroke="{DynamicResource AccentBrush}"
                               StrokeThickness="2"
                               Canvas.Left="200" Canvas.Top="50"
                               Visibility="Collapsed"
                               MouseEnter="Hotspot_MouseEnter"
                               MouseLeave="Hotspot_MouseLeave"
                               ToolTip="Data Processing"/>
                        
                        <Ellipse x:Name="Hotspot3"
                               Width="20" Height="20"
                               Fill="Transparent"
                               Stroke="{DynamicResource AccentBrush}"
                               StrokeThickness="2"
                               Canvas.Left="300" Canvas.Top="50"
                               Visibility="Collapsed"
                               MouseEnter="Hotspot_MouseEnter"
                               MouseLeave="Hotspot_MouseLeave"
                               ToolTip="Decision Point"/>
                    </Canvas>
                    
                    <!-- Loading overlay -->
                    <Border x:Name="LoadingOverlay"
                            Background="Black"
                            Opacity="0.3"
                            Visibility="Collapsed">
                        <Grid>
                            <Ellipse Width="40" Height="40"
                                   Stroke="{DynamicResource AccentBrush}"
                                   StrokeThickness="4"
                                   StrokeDashArray="20,4"
                                   RenderTransformOrigin="0.5,0.5">
                                <Ellipse.RenderTransform>
                                    <RotateTransform/>
                                </Ellipse.RenderTransform>
                                <Ellipse.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard RepeatBehavior="Forever">
                                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                                                               From="0" To="360" Duration="0:0:1"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Ellipse.Triggers>
                            </Ellipse>
                            <TextBlock Text="Loading diagram..."
                                     Foreground="White"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Bottom"
                                     Margin="0,0,0,60"/>
                        </Grid>
                    </Border>
                </Grid>
            </ScrollViewer>
        </Border>

        <!-- Footer with controls -->
        <Border Grid.Row="2"
                Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="16,8"
                Margin="0,16,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Zoom level indicator -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Zoom:"
                             FontSize="12"
                             Foreground="{DynamicResource ForegroundSecondaryBrush}"
                             VerticalAlignment="Center"/>
                    <TextBlock x:Name="ZoomLevelText"
                             Text="100%"
                             FontSize="12"
                             FontWeight="SemiBold"
                             Foreground="{DynamicResource AccentBrush}"
                             Margin="4,0,0,0"
                             VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Interactive mode toggle -->
                <StackPanel Grid.Column="1" 
                          Orientation="Horizontal" 
                          HorizontalAlignment="Center">
                    <CheckBox x:Name="InteractiveModeCheckBox"
                            Content="Interactive Mode"
                            FontSize="12"
                            Foreground="{DynamicResource ForegroundSecondaryBrush}"
                            Checked="InteractiveMode_Checked"
                            Unchecked="InteractiveMode_Unchecked"/>
                </StackPanel>

                <!-- Export options -->
                <StackPanel Grid.Column="2" 
                          Orientation="Horizontal">
                    <Button Content="💾"
                            Style="{StaticResource FluentIconButtonStyle}"
                            Width="28" Height="28"
                            FontSize="12"
                            ToolTip="Save as PNG"
                            Click="SaveAsPng_Click"/>
                    <Button Content="📄"
                            Style="{StaticResource FluentIconButtonStyle}"
                            Width="28" Height="28"
                            FontSize="12"
                            ToolTip="Save as PDF"
                            Margin="4,0,0,0"
                            Click="SaveAsPdf_Click"/>
                    <Button Content="📋"
                            Style="{StaticResource FluentIconButtonStyle}"
                            Width="28" Height="28"
                            FontSize="12"
                            ToolTip="Copy to Clipboard"
                            Margin="4,0,0,0"
                            Click="CopyToClipboard_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Animation triggers -->
        <Grid.Triggers>
            <EventTrigger RoutedEvent="Loaded">
                <BeginStoryboard Storyboard="{StaticResource DiagramEntranceAnimation}"/>
            </EventTrigger>
            <EventTrigger RoutedEvent="MouseEnter">
                <BeginStoryboard Storyboard="{StaticResource HoverAnimation}"/>
            </EventTrigger>
            <EventTrigger RoutedEvent="MouseLeave">
                <BeginStoryboard Storyboard="{StaticResource UnhoverAnimation}"/>
            </EventTrigger>
        </Grid.Triggers>
    </Grid>
</UserControl>