<UserControl x:Class="MandADiscoverySuite.Controls.ValidationSummaryPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="120" d:DesignWidth="800">

    <UserControl.Resources>
        <!-- Validation Colors -->
        <SolidColorBrush x:Key="SuccessBrush" Color="#4CAF50"/>
        <SolidColorBrush x:Key="WarningBrush" Color="#FF9800"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#F44336"/>
        <SolidColorBrush x:Key="CriticalBrush" Color="#D32F2F"/>
        <SolidColorBrush x:Key="ValidationBackgroundBrush" Color="#F8F9FA"/>
        <SolidColorBrush x:Key="ValidationBorderBrush" Color="#E1E5E9"/>
    </UserControl.Resources>

    <Border Background="{StaticResource ValidationBackgroundBrush}" 
            BorderBrush="{StaticResource ValidationBorderBrush}" 
            BorderThickness="1" 
            CornerRadius="8" 
            Padding="16"
            Margin="8"
            Visibility="{Binding ShowValidation, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}">
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid Grid.Row="0" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Path Width="16" Height="16" Fill="{StaticResource TextPrimaryBrush}" Margin="0,0,8,0"
                          Data="M12,2C13.1,2 14,2.9 14,4C14,5.1 13.1,6 12,6C10.9,6 10,5.1 10,4C10,2.9 10.9,2 12,2M21,9V7L15,1L9,7V9H3V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V9M19,19H5V11H9V17H11V11H13V17H15V11H19V19Z"/>
                    <TextBlock Text="Migration Validation" FontWeight="SemiBold" FontSize="14" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="View Details" Command="{Binding ShowValidationDetailsCommand}" 
                            Margin="0,0,8,0" Padding="12,6" FontSize="12"
                            Style="{StaticResource {x:Type Button}}"/>
                    <Button Content="âœ•" Command="{Binding HideValidationCommand}" 
                            Width="24" Height="24" Padding="0" FontSize="12"
                            ToolTip="Hide validation panel"/>
                </StackPanel>
            </Grid>

            <!-- Summary Statistics -->
            <Grid Grid.Row="1" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding ValidationSummary.TotalObjects}" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                    <TextBlock Text="Total" FontSize="10" Opacity="0.7" HorizontalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding ValidationSummary.SuccessfulObjects}" FontSize="18" FontWeight="Bold" 
                               Foreground="{StaticResource SuccessBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Success" FontSize="10" Opacity="0.7" HorizontalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding ValidationSummary.WarningObjects}" FontSize="18" FontWeight="Bold" 
                               Foreground="{StaticResource WarningBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Warning" FontSize="10" Opacity="0.7" HorizontalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding ValidationSummary.ErrorObjects}" FontSize="18" FontWeight="Bold" 
                               Foreground="{StaticResource ErrorBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Error" FontSize="10" Opacity="0.7" HorizontalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="4" HorizontalAlignment="Center">
                    <TextBlock Text="{Binding ValidationSummary.CriticalObjects}" FontSize="18" FontWeight="Bold" 
                               Foreground="{StaticResource CriticalBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Critical" FontSize="10" Opacity="0.7" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>

            <!-- Progress Bar and Actions -->
            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Status and Progress -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="{Binding ValidationStatusMessage, FallbackValue='Validation ready'}" 
                               FontSize="12" Opacity="0.8" Margin="0,0,0,4"/>
                    
                    <ProgressBar Height="4" 
                                 Value="{Binding ValidationProgress}" 
                                 Maximum="100"
                                 Visibility="{Binding IsValidating, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="Validate Now" Command="{Binding ValidateCommand}" 
                            Margin="0,0,8,0" Padding="10,6" FontSize="12"
                            IsEnabled="{Binding IsValidating, Converter={StaticResource InvertBooleanConverter}}"/>
                    <Button Content="Rollback Failed" Command="{Binding RollbackFailedCommand}" 
                            Padding="10,6" FontSize="12" Background="{StaticResource ErrorBrush}" Foreground="White"
                            Visibility="{Binding HasFailedValidations, Converter={StaticResource BooleanToVisibilityConverter}}"
                            IsEnabled="{Binding IsValidating, Converter={StaticResource InvertBooleanConverter}}"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Border>
</UserControl>