<Window x:Class="MandADiscoverySuite.Dialogs.PasswordGeneratorDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Password Generator" Height="450" Width="500"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        ResizeMode="NoResize"
        Style="{DynamicResource ThemedWindowStyle}">
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Themes/ThemeStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="Password Generator" 
                       Style="{StaticResource ThemedHeaderTextStyle}"/>
            <TextBlock Text="Generate secure passwords for user accounts" 
                       Style="{StaticResource ThemedSecondaryTextStyle}" Margin="0,4,0,0"/>
        </StackPanel>
        
        <!-- Password Options -->
        <Border Grid.Row="1" Style="{StaticResource ThemedCardStyle}">
            <StackPanel>
                <TextBlock Text="Password Settings" Style="{StaticResource ThemedSubHeaderTextStyle}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Length:" Style="{StaticResource ThemedTextBlockStyle}" VerticalAlignment="Center" Margin="0,0,0,8"/>
                    <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,8">
                        <Slider x:Name="LengthSlider" Minimum="8" Maximum="32" Value="12" Width="200" 
                                ValueChanged="LengthSlider_ValueChanged"/>
                        <TextBlock x:Name="LengthDisplay" Text="12" Foreground="{DynamicResource AccentBrush}" FontWeight="Bold" 
                                   VerticalAlignment="Center" Margin="12,0,0,0"/>
                    </StackPanel>
                    
                    <CheckBox Grid.Row="1" Grid.Column="1" x:Name="UppercaseCheckBox" Content="Uppercase letters (A-Z)" 
                              Style="{StaticResource ThemedCheckBoxStyle}" IsChecked="True" Margin="0,0,0,8" Checked="UpdatePassword" Unchecked="UpdatePassword"/>
                    
                    <CheckBox Grid.Row="2" Grid.Column="1" x:Name="LowercaseCheckBox" Content="Lowercase letters (a-z)" 
                              Style="{StaticResource ThemedCheckBoxStyle}" IsChecked="True" Margin="0,0,0,8" Checked="UpdatePassword" Unchecked="UpdatePassword"/>
                    
                    <CheckBox Grid.Row="3" Grid.Column="1" x:Name="NumbersCheckBox" Content="Numbers (0-9)" 
                              Style="{StaticResource ThemedCheckBoxStyle}" IsChecked="True" Margin="0,0,0,8" Checked="UpdatePassword" Unchecked="UpdatePassword"/>
                    
                    <CheckBox Grid.Row="4" Grid.Column="1" x:Name="SymbolsCheckBox" Content="Special characters (!@#$%)" 
                              Style="{StaticResource ThemedCheckBoxStyle}" IsChecked="True" Margin="0,0,0,8" Checked="UpdatePassword" Unchecked="UpdatePassword"/>
                    
                    <CheckBox Grid.Row="5" Grid.Column="1" x:Name="ExcludeAmbiguousCheckBox" Content="Exclude ambiguous characters (0oO1lI)" 
                              Style="{StaticResource ThemedCheckBoxStyle}" IsChecked="True" Checked="UpdatePassword" Unchecked="UpdatePassword"/>
                </Grid>
            </StackPanel>
        </Border>
        
        <!-- Generated Password -->
        <Border Grid.Row="2" Style="{StaticResource ThemedCardStyle}">
            <StackPanel>
                <TextBlock Text="Generated Password" Style="{StaticResource ThemedSubHeaderTextStyle}"/>
                <Border Background="{DynamicResource InputBackgroundBrush}" CornerRadius="4" Padding="12" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBox x:Name="GeneratedPasswordTextBox" Grid.Column="0" 
                                 Background="Transparent" Foreground="{DynamicResource PrimaryTextBrush}"
                                 BorderThickness="0" FontFamily="Consolas" FontSize="14"
                                 IsReadOnly="True" VerticalAlignment="Center"
                                 Text="SecurePass123!"/>
                        
                        <Button Grid.Column="1" Content="ðŸ“‹" FontSize="16" 
                                Background="Transparent" Foreground="{DynamicResource AccentBrush}"
                                BorderThickness="0" Padding="8,4"
                                Click="CopyPassword_Click" ToolTip="Copy to clipboard"/>
                    </Grid>
                </Border>
            </StackPanel>
        </Border>
        
        <!-- Strength Indicator -->
        <Border Grid.Row="3" Style="{StaticResource ThemedCardStyle}">
            <StackPanel>
                <TextBlock Text="Password Strength" Style="{StaticResource ThemedSubHeaderTextStyle}"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <ProgressBar x:Name="StrengthProgressBar" Grid.Column="0" 
                                 Style="{StaticResource ThemedProgressBarStyle}" Value="85"/>
                    
                    <TextBlock x:Name="StrengthLabel" Grid.Column="1" Text="Strong" 
                               Foreground="{DynamicResource SuccessBrush}" FontWeight="Medium" 
                               VerticalAlignment="Center" Margin="12,0,0,0"/>
                </Grid>
                
                <TextBlock x:Name="StrengthDetails" Text="âœ… Contains uppercase, lowercase, numbers, and symbols" 
                           Style="{StaticResource ThemedSecondaryTextStyle}" Margin="0,8,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- Action Buttons -->
        <WrapPanel Grid.Row="4" Margin="0,0,0,16">
            <Button Content="ðŸŽ² Generate New" Click="GenerateNew_Click" Style="{StaticResource ThemedButtonStyle}"/>
            <Button Content="ðŸ“ Multiple Passwords" Click="GenerateMultiple_Click" Style="{StaticResource ThemedButtonStyle}" Background="{DynamicResource AccentBrush}"/>
            <Button Content="ðŸ’¾ Save to File" Click="SaveToFile_Click" Style="{StaticResource ThemedButtonStyle}" Background="{DynamicResource WarningBrush}"/>
        </WrapPanel>
        
        <!-- Multiple Passwords List -->
        <Border Grid.Row="5" x:Name="MultiplePasswordsPanel" Style="{StaticResource ThemedCardStyle}" Visibility="Collapsed">
            <StackPanel>
                <TextBlock Text="Generated Passwords" Style="{StaticResource ThemedSubHeaderTextStyle}"/>
                <ScrollViewer MaxHeight="120" VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="MultiplePasswordsList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{DynamicResource InputBackgroundBrush}" CornerRadius="4" Padding="8" Margin="0,0,0,4" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0" Text="{Binding}" Foreground="{DynamicResource PrimaryTextBrush}" 
                                                   FontFamily="Consolas" FontSize="12" VerticalAlignment="Center"/>
                                        
                                        <Button Grid.Column="1" Content="ðŸ“‹" FontSize="12" 
                                                Background="Transparent" Foreground="{DynamicResource AccentBrush}"
                                                BorderThickness="0" Padding="4"
                                                Click="CopyIndividualPassword_Click" Tag="{Binding}"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </StackPanel>
        </Border>
        
        <!-- Bottom Buttons -->
        <StackPanel Grid.Row="6" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button Content="Use Password" Click="UsePassword_Click" 
                    Style="{StaticResource ThemedSuccessButtonStyle}"
                    Padding="20,8" Margin="0,0,10,0"/>
            
            <Button Content="Close" Click="Close_Click" 
                    Style="{StaticResource ThemedSecondaryButtonStyle}"
                    Padding="20,8"/>
        </StackPanel>
    </Grid>
</Window>