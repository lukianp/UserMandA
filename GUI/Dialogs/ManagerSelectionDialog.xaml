<Window x:Class="MandADiscoverySuite.Dialogs.ManagerSelectionDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Select Manager" Height="600" Width="800"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        ResizeMode="CanResize"
        Style="{DynamicResource ThemedWindowStyle}">
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/ThemeStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="Select Manager" 
                       Style="{StaticResource ThemedHeaderTextStyle}"/>
            <TextBlock Text="Choose a manager from the available users" 
                       Style="{StaticResource ThemedSecondaryTextStyle}" Margin="0,4,0,0"/>
        </StackPanel>
        
        <!-- Search and Filter Controls -->
        <Border Grid.Row="1" Style="{StaticResource ThemedCardStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Search:" Style="{StaticResource ThemedTextBlockStyle}" Margin="0,0,0,8"/>
                <TextBox Grid.Row="1" Grid.Column="0" x:Name="SearchTextBox" 
                         Style="{StaticResource ThemedTextBoxStyle}"
                         TextChanged="SearchTextBox_TextChanged"
                         Margin="0,0,16,0"/>
                
                <TextBlock Grid.Row="0" Grid.Column="2" Text="Department Filter:" Style="{StaticResource ThemedTextBlockStyle}" Margin="0,0,0,8"/>
                <ComboBox Grid.Row="1" Grid.Column="2" x:Name="DepartmentFilterComboBox"
                          Style="{StaticResource ThemedComboBoxStyle}"
                          SelectionChanged="DepartmentFilterComboBox_SelectionChanged">
                    <ComboBoxItem Content="All Departments" IsSelected="True"/>
                    <ComboBoxItem Content="IT"/>
                    <ComboBoxItem Content="Finance"/>
                    <ComboBoxItem Content="HR"/>
                    <ComboBoxItem Content="Sales"/>
                    <ComboBoxItem Content="Marketing"/>
                    <ComboBoxItem Content="Operations"/>
                    <ComboBoxItem Content="Legal"/>
                    <ComboBoxItem Content="Executive"/>
                </ComboBox>
            </Grid>
        </Border>
        
        <!-- Results Count -->
        <TextBlock Grid.Row="2" x:Name="ResultsCountTextBlock" 
                   Text="0 managers found" 
                   Style="{StaticResource ThemedSecondaryTextStyle}" 
                   Margin="0,16,0,8"/>
        
        <!-- Manager List -->
        <Border Grid.Row="3" Style="{StaticResource ThemedCardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="Available Managers" Style="{StaticResource ThemedSubHeaderTextStyle}"/>
                
                <!-- Loading Indicator -->
                <StackPanel Grid.Row="1" x:Name="LoadingPanel" Visibility="Visible" 
                           HorizontalAlignment="Center" VerticalAlignment="Center">
                    <ProgressBar Style="{StaticResource ThemedProgressBarStyle}" IsIndeterminate="True" 
                                Width="200" Height="4" Margin="0,0,0,16"/>
                    <TextBlock Text="Loading managers..." Style="{StaticResource ThemedSecondaryTextStyle}"/>
                </StackPanel>
                
                <!-- Manager DataGrid -->
                <DataGrid Grid.Row="1" x:Name="ManagerDataGrid" 
                         Visibility="Collapsed"
                         AutoGenerateColumns="False"
                         VirtualizingStackPanel.IsVirtualizing="True" 
                         EnableRowVirtualization="True" 
                         EnableColumnVirtualization="True"
                         CanUserAddRows="False"
                         CanUserDeleteRows="False"
                         CanUserReorderColumns="True"
                         CanUserResizeColumns="True"
                         CanUserSortColumns="True"
                         IsReadOnly="True"
                         SelectionMode="Single"
                         GridLinesVisibility="None"
                         HeadersVisibility="Column"
                         Background="{DynamicResource SurfaceBrush}"
                         Foreground="{DynamicResource PrimaryTextBrush}"
                         BorderBrush="{DynamicResource BorderBrush}"
                         BorderThickness="1"
                         SelectionChanged="ManagerDataGrid_SelectionChanged">
                    
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Display Name" Binding="{Binding DisplayName}" Width="200"/>
                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="250"/>
                        <DataGridTextColumn Header="Department" Binding="{Binding Department}" Width="150"/>
                        <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="200"/>
                        <DataGridTextColumn Header="Office Location" Binding="{Binding OfficeLocation}" Width="150"/>
                    </DataGrid.Columns>
                    
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
                            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource CardBrush}"/>
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
                                    <Setter Property="Foreground" Value="White"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                    
                    <DataGrid.ColumnHeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="{DynamicResource CardBrush}"/>
                            <Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
                            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                            <Setter Property="BorderThickness" Value="0,0,1,1"/>
                            <Setter Property="Padding" Value="12,8"/>
                            <Setter Property="FontWeight" Value="Medium"/>
                        </Style>
                    </DataGrid.ColumnHeaderStyle>
                </DataGrid>
                
                <!-- No Results Message -->
                <TextBlock Grid.Row="1" x:Name="NoResultsTextBlock" 
                          Text="No managers found matching your search criteria" 
                          Style="{StaticResource ThemedSecondaryTextStyle}"
                          HorizontalAlignment="Center" 
                          VerticalAlignment="Center"
                          Visibility="Collapsed"/>
            </Grid>
        </Border>
        
        <!-- Selected Manager Preview -->
        <Border Grid.Row="4" x:Name="SelectedManagerPanel" Style="{StaticResource ThemedCardStyle}" Visibility="Collapsed" Margin="0,16,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Selected Manager:" Style="{StaticResource ThemedSubHeaderTextStyle}" Margin="0,0,0,8"/>
                    <TextBlock x:Name="SelectedManagerNameTextBlock" Style="{StaticResource ThemedTextBlockStyle}" FontWeight="Medium"/>
                    <TextBlock x:Name="SelectedManagerDetailsTextBlock" Style="{StaticResource ThemedSecondaryTextStyle}" Margin="0,4,0,0"/>
                </StackPanel>
                
                <Button Grid.Column="1" Content="Clear Selection" 
                        Style="{StaticResource ThemedSecondaryButtonStyle}"
                        Click="ClearSelection_Click" 
                        Margin="16,0,0,0"/>
            </Grid>
        </Border>
        
        <!-- Bottom Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" 
                   Margin="0,24,0,0" x:Name="ButtonPanel">
            <Button Content="Select Manager" x:Name="SelectButton"
                    Style="{StaticResource ThemedSuccessButtonStyle}"
                    Click="SelectManager_Click" 
                    IsEnabled="False"
                    Padding="20,8" Margin="0,0,10,0"/>
            
            <Button Content="Cancel" 
                    Style="{StaticResource ThemedSecondaryButtonStyle}"
                    Click="Cancel_Click" 
                    Padding="20,8"/>
        </StackPanel>
    </Grid>
</Window>