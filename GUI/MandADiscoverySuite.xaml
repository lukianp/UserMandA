<Window x:Class="MandADiscoverySuite.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="M&amp;A Discovery Suite - Enterprise Edition" Height="1000" Width="1600"
        WindowStartupLocation="CenterScreen" WindowState="Maximized"
        Background="#FF0F1419">
    
    <Window.Resources>
        <!-- Modern Gradient Brushes -->
        <LinearGradientBrush x:Key="PrimaryGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF1e3c72" Offset="0"/>
            <GradientStop Color="#FF2a5298" Offset="1"/>
        </LinearGradientBrush>
        
        <LinearGradientBrush x:Key="AccentGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF667eea" Offset="0"/>
            <GradientStop Color="#FF764ba2" Offset="1"/>
        </LinearGradientBrush>
        
        <LinearGradientBrush x:Key="SuccessGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF11998e" Offset="0"/>
            <GradientStop Color="#FF38ef7d" Offset="1"/>
        </LinearGradientBrush>
        
        <LinearGradientBrush x:Key="DangerGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FFff5f6d" Offset="0"/>
            <GradientStop Color="#FFffc371" Offset="1"/>
        </LinearGradientBrush>
        
        <!-- ✨ AWESOME GLASSMORPHISM EFFECTS ✨ -->
        <LinearGradientBrush x:Key="GlassmorphismBrush" StartPoint="0,0" EndPoint="1,1" Opacity="0.15">
            <GradientStop Color="#FFFFFFFF" Offset="0"/>
            <GradientStop Color="#FF000000" Offset="0.5"/>
            <GradientStop Color="#FFFFFFFF" Offset="1"/>
        </LinearGradientBrush>
        
        <!-- 🌈 NEON GLOW GRADIENTS 🌈 -->
        <LinearGradientBrush x:Key="NeonCyanGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF00FFFF" Offset="0"/>
            <GradientStop Color="#FF0080FF" Offset="1"/>
        </LinearGradientBrush>
        
        <LinearGradientBrush x:Key="NeonPinkGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FFFF1493" Offset="0"/>
            <GradientStop Color="#FFFF69B4" Offset="1"/>
        </LinearGradientBrush>
        
        <LinearGradientBrush x:Key="HolographicGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FF8A2387" Offset="0"/>
            <GradientStop Color="#FFE94057" Offset="0.5"/>
            <GradientStop Color="#FFF27121" Offset="1"/>
        </LinearGradientBrush>
        
        <!-- ✨ ENHANCED MODERN CARD STYLE WITH GLASSMORPHISM ✨ -->
        <Style x:Key="ModernCardStyle" TargetType="Border">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1" Opacity="0.8">
                        <GradientStop Color="#FF1C2433" Offset="0"/>
                        <GradientStop Color="#FF2D3748" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderBrush">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1" Opacity="0.3">
                        <GradientStop Color="#FFFFFFFF" Offset="0"/>
                        <GradientStop Color="#FF4299E1" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#FF00FFFF" Direction="270" ShadowDepth="6" BlurRadius="20" Opacity="0.2"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource NeonCyanGradient}"/>
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1" Opacity="0.9">
                                <GradientStop Color="#FF2A3441" Offset="0"/>
                                <GradientStop Color="#FF3C4D62" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect Color="#FF00FFFF" Direction="270" ShadowDepth="8" BlurRadius="25" Opacity="0.4"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- Modern Button Style -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryGradient}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource AccentGradient}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF4A5568"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Sidebar Navigation Button Style -->
        <Style x:Key="NavButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#FFE2E8F0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Height" Value="56"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="24,0"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="0,12,12,0"
                                Margin="0,2,8,2"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF2D3748"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Metric Card Style -->
        <Style x:Key="MetricCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#FF1A202C"/>
            <Setter Property="BorderBrush" Value="#FF2D3748"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#FF000000" Direction="270" ShadowDepth="2" BlurRadius="8" Opacity="0.2"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- ComboBox Modern Style -->
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="#FF2D3748"/>
            <Setter Property="Foreground" Value="#FFE2E8F0"/>
            <Setter Property="BorderBrush" Value="#FF4A5568"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton Name="ToggleButton" 
                                        Background="{TemplateBinding Background}" 
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Focusable="false"
                                        IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"
                                        ClickMode="Press">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="20"/>
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter Grid.Column="0" Name="ContentSite" 
                                                    IsHitTestVisible="False" 
                                                    Content="{TemplateBinding SelectionBoxItem}"
                                                    ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                    ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                    Margin="3,3,23,3"
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Left" 
                                                    TextBlock.Foreground="#FFE2E8F0"/>
                                    <Path Grid.Column="1" x:Name="Arrow" 
                                        Fill="#FFE2E8F0" 
                                        HorizontalAlignment="Center" 
                                        VerticalAlignment="Center" 
                                        Data="M 0 0 L 4 4 L 8 0 Z"/>
                                </Grid>
                            </ToggleButton>
                            <ContentPresenter Name="ContentPresenter" 
                                            Content="{TemplateBinding SelectionBoxItem}"
                                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                            ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                            Margin="3,3,23,3"
                                            IsHitTestVisible="False"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Left"
                                            TextBlock.Foreground="#FFE2E8F0"/>
                            <TextBox x:Name="PART_EditableTextBox"
                                   Style="{x:Null}" 
                                   Template="{DynamicResource ComboBoxTextBox}" 
                                   HorizontalAlignment="Left" 
                                   VerticalAlignment="Center" 
                                   Margin="3,3,23,3"
                                   Focusable="True" 
                                   Background="#FF2D3748"
                                   Foreground="#FFE2E8F0"
                                   Visibility="Hidden"
                                   IsReadOnly="{TemplateBinding IsReadOnly}"/>
                            <Popup Name="Popup"
                                   Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True" 
                                   Focusable="False"
                                   PopupAnimation="Slide">
                                <Grid Name="DropDown"
                                      SnapsToDevicePixels="True"                
                                      MinWidth="{TemplateBinding ActualWidth}"
                                      MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border x:Name="DropDownBorder"
                                            Background="#FF2D3748" 
                                            BorderThickness="1"
                                            BorderBrush="#FF4A5568"/>
                                    <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" 
                                                   TextBlock.Foreground="#FFE2E8F0"/>
                                    </ScrollViewer>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Resources>
                <Style TargetType="ComboBoxItem">
                    <Setter Property="Background" Value="#FF2D3748"/>
                    <Setter Property="Foreground" Value="#FFE2E8F0"/>
                    <Setter Property="Padding" Value="8,4"/>
                    <Style.Triggers>
                        <Trigger Property="IsHighlighted" Value="True">
                            <Setter Property="Background" Value="#FF4A5568"/>
                            <Setter Property="Foreground" Value="#FFFFFFFF"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Style.Resources>
        </Style>

        <!-- Data Grid Modern Style -->
        <Style x:Key="ModernDataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="#FF1A202C"/>
            <Setter Property="Foreground" Value="#FFE2E8F0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#FF2D3748"/>
            <Setter Property="RowBackground" Value="#FF1A202C"/>
            <Setter Property="AlternatingRowBackground" Value="#FF2D3748"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserResizeColumns" Value="True"/>
            <Setter Property="CanUserSortColumns" Value="True"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        
        <!-- Header Text Style -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#FFF7FAFC"/>
            <Setter Property="FontSize" Value="32"/>
            <Setter Property="FontWeight" Value="Light"/>
            <Setter Property="Margin" Value="0,0,0,24"/>
        </Style>
        
        <!-- Section Header Style -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#FFE2E8F0"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>
        
        <!-- Page Header Style -->
        <Style x:Key="PageHeaderStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#FFF7FAFC"/>
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>
        
        <!-- Progress Ring Style -->
        <Style x:Key="ProgressRingStyle" TargetType="ProgressBar">
            <Setter Property="Background" Value="#FF2D3748"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryGradient}"/>
            <Setter Property="Height" Value="4"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="280"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Enhanced Sidebar -->
        <Border Grid.Column="0" Background="#FF1A202C" BorderBrush="#FF2D3748" BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Enhanced Logo/Title -->
                <Border Grid.Row="0" Padding="24,32,24,24">
                    <StackPanel>
                        <TextBlock Text="M&amp;A Discovery" Foreground="#FFF7FAFC" FontSize="24" FontWeight="Bold"/>
                        <TextBlock Text="Suite" Foreground="#FF4299E1" FontSize="24" FontWeight="Light"/>
                        <TextBlock Text="Enterprise Edition" Foreground="#FFA0AEC0" FontSize="11" FontWeight="Medium" Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- Company Selector with Status -->
                <Border Grid.Row="1" Padding="24,0,24,24">
                    <StackPanel>
                        <TextBlock Text="Active Company Profile" Foreground="#FFA0AEC0" FontSize="12" FontWeight="Medium" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <ComboBox Grid.Column="0" x:Name="CompanySelector" 
                                      Style="{StaticResource ModernComboBoxStyle}"
                                      Height="40"
                                      FontSize="14"
                                      Margin="0,0,8,0"
                                      SelectionChanged="CompanySelector_SelectionChanged">
                            </ComboBox>
                            
                            <Button Grid.Column="1" x:Name="CreateProfileButton"
                                    Click="CreateNewProfile_Click"
                                    Background="{StaticResource AccentGradient}"
                                    BorderThickness="0"
                                    Width="40" Height="40"
                                    Margin="0,0,4,0"
                                    ToolTip="Create New Company Profile">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                CornerRadius="8"
                                                x:Name="ButtonBorder">
                                            <TextBlock Text="+" FontSize="24" FontWeight="Bold"
                                                      Foreground="White" 
                                                      HorizontalAlignment="Center" 
                                                      VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="ButtonBorder" Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                            <GradientStop Color="#FF5A9FD4" Offset="0"/>
                                                            <GradientStop Color="#FF4A8BC2" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            
                            <Button Grid.Column="2" x:Name="DeleteProfileButton"
                                    Click="DeleteProfile_Click"
                                    Background="{StaticResource DangerGradient}"
                                    BorderThickness="0"
                                    Width="40" Height="40"
                                    ToolTip="Delete Selected Company Profile">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                CornerRadius="8"
                                                x:Name="DeleteButtonBorder">
                                            <TextBlock Text="×" FontSize="24" FontWeight="Bold"
                                                      Foreground="White" 
                                                      HorizontalAlignment="Center" 
                                                      VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="DeleteButtonBorder" Property="Background">
                                                    <Setter.Value>
                                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                            <GradientStop Color="#FFE57373" Offset="0"/>
                                                            <GradientStop Color="#FFD32F2F" Offset="1"/>
                                                        </LinearGradientBrush>
                                                    </Setter.Value>
                                                </Setter>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                            <Ellipse Width="8" Height="8" Fill="#FF48BB78" Margin="0,0,8,0"/>
                            <TextBlock Text="Profile Active" Foreground="#FF9AE6B4" FontSize="11"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <!-- Quick Actions Panel -->
                <Border Grid.Row="2" Margin="16,0,16,8" Background="Transparent">
                    <StackPanel>
                        <TextBlock Text="🚀 Quick Actions" Foreground="#FFE2E8F0" FontSize="13" FontWeight="Medium" Margin="0,0,0,12"/>
                        
                        <Button x:Name="QuickAppRegistrationButton" 
                                Click="RunAppRegistration_Click"
                                Background="{StaticResource AccentGradient}"
                                BorderThickness="0"
                                Height="36"
                                Margin="0,0,0,8"
                                ToolTip="Setup Azure App Registration">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            CornerRadius="8"
                                            x:Name="ActionButtonBorder">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="🔐" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Setup App Registration" FontSize="12" FontWeight="Medium"
                                                      Foreground="White" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="ActionButtonBorder" Property="Background">
                                                <Setter.Value>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                        <GradientStop Color="#FF5A9FD4" Offset="0"/>
                                                        <GradientStop Color="#FF4A8BC2" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        
                        <Button x:Name="QuickFullDiscoveryButton" 
                                Click="RunFullDiscovery_Click"
                                Background="{StaticResource SuccessGradient}"
                                BorderThickness="0"
                                Height="36"
                                Margin="0,0,0,8"
                                ToolTip="Run Full Discovery">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            CornerRadius="8"
                                            x:Name="DiscoveryButtonBorder">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Run Full Discovery" FontSize="12" FontWeight="Medium"
                                                      Foreground="White" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="DiscoveryButtonBorder" Property="Background">
                                                <Setter.Value>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                        <GradientStop Color="#FF5CBB5C" Offset="0"/>
                                                        <GradientStop Color="#FF4A9F4A" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                        
                        <Button x:Name="QuickReportsButton" 
                                Click="NavigationButton_Click"
                                Tag="Reports"
                                Background="#FF6B46C1"
                                BorderThickness="0"
                                Height="36"
                                ToolTip="Generate Reports">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}" 
                                            CornerRadius="8"
                                            x:Name="ReportsButtonBorder">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="📊" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Generate Reports" FontSize="12" FontWeight="Medium"
                                                      Foreground="White" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="ReportsButtonBorder" Property="Background" Value="#FF7C5BDC"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>
                </Border>
                
                <!-- Navigation Buttons with Scroll Support -->
                <ScrollViewer Grid.Row="4" Margin="0,8,0,0" 
                              VerticalScrollBarVisibility="Auto" 
                              HorizontalScrollBarVisibility="Disabled"
                              PanningMode="VerticalOnly">
                    <StackPanel>
                        <Button x:Name="DashboardButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📊" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Dashboard"/>
                                <TextBlock Text="Overview &amp; Stats" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="DiscoveryButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🔍" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Discovery"/>
                                <TextBlock Text="Run Discovery Modules" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="UsersButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👥" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Users"/>
                                <TextBlock Text="User Accounts &amp; Profiles" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="ComputersButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="💻" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Computers"/>
                                <TextBlock Text="Devices &amp; Hardware" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="InfrastructureButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🌐" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Infrastructure"/>
                                <TextBlock Text="Network &amp; Topology" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="DomainDiscoveryButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🔍" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Domain Discovery"/>
                                <TextBlock Text="DNS &amp; Domain Enumeration" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <Button x:Name="FileServersButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📁" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="File Servers"/>
                                <TextBlock Text="File Shares &amp; Storage" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <Button x:Name="DatabasesButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🗄️" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Databases"/>
                                <TextBlock Text="SQL &amp; Database Discovery" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <Button x:Name="SecurityButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🔒" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Group Policy &amp; Security"/>
                                <TextBlock Text="Security Assessment &amp; GPO Analysis" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>

                    <Button x:Name="ApplicationsButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📱" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Applications"/>
                                <TextBlock Text="App Discovery &amp; Catalog" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="WavesButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🚀" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Migration Waves"/>
                                <TextBlock Text="Planning &amp; Timeline" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="MigrateButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="⚡" FontSize="18" Margin="0,0,16,0"/>
                            <StackPanel>
                                <TextBlock Text="Migrate"/>
                                <TextBlock Text="Execute Migration" FontSize="10" Foreground="#FFA0AEC0"/>
                            </StackPanel>
                        </StackPanel>
                    </Button>
                    
                    <Separator Margin="24,16" Background="#FF2D3748"/>
                    
                    <Button x:Name="ReportsButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📄" FontSize="18" Margin="0,0,16,0"/>
                            <TextBlock Text="Reports"/>
                        </StackPanel>
                    </Button>
                    
                    <Button x:Name="SettingsButton" Style="{StaticResource NavButtonStyle}" Click="NavigationButton_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="⚙️" FontSize="18" Margin="0,0,16,0"/>
                            <TextBlock Text="Settings"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </ScrollViewer>
                
                <!-- Spacer -->
                <Grid Grid.Row="5"/>
                
                <!-- Enhanced Status Bar -->
                <Border Grid.Row="6" Background="{StaticResource PrimaryGradient}" Padding="24,16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                            <Ellipse Width="8" Height="8" Fill="#FF48BB78" Margin="0,0,8,0"/>
                            <TextBlock Text="System Ready" Foreground="White" FontSize="13" FontWeight="Medium"/>
                        </StackPanel>
                        <TextBlock x:Name="StatusDetails" Text="Last discovery: 2 hours ago" Foreground="White" FontSize="11" Opacity="0.8"/>
                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock x:Name="DomainInfo" Text="Domain: Not detected" Foreground="White" FontSize="11" Opacity="0.8" Margin="0,0,16,0"/>
                            <TextBlock x:Name="EnvironmentType" Text="Environment: Unknown" Foreground="White" FontSize="11" Opacity="0.8"/>
                        </StackPanel>
                        <ProgressBar x:Name="StatusProgressBar" Style="{StaticResource ProgressRingStyle}" Value="0" Margin="0,8,0,0" Visibility="Collapsed"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
        
        <!-- Main Content Area -->
        <Grid Grid.Column="1" Background="#FF0F1419">
            <!-- Dashboard View -->
            <ScrollViewer x:Name="DashboardView" Visibility="Visible" VerticalScrollBarVisibility="Auto">
                <Grid Margin="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Dashboard Header -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,32">
                        <StackPanel>
                            <TextBlock Text="Discovery Dashboard" Style="{StaticResource HeaderTextStyle}"/>
                            <TextBlock Text="Real-time insights into your M&amp;A discovery progress" Foreground="#FFA0AEC0" FontSize="16"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="32,0,0,0">
                            <Button Content="Export Report" Style="{StaticResource ModernButtonStyle}" Margin="0,0,12,0"/>
                            <Button Content="Refresh Data" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentGradient}"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Key Metrics Row -->
                    <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,32">
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="👥" FontSize="24" Margin="0,0,12,0"/>
                                    <StackPanel>
                                        <TextBlock x:Name="TotalUsersTextBlock" Text="0" Foreground="#FF4299E1" FontSize="28" FontWeight="Bold"/>
                                        <TextBlock Text="Total Users" Foreground="#FFA0AEC0" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="↗" Foreground="#FF48BB78" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="+12% from last scan" Foreground="#FF9AE6B4" FontSize="11"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="💻" FontSize="24" Margin="0,0,12,0"/>
                                    <StackPanel>
                                        <TextBlock x:Name="TotalDevicesTextBlock" Text="0" Foreground="#FF48BB78" FontSize="28" FontWeight="Bold"/>
                                        <TextBlock Text="Devices" Foreground="#FFA0AEC0" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="→" Foreground="#FFED8936" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="No changes" Foreground="#FFFBB859" FontSize="11"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="🌐" FontSize="24" Margin="0,0,12,0"/>
                                    <StackPanel>
                                        <TextBlock x:Name="TotalInfrastructureTextBlock" Text="0" Foreground="#FFED8936" FontSize="28" FontWeight="Bold"/>
                                        <TextBlock Text="Infrastructure" Foreground="#FFA0AEC0" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="↗" Foreground="#FF48BB78" FontSize="14" Margin="0,0,4,0"/>
                                    <TextBlock Text="+3 new devices" Foreground="#FF9AE6B4" FontSize="11"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="✅" FontSize="24" Margin="0,0,12,0"/>
                                    <StackPanel>
                                        <TextBlock x:Name="DiscoveryProgressTextBlock" Text="0%" Foreground="#FF9F7AEA" FontSize="28" FontWeight="Bold"/>
                                        <TextBlock Text="Discovery Complete" Foreground="#FFA0AEC0" FontSize="12"/>
                                    </StackPanel>
                                </StackPanel>
                                <ProgressBar x:Name="DiscoveryProgressBar" Value="0" Maximum="100" Height="4" Background="#FF2D3748" Foreground="#FF9F7AEA" BorderThickness="0"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>
                    
                    <!-- Discovery Status Grid -->
                    <Border Grid.Row="2" Style="{StaticResource ModernCardStyle}" Margin="0,0,0,32">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Discovery Module Status" Style="{StaticResource SectionHeaderStyle}"/>
                                <ItemsControl x:Name="DashboardModules">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#FF2D3748" CornerRadius="6" Padding="16" Margin="0,0,0,8">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="20" Margin="0,0,16,0"/>
                                                    <StackPanel Grid.Column="1">
                                                        <TextBlock Text="{Binding Name}" Foreground="#FFE2E8F0" FontSize="14" FontWeight="Medium"/>
                                                        <TextBlock Text="{Binding Description}" Foreground="#FFA0AEC0" FontSize="11" TextWrapping="Wrap"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="16,0">
                                                        <Ellipse Width="8" Height="8" Fill="{Binding StatusColor}" Margin="0,0,6,0"/>
                                                        <TextBlock Text="{Binding Status}" Foreground="#FFA0AEC0" FontSize="12"/>
                                                    </StackPanel>
                                                    <Button Grid.Column="3" Content="View" 
                                                            Background="{StaticResource PrimaryGradient}" 
                                                            Foreground="White" 
                                                            BorderThickness="0" 
                                                            Padding="12,6" 
                                                            FontSize="11"/>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="32,0,0,0">
                                <TextBlock Text="Recent Activity" Style="{StaticResource SectionHeaderStyle}"/>
                                <Border Background="#FF2D3748" CornerRadius="6" Padding="16">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Ellipse Width="6" Height="6" Fill="#FF48BB78" Margin="0,0,8,0"/>
                                            <StackPanel>
                                                <TextBlock Text="Palo Alto Discovery" Foreground="#FFE2E8F0" FontSize="12" FontWeight="Medium"/>
                                                <TextBlock Text="2 minutes ago" Foreground="#FFA0AEC0" FontSize="10"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Ellipse Width="6" Height="6" Fill="#FF4299E1" Margin="0,0,8,0"/>
                                            <StackPanel>
                                                <TextBlock Text="User Data Updated" Foreground="#FFE2E8F0" FontSize="12" FontWeight="Medium"/>
                                                <TextBlock Text="15 minutes ago" Foreground="#FFA0AEC0" FontSize="10"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Ellipse Width="6" Height="6" Fill="#FFED8936" Margin="0,0,8,0"/>
                                            <StackPanel>
                                                <TextBlock Text="Exchange Discovery" Foreground="#FFE2E8F0" FontSize="12" FontWeight="Medium"/>
                                                <TextBlock Text="1 hour ago" Foreground="#FFA0AEC0" FontSize="10"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <Button Content="View All Activity" 
                                                Background="Transparent" 
                                                Foreground="#FF4299E1" 
                                                BorderThickness="0" 
                                                HorizontalAlignment="Left"
                                                Padding="0,8,0,0"
                                                FontSize="11"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Quick Actions Panel -->
                    <Border Grid.Row="3" Style="{StaticResource ModernCardStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Quick Actions" Style="{StaticResource SectionHeaderStyle}"/>
                                <Button x:Name="RunFullDiscoveryButton" Click="RunFullDiscovery_Click" Style="{StaticResource ModernButtonStyle}" Margin="0,0,0,12">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0"/>
                                        <TextBlock Text="Run Full Discovery"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="ImportDataButton" Click="ImportData_Click" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentGradient}" Margin="0,0,0,12">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📂" FontSize="16" Margin="0,0,8,0"/>
                                        <TextBlock Text="Import Existing Data"/>
                                    </StackPanel>
                                </Button>
                                <Button Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📊" FontSize="16" Margin="0,0,8,0"/>
                                        <TextBlock Text="Generate Report"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="32,0">
                                <TextBlock Text="Data Quality" Style="{StaticResource SectionHeaderStyle}"/>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="User Data" Foreground="#FFE2E8F0" FontSize="13" Width="100"/>
                                        <ProgressBar Value="95" Maximum="100" Height="6" Width="120" Background="#FF2D3748" Foreground="#FF48BB78" BorderThickness="0"/>
                                        <TextBlock Text="95%" Foreground="#FF48BB78" FontSize="12" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="Computer Data" Foreground="#FFE2E8F0" FontSize="13" Width="100"/>
                                        <ProgressBar Value="87" Maximum="100" Height="6" Width="120" Background="#FF2D3748" Foreground="#FF4299E1" BorderThickness="0"/>
                                        <TextBlock Text="87%" Foreground="#FF4299E1" FontSize="12" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="Infrastructure" Foreground="#FFE2E8F0" FontSize="13" Width="100"/>
                                        <ProgressBar Value="73" Maximum="100" Height="6" Width="120" Background="#FF2D3748" Foreground="#FFED8936" BorderThickness="0"/>
                                        <TextBlock Text="73%" Foreground="#FFED8936" FontSize="12" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Applications" Foreground="#FFE2E8F0" FontSize="13" Width="100"/>
                                        <ProgressBar Value="91" Maximum="100" Height="6" Width="120" Background="#FF2D3748" Foreground="#FF9F7AEA" BorderThickness="0"/>
                                        <TextBlock Text="91%" Foreground="#FF9F7AEA" FontSize="12" Margin="8,0,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2">
                                <TextBlock Text="System Health" Style="{StaticResource SectionHeaderStyle}"/>
                                <Border Background="#FF2D3748" CornerRadius="6" Padding="16">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                            <Ellipse Width="8" Height="8" Fill="#FF48BB78" Margin="0,0,8,0"/>
                                            <TextBlock Text="PowerShell Modules" Foreground="#FFE2E8F0" FontSize="12"/>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                            <Ellipse Width="8" Height="8" Fill="#FF48BB78" Margin="0,0,8,0"/>
                                            <TextBlock Text="Network Connectivity" Foreground="#FFE2E8F0" FontSize="12"/>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                            <Ellipse Width="8" Height="8" Fill="#FFED8936" Margin="0,0,8,0"/>
                                            <TextBlock Text="API Credentials" Foreground="#FFE2E8F0" FontSize="12"/>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal">
                                            <Ellipse Width="8" Height="8" Fill="#FF48BB78" Margin="0,0,8,0"/>
                                            <TextBlock Text="Data Storage" Foreground="#FFE2E8F0" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </ScrollViewer>
            
            <!-- Discovery View -->
            <ScrollViewer x:Name="DiscoveryView" Visibility="Collapsed" VerticalScrollBarVisibility="Auto">
                <Grid Margin="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,32">
                        <StackPanel>
                            <TextBlock Text="Discovery Modules" Style="{StaticResource HeaderTextStyle}"/>
                            <TextBlock Text="Run discovery modules to gather comprehensive organizational data" Foreground="#FFA0AEC0" FontSize="16"/>
                        </StackPanel>
                        <Button x:Name="RunAllDiscoveryButton" Content="Run All Modules" Style="{StaticResource ModernButtonStyle}" 
                                HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="32,0,0,0"/>
                    </StackPanel>
                    
                    <WrapPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,32">
                        <Button x:Name="ADDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentGradient}" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Active Directory" Foreground="White"/>
                                    <Ellipse x:Name="ADStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="ADStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="EntraDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Azure AD / Entra" Foreground="White"/>
                                    <Ellipse x:Name="EntraStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="EntraStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="InfraDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Infrastructure" Foreground="White"/>
                                    <Ellipse x:Name="InfraStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="InfraStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="AppsDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Applications" Foreground="White"/>
                                    <Ellipse x:Name="AppsStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="AppsStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="DomainDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Domain Discovery" Foreground="White"/>
                                    <Ellipse x:Name="DomainStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="DomainStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="FileServersDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="File Servers" Foreground="White"/>
                                    <Ellipse x:Name="FileServersStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="FileServersStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="DatabasesDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Databases" Foreground="White"/>
                                    <Ellipse x:Name="DatabasesStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="DatabasesStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button x:Name="SecurityDiscoveryBtn" Style="{StaticResource ModernButtonStyle}" Background="#FF2D3748" Margin="0,0,12,8" Click="DiscoveryModule_Click">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Security" Foreground="White"/>
                                    <Ellipse x:Name="SecurityStatusIndicator" Width="8" Height="8" Fill="#FFF59E0B" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="SecurityStatusText" Text="Ready" FontSize="10" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <Button Content="Show All" Style="{StaticResource ModernButtonStyle}" Background="Transparent" BorderBrush="#FF4A5568" BorderThickness="1" Click="ShowAllDiscoveryData_Click"/>
                    </WrapPanel>
                    
                    <ItemsControl Grid.Row="2" x:Name="DiscoveryModules">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ModernCardStyle}" Width="380" Height="220">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                                            <TextBlock Text="{Binding Icon}" FontSize="32" Margin="0,0,16,0"/>
                                            <StackPanel>
                                                <TextBlock Text="{Binding Name}" Foreground="#FFE2E8F0" FontSize="18" FontWeight="SemiBold"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <Ellipse Width="8" Height="8" Fill="{Binding StatusColor}" Margin="0,0,8,0"/>
                                                    <TextBlock Text="{Binding Status}" Foreground="#FFA0AEC0" FontSize="12"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <TextBlock Grid.Row="1" Text="{Binding Description}" 
                                                   Foreground="#FFA0AEC0" FontSize="13" 
                                                   TextWrapping="Wrap" LineHeight="20"/>
                                        
                                        <ProgressBar Grid.Row="2" Value="0" Maximum="100" Height="4" 
                                                     Background="#FF2D3748" Foreground="{StaticResource PrimaryGradient}" 
                                                     BorderThickness="0" Margin="0,16,0,16" 
                                                     Visibility="Collapsed"/>
                                        
                                        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Content="Configure" 
                                                    Background="#FF2D3748" Foreground="#FFE2E8F0"
                                                    BorderThickness="0" Padding="16,8" 
                                                    FontSize="12" Margin="0,0,8,0"/>
                                            <Button Content="Run Discovery" 
                                                    Click="RunModule_Click" Tag="{Binding ModuleName}"
                                                    Style="{StaticResource ModernButtonStyle}" 
                                                    FontSize="12" Padding="16,8"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </ScrollViewer>
            
            <!-- Enhanced Users View -->
            <ScrollViewer x:Name="UsersView" Visibility="Collapsed" VerticalScrollBarVisibility="Auto">
                <Grid Margin="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,24">
                        <StackPanel>
                            <TextBlock Text="User Accounts" Style="{StaticResource HeaderTextStyle}"/>
                            <TextBlock Text="Comprehensive view of all discovered user accounts and profiles" Foreground="#FFA0AEC0" FontSize="16"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="32,0,0,0">
                            <TextBox x:Name="UserSearchBox" Width="250" Height="32" 
                                     Background="#FF2D3748" Foreground="#FFE2E8F0" 
                                     BorderBrush="#FF4A5568" Padding="12,6"
                                     FontSize="13" Text="Search users..."/>
                            <Button Content="Export" Style="{StaticResource ModernButtonStyle}" Margin="12,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <UniformGrid Grid.Row="1" Columns="5" Margin="0,0,0,24">
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock x:Name="UsersViewTotalTextBlock" Text="0" Foreground="#FF4299E1" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Total Users" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock x:Name="ActiveUsersTextBlock" Text="0" Foreground="#FF48BB78" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Active Users" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock Text="91" Foreground="#FFED8936" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Disabled Users" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock x:Name="ServiceAccountsTextBlock" Text="0" Foreground="#FF9F7AEA" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Service Accounts" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock Text="67" Foreground="#FFED8936" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Privileged Users" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>
                    
                    <Border Grid.Row="2" Style="{StaticResource ModernCardStyle}">
                        <DataGrid x:Name="UsersDataGrid" Style="{StaticResource ModernDataGridStyle}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Display Name" Binding="{Binding Name}" Width="200">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="{StaticResource PrimaryGradient}"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="Padding" Value="12,8"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="250"/>
                                <DataGridTextColumn Header="Department" Binding="{Binding Department}" Width="150"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="120"/>
                                <DataGridTextColumn Header="Last Logon" Binding="{Binding LastLogon}" Width="150"/>
                                <DataGridTextColumn Header="Groups" Binding="{Binding Groups}" Width="80"/>
                                <DataGridTextColumn Header="Manager" Binding="{Binding Manager}" Width="150"/>
                                <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="150"/>
                                <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </ScrollViewer>
            
            <!-- Enhanced Computers View -->
            <ScrollViewer x:Name="ComputersView" Visibility="Collapsed" VerticalScrollBarVisibility="Auto">
                <Grid Margin="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,24">
                        <StackPanel>
                            <TextBlock Text="Computer Inventory" Style="{StaticResource HeaderTextStyle}"/>
                            <TextBlock Text="Complete hardware and software inventory with compliance status" Foreground="#FFA0AEC0" FontSize="16"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="32,0,0,0">
                            <TextBox x:Name="ComputerSearchBox" Width="250" Height="32" 
                                     Background="#FF2D3748" Foreground="#FFE2E8F0" 
                                     BorderBrush="#FF4A5568" Padding="12,6"
                                     FontSize="13" Text="Search computers..."/>
                            <Button Content="Health Check" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentGradient}" Margin="12,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <UniformGrid Grid.Row="1" Columns="6" Margin="0,0,0,24">
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock x:Name="ComputersViewTotalTextBlock" Text="0" Foreground="#FF4299E1" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Total Devices" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock Text="134" Foreground="#FF48BB78" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Online" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock Text="89" Foreground="#FF9F7AEA" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Windows 11" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock Text="45" Foreground="#FFED8936" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Windows 10" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock Text="12" Foreground="#FFF56565" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Non-Compliant" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <TextBlock x:Name="ServersTextBlock" Text="0" Foreground="#FF4299E1" FontSize="24" FontWeight="Bold"/>
                                <TextBlock Text="Servers" Foreground="#FFA0AEC0" FontSize="11"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>
                    
                    <Border Grid.Row="2" Style="{StaticResource ModernCardStyle}">
                        <DataGrid x:Name="ComputersDataGrid" Style="{StaticResource ModernDataGridStyle}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Computer Name" Binding="{Binding Name}" Width="180">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="{StaticResource PrimaryGradient}"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="Padding" Value="12,8"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Operating System" Binding="{Binding OS}" Width="160"/>
                                <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="120"/>
                                <DataGridTextColumn Header="Last Seen" Binding="{Binding LastSeen}" Width="140"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTextColumn Header="Domain" Binding="{Binding Domain}" Width="120"/>
                                <DataGridTextColumn Header="OU" Binding="{Binding OU}" Width="200"/>
                                <DataGridTextColumn Header="Manufacturer" Binding="{Binding Manufacturer}" Width="120"/>
                                <DataGridTextColumn Header="Model" Binding="{Binding Model}" Width="150"/>
                                <DataGridTextColumn Header="Serial Number" Binding="{Binding SerialNumber}" Width="140"/>
                                <DataGridTextColumn Header="RAM (GB)" Binding="{Binding RAM}" Width="80"/>
                                <DataGridTextColumn Header="Disk Space (GB)" Binding="{Binding DiskSpace}" Width="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </ScrollViewer>
            
            <!-- Enhanced Infrastructure View -->
            <ScrollViewer x:Name="InfrastructureView" Visibility="Collapsed" VerticalScrollBarVisibility="Auto">
                <Grid Margin="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,24">
                        <StackPanel>
                            <TextBlock Text="Network Infrastructure" Style="{StaticResource HeaderTextStyle}"/>
                            <TextBlock Text="Network topology, security devices, and infrastructure components" Foreground="#FFA0AEC0" FontSize="16"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="32,0,0,0">
                            <Button Content="Network Map" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentGradient}" Margin="0,0,12,0"/>
                            <Button Content="Security Scan" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource DangerGradient}"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,24">
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="🔥" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock Text="5" Foreground="#FFED8936" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="Palo Alto Devices" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="2 HA Pairs" Foreground="#FF9AE6B4" FontSize="10"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="🌐" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock Text="12" Foreground="#FF4299E1" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="Network Devices" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="Switches &amp; Routers" Foreground="#FF63B3ED" FontSize="10"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="🖥️" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock x:Name="InfrastructureServersTextBlock" Text="0" Foreground="#FF48BB78" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="Servers" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="Physical &amp; Virtual" Foreground="#FF9AE6B4" FontSize="10"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="☁️" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock Text="8" Foreground="#FF9F7AEA" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="Cloud Services" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="Azure &amp; AWS" Foreground="#FFD6BCFA" FontSize="10"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>
                    
                    <!-- Dynamic Network Topology Visualization -->
                    <Border Grid.Row="2" Style="{StaticResource ModernCardStyle}" Margin="0,0,0,24">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                    <TextBlock Text="Network Topology" Style="{StaticResource SectionHeaderStyle}" VerticalAlignment="Center"/>
                                    <Button x:Name="RefreshTopologyButton" Content="🔄 Refresh" 
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF4299E1" Margin="16,0,0,0" Padding="8,4"
                                            Click="RefreshTopology_Click" FontSize="12"/>
                                    <Button x:Name="AutoLayoutButton" Content="📐 Auto Layout" 
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF48BB78" Margin="8,0,0,0" Padding="8,4"
                                            Click="AutoLayoutTopology_Click" FontSize="12"/>
                                </StackPanel>
                                <Border Background="#FF2D3748" CornerRadius="8" Height="300" Padding="10">
                                    <Grid>
                                        <Canvas x:Name="NetworkTopologyCanvas" ClipToBounds="True">
                                            <!-- Dynamic network nodes and connections will be added here -->
                                        </Canvas>
                                        
                                        <!-- Loading Indicator -->
                                        <Border x:Name="TopologyLoadingPanel" Background="#AA1A202C" 
                                                CornerRadius="8" Visibility="Collapsed">
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                                <TextBlock Text="⏳" FontSize="24" HorizontalAlignment="Center" 
                                                           Foreground="#FF4299E1" Margin="0,0,0,8"/>
                                                <TextBlock Text="Scanning network topology..." 
                                                           Foreground="#FFE2E8F0" FontSize="14" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                        
                                        <!-- No Data Indicator -->
                                        <Border x:Name="TopologyNoDataPanel" Background="Transparent" 
                                                CornerRadius="8" Visibility="Collapsed">
                                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                                <TextBlock Text="🔍" FontSize="32" HorizontalAlignment="Center" 
                                                           Foreground="#FF718096" Margin="0,0,0,8"/>
                                                <TextBlock Text="No network topology data available" 
                                                           Foreground="#FF718096" FontSize="14" HorizontalAlignment="Center"/>
                                                <TextBlock Text="Run Network Infrastructure Discovery to populate this view" 
                                                           Foreground="#FF4A5568" FontSize="12" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                </Border>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="24,0,0,0">
                                <TextBlock Text="Security Posture" Style="{StaticResource SectionHeaderStyle}"/>
                                <Border Background="#FF2D3748" CornerRadius="6" Padding="16">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Ellipse Width="8" Height="8" Fill="#FF48BB78" Margin="0,0,8,0"/>
                                            <StackPanel>
                                                <TextBlock Text="Firewall Rules" Foreground="#FFE2E8F0" FontSize="12" FontWeight="Medium"/>
                                                <TextBlock Text="347 rules optimized" Foreground="#FF9AE6B4" FontSize="10"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Ellipse Width="8" Height="8" Fill="#FFED8936" Margin="0,0,8,0"/>
                                            <StackPanel>
                                                <TextBlock Text="VPN Tunnels" Foreground="#FFE2E8F0" FontSize="12" FontWeight="Medium"/>
                                                <TextBlock Text="12 active connections" Foreground="#FFFBB859" FontSize="10"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                            <Ellipse Width="8" Height="8" Fill="#FF4299E1" Margin="0,0,8,0"/>
                                            <StackPanel>
                                                <TextBlock Text="SSL Decryption" Foreground="#FFE2E8F0" FontSize="12" FontWeight="Medium"/>
                                                <TextBlock Text="89% coverage" Foreground="#FF63B3ED" FontSize="10"/>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal">
                                            <Ellipse Width="8" Height="8" Fill="#FFF56565" Margin="0,0,8,0"/>
                                            <StackPanel>
                                                <TextBlock Text="Threat Detection" Foreground="#FFE2E8F0" FontSize="12" FontWeight="Medium"/>
                                                <TextBlock Text="3 alerts today" Foreground="#FFFED7D7" FontSize="10"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                
                                <TextBlock Text="Device Health" Style="{StaticResource SectionHeaderStyle}" Margin="0,16,0,8"/>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="PA-5220-1" Foreground="#FFE2E8F0" FontSize="12" Width="80"/>
                                        <ProgressBar Value="95" Maximum="100" Height="4" Width="80" Background="#FF2D3748" Foreground="#FF48BB78" BorderThickness="0"/>
                                        <TextBlock Text="95%" Foreground="#FF48BB78" FontSize="10" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="PA-5220-2" Foreground="#FFE2E8F0" FontSize="12" Width="80"/>
                                        <ProgressBar Value="97" Maximum="100" Height="4" Width="80" Background="#FF2D3748" Foreground="#FF48BB78" BorderThickness="0"/>
                                        <TextBlock Text="97%" Foreground="#FF48BB78" FontSize="10" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="Panorama" Foreground="#FFE2E8F0" FontSize="12" Width="80"/>
                                        <ProgressBar Value="92" Maximum="100" Height="4" Width="80" Background="#FF2D3748" Foreground="#FF4299E1" BorderThickness="0"/>
                                        <TextBlock Text="92%" Foreground="#FF4299E1" FontSize="10" Margin="8,0,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Infrastructure Device List -->
                    <Border Grid.Row="3" Style="{StaticResource ModernCardStyle}">
                        <DataGrid x:Name="InfrastructureDataGrid" Style="{StaticResource ModernDataGridStyle}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Device Name" Binding="{Binding Name}" Width="200">
                                    <DataGridTextColumn.HeaderStyle>
                                        <Style TargetType="DataGridColumnHeader">
                                            <Setter Property="Background" Value="{StaticResource PrimaryGradient}"/>
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="Padding" Value="12,8"/>
                                        </Style>
                                    </DataGridTextColumn.HeaderStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="150"/>
                                <DataGridTextColumn Header="Model" Binding="{Binding Model}" Width="140"/>
                                <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="120"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="120"/>
                                <DataGridTextColumn Header="Location" Binding="{Binding Location}" Width="120"/>
                                <DataGridTextColumn Header="Uptime" Binding="{Binding Uptime}" Width="120"/>
                                <DataGridTextColumn Header="CPU Usage" Binding="{Binding CPUUsage}" Width="100"/>
                                <DataGridTextColumn Header="Memory Usage" Binding="{Binding MemoryUsage}" Width="120"/>
                                <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="120"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </ScrollViewer>
            
            <!-- Enhanced Migration Waves View -->
            <ScrollViewer x:Name="WavesView" Visibility="Collapsed" VerticalScrollBarVisibility="Auto">
                <Grid Margin="32">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,24">
                        <StackPanel>
                            <TextBlock Text="Migration Waves" Style="{StaticResource HeaderTextStyle}"/>
                            <TextBlock Text="Strategic migration planning with dependency mapping and timeline visualization" Foreground="#FFA0AEC0" FontSize="16"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="32,0,0,0">
                            <Button Content="Generate Waves" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource AccentGradient}" Margin="0,0,12,0"/>
                            <Button Content="Timeline View" Style="{StaticResource ModernButtonStyle}" Background="{StaticResource SuccessGradient}"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <Grid Grid.Row="1" Margin="0,0,0,24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="🌊" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock Text="5" Foreground="#FF4299E1" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="Migration Waves" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="Optimized grouping" Foreground="#FF63B3ED" FontSize="10"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="1" Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="⚡" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock x:Name="HighPriorityUsersTextBlock" Text="0" Foreground="#FF48BB78" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="High Priority Users" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="Wave 1 candidates" Foreground="#FF9AE6B4" FontSize="10"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="2" Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="🔄" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock Text="67" Foreground="#FFED8936" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="Dependencies" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="Mapped relations" Foreground="#FFFBB859" FontSize="10"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="3" Style="{StaticResource MetricCardStyle}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                    <TextBlock Text="📅" FontSize="20" Margin="0,0,8,0"/>
                                    <StackPanel>
                                        <TextBlock Text="12" Foreground="#FF9F7AEA" FontSize="24" FontWeight="Bold"/>
                                        <TextBlock Text="Weeks Timeline" Foreground="#FFA0AEC0" FontSize="11"/>
                                    </StackPanel>
                                </StackPanel>
                                <TextBlock Text="Estimated duration" Foreground="#FFD6BCFA" FontSize="10"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                    
                    <Border Grid.Row="2" Style="{StaticResource ModernCardStyle}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Wave Assignment Details" Style="{StaticResource SectionHeaderStyle}"/>
                                <DataGrid x:Name="WavesDataGrid" Style="{StaticResource ModernDataGridStyle}" Height="400" 
                                          AllowDrop="True" Drop="WavesDataGrid_Drop" DragOver="WavesDataGrid_DragOver"
                                          MouseMove="WavesDataGrid_MouseMove" PreviewMouseLeftButtonDown="WavesDataGrid_PreviewMouseLeftButtonDown">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="User Name" Binding="{Binding UserName}" Width="150">
                                            <DataGridTextColumn.HeaderStyle>
                                                <Style TargetType="DataGridColumnHeader">
                                                    <Setter Property="Background" Value="{StaticResource PrimaryGradient}"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                                    <Setter Property="Padding" Value="12,8"/>
                                                </Style>
                                            </DataGridTextColumn.HeaderStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200"/>
                                        <DataGridTextColumn Header="Department" Binding="{Binding Department}" Width="120"/>
                                        <DataGridTextColumn Header="Wave" Binding="{Binding Wave}" Width="60"/>
                                        <DataGridTextColumn Header="Priority" Binding="{Binding Priority}" Width="80"/>
                                        <DataGridTextColumn Header="Complexity" Binding="{Binding Complexity}" Width="80"/>
                                        <DataGridTextColumn Header="Dependencies" Binding="{Binding Dependencies}" Width="100"/>
                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                        <DataGridTextColumn Header="Est. Duration" Binding="{Binding EstimatedDuration}" Width="100"/>
                                        <DataGridTextColumn Header="Risk Level" Binding="{Binding RiskLevel}" Width="100"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="24,0,0,0">
                                <TextBlock Text="Wave Timeline" Style="{StaticResource SectionHeaderStyle}"/>
                                <Border Background="#FF2D3748" CornerRadius="6" Padding="16">
                                    <StackPanel>
                                        <Border x:Name="Wave1DropZone" Tag="1" Margin="0,0,0,16" Background="Transparent" 
                                                AllowDrop="True" Drop="WaveDropZone_Drop" DragOver="WaveDropZone_DragOver" 
                                                DragLeave="WaveDropZone_DragLeave" CornerRadius="4" BorderThickness="2" BorderBrush="Transparent">
                                            <StackPanel>
                                                <TextBlock Text="Wave 1 - Executive &amp; IT" Foreground="#FF4299E1" FontSize="13" FontWeight="Medium"/>
                                                <TextBlock x:Name="Wave1UserCount" Text="Week 1-2 • 0 users" Foreground="#FFA0AEC0" FontSize="11"/>
                                                <ProgressBar Value="100" Maximum="100" Height="4" Background="#FF1A202C" Foreground="#FF4299E1" BorderThickness="0" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        
                                        <Border x:Name="Wave2DropZone" Tag="2" Margin="0,0,0,16" Background="Transparent" 
                                                AllowDrop="True" Drop="WaveDropZone_Drop" DragOver="WaveDropZone_DragOver" 
                                                DragLeave="WaveDropZone_DragLeave" CornerRadius="4" BorderThickness="2" BorderBrush="Transparent">
                                            <StackPanel>
                                                <TextBlock Text="Wave 2 - Finance &amp; Legal" Foreground="#FF48BB78" FontSize="13" FontWeight="Medium"/>
                                                <TextBlock x:Name="Wave2UserCount" Text="Week 3-5 • 189 users" Foreground="#FFA0AEC0" FontSize="11"/>
                                                <ProgressBar Value="65" Maximum="100" Height="4" Background="#FF1A202C" Foreground="#FF48BB78" BorderThickness="0" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        
                                        <Border x:Name="Wave3DropZone" Tag="3" Margin="0,0,0,16" Background="Transparent" 
                                                AllowDrop="True" Drop="WaveDropZone_Drop" DragOver="WaveDropZone_DragOver" 
                                                DragLeave="WaveDropZone_DragLeave" CornerRadius="4" BorderThickness="2" BorderBrush="Transparent">
                                            <StackPanel>
                                                <TextBlock Text="Wave 3 - Sales &amp; Marketing" Foreground="#FFED8936" FontSize="13" FontWeight="Medium"/>
                                                <TextBlock x:Name="Wave3UserCount" Text="Week 6-8 • 456 users" Foreground="#FFA0AEC0" FontSize="11"/>
                                                <ProgressBar Value="20" Maximum="100" Height="4" Background="#FF1A202C" Foreground="#FFED8936" BorderThickness="0" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        
                                        <Border x:Name="Wave4DropZone" Tag="4" Margin="0,0,0,16" Background="Transparent" 
                                                AllowDrop="True" Drop="WaveDropZone_Drop" DragOver="WaveDropZone_DragOver" 
                                                DragLeave="WaveDropZone_DragLeave" CornerRadius="4" BorderThickness="2" BorderBrush="Transparent">
                                            <StackPanel>
                                                <TextBlock Text="Wave 4 - Operations" Foreground="#FF9F7AEA" FontSize="13" FontWeight="Medium"/>
                                                <TextBlock x:Name="Wave4UserCount" Text="Week 9-11 • 298 users" Foreground="#FFA0AEC0" FontSize="11"/>
                                                <ProgressBar Value="0" Maximum="100" Height="4" Background="#FF1A202C" Foreground="#FF9F7AEA" BorderThickness="0" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                        
                                        <Border x:Name="Wave5DropZone" Tag="5" Background="Transparent" 
                                                AllowDrop="True" Drop="WaveDropZone_Drop" DragOver="WaveDropZone_DragOver" 
                                                DragLeave="WaveDropZone_DragLeave" CornerRadius="4" BorderThickness="2" BorderBrush="Transparent">
                                            <StackPanel>
                                                <TextBlock Text="Wave 5 - General Users" Foreground="#FFF56565" FontSize="13" FontWeight="Medium"/>
                                                <TextBlock x:Name="Wave5UserCount" Text="Week 12+ • 70 users" Foreground="#FFA0AEC0" FontSize="11"/>
                                                <ProgressBar Value="0" Maximum="100" Height="4" Background="#FF1A202C" Foreground="#FFF56565" BorderThickness="0" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>
                                
                                <TextBlock Text="Risk Assessment" Style="{StaticResource SectionHeaderStyle}" Margin="0,16,0,8"/>
                                <Border Background="#FF2D3748" CornerRadius="6" Padding="16">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                            <Ellipse Width="8" Height="8" Fill="#FF48BB78" Margin="0,0,8,0"/>
                                            <TextBlock Text="Low Risk: 67%" Foreground="#FF9AE6B4" FontSize="12"/>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                            <Ellipse Width="8" Height="8" Fill="#FFED8936" Margin="0,0,8,0"/>
                                            <TextBlock Text="Medium Risk: 28%" Foreground="#FFFBB859" FontSize="12"/>
                                        </StackPanel>
                                        
                                        <StackPanel Orientation="Horizontal">
                                            <Ellipse Width="8" Height="8" Fill="#FFF56565" Margin="0,0,8,0"/>
                                            <TextBlock Text="High Risk: 5%" Foreground="#FFFED7D7" FontSize="12"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </ScrollViewer>
            
            <!-- Migrate View -->
            <Grid x:Name="MigrateView" Visibility="Collapsed" Margin="30">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="Migration" Style="{StaticResource HeaderTextStyle}"/>
                
                <TabControl Grid.Row="1" Background="Transparent" BorderThickness="0">
                    <TabControl.Resources>
                        <Style TargetType="TabItem">
                            <Setter Property="Foreground" Value="White"/>
                            <Setter Property="Background" Value="#FF2D2D30"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Setter Property="Padding" Value="20,10"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TabItem">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                Margin="0,0,2,0">
                                            <ContentPresenter x:Name="ContentSite"
                                                              VerticalAlignment="Center"
                                                              HorizontalAlignment="Center"
                                                              ContentSource="Header"
                                                              Margin="{TemplateBinding Padding}"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#FF007ACC"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabControl.Resources>
                    
                    <TabItem Header="User Migration">
                        <Grid Margin="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Text="User Account Migration" 
                                       Foreground="White" FontSize="18" Margin="0,0,0,20"/>
                            
                            <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,20">
                                <Button Content="Select Users" Click="SelectUsers_Click"
                                        Background="#FF3E3E42" Foreground="White"
                                        Padding="15,8" Margin="0,0,10,0" BorderThickness="0"/>
                                <Button Content="Map Security Groups" Click="MapSecurityGroups_Click"
                                        Background="#FF3E3E42" Foreground="White"
                                        Padding="15,8" Margin="0,0,10,0" BorderThickness="0"/>
                                <Button Content="Start Migration" Click="StartUserMigration_Click"
                                        Background="#FF007ACC" Foreground="White"
                                        Padding="15,8" BorderThickness="0"/>
                            </StackPanel>
                            
                            <DataGrid Grid.Row="2" x:Name="UserMigrationGrid"
                                      Background="#FF2D2D30" Foreground="White"
                                      BorderBrush="#FF3E3E42"/>
                        </Grid>
                    </TabItem>
                    
                    <TabItem Header="Mailbox Migration">
                        <Grid Margin="20">
                            <TextBlock Text="Mailbox Migration Module" Foreground="White" FontSize="16"/>
                        </Grid>
                    </TabItem>
                    
                    <TabItem Header="SharePoint Migration">
                        <Grid Margin="20">
                            <TextBlock Text="SharePoint Migration Module" Foreground="White" FontSize="16"/>
                        </Grid>
                    </TabItem>
                    
                    <TabItem Header="Teams Migration">
                        <Grid Margin="20">
                            <TextBlock Text="Teams Migration Module" Foreground="White" FontSize="16"/>
                        </Grid>
                    </TabItem>
                    
                    <TabItem Header="OneDrive Migration">
                        <Grid Margin="20">
                            <TextBlock Text="OneDrive Migration Module" Foreground="White" FontSize="16"/>
                        </Grid>
                    </TabItem>
                </TabControl>
            </Grid>
            
            <!-- Reports View -->
            <Grid x:Name="ReportsView" Visibility="Collapsed" Margin="32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="Reports &amp; Analytics" Style="{StaticResource HeaderTextStyle}"/>
                
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Executive Summary Reports -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Executive Summary Reports" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="High-level overview reports for management and stakeholders" 
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <WrapPanel>
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="{StaticResource AccentGradient}"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateDiscoverySummary_Click">
                                        <StackPanel>
                                            <TextBlock Text="📊" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="Discovery Summary"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateUserAnalytics_Click">
                                        <StackPanel>
                                            <TextBlock Text="📈" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="User Analytics"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateInfrastructureReport_Click">
                                        <StackPanel>
                                            <TextBlock Text="🏢" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="Infrastructure Report"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateMigrationReadiness_Click">
                                        <StackPanel>
                                            <TextBlock Text="📉" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="Migration Readiness"/>
                                        </StackPanel>
                                    </Button>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Technical Reports -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Technical Reports" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Detailed technical reports for IT teams and architects" 
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <WrapPanel>
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateSecurityAudit_Click">
                                        <StackPanel>
                                            <TextBlock Text="🔒" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="Security Audit"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateDependencyMap_Click">
                                        <StackPanel>
                                            <TextBlock Text="🔗" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="Dependency Map"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateConfigurationReport_Click">
                                        <StackPanel>
                                            <TextBlock Text="🔧" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="Configuration Report"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="GenerateNetworkTopology_Click">
                                        <StackPanel>
                                            <TextBlock Text="📡" FontSize="24" Margin="0,0,0,4"/>
                                            <TextBlock Text="Network Topology"/>
                                        </StackPanel>
                                    </Button>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Custom Reports -->
                        <Border Style="{StaticResource ModernCardStyle}">
                            <StackPanel>
                                <TextBlock Text="Custom Reports" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Create custom reports based on discovery data" 
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="Report Type:" Foreground="#FFE2E8F0" FontSize="13" Margin="0,0,0,8"/>
                                        <ComboBox Background="#FF2D3748" Foreground="#FFE2E8F0"
                                                  BorderBrush="#FF4A5568" Height="36" Margin="0,0,0,12">
                                            <ComboBoxItem>User Distribution by Department</ComboBoxItem>
                                            <ComboBoxItem>Device Compliance Status</ComboBoxItem>
                                            <ComboBoxItem>Application Usage Analysis</ComboBoxItem>
                                            <ComboBoxItem>Security Group Membership</ComboBoxItem>
                                            <ComboBoxItem>Migration Wave Summary</ComboBoxItem>
                                        </ComboBox>
                                        
                                        <TextBlock Text="Format:" Foreground="#FFE2E8F0" FontSize="13" Margin="0,0,0,8"/>
                                        <WrapPanel>
                                            <RadioButton Content="PDF" Foreground="#FFE2E8F0" IsChecked="True" Margin="0,0,20,0"/>
                                            <RadioButton Content="Excel" Foreground="#FFE2E8F0" Margin="0,0,20,0"/>
                                            <RadioButton Content="HTML" Foreground="#FFE2E8F0" Margin="0,0,20,0"/>
                                            <RadioButton Content="CSV" Foreground="#FFE2E8F0"/>
                                        </WrapPanel>
                                    </StackPanel>
                                    
                                    <Button Grid.Column="1" Content="Generate Report" 
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Background="{StaticResource SuccessGradient}"
                                            VerticalAlignment="Bottom" Margin="16,0,0,0"
                                            Click="GenerateCustomReport_Click"/>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
            
            <!-- Settings View -->
            <Grid x:Name="SettingsView" Visibility="Collapsed" Margin="32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="Settings &amp; Configuration" Style="{StaticResource HeaderTextStyle}"/>
                
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Discovery Data Path Settings -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Discovery Data Location" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Configure where company profiles and discovery data are stored" 
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Column="0" Text="Current Path:" 
                                               Foreground="#FFE2E8F0" FontSize="14" 
                                               VerticalAlignment="Center" Margin="0,0,16,0"/>
                                    
                                    <TextBox Grid.Column="1" x:Name="DataPathTextBox" 
                                             Background="#FF2D3748" Foreground="#FFE2E8F0"
                                             BorderBrush="#FF4A5568" BorderThickness="1"
                                             Padding="12,8" FontSize="13"
                                             Text="C:\DiscoveryData" IsReadOnly="True"/>
                                    
                                    <Button Grid.Column="2" Content="Change Path" 
                                            Click="ChangeDataPath_Click"
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Margin="12,0,0,0"/>
                                </Grid>
                                
                                <TextBlock Text="Note: Changing the path will require restarting the application" 
                                           Foreground="#FFFBB859" FontSize="11" Margin="0,8,0,0"/>
                            </StackPanel>
                        </Border>
                        
                        <!-- App Registration Setup -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Azure App Registration Setup" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Configure Azure AD app registration for discovery modules" 
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <WrapPanel>
                                    <Button Content="Run App Registration Script" 
                                            Click="RunAppRegistration_Click"
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Background="{StaticResource AccentGradient}"
                                            Margin="0,0,12,8">
                                        <Button.ToolTip>
                                            <ToolTip>
                                                <TextBlock Text="Creates Azure AD app registration with required permissions for discovery"/>
                                            </ToolTip>
                                        </Button.ToolTip>
                                    </Button>
                                    
                                    <Button Content="🔐 App Registration" 
                                            Click="AppRegistration_Click"
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF6B46C1"
                                            Margin="0,0,12,8">
                                        <Button.ToolTip>
                                            <ToolTip>
                                                <TextBlock Text="Create Azure AD App Registration with required permissions for M&amp;A Discovery" 
                                                           MaxWidth="300" TextWrapping="Wrap"/>
                                            </ToolTip>
                                        </Button.ToolTip>
                                    </Button>
                                    
                                    <Button Content="Configure Credentials" 
                                            Click="ConfigureCredentials_Click"
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748"
                                            Margin="0,0,12,8">
                                        <Button.ToolTip>
                                            <ToolTip>
                                                <TextBlock Text="Configure credentials for the selected company profile"/>
                                            </ToolTip>
                                        </Button.ToolTip>
                                    </Button>
                                    
                                    <Button Content="Test Connection" 
                                            Click="TestConnection_Click"
                                            Style="{StaticResource ModernButtonStyle}" 
                                            Background="#FF2D3748">
                                        <Button.ToolTip>
                                            <ToolTip>
                                                <TextBlock Text="Test Azure AD connection with current credentials"/>
                                            </ToolTip>
                                        </Button.ToolTip>
                                    </Button>
                                </WrapPanel>
                                
                                <Border Background="#FF2D3748" CornerRadius="6" Padding="16" Margin="0,16,0,0">
                                    <StackPanel>
                                        <TextBlock Text="Required Permissions:" Foreground="#FFE2E8F0" FontSize="13" FontWeight="Medium" Margin="0,0,0,8"/>
                                        <TextBlock Text="• Directory.Read.All - Read directory data" Foreground="#FFA0AEC0" FontSize="12"/>
                                        <TextBlock Text="• User.Read.All - Read all users' profiles" Foreground="#FFA0AEC0" FontSize="12"/>
                                        <TextBlock Text="• Group.Read.All - Read all groups" Foreground="#FFA0AEC0" FontSize="12"/>
                                        <TextBlock Text="• Application.Read.All - Read all applications" Foreground="#FFA0AEC0" FontSize="12"/>
                                        <TextBlock Text="• Policy.Read.All - Read organization policies" Foreground="#FFA0AEC0" FontSize="12"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                        
                        <!-- Module Settings -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Discovery Module Settings" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Configure default settings for discovery modules" 
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Default Network Ranges:" 
                                               Foreground="#FFE2E8F0" FontSize="13" 
                                               VerticalAlignment="Center" Margin="0,0,0,8"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="NetworkRangesTextBox"
                                             Background="#FF2D3748" Foreground="#FFE2E8F0"
                                             BorderBrush="#FF4A5568" BorderThickness="1"
                                             Padding="8,6" FontSize="12" Margin="0,0,0,8"
                                             Text="10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16"/>
                                    
                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Discovery Timeout (min):" 
                                               Foreground="#FFE2E8F0" FontSize="13" 
                                               VerticalAlignment="Center" Margin="0,0,0,8"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" x:Name="TimeoutTextBox"
                                             Background="#FF2D3748" Foreground="#FFE2E8F0"
                                             BorderBrush="#FF4A5568" BorderThickness="1"
                                             Padding="8,6" FontSize="12" Margin="0,0,0,8"
                                             Text="30"/>
                                    
                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="Max Concurrent Threads:" 
                                               Foreground="#FFE2E8F0" FontSize="13" 
                                               VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" x:Name="ThreadsTextBox"
                                             Background="#FF2D3748" Foreground="#FFE2E8F0"
                                             BorderBrush="#FF4A5568" BorderThickness="1"
                                             Padding="8,6" FontSize="12"
                                             Text="10"/>
                                </Grid>
                                
                                <Button Content="Save Module Settings" 
                                        Click="SaveModuleSettings_Click"
                                        Style="{StaticResource ModernButtonStyle}" 
                                        HorizontalAlignment="Right" Margin="0,16,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
            
            <!-- Applications View -->
            <Grid x:Name="ApplicationsView" Visibility="Collapsed" Margin="32">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <TextBlock Grid.Row="0" Text="Application Discovery &amp; Catalog" Style="{StaticResource HeaderTextStyle}"/>
            
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <!-- Discovery Overview Cards -->
                    <Grid Margin="0,0,0,24">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <Border Grid.Column="0" Style="{StaticResource ModernCardStyle}" Margin="0,0,8,0">
                            <StackPanel>
                                <TextBlock Text="📱" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock x:Name="TotalAppsCount" Text="0" FontSize="24" FontWeight="Bold" 
                                           Foreground="#FF4299E1" HorizontalAlignment="Center"/>
                                <TextBlock Text="Total Applications" FontSize="12" Foreground="#FFA0AEC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="1" Style="{StaticResource ModernCardStyle}" Margin="8,0">
                            <StackPanel>
                                <TextBlock Text="⚠️" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock x:Name="HighRiskAppsCount" Text="0" FontSize="24" FontWeight="Bold" 
                                           Foreground="#FFE53E3E" HorizontalAlignment="Center"/>
                                <TextBlock Text="High Risk Apps" FontSize="12" Foreground="#FFA0AEC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="2" Style="{StaticResource ModernCardStyle}" Margin="8,0">
                            <StackPanel>
                                <TextBlock Text="☁️" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock x:Name="CloudReadyAppsCount" Text="0" FontSize="24" FontWeight="Bold" 
                                           Foreground="#FF48BB78" HorizontalAlignment="Center"/>
                                <TextBlock Text="Cloud Ready" FontSize="12" Foreground="#FFA0AEC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        
                        <Border Grid.Column="3" Style="{StaticResource ModernCardStyle}" Margin="8,0,0,0">
                            <StackPanel>
                                <TextBlock Text="🔄" FontSize="32" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock x:Name="PendingReviewCount" Text="0" FontSize="24" FontWeight="Bold" 
                                           Foreground="#FFFBB859" HorizontalAlignment="Center"/>
                                <TextBlock Text="Pending Review" FontSize="12" Foreground="#FFA0AEC0" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                    
                    <!-- Application Discovery Actions -->
                    <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Application Discovery" Style="{StaticResource SectionHeaderStyle}"/>
                            <TextBlock Text="Discover and catalog applications across your infrastructure" 
                                       Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                            
                            <WrapPanel>
                                <Button x:Name="RunAppDiscoveryButton" Style="{StaticResource ModernButtonStyle}" 
                                        Background="{StaticResource AccentGradient}"
                                        Margin="0,0,12,12" Padding="20,12"
                                        Click="RunAppDiscovery_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0"/>
                                        <TextBlock Text="Run Full App Discovery"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="ImportAppListButton" Style="{StaticResource ModernButtonStyle}" 
                                        Background="#FF48BB78" Foreground="White"
                                        Margin="0,0,12,12" Padding="20,12"
                                        Click="ImportAppList_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="📂" FontSize="16" Margin="0,0,8,0"/>
                                        <TextBlock Text="Import App List"/>
                                    </StackPanel>
                                </Button>
                                
                                <Button x:Name="RefreshAppsButton" Style="{StaticResource ModernButtonStyle}" 
                                        Background="#FF805AD5" Foreground="White"
                                        Margin="0,0,12,12" Padding="20,12"
                                        Click="RefreshApps_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="🔄" FontSize="16" Margin="0,0,8,0"/>
                                        <TextBlock Text="Refresh Data"/>
                                    </StackPanel>
                                </Button>
                            </WrapPanel>
                        </StackPanel>
                    </Border>
                    
                    <!-- Applications Grid -->
                    <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                        <StackPanel>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Discovered Applications" Style="{StaticResource SectionHeaderStyle}"/>
                                
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <TextBox x:Name="AppSearchBox" Width="200" Height="32" 
                                             Background="#FF2D3748" Foreground="White" BorderBrush="#FF4A5568"
                                             Padding="12,8" FontSize="13" Margin="0,0,12,0"
                                             TextChanged="AppSearchBox_TextChanged">
                                        <TextBox.Resources>
                                            <Style TargetType="TextBox">
                                                <Style.Triggers>
                                                    <Trigger Property="Text" Value="">
                                                        <Setter Property="Background">
                                                            <Setter.Value>
                                                                <VisualBrush Stretch="None">
                                                                    <VisualBrush.Visual>
                                                                        <TextBlock Text="🔍 Search applications..." 
                                                                                   Foreground="#FFA0AEC0" FontSize="13" 
                                                                                   Margin="4,0,0,0"/>
                                                                    </VisualBrush.Visual>
                                                                </VisualBrush>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBox.Resources>
                                    </TextBox>
                                    
                                    <ComboBox x:Name="AppFilterCombo" Width="140" Height="32" 
                                              Background="#FF2D3748" Foreground="White" BorderBrush="#FF4A5568"
                                              SelectionChanged="AppFilterCombo_SelectionChanged">
                                        <ComboBoxItem Content="All Apps" IsSelected="True"/>
                                        <ComboBoxItem Content="High Risk"/>
                                        <ComboBoxItem Content="Cloud Ready"/>
                                        <ComboBoxItem Content="Legacy"/>
                                        <ComboBoxItem Content="Pending Review"/>
                                    </ComboBox>
                                </StackPanel>
                            </Grid>
                            
                            <DataGrid x:Name="ApplicationsGrid" Margin="0,16,0,0" Height="400"
                                      Background="#FF1A202C" Foreground="White" BorderBrush="#FF2D3748"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      RowBackground="#FF2D2D30" AlternatingRowBackground="#FF1A202C"
                                      SelectionMode="Single" IsReadOnly="True"
                                      AutoGenerateColumns="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Application Name" Binding="{Binding Name}" Width="200"/>
                                    <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="100"/>
                                    <DataGridTextColumn Header="Vendor" Binding="{Binding Vendor}" Width="150"/>
                                    <DataGridTextColumn Header="Install Path" Binding="{Binding InstallPath}" Width="250"/>
                                    <DataGridTextColumn Header="Risk Level" Binding="{Binding RiskLevel}" Width="100"/>
                                    <DataGridTextColumn Header="Cloud Readiness" Binding="{Binding CloudReadiness}" Width="120"/>
                                    <DataGridTextColumn Header="Last Updated" Binding="{Binding LastUpdated}" Width="120"/>
                                </DataGrid.Columns>
                                <DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Setter Property="Background" Value="#FF2D2D30"/>
                                        <Setter Property="Foreground" Value="White"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#FF3E3E42"/>
                                            </Trigger>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#FF007ACC"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                            </DataGrid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Application Risk Assessment -->
                    <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                        <StackPanel>
                            <TextBlock Text="Risk Assessment Overview" Style="{StaticResource SectionHeaderStyle}"/>
                            <TextBlock Text="Application migration risk analysis and recommendations" 
                                       Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Risk Chart Placeholder -->
                                <Border Grid.Column="0" Background="#FF1A202C" CornerRadius="8" Margin="0,0,8,0" Height="200">
                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <TextBlock Text="📊" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                        <TextBlock Text="Risk Distribution Chart" FontSize="16" Foreground="#FFA0AEC0" HorizontalAlignment="Center"/>
                                        <TextBlock Text="Coming Soon" FontSize="12" Foreground="#FF4299E1" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- Recommendations -->
                                <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                    <TextBlock Text="Top Recommendations" FontSize="14" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,12"/>
                                    
                                    <Border Background="#FF2D3748" CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                        <StackPanel>
                                            <TextBlock Text="🔴 High Priority" FontSize="12" FontWeight="Medium" Foreground="#FFE53E3E"/>
                                            <TextBlock Text="Review legacy applications for cloud compatibility" FontSize="11" Foreground="#FFA0AEC0" TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <Border Background="#FF2D3748" CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                        <StackPanel>
                                            <TextBlock Text="🟡 Medium Priority" FontSize="12" FontWeight="Medium" Foreground="#FFFBB859"/>
                                            <TextBlock Text="Update application inventory with latest versions" FontSize="11" Foreground="#FFA0AEC0" TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <Border Background="#FF2D3748" CornerRadius="6" Padding="12">
                                        <StackPanel>
                                            <TextBlock Text="🟢 Low Priority" FontSize="12" FontWeight="Medium" Foreground="#FF48BB78"/>
                                            <TextBlock Text="Optimize application licensing for cost savings" FontSize="11" Foreground="#FFA0AEC0" TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                    
                    <!-- Application Dependencies -->
                    <Border Style="{StaticResource ModernCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Application Dependencies" Style="{StaticResource SectionHeaderStyle}"/>
                            <TextBlock Text="Dependency mapping and migration impact analysis" 
                                       Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Dependency Visualization Placeholder -->
                                <Border Grid.Column="0" Background="#FF1A202C" CornerRadius="8" Margin="0,0,8,0" Height="250">
                                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <TextBlock Text="🕸️" FontSize="64" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                        <TextBlock Text="Dependency Map" FontSize="18" Foreground="#FFA0AEC0" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                        <TextBlock Text="Interactive dependency visualization" FontSize="12" Foreground="#FF4299E1" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- Dependency Stats -->
                                <StackPanel Grid.Column="1" Margin="8,0,0,0">
                                    <TextBlock Text="Dependency Statistics" FontSize="14" FontWeight="SemiBold" Foreground="White" Margin="0,0,0,16"/>
                                    
                                    <StackPanel Margin="0,0,0,12">
                                        <TextBlock Text="Critical Dependencies" FontSize="12" Foreground="#FFA0AEC0"/>
                                        <TextBlock x:Name="CriticalDepsCount" Text="0" FontSize="20" FontWeight="Bold" Foreground="#FFE53E3E"/>
                                    </StackPanel>
                                    
                                    <StackPanel Margin="0,0,0,12">
                                        <TextBlock Text="Circular Dependencies" FontSize="12" Foreground="#FFA0AEC0"/>
                                        <TextBlock x:Name="CircularDepsCount" Text="0" FontSize="20" FontWeight="Bold" Foreground="#FFFBB859"/>
                                    </StackPanel>
                                    
                                    <StackPanel Margin="0,0,0,16">
                                        <TextBlock Text="Isolated Applications" FontSize="12" Foreground="#FFA0AEC0"/>
                                        <TextBlock x:Name="IsolatedAppsCount" Text="0" FontSize="20" FontWeight="Bold" Foreground="#FF48BB78"/>
                                    </StackPanel>
                                    
                                    <Button x:Name="AnalyzeDependenciesButton" Style="{StaticResource ModernButtonStyle}" 
                                            Background="{StaticResource AccentGradient}" 
                                            Padding="16,8" HorizontalAlignment="Stretch"
                                            Click="AnalyzeDependencies_Click">
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="🔍" FontSize="14" Margin="0,0,6,0"/>
                                            <TextBlock Text="Analyze Dependencies"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>
        </Grid>
        
        <!-- Enhanced Progress Overlay -->
        <Grid x:Name="ProgressOverlay" Grid.ColumnSpan="2" 
              Background="#DD000000" Visibility="Collapsed">
            <Border Background="#FF1A202C" BorderBrush="#FF2D3748" BorderThickness="1"
                    CornerRadius="12" Width="500" Height="280"
                    HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect Color="#FF000000" Direction="270" ShadowDepth="8" BlurRadius="24" Opacity="0.4"/>
                </Border.Effect>
                <Grid Margin="40">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" x:Name="ProgressTitle" 
                               Text="Operation in Progress" 
                               Foreground="#FFF7FAFC" FontSize="20" FontWeight="SemiBold"
                               HorizontalAlignment="Center" Margin="0,0,0,24"/>
                    
                    <ProgressBar Grid.Row="1" x:Name="ProgressBar" 
                                 Height="8" Margin="0,0,0,16"
                                 Background="#FF2D3748" Foreground="{StaticResource PrimaryGradient}"
                                 BorderThickness="0"/>
                    
                    <TextBlock Grid.Row="2" x:Name="ProgressStatus" 
                               Text="Processing..." 
                               Foreground="#FFA0AEC0" FontSize="14" TextAlignment="Center"
                               Margin="0,0,0,24"/>
                    
                    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,16">
                        <TextBlock Text="⏱️" FontSize="16" Margin="0,0,8,0"/>
                        <TextBlock x:Name="ProgressTimer" Text="00:00" Foreground="#FF4299E1" FontSize="14"/>
                    </StackPanel>
                    
                    <Button Grid.Row="4" Content="Cancel Operation" 
                            Click="CancelOperation_Click"
                            Background="{StaticResource DangerGradient}" Foreground="White"
                            Padding="24,10" BorderThickness="0"
                            HorizontalAlignment="Center" Style="{StaticResource ModernButtonStyle}"/>
                </Grid>
            </Border>
        </Grid>

            <!-- Domain Discovery View -->
            <Grid x:Name="DomainDiscoveryView" Visibility="Collapsed" Margin="32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header -->
                <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,24">
                    <StackPanel>
                        <TextBlock Text="Domain Discovery &amp; DNS Enumeration" Style="{StaticResource PageHeaderStyle}"/>
                        <TextBlock Text="Discover and enumerate domain names, DNS records, and related infrastructure"
                                   Foreground="#FFA0AEC0" FontSize="14" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- Content -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Domain Discovery Actions -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Domain Discovery Tools" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Run comprehensive domain and DNS enumeration scans"
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <WrapPanel>
                                    <Button x:Name="RunDomainScanButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="{StaticResource AccentGradient}"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="RunDomainScan_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Full Domain Scan"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="DnsLookupButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF48BB78" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="DnsLookup_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🌐" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="DNS Lookup"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="SubdomainEnumButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF9F7AEA" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="SubdomainEnum_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🔗" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Subdomain Enumeration"/>
                                        </StackPanel>
                                    </Button>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Domain Results -->
                        <Border Style="{StaticResource ModernCardStyle}">
                            <StackPanel>
                                <TextBlock Text="Discovered Domains" Style="{StaticResource SectionHeaderStyle}"/>
                                <DataGrid x:Name="DomainsDataGrid" Style="{StaticResource ModernDataGridStyle}"
                                          Margin="0,16,0,0" Height="300">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Domain Name" Binding="{Binding DomainName}" Width="200"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="100"/>
                                        <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="150"/>
                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                        <DataGridTextColumn Header="Last Checked" Binding="{Binding LastChecked}" Width="150"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

            <!-- File Servers View -->
            <Grid x:Name="FileServersView" Visibility="Collapsed" Margin="32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header -->
                <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,24">
                    <StackPanel>
                        <TextBlock Text="File Servers &amp; Storage Discovery" Style="{StaticResource PageHeaderStyle}"/>
                        <TextBlock Text="Discover and analyze file servers, shares, and storage infrastructure"
                                   Foreground="#FFA0AEC0" FontSize="14" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- Content -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- File Server Discovery Actions -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="File Server Discovery Tools" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Scan network for file servers and analyze storage usage"
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <WrapPanel>
                                    <Button x:Name="ScanFileServersButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="{StaticResource AccentGradient}"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="ScanFileServers_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Scan File Servers"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="AnalyzeSharesButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF48BB78" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="AnalyzeShares_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="📊" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Analyze Shares"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="StorageReportButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF9F7AEA" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="StorageReport_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="📈" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Storage Report"/>
                                        </StackPanel>
                                    </Button>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- File Servers Results -->
                        <Border Style="{StaticResource ModernCardStyle}">
                            <StackPanel>
                                <TextBlock Text="Discovered File Servers" Style="{StaticResource SectionHeaderStyle}"/>
                                <DataGrid x:Name="FileServersDataGrid" Style="{StaticResource ModernDataGridStyle}"
                                          Margin="0,16,0,0" Height="350">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Server Name" Binding="{Binding ServerName}" Width="150"/>
                                        <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="120"/>
                                        <DataGridTextColumn Header="Share Count" Binding="{Binding ShareCount}" Width="100"/>
                                        <DataGridTextColumn Header="Total Size" Binding="{Binding TotalSize}" Width="120"/>
                                        <DataGridTextColumn Header="Used Space" Binding="{Binding UsedSpace}" Width="120"/>
                                        <DataGridTextColumn Header="Free Space" Binding="{Binding FreeSpace}" Width="120"/>
                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                        <DataGridTextColumn Header="Last Scanned" Binding="{Binding LastScanned}" Width="150"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

            <!-- Databases View -->
            <Grid x:Name="DatabasesView" Visibility="Collapsed" Margin="32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header -->
                <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,24">
                    <StackPanel>
                        <TextBlock Text="Database Discovery &amp; Analysis" Style="{StaticResource PageHeaderStyle}"/>
                        <TextBlock Text="Discover SQL Server, Oracle, MySQL, and other database systems across your infrastructure"
                                   Foreground="#FFA0AEC0" FontSize="14" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- Content -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Database Discovery Actions -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Database Discovery Tools" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Scan network for database servers and analyze database configurations"
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <WrapPanel>
                                    <Button x:Name="ScanDatabasesButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="{StaticResource AccentGradient}"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="ScanDatabases_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Scan Database Servers"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="AnalyzeSQLButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF48BB78" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="AnalyzeSQL_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🗃️" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Analyze SQL Servers"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="DatabaseReportButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF9F7AEA" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="DatabaseReport_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="📊" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Database Report"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="CheckDatabaseVersionsButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FFE53E3E" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="CheckDatabaseVersions_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="⚠️" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Check Versions"/>
                                        </StackPanel>
                                    </Button>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Database Results -->
                        <Border Style="{StaticResource ModernCardStyle}">
                            <StackPanel>
                                <TextBlock Text="Discovered Database Servers" Style="{StaticResource SectionHeaderStyle}"/>
                                <DataGrid x:Name="DatabasesDataGrid" Style="{StaticResource ModernDataGridStyle}"
                                          Margin="0,16,0,0" Height="350">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Server Name" Binding="{Binding ServerName}" Width="150"/>
                                        <DataGridTextColumn Header="IP Address" Binding="{Binding IPAddress}" Width="120"/>
                                        <DataGridTextColumn Header="Database Type" Binding="{Binding DatabaseType}" Width="100"/>
                                        <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="120"/>
                                        <DataGridTextColumn Header="Instance Name" Binding="{Binding InstanceName}" Width="120"/>
                                        <DataGridTextColumn Header="Database Count" Binding="{Binding DatabaseCount}" Width="100"/>
                                        <DataGridTextColumn Header="Total Size" Binding="{Binding TotalSize}" Width="120"/>
                                        <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                        <DataGridTextColumn Header="Last Scanned" Binding="{Binding LastScanned}" Width="150"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>

            <!-- Security View -->
            <Grid x:Name="SecurityView" Visibility="Collapsed" Margin="32">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header -->
                <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,24">
                    <StackPanel>
                        <TextBlock Text="Group Policy &amp; Security Discovery" Style="{StaticResource PageHeaderStyle}"/>
                        <TextBlock Text="Analyze Group Policy settings, security configurations, and compliance posture across your domain"
                                   Foreground="#FFA0AEC0" FontSize="14" Margin="0,8,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- Content -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Security Discovery Actions -->
                        <Border Style="{StaticResource ModernCardStyle}" Margin="0,0,0,16">
                            <StackPanel>
                                <TextBlock Text="Security Assessment Tools" Style="{StaticResource SectionHeaderStyle}"/>
                                <TextBlock Text="Analyze Group Policy Objects, security settings, and compliance status"
                                           Foreground="#FFA0AEC0" FontSize="13" Margin="0,0,0,16"/>
                                
                                <WrapPanel>
                                    <Button x:Name="ScanGPOButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="{StaticResource AccentGradient}"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="ScanGPO_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🔍" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Scan Group Policies"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="SecurityAuditButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FFE53E3E" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="SecurityAudit_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🛡️" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Security Audit"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="ComplianceCheckButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF48BB78" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="ComplianceCheck_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="✅" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Compliance Check"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="VulnerabilityAssessmentButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF9F7AEA" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="VulnerabilityAssessment_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="⚠️" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Vulnerability Scan"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="PasswordPolicyButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FFED8936" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="PasswordPolicy_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🔐" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Password Policies"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="FirewallAnalysisButton" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF38B2AC" Foreground="White"
                                            Margin="0,0,12,12" Padding="20,12"
                                            Click="FirewallAnalysis_Click">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="🔥" FontSize="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Firewall Analysis"/>
                                        </StackPanel>
                                    </Button>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                        
                        <!-- Security Results Tabs -->
                        <Border Style="{StaticResource ModernCardStyle}">
                            <StackPanel>
                                <TextBlock Text="Security Assessment Results" Style="{StaticResource SectionHeaderStyle}"/>
                                
                                <!-- Tab Headers -->
                                <StackPanel Orientation="Horizontal" Margin="0,16,0,16">
                                    <Button x:Name="GPOTabButton" Content="Group Policies" Style="{StaticResource ModernButtonStyle}"
                                            Background="{StaticResource AccentGradient}" Margin="0,0,8,0" Padding="16,8"
                                            Click="SecurityTab_Click" Tag="GPO"/>
                                    <Button x:Name="SecurityTabButton" Content="Security Issues" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF4A5568" Margin="0,0,8,0" Padding="16,8"
                                            Click="SecurityTab_Click" Tag="Security"/>
                                    <Button x:Name="ComplianceTabButton" Content="Compliance" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF4A5568" Margin="0,0,8,0" Padding="16,8"
                                            Click="SecurityTab_Click" Tag="Compliance"/>
                                    <Button x:Name="VulnerabilitiesTabButton" Content="Vulnerabilities" Style="{StaticResource ModernButtonStyle}"
                                            Background="#FF4A5568" Margin="0,0,8,0" Padding="16,8"
                                            Click="SecurityTab_Click" Tag="Vulnerabilities"/>
                                </StackPanel>
                                
                                <!-- GPO Results -->
                                <Grid x:Name="GPOResultsPanel" Visibility="Visible">
                                    <DataGrid x:Name="GPODataGrid" Style="{StaticResource ModernDataGridStyle}"
                                              Height="300">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="GPO Name" Binding="{Binding Name}" Width="200"/>
                                            <DataGridTextColumn Header="Domain" Binding="{Binding Domain}" Width="150"/>
                                            <DataGridTextColumn Header="Linked To" Binding="{Binding LinkedTo}" Width="200"/>
                                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                            <DataGridTextColumn Header="Settings Count" Binding="{Binding SettingsCount}" Width="120"/>
                                            <DataGridTextColumn Header="Risk Level" Binding="{Binding RiskLevel}" Width="100"/>
                                            <DataGridTextColumn Header="Last Modified" Binding="{Binding LastModified}" Width="150"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                                
                                <!-- Security Issues Results -->
                                <Grid x:Name="SecurityResultsPanel" Visibility="Collapsed">
                                    <DataGrid x:Name="SecurityIssuesDataGrid" Style="{StaticResource ModernDataGridStyle}"
                                              Height="300">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Issue Type" Binding="{Binding IssueType}" Width="150"/>
                                            <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="100"/>
                                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="300"/>
                                            <DataGridTextColumn Header="Affected System" Binding="{Binding AffectedSystem}" Width="200"/>
                                            <DataGridTextColumn Header="Recommendation" Binding="{Binding Recommendation}" Width="250"/>
                                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                                
                                <!-- Compliance Results -->
                                <Grid x:Name="ComplianceResultsPanel" Visibility="Collapsed">
                                    <DataGrid x:Name="ComplianceDataGrid" Style="{StaticResource ModernDataGridStyle}"
                                              Height="300">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Control ID" Binding="{Binding ControlId}" Width="100"/>
                                            <DataGridTextColumn Header="Control Name" Binding="{Binding ControlName}" Width="200"/>
                                            <DataGridTextColumn Header="Framework" Binding="{Binding Framework}" Width="120"/>
                                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                            <DataGridTextColumn Header="Score" Binding="{Binding Score}" Width="80"/>
                                            <DataGridTextColumn Header="Evidence" Binding="{Binding Evidence}" Width="200"/>
                                            <DataGridTextColumn Header="Gap Analysis" Binding="{Binding GapAnalysis}" Width="250"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                                
                                <!-- Vulnerabilities Results -->
                                <Grid x:Name="VulnerabilitiesResultsPanel" Visibility="Collapsed">
                                    <DataGrid x:Name="VulnerabilitiesDataGrid" Style="{StaticResource ModernDataGridStyle}"
                                              Height="300">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="CVE ID" Binding="{Binding CveId}" Width="120"/>
                                            <DataGridTextColumn Header="Title" Binding="{Binding Title}" Width="250"/>
                                            <DataGridTextColumn Header="CVSS Score" Binding="{Binding CvssScore}" Width="100"/>
                                            <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="100"/>
                                            <DataGridTextColumn Header="Affected Systems" Binding="{Binding AffectedSystems}" Width="200"/>
                                            <DataGridTextColumn Header="Patch Available" Binding="{Binding PatchAvailable}" Width="120"/>
                                            <DataGridTextColumn Header="Exploit Available" Binding="{Binding ExploitAvailable}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
    </Grid>
</Window>