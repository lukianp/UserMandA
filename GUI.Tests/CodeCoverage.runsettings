<?xml version="1.0" encoding="utf-8"?>
<RunSettings>
  <DataCollectionRunSettings>
    <DataCollectors>
      <DataCollector friendlyName="Code Coverage" uri="datacollector://Microsoft/CodeCoverage/2.0" assemblyQualifiedName="Microsoft.VisualStudio.Coverage.DynamicCoverageDataCollector, Microsoft.VisualStudio.TraceCollection, Version=11.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a">
        <Configuration>
          <CoverageFileName>coverage.coverage</CoverageFileName>
          <CodeCoverage>
            <!-- Include assemblies from the main GUI project -->
            <ModulePaths>
              <Include>
                <ModulePath>.*MandADiscoverySuite\.dll$</ModulePath>
                <ModulePath>.*MandADiscoverySuite\.exe$</ModulePath>
              </Include>
            </ModulePaths>

            <!-- Include specific namespaces for coverage -->
            <Include>
              <Function>^MandADiscoverySuite\.ViewModels\..*</Function>
              <Function>^MandADiscoverySuite\.Services\..*</Function>
              <Function>^MandADiscoverySuite\.Models\..*</Function>
              <Function>^MandADiscoverySuite\.Controls\..*</Function>
              <Function>^MandADiscoverySuite\.Converters\..*</Function>
              <Function>^MandADiscoverySuite\.Behaviors\..*</Function>
            </Include>

            <!-- Exclude test assemblies and third-party code -->
            <Exclude>
              <Function>^GUI\.Tests\..*</Function>
              <Function>^Microsoft\..*</Function>
              <Function>^System\..*</Function>
              <Function>^Newtonsoft\.Json\..*</Function>
              <Function>^CommunityToolkit\.Mvvm\..*</Function>
              <Function>^Moq\..*</Function>
              <Function>^MSTest\..*</Function>
              <Function>^xunit\..*</Function>
              <Function>^NUnit\..*</Function>
              <Function>.*\.Tests\..*</Function>
            </Exclude>

            <!-- Include source files -->
            <Sources>
              <Include>
                <SourceFile>../GUI/**/*.cs</SourceFile>
              </Include>
              <Exclude>
                <SourceFile>../GUI/**/obj/**/*.cs</SourceFile>
                <SourceFile>../GUI/**/bin/**/*.cs</SourceFile>
                <SourceFile>../GUI/Examples/**/*.cs</SourceFile>
                <SourceFile>../GUI/Documentation/**/*.cs</SourceFile>
                <SourceFile>../GUI/**/*.g.cs</SourceFile>
                <SourceFile>../GUI/**/*.AssemblyInfo.cs</SourceFile>
                <SourceFile>../GUI/**/*.AssemblyAttributes.cs</SourceFile>
              </Exclude>
            </Sources>

            <!-- Company paths to exclude -->
            <CompanyPaths>
              <Exclude>
                <CompanyPath>.*</CompanyPath>
              </Exclude>
            </CompanyPaths>

            <!-- Attributes to exclude from coverage -->
            <Attributes>
              <Exclude>
                <Attribute>^System\.Runtime\.CompilerServices\.CompilerGeneratedAttribute$</Attribute>
                <Attribute>^System\.CodeDom\.Compiler\.GeneratedCodeAttribute$</Attribute>
                <Attribute>^System\.Diagnostics\.DebuggerNonUserCodeAttribute$</Attribute>
                <Attribute>^System\.Diagnostics\.CodeAnalysis\.ExcludeFromCodeCoverageAttribute$</Attribute>
              </Exclude>
            </Attributes>

            <!-- Functions to exclude from coverage -->
            <Functions>
              <Exclude>
                <Function>^get_.*</Function>
                <Function>^set_.*</Function>
                <Function>.*\.get_.*</Function>
                <Function>.*\.set_.*</Function>
              </Exclude>
            </Functions>

            <!-- Enable branch coverage -->
            <UseVerifiableInstrumentation>True</UseVerifiableInstrumentation>
            <AllowLowIntegrityProcesses>True</AllowLowIntegrityProcesses>
            <CollectFromChildProcesses>True</CollectFromChildProcesses>
            <CollectAspDotNet>False</CollectAspDotNet>

          </CodeCoverage>
        </Configuration>
      </DataCollector>
    </DataCollectors>
  </DataCollectionRunSettings>
</RunSettings>